<span data-ttu-id="79ff2-101">Azure에서 Windows VM(가상 컴퓨터)에 부팅 또는 디스크 오류가 발생하는 경우 가상 하드 디스크에서 바로 문제 해결 단계를 수행해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-101">If your virtual machine (VM) in Azure encounters a boot or disk error, you may need to perform troubleshooting steps on the virtual hard disk itself.</span></span> <span data-ttu-id="79ff2-102">일반적인 예로는 응용 프로그램 업데이트가 실패하여 VM이 성공적으로 부팅되지 않는 경우입니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-102">A common example would be a failed application update that prevents the VM from booting successfully.</span></span> <span data-ttu-id="79ff2-103">이 문서는 가상 하드 디스크를 다른 VM에 연결하여 모든 오류를 수정한 후 원래 VM을 다시 만들기 위해 Azure Portal을 사용하는 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-103">This article describes how to use Azure portal to connect your virtual hard disk to another VM to fix any errors and then re-create your original VM.</span></span>

## <a name="recovery-process-overview"></a><span data-ttu-id="79ff2-104">복구 프로세스 개요</span><span class="sxs-lookup"><span data-stu-id="79ff2-104">Recovery process overview</span></span>
<span data-ttu-id="79ff2-105">문제 해결 프로세스는 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-105">The troubleshooting process is as follows:</span></span>

1. <span data-ttu-id="79ff2-106">문제가 발생하는 VM을 삭제하지만, 가상 하드 디스크는 유지합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-106">Delete the VM that's encountering issues, but retain the virtual hard disks.</span></span>
2. <span data-ttu-id="79ff2-107">문제 해결을 위해 가상 하드 디스크를 다른 VM에 연결하고 탑재합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-107">Attach and mount the virtual hard disk to another VM for troubleshooting.</span></span>
3. <span data-ttu-id="79ff2-108">문제 해결 VM에 연결합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-108">Connect to the troubleshooting VM.</span></span> <span data-ttu-id="79ff2-109">파일을 편집하거나 도구를 실행하여 원래의 가상 하드 디스크에서 오류를 수정합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-109">Edit files or run tools to fix errors on the original virtual hard disk.</span></span>
4. <span data-ttu-id="79ff2-110">문제 해결 VM에서 가상 하드 디스크를 탑재 해제하고 분리합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-110">Unmount and detach the virtual hard disk from the troubleshooting VM.</span></span>
5. <span data-ttu-id="79ff2-111">원래 가상 하드 디스크를 사용하여 VM을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-111">Create a VM by using the original virtual hard disk.</span></span>

## <a name="delete-the-original-vm"></a><span data-ttu-id="79ff2-112">원본 VM 삭제</span><span class="sxs-lookup"><span data-stu-id="79ff2-112">Delete the original VM</span></span>
<span data-ttu-id="79ff2-113">가상 하드 디스크와 VM은 Azure의 두 가지 별개의 리소스입니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-113">Virtual hard disks and VMs are two distinct resources in Azure.</span></span> <span data-ttu-id="79ff2-114">가상 하드 디스크에는 운영 체제, 응용 프로그램 및 구성이 저장됩니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-114">A virtual hard disk is where the operating system, applications, and configurations are stored.</span></span> <span data-ttu-id="79ff2-115">VM은 크기 또는 위치를 정의하고 가상 하드 디스크 또는 가상 NIC(네트워크 인터페이스 카드)와 같은 리소스를 참조하는 메타데이터일 뿐입니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-115">The VM is just metadata that defines the size or location and that references resources such as a virtual hard disk or virtual network interface card (NIC).</span></span> <span data-ttu-id="79ff2-116">각 가상 하드 디스크에는 VM에 연결할 때 임대가 할당됩니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-116">Each virtual hard disk gets a lease assigned when that disk is attached to a VM.</span></span> <span data-ttu-id="79ff2-117">VM을 실행하는 동안에도 데이터 디스크를 연결하고 분리할 수 있지만, VM 리소스를 삭제하지 않는 한 OS 디스크를 분리할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-117">Although data disks can be attached and detached even while the VM is running, the OS disk cannot be detached unless the VM resource is deleted.</span></span> <span data-ttu-id="79ff2-118">해당 VM이 중지 및 할당 취소된 상태에 있을 때에도 임대는 OS 디스크와 VM을 계속 연결합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-118">The lease continues to associate the OS disk to a VM even when that VM is in a stopped and deallocated state.</span></span>

<span data-ttu-id="79ff2-119">VM을 복구하는 첫 번째 단계는 자체 VM 리소스를 삭제하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-119">The first step to recovering your VM is to delete the VM resource itself.</span></span> <span data-ttu-id="79ff2-120">VM을 삭제하면 가상 하드 디스크는 저장소 계정에 남게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-120">Deleting the VM leaves the virtual hard disks in your storage account.</span></span> <span data-ttu-id="79ff2-121">VM을 삭제한 후 가상 하드 디스크를 다른 VM에 연결하여 문제와 오류를 해결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-121">After the VM is deleted, you can attach the virtual hard disk to another VM to troubleshoot and resolve the errors.</span></span> 

1. <span data-ttu-id="79ff2-122">[Azure 포털](https://portal.azure.com)에 로그인합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-122">Sign in to the [Azure portal](https://portal.azure.com).</span></span> 
2. <span data-ttu-id="79ff2-123">왼쪽 메뉴에서 **Virtual Machines(클래식)**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-123">On the menu on the left side, click **Virtual Machines (classic)**.</span></span>
3. <span data-ttu-id="79ff2-124">문제가 있는 VM을 선택하고 **디스크**를 클릭한 후 가상 하드 디스크의 이름을 식별합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-124">Select the VM that has the problem, click **Disks**, and then identify the name of the virtual hard disk.</span></span> 
4. <span data-ttu-id="79ff2-125">OS 가상 하드 디스크를 선택하고 **위치**를 확인하여 가상 하드 디스크가 있는 저장소 계정을 식별합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-125">Select the OS virtual hard disk and check the **Location** to identify the storage account that contains that virtual hard disk.</span></span> <span data-ttu-id="79ff2-126">다음 예제에서는 “.blob.core.windows.net” 앞의 문자열이 저장소 계정 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-126">In the following example, the string immediately before ".blob.core.windows.net" is the storage account name.</span></span>

    ```
    https://portalvhds73fmhrw5xkp43.blob.core.windows.net/vhds/SCCM2012-2015-08-28.vhd
    ```

    ![VM의 위치에 대한 이미지](./media/virtual-machines-classic-recovery-disks-portal/vm-location.png)

5. <span data-ttu-id="79ff2-128">VM을 마우스 오른쪽 단추로 클릭한 다음 **삭제**를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-128">Right-click the VM and then select **Delete**.</span></span> <span data-ttu-id="79ff2-129">VM을 삭제하는 경우 디스크가 선택되어 있지 않아야 합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-129">Make sure that the disks are not selected when you delete the VM.</span></span>
6. <span data-ttu-id="79ff2-130">새 복구 VM을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-130">Create a new recovery VM.</span></span> <span data-ttu-id="79ff2-131">이 VM은 문제 VM과 동일한 지역 및 리소스 그룹(클라우드 서비스)에 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-131">This VM must be in the same region and resource group (Cloud Service) as the problem VM.</span></span>
7. <span data-ttu-id="79ff2-132">복구 VM을 선택한 다음 **디스크** > **기존 연결**을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-132">Select the recovery VM, and then select **Disks** > **Attach Existing**.</span></span>
8. <span data-ttu-id="79ff2-133">기존 가상 하드 디스크를 선택하려면 **VHD 파일**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-133">To select your existing virtual hard disk, click **VHD File**:</span></span>

    ![기존 VHD 찾아보기](./media/virtual-machines-classic-recovery-disks-portal/select-vhd-location.png)

9. <span data-ttu-id="79ff2-135">저장소 계정 > VHD 컨테이너 > 가상 하드 디스크를 선택하고 **선택** 단추를 클릭하여 선택한 내용을 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-135">Select the storage account > VHD container > the virtual hard disk, click the **Select** button to confirm your choice.</span></span>

    ![기존 VHD 선택](./media/virtual-machines-classic-recovery-disks-portal/select-vhd.png)

10. <span data-ttu-id="79ff2-137">이제 VHD를 선택하였으므로 **확인**을 선택하여 기존 가상 하드 디스크를 연결합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-137">With your VHD now selected, select **OK** to attach the existing virtual hard disk.</span></span>
11. <span data-ttu-id="79ff2-138">몇 초 후에 VM의 **디스크** 창에서는 데이터 디스크로 연결된 기존 가상 하드 디스크가 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-138">After a few seconds, the **Disks** pane for your VM will display your existing virtual hard disk connected as a data disk:</span></span>

    ![데이터 디스크로 연결된 기존 가상 하드 디스크](./media/virtual-machines-classic-recovery-disks-portal/attached-disk.png)

## <a name="fix-issues-on-the-original-virtual-hard-disk"></a><span data-ttu-id="79ff2-140">원래 가상 하드 디스크의 문제 해결</span><span class="sxs-lookup"><span data-stu-id="79ff2-140">Fix issues on the original virtual hard disk</span></span>
<span data-ttu-id="79ff2-141">기존 가상 하드 디스크가 탑재되면 이제 필요에 따라 모든 유지 관리 및 문제 해결 단계를 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-141">When the existing virtual hard disk is mounted, you can now perform any maintenance and troubleshooting steps as needed.</span></span> <span data-ttu-id="79ff2-142">문제가 해결되면 다음 단계를 계속합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-142">Once you have addressed the issues, continue with the following steps.</span></span>

## <a name="unmount-and-detach-the-original-virtual-hard-disk"></a><span data-ttu-id="79ff2-143">원래 가상 하드 디스크의 탑재 해제 및 분리</span><span class="sxs-lookup"><span data-stu-id="79ff2-143">Unmount and detach the original virtual hard disk</span></span>
<span data-ttu-id="79ff2-144">오류가 해결되면 문제 해결 VM에서 기존 가상 하드 디스크를 탑재 해제하고 분리합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-144">Once any errors are resolved, unmount and detach the existing virtual hard disk from your troubleshooting VM.</span></span> <span data-ttu-id="79ff2-145">가상 하드 디스크를 문제 해결 VM에 연결하는 임대가 해제될 때까지 가상 하드 디스크를 다른 VM과 함께 사용할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-145">You cannot use your virtual hard disk together with any other VM until the lease that attaches the virtual hard disk to the troubleshooting VM is released.</span></span>  

1. <span data-ttu-id="79ff2-146">[Azure 포털](https://portal.azure.com)에 로그인합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-146">Sign in to the [Azure portal](https://portal.azure.com).</span></span> 
2. <span data-ttu-id="79ff2-147">왼쪽 메뉴에서 **Virtual Machines(클래식)**를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-147">On the menu on the left side, select **Virtual Machines (classic)**.</span></span>
3. <span data-ttu-id="79ff2-148">복구를 VM을 찾습니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-148">Locate the recovery VM.</span></span> <span data-ttu-id="79ff2-149">디스크를 선택하고 디스크를 마우스 오른쪽 단추로 선택한 다음 **분리**를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-149">Select Disks, right-click the disk, and then select **Detach**.</span></span>

## <a name="create-a-vm-from-the-original-hard-disk"></a><span data-ttu-id="79ff2-150">원래 하드 디스크에서 VM 만들기</span><span class="sxs-lookup"><span data-stu-id="79ff2-150">Create a VM from the original hard disk</span></span>

<span data-ttu-id="79ff2-151">원래 가상 하드 디스크에서 VM을 만들려면 [Azure 클래식 포털](https://manage.windowsazure.com)을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-151">To create a VM from your original virtual hard disk, use [Azure classic portal](https://manage.windowsazure.com).</span></span>

1. <span data-ttu-id="79ff2-152">[Azure 클래식 포털](https://manage.windowsazure.com)에 로그인합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-152">Sign into [Azure classic portal](https://manage.windowsazure.com).</span></span>
2. <span data-ttu-id="79ff2-153">포털의 맨 아래에서 **새로 만들기** > **Compute** > **Virtual Machine** > **갤러리에서**를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-153">At the bottom of the portal, select **New** > **Compute** > **Virtual Machine** > **From Gallery**.</span></span>
3. <span data-ttu-id="79ff2-154">**이미지 선택** 섹션에서 **내 디스크**를 선택한 후 원래 가상 하드 디스크를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-154">In the **Choose an Image** section, select **My disks**, and then select the original virtual hard disk.</span></span> <span data-ttu-id="79ff2-155">위치 정보를 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-155">Check the location information.</span></span> <span data-ttu-id="79ff2-156">VM을 배포해야 하는 지역입니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-156">This is the region where the VM must be deployed.</span></span> <span data-ttu-id="79ff2-157">[다음] 단추를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-157">Select the next button.</span></span>
4. <span data-ttu-id="79ff2-158">**가상 컴퓨터 구성** 섹션에서 VM 이름을 입력하고 VM 크기를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="79ff2-158">In the **Virtual machine configuration** section, type the VM name and select a size for the VM.</span></span>