---
title: "aaaHow tooupdate 클라우드 서비스 | Microsoft Docs"
description: "Azure에서 tooupdate 클라우드 서비스 하는 방법에 대해 알아봅니다. 클라우드 서비스에 대 한 업데이트 tooensure 가용성을 진행 하는 방법에 대해 알아봅니다."
services: cloud-services
documentationcenter: 
author: Thraka
manager: timlt
editor: 
ms.assetid: c6a8b5e6-5c99-454c-9911-5c7ae8d1af63
ms.service: cloud-services
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/19/2017
ms.author: adegeo
ms.openlocfilehash: 7e4c8bd46e51a555b4309ea8927d120e8efcf0ea
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/06/2017
---
# <a name="how-tooupdate-a-cloud-service"></a><span data-ttu-id="1aa60-104">어떻게 tooupdate 클라우드 서비스</span><span class="sxs-lookup"><span data-stu-id="1aa60-104">How tooupdate a cloud service</span></span>

<span data-ttu-id="1aa60-105">해당 역할 및 게스트 OS를 포함한 클라우드 서비스 업데이트는 3단계 프로세스입니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-105">Updating a cloud service, including both its roles and guest OS, is a three step process.</span></span> <span data-ttu-id="1aa60-106">첫째, hello 이진 파일 및 새 hello에 대 한 구성 파일에 대 한 클라우드 서비스 또는 OS 버전을 업로드 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-106">First, hello binaries and configuration files for hello new cloud service or OS version must be uploaded.</span></span> <span data-ttu-id="1aa60-107">그런 다음 Azure hello 새 클라우드 서비스 버전의 hello 요구 사항에 따라 hello 클라우드 서비스에 대 한 계산 및 네트워크 리소스를 예약 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-107">Next, Azure reserves compute and network resources for hello cloud service based on hello requirements of hello new cloud service version.</span></span> <span data-ttu-id="1aa60-108">마지막으로, Azure 하 여 가용성을 유지 하면서 롤링 업그레이드 tooincrementally 업데이트 hello 테 넌 트 toohello 새 버전 또는 게스트 OS 수행 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-108">Finally, Azure performs a rolling upgrade tooincrementally update hello tenant toohello new version or guest OS, while preserving your availability.</span></span> <span data-ttu-id="1aa60-109">이 마지막 단계 – hello 롤링 업그레이드의 hello 세부 정보에 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-109">This article discusses hello details of this last step – hello rolling upgrade.</span></span>

## <a name="update-an-azure-service"></a><span data-ttu-id="1aa60-110">Azure 서비스 업데이트</span><span class="sxs-lookup"><span data-stu-id="1aa60-110">Update an Azure Service</span></span>
<span data-ttu-id="1aa60-111">Azure는 업그레이드 도메인(UD)이라는 논리적 그룹으로 역할 인스턴스를 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-111">Azure organizes your role instances into logical groupings called upgrade domains (UD).</span></span> <span data-ttu-id="1aa60-112">업그레이드 도메인(UD)은 그룹으로 업데이트되는 역할 인스턴스의 논리적 집합입니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-112">Upgrade domains (UD) are logical sets of role instances that are updated as a group.</span></span>  <span data-ttu-id="1aa60-113">다른 Ud toocontinue 트래픽 처리에 인스턴스를 허용 하 여 한 번에 하나의 UD를 서비스 하는 클라우드는 azure 업데이트 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-113">Azure updates a cloud service one UD at a time, which allows instances in other UDs toocontinue serving traffic.</span></span>

<span data-ttu-id="1aa60-114">hello 기본 업그레이드 도메인 수는 5입니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-114">hello default number of upgrade domains is 5.</span></span> <span data-ttu-id="1aa60-115">Hello 서비스 정의 파일 (.csdef)에 hello upgradeDomainCount 특성을 포함 하 여 서로 다른 업그레이드 도메인 수를 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-115">You can specify a different number of upgrade domains by including hello upgradeDomainCount attribute in hello service’s definition file (.csdef).</span></span> <span data-ttu-id="1aa60-116">Hello upgradeDomainCount 특성에 대 한 자세한 내용은 참조 [WebRole 스키마](https://msdn.microsoft.com/library/azure/gg557553.aspx) 또는 [WorkerRole 스키마](https://msdn.microsoft.com/library/azure/gg557552.aspx)합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-116">For more information about hello upgradeDomainCount attribute, see [WebRole Schema](https://msdn.microsoft.com/library/azure/gg557553.aspx) or [WorkerRole Schema](https://msdn.microsoft.com/library/azure/gg557552.aspx).</span></span>

<span data-ttu-id="1aa60-117">서비스에 하나 이상의 역할의 내부 업데이트를 수행 하는 경우 Azure toohello 업그레이드 도메인 toowhich 속하는지에 따라 역할 인스턴스의 조합을 업데이트 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-117">When you perform an in-place update of one or more roles in your service, Azure updates sets of role instances according toohello upgrade domain toowhich they belong.</span></span> <span data-ttu-id="1aa60-118">Azure 업데이트 중지 상태로, 업데이트, 지정 된 업그레이드 도메인-hello 인스턴스를 모두 다시 온라인 hello 다음 도메인으로 이동 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-118">Azure updates all of hello instances in a given upgrade domain – stopping them, updating them, bringing them back on-line – then moves onto hello next domain.</span></span> <span data-ttu-id="1aa60-119">현재 hello에서 실행 되는 유일한 hello 인스턴스를 중지 하 여 업그레이드 도메인에서는 Azure와 hello 서비스가 실행 되는 가능한 한 최소한 영향 toohello 업데이트가 발생 하는지 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-119">By stopping only hello instances running in hello current upgrade domain, Azure makes sure that an update occurs with hello least possible impact toohello running service.</span></span> <span data-ttu-id="1aa60-120">자세한 내용은 참조 [hello 업데이트를 처리할 방법을](#howanupgradeproceeds) 이 문서의 뒷부분에 나오는 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-120">For more information, see [How hello update proceeds](#howanupgradeproceeds) later in this article.</span></span>

> [!NOTE]
> <span data-ttu-id="1aa60-121">Hello 용어 동안 **업데이트** 및 **업그레이드** Azure hello 컨텍스트에서 의미가 약간 다르지만, hello 프로세스와이 문서에 hello 기능 설명은 같은 의미로 사용 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-121">While hello terms **update** and **upgrade** have slightly different meaning in hello context Azure, they can be used interchangeably for hello processes and descriptions of hello features in this document.</span></span>
>
>

<span data-ttu-id="1aa60-122">서비스는 해당 역할 업데이트 toobe 내부 가동 중지 시간 없이 대 한 역할의 인스턴스가 둘 이상 정의 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-122">Your service must define at least two instances of a role for that role toobe updated in-place without downtime.</span></span> <span data-ttu-id="1aa60-123">Hello 서비스 역할의 인스턴스가 하나만으로 구성 된 경우 서비스에 사용할 수 없게 됩니다 hello 내부 업데이트가 끝날 때까지 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-123">If hello service consists of only one instance of one role, your service will be unavailable until hello in-place update has finished.</span></span>

<span data-ttu-id="1aa60-124">이 항목에서는 hello 다음 Azure 업데이트에 대 한 정보를 다룹니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-124">This topic covers hello following information about Azure updates:</span></span>

* [<span data-ttu-id="1aa60-125">업데이트 중 허용된 서비스 변경 내용</span><span class="sxs-lookup"><span data-stu-id="1aa60-125">Allowed service changes during an update</span></span>](#AllowedChanges)
* [<span data-ttu-id="1aa60-126">업그레이드 진행 방법</span><span class="sxs-lookup"><span data-stu-id="1aa60-126">How an upgrade proceeds</span></span>](#howanupgradeproceeds)
* [<span data-ttu-id="1aa60-127">업데이트 롤백</span><span class="sxs-lookup"><span data-stu-id="1aa60-127">Rollback of an update</span></span>](#RollbackofanUpdate)
* [<span data-ttu-id="1aa60-128">진행 중인 배포에 여러 변경 작업 시작</span><span class="sxs-lookup"><span data-stu-id="1aa60-128">Initiating multiple mutating operations on an ongoing deployment</span></span>](#multiplemutatingoperations)
* [<span data-ttu-id="1aa60-129">업그레이드 도메인 간 역할의 배포</span><span class="sxs-lookup"><span data-stu-id="1aa60-129">Distribution of roles across upgrade domains</span></span>](#distributiondfroles)

<a name="AllowedChanges"></a>

## <a name="allowed-service-changes-during-an-update"></a><span data-ttu-id="1aa60-130">업데이트 중 허용된 서비스 변경 내용</span><span class="sxs-lookup"><span data-stu-id="1aa60-130">Allowed service changes during an update</span></span>
<span data-ttu-id="1aa60-131">hello 아래 표에 나와 hello 허용 된 변경 내용을 tooa 서비스 업데이트 하는 동안.</span><span class="sxs-lookup"><span data-stu-id="1aa60-131">hello following table shows hello allowed changes tooa service during an update:</span></span>

| <span data-ttu-id="1aa60-132">Toohosting, 서비스 및 역할을 허용 하는 변경</span><span class="sxs-lookup"><span data-stu-id="1aa60-132">Changes permitted toohosting, services, and roles</span></span> | <span data-ttu-id="1aa60-133">전체 업데이트</span><span class="sxs-lookup"><span data-stu-id="1aa60-133">In-place update</span></span> | <span data-ttu-id="1aa60-134">스테이징(VIP 교체)</span><span class="sxs-lookup"><span data-stu-id="1aa60-134">Staged (VIP swap)</span></span> | <span data-ttu-id="1aa60-135">삭제 및 다시 배포</span><span class="sxs-lookup"><span data-stu-id="1aa60-135">Delete and re-deploy</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="1aa60-136">운영 체제 버전</span><span class="sxs-lookup"><span data-stu-id="1aa60-136">Operating system version</span></span> |<span data-ttu-id="1aa60-137">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-137">Yes</span></span> |<span data-ttu-id="1aa60-138">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-138">Yes</span></span> |<span data-ttu-id="1aa60-139">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-139">Yes</span></span> |
| <span data-ttu-id="1aa60-140">.NET 신뢰 수준</span><span class="sxs-lookup"><span data-stu-id="1aa60-140">.NET trust level</span></span> |<span data-ttu-id="1aa60-141">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-141">Yes</span></span> |<span data-ttu-id="1aa60-142">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-142">Yes</span></span> |<span data-ttu-id="1aa60-143">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-143">Yes</span></span> |
| <span data-ttu-id="1aa60-144">가상 컴퓨터 크기<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="1aa60-144">Virtual machine size<sup>1</sup></span></span> |<span data-ttu-id="1aa60-145">예<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="1aa60-145">Yes<sup>2</sup></span></span> |<span data-ttu-id="1aa60-146">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-146">Yes</span></span> |<span data-ttu-id="1aa60-147">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-147">Yes</span></span> |
| <span data-ttu-id="1aa60-148">로컬 저장소 설정</span><span class="sxs-lookup"><span data-stu-id="1aa60-148">Local storage settings</span></span> |<span data-ttu-id="1aa60-149">증가만<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="1aa60-149">Increase only<sup>2</sup></span></span> |<span data-ttu-id="1aa60-150">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-150">Yes</span></span> |<span data-ttu-id="1aa60-151">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-151">Yes</span></span> |
| <span data-ttu-id="1aa60-152">서비스에서 역할 추가 또는 제거</span><span class="sxs-lookup"><span data-stu-id="1aa60-152">Add or remove roles in a service</span></span> |<span data-ttu-id="1aa60-153">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-153">Yes</span></span> |<span data-ttu-id="1aa60-154">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-154">Yes</span></span> |<span data-ttu-id="1aa60-155">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-155">Yes</span></span> |
| <span data-ttu-id="1aa60-156">특정 역할의 인스턴스 수</span><span class="sxs-lookup"><span data-stu-id="1aa60-156">Number of instances of a particular role</span></span> |<span data-ttu-id="1aa60-157">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-157">Yes</span></span> |<span data-ttu-id="1aa60-158">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-158">Yes</span></span> |<span data-ttu-id="1aa60-159">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-159">Yes</span></span> |
| <span data-ttu-id="1aa60-160">서비스에 대한 끝점의 개수 또는 유형</span><span class="sxs-lookup"><span data-stu-id="1aa60-160">Number or type of endpoints for a service</span></span> |<span data-ttu-id="1aa60-161">예<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="1aa60-161">Yes<sup>2</sup></span></span> |<span data-ttu-id="1aa60-162">아니요</span><span class="sxs-lookup"><span data-stu-id="1aa60-162">No</span></span> |<span data-ttu-id="1aa60-163">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-163">Yes</span></span> |
| <span data-ttu-id="1aa60-164">구성 설정의 이름 및 값</span><span class="sxs-lookup"><span data-stu-id="1aa60-164">Names and values of configuration settings</span></span> |<span data-ttu-id="1aa60-165">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-165">Yes</span></span> |<span data-ttu-id="1aa60-166">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-166">Yes</span></span> |<span data-ttu-id="1aa60-167">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-167">Yes</span></span> |
| <span data-ttu-id="1aa60-168">구성 설정의 값(이름 제외)</span><span class="sxs-lookup"><span data-stu-id="1aa60-168">Values (but not names) of configuration settings</span></span> |<span data-ttu-id="1aa60-169">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-169">Yes</span></span> |<span data-ttu-id="1aa60-170">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-170">Yes</span></span> |<span data-ttu-id="1aa60-171">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-171">Yes</span></span> |
| <span data-ttu-id="1aa60-172">새 인증서 추가</span><span class="sxs-lookup"><span data-stu-id="1aa60-172">Add new certificates</span></span> |<span data-ttu-id="1aa60-173">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-173">Yes</span></span> |<span data-ttu-id="1aa60-174">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-174">Yes</span></span> |<span data-ttu-id="1aa60-175">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-175">Yes</span></span> |
| <span data-ttu-id="1aa60-176">기존 인증서 변경</span><span class="sxs-lookup"><span data-stu-id="1aa60-176">Change existing certificates</span></span> |<span data-ttu-id="1aa60-177">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-177">Yes</span></span> |<span data-ttu-id="1aa60-178">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-178">Yes</span></span> |<span data-ttu-id="1aa60-179">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-179">Yes</span></span> |
| <span data-ttu-id="1aa60-180">새 코드 배포</span><span class="sxs-lookup"><span data-stu-id="1aa60-180">Deploy new code</span></span> |<span data-ttu-id="1aa60-181">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-181">Yes</span></span> |<span data-ttu-id="1aa60-182">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-182">Yes</span></span> |<span data-ttu-id="1aa60-183">예</span><span class="sxs-lookup"><span data-stu-id="1aa60-183">Yes</span></span> |

<span data-ttu-id="1aa60-184"><sup>1</sup> 크기 변경 hello 클라우드 서비스에 대해 사용할 수 있는 크기의 toohello 하위 집합을 제한 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-184"><sup>1</sup> Size change limited toohello subset of sizes available for hello cloud service.</span></span>

<span data-ttu-id="1aa60-185"><sup>2</sup> Azure SDK 1.5 이상 버전이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-185"><sup>2</sup> Requires Azure SDK 1.5 or later versions.</span></span>

> [!WARNING]
> <span data-ttu-id="1aa60-186">Hello 가상 컴퓨터 크기를 변경 하면 로컬 데이터가 소멸 됩니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-186">Changing hello virtual machine size will destroy local data.</span></span>
>
>

<span data-ttu-id="1aa60-187">다음 항목 hello 업데이트 하는 동안 지원 되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-187">hello following items are not supported during an update:</span></span>

* <span data-ttu-id="1aa60-188">역할의 hello 이름을 변경 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-188">Changing hello name of a role.</span></span> <span data-ttu-id="1aa60-189">제거 하 고 hello 새 이름으로 hello 역할을 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-189">Remove and then add hello role with hello new name.</span></span>
* <span data-ttu-id="1aa60-190">Hello 업그레이드 도메인 수의 변경입니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-190">Changing of hello Upgrade Domain count.</span></span>
* <span data-ttu-id="1aa60-191">Hello 로컬 리소스 감소 hello 크기입니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-191">Decreasing hello size of hello local resources.</span></span>

<span data-ttu-id="1aa60-192">로컬 리소스의 hello 크기 줄이기와 같은 tooyour 서비스의 정의 다른 업데이트 하는 경우 대신 VIP swap 업데이트를 수행 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-192">If you are making other updates tooyour service's definition, such as decreasing hello size of local resource, you must perform a VIP swap update instead.</span></span> <span data-ttu-id="1aa60-193">자세한 내용은 [교환 배포](https://msdn.microsoft.com/library/azure/ee460814.aspx)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="1aa60-193">For more information, see [Swap Deployment](https://msdn.microsoft.com/library/azure/ee460814.aspx).</span></span>

<a name="howanupgradeproceeds"></a>

## <a name="how-an-upgrade-proceeds"></a><span data-ttu-id="1aa60-194">업그레이드 진행 방법</span><span class="sxs-lookup"><span data-stu-id="1aa60-194">How an upgrade proceeds</span></span>
<span data-ttu-id="1aa60-195">Tooupdate 사용할지 결정할 수의 모든 서비스에 대 한 hello 역할 또는 hello 서비스에서 단일 역할입니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-195">You can decide whether you want tooupdate all of hello roles in your service or a single role in hello service.</span></span> <span data-ttu-id="1aa60-196">두 경우 모두 업그레이드 하는 중 및 toohello 첫 번째 업그레이드 도메인에 속해 있는 각 역할의 모든 인스턴스는 중지, 업그레이드 및 다시 온라인 상태로 전환 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-196">In either case, all instances of each role that is being upgraded and belong toohello first upgrade domain are stopped, upgraded, and brought back online.</span></span> <span data-ttu-id="1aa60-197">다시 온라인 상태로 전환 된 hello hello 두 번째 업그레이드 도메인의 인스턴스 중지, 업그레이드 되며 다시 온라인 상태로 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-197">Once they are back online, hello instances in hello second upgrade domain are stopped, upgraded, and brought back online.</span></span> <span data-ttu-id="1aa60-198">클라우드 서비스는 한 번에 하나의 업그레이드를 활성화할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-198">A cloud service can have at most one upgrade active at a time.</span></span> <span data-ttu-id="1aa60-199">hello 업그레이드는 hello hello 클라우드 서비스의 최신 버전에 대해 수행 됩니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-199">hello upgrade is always performed against hello latest version of hello cloud service.</span></span>

<span data-ttu-id="1aa60-200">hello 다음 다이어그램에서는 모든 hello 역할 hello 서비스에서 업그레이드 하는 경우 hello 업그레이드를 처리할 방법을 수행 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-200">hello following diagram illustrates how hello upgrade proceeds if you are upgrading all of hello roles in hello service:</span></span>

<span data-ttu-id="1aa60-201">![서비스 업그레이드](media/cloud-services-update-azure-service/IC345879.png "서비스 업그레이드")</span><span class="sxs-lookup"><span data-stu-id="1aa60-201">![Upgrade service](media/cloud-services-update-azure-service/IC345879.png "Upgrade service")</span></span>

<span data-ttu-id="1aa60-202">다음 다이어그램에서는 단일 역할만 업그레이드 하는 경우 hello 업데이트를 처리할 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-202">This next diagram illustrates how hello update proceeds if you are upgrading only a single role:</span></span>

<span data-ttu-id="1aa60-203">![역할 업그레이드](media/cloud-services-update-azure-service/IC345880.png "역할 업그레이드")</span><span class="sxs-lookup"><span data-stu-id="1aa60-203">![Upgrade role](media/cloud-services-update-azure-service/IC345880.png "Upgrade role")</span></span>  

<span data-ttu-id="1aa60-204">자동 업데이트를 사용 하는 동안 Azure 패브릭 컨트롤러 hello 주기적으로 평가 hello 클라우드 서비스 toodetermine의 hello 상태 안전 toowalk hello 다음 UD 됩니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-204">During an automatic update, hello Azure Fabric Controller periodically evaluates hello health of hello cloud service toodetermine when it’s safe toowalk hello next UD.</span></span> <span data-ttu-id="1aa60-205">이 상태 평가에 역할 단위로 수행 되 고 hello 최신 버전 (즉, 워크 이미 있는 Ud에서 인스턴스)의 인스턴스만 고려 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-205">This health evaluation is performed on a per-role basis and considers only instances in hello latest version (i.e. instances from UDs that have already been walked).</span></span> <span data-ttu-id="1aa60-206">각 역할에 대해 최소 수의 역할 인스턴스가 만족스러운 터미널 상태로 수행됐는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-206">It verifies that a minimum number of role instances, for each role, have achieved a satisfactory terminal state.</span></span>

### <a name="role-instance-start-timeout"></a><span data-ttu-id="1aa60-207">역할 인스턴스 시작 시간 제한</span><span class="sxs-lookup"><span data-stu-id="1aa60-207">Role Instance Start Timeout</span></span>
<span data-ttu-id="1aa60-208">hello 패브릭 컨트롤러는 각 역할 인스턴스 tooreach 시작 됨 상태에 대 일 분 동안 대기 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-208">hello Fabric Controller will wait 30 minutes for each role instance tooreach a Started state.</span></span> <span data-ttu-id="1aa60-209">Hello 시간 제한 기간이 경과 하면 hello 패브릭 컨트롤러 toohello 다음 역할 인스턴스를 순환 계속 됩니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-209">If hello timeout duration elapses, hello Fabric Controller will continue walking toohello next role instance.</span></span>

### <a name="impact-toodrive-data-during-cloud-service-upgrades"></a><span data-ttu-id="1aa60-210">클라우드 서비스 업그레이드 하는 동안 영향 toodrive 데이터</span><span class="sxs-lookup"><span data-stu-id="1aa60-210">Impact toodrive data during Cloud Service upgrades</span></span>

<span data-ttu-id="1aa60-211">단일 인스턴스 toomultiple 인스턴스에서 서비스를 업그레이드 하는 경우 Azure 서비스 업그레이드 toohello 방식으로 인해 hello 업그레이드가 수행 될 동안 서비스 이동 됩니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-211">When upgrading a service from a single instance toomultiple instances your service will be brought down while hello upgrade is performed due toohello way Azure upgrades services.</span></span> <span data-ttu-id="1aa60-212">hello 서비스 수준 계약 서비스 가용성을 보장에 둘 이상의 인스턴스를 함께 배포 되는 tooservices만 적용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-212">hello service level agreement guaranteeing service availability only applies tooservices that are deployed with more than one instance.</span></span> <span data-ttu-id="1aa60-213">hello 다음 목록은 각 Azure 서비스 업그레이드 시나리오에 따라 각 드라이브에 hello 데이터 영향:</span><span class="sxs-lookup"><span data-stu-id="1aa60-213">hello following list describes how hello data on each drive is affected by each Azure service upgrade scenario:</span></span>

|<span data-ttu-id="1aa60-214">시나리오</span><span class="sxs-lookup"><span data-stu-id="1aa60-214">Scenario</span></span>|<span data-ttu-id="1aa60-215">C 드라이브</span><span class="sxs-lookup"><span data-stu-id="1aa60-215">C Drive</span></span>|<span data-ttu-id="1aa60-216">D 드라이브</span><span class="sxs-lookup"><span data-stu-id="1aa60-216">D Drive</span></span>|<span data-ttu-id="1aa60-217">E 드라이브</span><span class="sxs-lookup"><span data-stu-id="1aa60-217">E Drive</span></span>|
|--------|-------|-------|-------|
|<span data-ttu-id="1aa60-218">VM 재부팅</span><span class="sxs-lookup"><span data-stu-id="1aa60-218">VM reboot</span></span>|<span data-ttu-id="1aa60-219">유지됨</span><span class="sxs-lookup"><span data-stu-id="1aa60-219">Preserved</span></span>|<span data-ttu-id="1aa60-220">유지됨</span><span class="sxs-lookup"><span data-stu-id="1aa60-220">Preserved</span></span>|<span data-ttu-id="1aa60-221">유지됨</span><span class="sxs-lookup"><span data-stu-id="1aa60-221">Preserved</span></span>|
|<span data-ttu-id="1aa60-222">포털 재부팅</span><span class="sxs-lookup"><span data-stu-id="1aa60-222">Portal reboot</span></span>|<span data-ttu-id="1aa60-223">유지됨</span><span class="sxs-lookup"><span data-stu-id="1aa60-223">Preserved</span></span>|<span data-ttu-id="1aa60-224">유지됨</span><span class="sxs-lookup"><span data-stu-id="1aa60-224">Preserved</span></span>|<span data-ttu-id="1aa60-225">제거됨</span><span class="sxs-lookup"><span data-stu-id="1aa60-225">Destroyed</span></span>|
|<span data-ttu-id="1aa60-226">포털 이미지로 다시 설치</span><span class="sxs-lookup"><span data-stu-id="1aa60-226">Portal reimage</span></span>|<span data-ttu-id="1aa60-227">유지됨</span><span class="sxs-lookup"><span data-stu-id="1aa60-227">Preserved</span></span>|<span data-ttu-id="1aa60-228">제거됨</span><span class="sxs-lookup"><span data-stu-id="1aa60-228">Destroyed</span></span>|<span data-ttu-id="1aa60-229">제거됨</span><span class="sxs-lookup"><span data-stu-id="1aa60-229">Destroyed</span></span>|
|<span data-ttu-id="1aa60-230">전체 업그레이드</span><span class="sxs-lookup"><span data-stu-id="1aa60-230">In-Place Upgrade</span></span>|<span data-ttu-id="1aa60-231">유지됨</span><span class="sxs-lookup"><span data-stu-id="1aa60-231">Preserved</span></span>|<span data-ttu-id="1aa60-232">유지됨</span><span class="sxs-lookup"><span data-stu-id="1aa60-232">Preserved</span></span>|<span data-ttu-id="1aa60-233">제거됨</span><span class="sxs-lookup"><span data-stu-id="1aa60-233">Destroyed</span></span>|
|<span data-ttu-id="1aa60-234">노드 마이그레이션:</span><span class="sxs-lookup"><span data-stu-id="1aa60-234">Node migration</span></span>|<span data-ttu-id="1aa60-235">제거됨</span><span class="sxs-lookup"><span data-stu-id="1aa60-235">Destroyed</span></span>|<span data-ttu-id="1aa60-236">제거됨</span><span class="sxs-lookup"><span data-stu-id="1aa60-236">Destroyed</span></span>|<span data-ttu-id="1aa60-237">제거됨</span><span class="sxs-lookup"><span data-stu-id="1aa60-237">Destroyed</span></span>|

<span data-ttu-id="1aa60-238">Note, 목록 위의 hello, hello e: 드라이브 hello 역할 루트 드라이브를 나타내고 하드 코딩 되지 않아야 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-238">Note that, in hello above list, hello E: drive represents hello role’s root drive, and should not be hard-coded.</span></span> <span data-ttu-id="1aa60-239">대신, hello를 사용 하 여 **% RoleRoot %** 환경 변수 toorepresent hello 드라이브입니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-239">Instead, use hello **%RoleRoot%** environment variable toorepresent hello drive.</span></span>

<span data-ttu-id="1aa60-240">단일 인스턴스 서비스를 업그레이드할 때 toominimize hello 가동 중지 시간 새 다중 인스턴스 서비스 toohello 준비 서버를 배포 및 VIP 교체를 수행 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-240">toominimize hello downtime when upgrading a single-instance service, deploy a new multi-instance service toohello staging server and perform a VIP swap.</span></span>

<a name="RollbackofanUpdate"></a>

## <a name="rollback-of-an-update"></a><span data-ttu-id="1aa60-241">업데이트 롤백</span><span class="sxs-lookup"><span data-stu-id="1aa60-241">Rollback of an update</span></span>
<span data-ttu-id="1aa60-242">Azure는 hello Azure 패브릭 컨트롤러 하 여 hello 초기 업데이트 요청이 수락 되는 서비스에서 추가 작업을 시작할 수 있도록 하 여 업데이트 하는 동안 서비스를 관리에 유연성을 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-242">Azure provides flexibility in managing services during an update by letting you initiate additional operations on a service, after hello initial update request is accepted by hello Azure Fabric Controller.</span></span> <span data-ttu-id="1aa60-243">롤백을 수행할 수 있습니다만 업데이트 (구성 변경) 또는 업그레이드가 hello **진행에서** hello 배포의 상태입니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-243">A rollback can only be performed when an update (configuration change) or upgrade is in hello **in progress** state on hello deployment.</span></span> <span data-ttu-id="1aa60-244">업데이트 또는 업그레이드 아직 새 버전을 업데이트 된 toohello hello 서비스의 인스턴스가 두 개 이상으로 진행 중인 toobe 간주 됩니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-244">An update or upgrade is considered toobe in-progress as long as there is at least one instance of hello service which has not yet been updated toohello new version.</span></span> <span data-ttu-id="1aa60-245">tootest 롤백이 허용 되는지 여부를 확인 하 여 반환 된 hello RollbackAllowed 플래그의 hello 값 [배포 가져오기](https://msdn.microsoft.com/library/azure/ee460804.aspx) 및 [클라우드 서비스 속성 가져오기](https://msdn.microsoft.com/library/azure/ee460806.aspx) 작업 tootrue 설정 됩니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-245">tootest whether a rollback is allowed, check hello value of hello RollbackAllowed flag, returned by [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx) operations, is set tootrue.</span></span>

> [!NOTE]
> <span data-ttu-id="1aa60-246">만 의미 toocall 롤백에 사용 하면는 **내부** 업데이트 또는 업그레이드를 다른 서비스의 전체 하나의 실행 중인 인스턴스를 대체 VIP 스왑 업그레이드를 포함 하기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-246">It only makes sense toocall Rollback on an **in-place** update or upgrade because VIP swap upgrades involve replacing one entire running instance of your service with another.</span></span>
>
>

<span data-ttu-id="1aa60-247">진행 중인 업데이트 롤백 hello hello 배포에 영향을 뒤에 있습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-247">Rollback of an in-progress update has hello following effects on hello deployment:</span></span>

* <span data-ttu-id="1aa60-248">역할 인스턴스는 업데이트 또는 업그레이드 된 toohello 새 버전을 아직 되지 않은 업데이트 되거나 이러한 인스턴스는 이미 실행 되 고 hello 대상 버전의 hello 서비스 업그레이드 되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-248">Any role instances which had not yet been updated or upgraded toohello new version are not updated or upgraded, because those instances are already running hello target version of hello service.</span></span>
* <span data-ttu-id="1aa60-249">모든 역할 인스턴스가 이미 업데이트는 또는 업그레이드 된 toohello 새 버전의 hello 서비스 패키지 (\*.cspkg) 파일 또는 hello 서비스 구성 (\*.cscfg) 파일 (또는 두 파일)은 되돌린된 toohello 업그레이드 이전 버전의 이러한 파일입니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-249">Any role instances which had already been updated or upgraded toohello new version of hello service package (\*.cspkg) file or hello service configuration (\*.cscfg) file (or both files) are reverted toohello pre-upgrade version of these files.</span></span>

<span data-ttu-id="1aa60-250">이 기능적으로 제공한 hello 같은 기능:</span><span class="sxs-lookup"><span data-stu-id="1aa60-250">This functionally is provided by hello following features:</span></span>

* <span data-ttu-id="1aa60-251">hello [롤백 업데이트 또는 업그레이드](https://msdn.microsoft.com/library/azure/hh403977.aspx) 구성 업데이트에서 호출 될 수 있는 작업 (호출에 의해 트리거됨 [배포 구성 변경](https://msdn.microsoft.com/library/azure/ee460809.aspx)) 또는 업그레이드 (호출에 의해 트리거됨 [ 업그레이드 배포](https://msdn.microsoft.com/library/azure/ee460793.aspx)) hello 서비스 중인 인스턴스를 하나 이상으로 toohello 새 버전을 업데이트는 아직 되지 않았습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-251">hello [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation, which can be called on a configuration update (triggered by calling [Change Deployment Configuration](https://msdn.microsoft.com/library/azure/ee460809.aspx)) or an upgrade (triggered by calling [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx)) as long as there is at least one instance in hello service which has not yet been updated toohello new version.</span></span>
* <span data-ttu-id="1aa60-252">hello의 hello 응답 본문의 일부로 반환 되는 잠금 요소와 hello RollbackAllowed 요소 hello [배포 가져오기](https://msdn.microsoft.com/library/azure/ee460804.aspx) 및 [클라우드 서비스 속성 가져오기](https://msdn.microsoft.com/library/azure/ee460806.aspx) 작업:</span><span class="sxs-lookup"><span data-stu-id="1aa60-252">hello Locked element and hello RollbackAllowed element, which are returned as part of hello response body of hello [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx) operations:</span></span>

  1. <span data-ttu-id="1aa60-253">hello 잠금 요소가 있습니다 toodetect을 때 지정된 된 배포에서 변경 작업을 호출할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-253">hello Locked element allows you toodetect when a mutating operation can be invoked on a given deployment.</span></span>
  2. <span data-ttu-id="1aa60-254">hello RollbackAllowed 요소를 있습니다 때 hello toodetect [업데이트 또는 업그레이드 롤백](https://msdn.microsoft.com/library/azure/hh403977.aspx) 지정된 된 배포에서 작업을 호출할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-254">hello RollbackAllowed element allows you toodetect when hello [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation can be called on a given deployment.</span></span>

  <span data-ttu-id="1aa60-255">순서 tooperform 롤백에에서 없는 toocheck hello Locked 및 RollbackAllowed 요소 hello 모두 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-255">In order tooperform a rollback, you do not have toocheck both hello Locked and hello RollbackAllowed elements.</span></span> <span data-ttu-id="1aa60-256">그 RollbackAllowed tootrue 설정 되어 있는지 tooconfirm을 충분 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-256">It suffices tooconfirm that RollbackAllowed is set tootrue.</span></span> <span data-ttu-id="1aa60-257">이러한 요소는도 hello 요청 헤더를 사용 하 여 두이 메서드는 호출 하는 경우에 반환 됩니다 "x ms 버전: 2011-10-01" 이상 버전입니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-257">These elements are only returned if these methods are invoked by using hello request header set too“x-ms-version: 2011-10-01” or a later version.</span></span> <span data-ttu-id="1aa60-258">버전 관리 헤더에 대한 자세한 내용은 [서비스 관리 버전 관리](https://msdn.microsoft.com/library/azure/gg592580.aspx)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="1aa60-258">For more information about versioning headers, see [Service Management Versioning](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span></span>

<span data-ttu-id="1aa60-259">업데이트 또는 업그레이드의 롤백이 지원되지 않는 경우는 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-259">There are some situations where a rollback of an update or upgrade is not supported, these are as follows:</span></span>

* <span data-ttu-id="1aa60-260">-로컬 리소스 감소 hello 업데이트 증가 hello 로컬 리소스는 역할에 대 한 hello Azure 플랫폼에서 허용 하지 않습니다 롤백 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-260">Reduction in local resources - If hello update increases hello local resources for a role hello Azure platform does not allow rolling back.</span></span>
* <span data-ttu-id="1aa60-261">할당량 한도-전보다 hello 업데이트를 축소 작업을 더 이상 수 없으면 toocomplete hello 롤백 작업에 대 한 충분 한의 계산 할당량.</span><span class="sxs-lookup"><span data-stu-id="1aa60-261">Quota limitations - If hello update was a scale down operation you may no longer have sufficient compute quota toocomplete hello rollback operation.</span></span> <span data-ttu-id="1aa60-262">각 Azure 구독에 연결 된 hello toothat 구독에 속하는 모든 호스팅된 서비스에서 사용할 수 있는 코어의 최대 수를 지정 하는 할당량입니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-262">Each Azure subscription has a quota associated with it that specifies hello maximum number of cores which can be consumed by all hosted services that belong toothat subscription.</span></span> <span data-ttu-id="1aa60-263">특정 업데이트의 롤백 수행으로 구독이 할당량을 초과하게 되는 경우 해당 롤백을 사용할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-263">If performing a rollback of a given update would put your subscription over quota then that a rollback will not be enabled.</span></span>
* <span data-ttu-id="1aa60-264">경합 상태-초기 업데이트가 hello 완료, 롤백 수는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-264">Race condition - If hello initial update has completed, a rollback is not possible.</span></span>

<span data-ttu-id="1aa60-265">업데이트 롤백 hello 유용할 수의 예로 hello를 사용 하는 경우 [업그레이드 배포](https://msdn.microsoft.com/library/azure/ee460793.aspx) 수동 모드 toocontrol hello 속도 주요 내부 업그레이드 tooyour Azure 호스팅 서비스에서 작업에 전달 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-265">An example of when hello rollback of an update might be useful is if you are using hello [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx) operation in manual mode toocontrol hello rate at which a major in-place upgrade tooyour Azure hosted service is rolled out.</span></span>

<span data-ttu-id="1aa60-266">Hello 업그레이드의 롤아웃 hello 동안 호출 [업그레이드 배포](https://msdn.microsoft.com/library/azure/ee460793.aspx) 수동 모드에서 toowalk 업그레이드 도메인을 시작 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-266">During hello rollout of hello upgrade you call [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx) in manual mode and begin toowalk upgrade domains.</span></span> <span data-ttu-id="1aa60-267">Hello를 호출할 수 있으면 어느 시점 부터는 hello 업그레이드를 모니터링 하면서 hello 첫 번째 업그레이드 도메인 살펴보면의 일부 역할 인스턴스가 응답 하지 않는 했으면, [업데이트 또는 업그레이드 롤백](https://msdn.microsoft.com/library/azure/hh403977.aspx) hello 배포에 대 한 작업이 있는 아직 업그레이드 되지에 그대로 hello 인스턴스 두고 이었던 롤백 인스턴스 업그레이드 toohello 이전 서비스 패키지 및 구성 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-267">If at some point, as you monitor hello upgrade, you note some role instances in hello first upgrade domains that you examine have become unresponsive, you can call hello [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation on hello deployment, which will leave untouched hello instances which had not yet been upgraded and rollback instances which had been upgraded toohello previous service package and configuration.</span></span>

<a name="multiplemutatingoperations"></a>

## <a name="initiating-multiple-mutating-operations-on-an-ongoing-deployment"></a><span data-ttu-id="1aa60-268">진행 중인 배포에 여러 변경 작업 시작</span><span class="sxs-lookup"><span data-stu-id="1aa60-268">Initiating multiple mutating operations on an ongoing deployment</span></span>
<span data-ttu-id="1aa60-269">일부 경우에 tooinitiate 진행 중인 배포에서 여러 동시 변경 작업을 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-269">In some cases you may want tooinitiate multiple simultaneous mutating operations on an ongoing deployment.</span></span> <span data-ttu-id="1aa60-270">예를 들어 서비스 업데이트를 수행할 수 있습니다 하 고, 해당 업데이트는 여러 서비스 롤아웃 되는 동안 toomake 일부 변경 5d; 예: tooroll 업데이트 다시 hello, 다른 업데이트를 적용 하거나 삭제할 수 hello 배포 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-270">For example, you may perform a service update and, while that update is being rolled out across your service, you want toomake some change, e.g. tooroll hello update back, apply a different update, or even delete hello deployment.</span></span> <span data-ttu-id="1aa60-271">필요할 수 있습니다 하는 경우 서비스 업그레이드 하는 업그레이드 된 역할 인스턴스 toorepeatedly 손상 시키는 버그가 있는 코드를 포함 하는 경우입니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-271">A case in which this might be necessary is if a service upgrade contains buggy code which causes an upgraded role instance toorepeatedly crash.</span></span> <span data-ttu-id="1aa60-272">이 경우 Azure 패브릭 컨트롤러 hello 수 toomake 계속 적용할 하 여 hello 업그레이드 도메인에 인스턴스 수가 부족 비정상 상태는 업그레이드 되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-272">In this case, hello Azure Fabric Controller will not be able toomake progress in applying that upgrade because an insufficient number of instances in hello upgraded domain are healthy.</span></span> <span data-ttu-id="1aa60-273">이 상태는 참조 된 tooas는 *배포 중단*합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-273">This state is referred tooas a *stuck deployment*.</span></span> <span data-ttu-id="1aa60-274">Hello 업데이트 롤백 또는 hello 하나 실패 맨 위에 새 업데이트를 적용 하 여 hello 배포 중단을 해결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-274">You can unstick hello deployment by rolling back hello update or applying a fresh update over top of hello failing one.</span></span>

<span data-ttu-id="1aa60-275">Hello 초기 요청 tooupdate 또는 업그레이드 hello 서비스는 hello Azure 패브릭 컨트롤러에서 받은, 되 면 후속 변경 작업을 시작할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-275">Once hello initial request tooupdate or upgrade hello service has been received by hello Azure Fabric Controller, you can start subsequent mutating operations.</span></span> <span data-ttu-id="1aa60-276">즉, 않아도 toowait 초기 작업 toocomplete hello에 대 한 다른 변경 작업을 시작 하기 전에.</span><span class="sxs-lookup"><span data-stu-id="1aa60-276">That is, you do not have toowait for hello initial operation toocomplete before you can start another mutating operation.</span></span>

<span data-ttu-id="1aa60-277">Hello 첫 번째 업데이트가 진행 중일 동안 두 번째 업데이트 작업을 시작 하는 비슷한 toohello 롤백 작업이 수행 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-277">Initiating a second update operation while hello first update is ongoing will perform similar toohello rollback operation.</span></span> <span data-ttu-id="1aa60-278">Hello 두 번째 업데이트 자동 모드에 있으면 hello 첫 번째 업그레이드 도메인을 즉시 업그레이드 됩니다, 그리고 hello에 오프 라인 상태로 유지 하는 여러 업그레이드 도메인의 tooinstances 라인이 같은 지정 시간입니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-278">If hello second update is in automatic mode, hello first upgrade domain will be upgraded immediately, possibly leading tooinstances from multiple upgrade domains being offline at hello same point in time.</span></span>

<span data-ttu-id="1aa60-279">hello 변경 작업은 다음과 같습니다: [배포 구성 변경](https://msdn.microsoft.com/library/azure/ee460809.aspx), [업그레이드 배포](https://msdn.microsoft.com/library/azure/ee460793.aspx), [업데이트 배포 상태](https://msdn.microsoft.com/library/azure/ee460808.aspx), [삭제 배포](https://msdn.microsoft.com/library/azure/ee460815.aspx), 및 [업데이트 또는 업그레이드 롤백](https://msdn.microsoft.com/library/azure/hh403977.aspx)합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-279">hello mutating operations are as follows: [Change Deployment Configuration](https://msdn.microsoft.com/library/azure/ee460809.aspx), [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx), [Update Deployment Status](https://msdn.microsoft.com/library/azure/ee460808.aspx), [Delete Deployment](https://msdn.microsoft.com/library/azure/ee460815.aspx), and [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx).</span></span>

<span data-ttu-id="1aa60-280">두 개의 작업 [배포 가져오기](https://msdn.microsoft.com/library/azure/ee460804.aspx) 및 [클라우드 서비스 속성 가져오기](https://msdn.microsoft.com/library/azure/ee460806.aspx), 지정된 된 배포에서 변경 작업을 호출할 수 있는지 여부를 검사 toodetermine 될 수 있는 hello 잠금 플래그를 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-280">Two operations, [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx), return hello Locked flag which can be examined toodetermine whether a mutating operation can be invoked on a given deployment.</span></span>

<span data-ttu-id="1aa60-281">순서 toocall hello 버전에서 이러한 메서드의 hello 잠금 플래그를 반환 하는 설정 해야 요청 헤더가 너무 "x ms 버전: 2011-10-01" 이상.</span><span class="sxs-lookup"><span data-stu-id="1aa60-281">In order toocall hello version of these methods which returns hello Locked flag, you must set request header too“x-ms-version: 2011-10-01” or a later.</span></span> <span data-ttu-id="1aa60-282">버전 관리 헤더에 대한 자세한 내용은 [서비스 관리 버전 관리](https://msdn.microsoft.com/library/azure/gg592580.aspx)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="1aa60-282">For more information about versioning headers, see [Service Management Versioning](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span></span>

<a name="distributiondfroles"></a>

## <a name="distribution-of-roles-across-upgrade-domains"></a><span data-ttu-id="1aa60-283">업그레이드 도메인 간 역할의 배포</span><span class="sxs-lookup"><span data-stu-id="1aa60-283">Distribution of roles across upgrade domains</span></span>
<span data-ttu-id="1aa60-284">Azure는 역할의 인스턴스를 여러 hello 서비스 정의 (.csdef) 파일의 일부로 구성 될 수 있는 업그레이드 도메인 수에 대해 균등 하 게 배포 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-284">Azure distributes instances of a role evenly across a set number of upgrade domains, which can be configured as part of hello service definition (.csdef) file.</span></span> <span data-ttu-id="1aa60-285">hello 최대 업그레이드 도메인 수는 20 개이고, hello 기본값은 5입니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-285">hello max number of upgrade domains is 20 and hello default is 5.</span></span> <span data-ttu-id="1aa60-286">어떻게 toomodify hello 서비스 정의 파일에 대 한 자세한 내용은 참조 [Azure Service 정의 스키마 (.csdef 파일)](cloud-services-model-and-package.md#csdef)합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-286">For more information about how toomodify hello service definition file, see [Azure Service Definition Schema (.csdef File)](cloud-services-model-and-package.md#csdef).</span></span>

<span data-ttu-id="1aa60-287">예를 들어 역할에 10개의 인스턴스가 있는 경우 기본적으로 각 업그레이드 도메인에는 두 개의 인스턴스가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-287">For example, if your role has ten instances, by default each upgrade domain contains two instances.</span></span> <span data-ttu-id="1aa60-288">사용자의 역할 인스턴스가 14 세 인스턴스를 포함할 hello 업그레이드 도메인의 4 개는 다음 및 두 개의 도메인에 있습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-288">If your role has 14 instances, then four of hello upgrade domains contain three instances, and a fifth domain contains two.</span></span>

<span data-ttu-id="1aa60-289">업그레이드 도메인 0 기반 인덱스로 식별 됩니다: hello 첫 번째 업그레이드 도메인은 0, ID 및 hello 두 번째 업그레이드 도메인은 ID가 1, 및 기타 등등.</span><span class="sxs-lookup"><span data-stu-id="1aa60-289">Upgrade domains are identified with a zero-based index: hello first upgrade domain has an ID of 0, and hello second upgrade domain has an ID of 1, and so on.</span></span>

<span data-ttu-id="1aa60-290">hello 다음 다이어그램에서는 두 개의 업그레이드 도메인을 정의 하는 hello 서비스는 서비스를 두 개의 역할을 포함 하는 보다 어떻게 분포 되어 합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-290">hello following diagram illustrates how a service than contains two roles are distributed when hello service defines two upgrade domains.</span></span> <span data-ttu-id="1aa60-291">hello 웹 역할 인스턴스가 8 개인 및 hello 작업자 역할 인스턴스 9 개 hello 서비스가 실행 되 고 있습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-291">hello service is running eight instances of hello web role and nine instances of hello worker role.</span></span>

<span data-ttu-id="1aa60-292">![업그레이드 도메인 배포](media/cloud-services-update-azure-service/IC345533.png "업그레이드 도메인 배포")</span><span class="sxs-lookup"><span data-stu-id="1aa60-292">![Distribution of Upgrade Domains](media/cloud-services-update-azure-service/IC345533.png "Distribution of Upgrade Domains")</span></span>

> [!NOTE]
> <span data-ttu-id="1aa60-293">Azure는 업그레이드 도메인에 인스턴스가 할당되는 방식을 제어합니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-293">Note that Azure controls how instances are allocated across upgrade domains.</span></span> <span data-ttu-id="1aa60-294">가능한 toospecify 인스턴스 toowhich 도메인에 할당 되는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="1aa60-294">It's not possible toospecify which instances are allocated toowhich domain.</span></span>
>
>

## <a name="next-steps"></a><span data-ttu-id="1aa60-295">다음 단계</span><span class="sxs-lookup"><span data-stu-id="1aa60-295">Next steps</span></span>
[<span data-ttu-id="1aa60-296">TooManage 클라우드 서비스 하는 방법</span><span class="sxs-lookup"><span data-stu-id="1aa60-296">How tooManage Cloud Services</span></span>](cloud-services-how-to-manage.md)  
[<span data-ttu-id="1aa60-297">TooMonitor 클라우드 서비스 하는 방법</span><span class="sxs-lookup"><span data-stu-id="1aa60-297">How tooMonitor Cloud Services</span></span>](cloud-services-how-to-monitor.md)  
[<span data-ttu-id="1aa60-298">TooConfigure 클라우드 서비스 하는 방법</span><span class="sxs-lookup"><span data-stu-id="1aa60-298">How tooConfigure Cloud Services</span></span>](cloud-services-how-to-configure.md)  
