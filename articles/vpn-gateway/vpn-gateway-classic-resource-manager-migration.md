---
title: "Resource Manager 마이그레이션에 대한 VPN Gateway 클래식 | Microsoft Docs"
description: "이 페이지에서는 Resource Manager 마이그레이션에 대한 VPN Gateway 클래식의 개요를 제공합니다."
documentationcenter: na
services: vpn-gateway
author: amsriva
manager: rossort
editor: amsriva
ms.assetid: caa8eb19-825a-4031-8b49-18fbf3ebc04e
ms.service: vpn-gateway
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 05/02/2017
ms.author: amsriva
ms.openlocfilehash: 1164fc24355657af22b6befaad74685ebbc2b5cb
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/11/2017
---
# <a name="vpn-gateway-classic-to-resource-manager-migration"></a><span data-ttu-id="6a48d-103">Resource Manager 마이그레이션에 대한 VPN Gateway 클래식</span><span class="sxs-lookup"><span data-stu-id="6a48d-103">VPN Gateway classic to Resource Manager migration</span></span>
<span data-ttu-id="6a48d-104">이제 VPN Gateway을 클래식에서 Resource Manager 배포 모델로 마이그레이션할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-104">VPN Gateways can now be migrated from classic to Resource Manager deployment model.</span></span> <span data-ttu-id="6a48d-105">[Azure Resource Manager 기능 및 이점](../azure-resource-manager/resource-group-overview.md)에 대해 자세히 알아볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-105">You can read more about Azure Resource Manager [features and benefits](../azure-resource-manager/resource-group-overview.md).</span></span> <span data-ttu-id="6a48d-106">이 문서에서는 클래식 배포에서 새로운 Resource Manager 기반 모델로 마이그레이션하는 방법을 자세히 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-106">In this article, we  detail how to migrate from classic deployments to newer Resource Manager based model.</span></span> 

<span data-ttu-id="6a48d-107">VPN Gateway는 VNet 마이그레이션의 일환으로 클래식에서 Resource Manager로 마이그레이션됩니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-107">VPN Gateways are migrated as part of VNet migration from classic to Resource Manager.</span></span> <span data-ttu-id="6a48d-108">이 마이그레이션은 한 번에 하나의 VNet 꼴로 이뤄집니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-108">This migration is done one VNet at a time.</span></span> <span data-ttu-id="6a48d-109">도구 측면에서 추가 요구 사항이나 마이그레이션에 대한 전제 조건이 없습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-109">There is no additional requirement in terms of tools or prerequisites to migration.</span></span> <span data-ttu-id="6a48d-110">마이그레이션 단계는 기존 VNet 마이그레이션과 동일하며 [IaaS 리소스 마이그레이션 페이지](../virtual-machines/windows/migration-classic-resource-manager-ps.md)에 설명되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-110">Migration steps are identical to existing VNet migration and are documented at [IaaS resources migration page](../virtual-machines/windows/migration-classic-resource-manager-ps.md).</span></span> <span data-ttu-id="6a48d-111">마이그레이션 중에 데이터 경로 가동 중지 시간이 없습니다. 따라서 기존 작업은 마이그레이션 중에 온-프레미스 연결 손실 없이 계속 작동할 것입니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-111">There is no data path downtime during migration and thus existing workloads would continue to function without loss of on-premises connectivity during migration.</span></span> <span data-ttu-id="6a48d-112">VPN 게이트웨이에 연결된 공용 IP 주소는 마이그레이션 프로세스 중에 변경되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-112">The public IP address associated with the VPN gateway does not change during the migration process.</span></span> <span data-ttu-id="6a48d-113">즉, 마이그레이션이 완료되면 온-프레미스 라우터를 다시 구성할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-113">This implies that you will not need to reconfigure your on-premises router once the migration is completed.</span></span>  

<span data-ttu-id="6a48d-114">Resource Manager에 있는 모델은 클래식 모델과 다르며 가상 네트워크 게이트웨이, 로컬 네트워크 게이트웨이 및 연결 리소스로 구성됩니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-114">The model in Resource Manager is different from classic model and is composed of virtual network gateways, local network gateways and connection resources.</span></span> <span data-ttu-id="6a48d-115">이것들은 각기 VPN 게이트웨이 자체를, 온-프레미스 주소 공간을 나타내는 로컬 사이트 및 둘 간의 연결을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-115">These represent the VPN gateway itself, the local-site representing on premises address space and connectivity between the two respectively.</span></span> <span data-ttu-id="6a48d-116">마이그레이션이 완료되면 게이트웨이는 클래식 모델에서 사용할 수 없게 될 것이며 가상 네트워크 게이트웨이, 로컬 네트워크 게이트웨이 및 연결 개체에서의 모든 관리 작업은 Resource Manager 모델을 사용하여 수행되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-116">Once migration is completed your gateways would not be available in classic model and all management operations on virtual network gateways, local network gateways, and connection objects must be performed using Resource Manager model.</span></span>

## <a name="supported-scenarios"></a><span data-ttu-id="6a48d-117">지원되는 시나리오</span><span class="sxs-lookup"><span data-stu-id="6a48d-117">Supported scenarios</span></span>
<span data-ttu-id="6a48d-118">가장 일반적인 VPN 연결 시나리오는 클래식에서 Resource Manager 마이그레이션에서 다뤄집니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-118">Most common VPN connectivity scenarios are covered by classic to Resource Manager migration.</span></span> <span data-ttu-id="6a48d-119">지원되는 시나리오 -</span><span class="sxs-lookup"><span data-stu-id="6a48d-119">The supported scenarios include -</span></span>

* <span data-ttu-id="6a48d-120">지점 및 사이트 간 연결</span><span class="sxs-lookup"><span data-stu-id="6a48d-120">Point to site connectivity</span></span>
* <span data-ttu-id="6a48d-121">온-프레미스 위치에서 연결된 VPN Gateway를 사용한 사이트 간 연결</span><span class="sxs-lookup"><span data-stu-id="6a48d-121">Site to site connectivity with VPN Gateway connected to on premises location</span></span>
* <span data-ttu-id="6a48d-122">VPN Gateway를 사용한 두 VNet 사이의 VNet 간 연결</span><span class="sxs-lookup"><span data-stu-id="6a48d-122">VNet to VNet connectivity between two VNets using VPN gateways</span></span>
* <span data-ttu-id="6a48d-123">온-프레미스 위치의 같은 곳에 연결된 다중 VNet</span><span class="sxs-lookup"><span data-stu-id="6a48d-123">Multiple VNets connected to same on premises location</span></span>
* <span data-ttu-id="6a48d-124">다중 사이트 연결</span><span class="sxs-lookup"><span data-stu-id="6a48d-124">Multi-site connectivity</span></span>
* <span data-ttu-id="6a48d-125">강제 터널링 사용 설정된 VNet</span><span class="sxs-lookup"><span data-stu-id="6a48d-125">Forced tunneling enabled VNets</span></span>

<span data-ttu-id="6a48d-126">지원되지 않는 시나리오 -</span><span class="sxs-lookup"><span data-stu-id="6a48d-126">Scenarios which are not supported include -</span></span>  

* <span data-ttu-id="6a48d-127">ExpressRoute 게이트웨이와 VPN Gateway가 모두 있는 VNet은 현재 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-127">VNet with both ExpressRoute Gateway and VPN Gateway is not currently supported.</span></span>
* <span data-ttu-id="6a48d-128">VM 확장이 온-프레미스 서버에 연결된 시나리오를 전송합니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-128">Transit scenarios where VM extensions are connected to on-premises servers.</span></span> <span data-ttu-id="6a48d-129">전송 시 VPN 연결 제한은 아래에 자세히 설명됩니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-129">Transit VPN connectivity limitations are detailed below.</span></span>

> [!NOTE]
> <span data-ttu-id="6a48d-130">Resource Manager 모델의 CIDR 유효성 검사는 기존 모델에 비해 훨씬 엄격합니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-130">CIDR validation in Resource Manager model is more strict than the one in classic model.</span></span> <span data-ttu-id="6a48d-131">주어진 클래식 주소 범위가 유효한 CIDR 형식을 준수하는지 마이그레이션이 시작되기 전에 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-131">Before migrating ensure that classic address ranges given conform to valid CIDR format before beginning the migration.</span></span> <span data-ttu-id="6a48d-132">CIDR는 일반적인 CIDR 유효성 검사기를 사용하여 유효성을 검사할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-132">CIDR can be validated using any common CIDR validators.</span></span> <span data-ttu-id="6a48d-133">마이그레이션할 때 유효하지 않은 CIDR 범위를 사용한 VNet 또는 로컬 사이트는 실패 상태가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-133">VNet or local sites with invalid CIDR ranges when migrated would result in failed state.</span></span>
> 
> 

## <a name="vnet-to-vnet-connectivity-migration"></a><span data-ttu-id="6a48d-134">VNet 간 연결 마이그레이션</span><span class="sxs-lookup"><span data-stu-id="6a48d-134">VNet to VNet connectivity migration</span></span>
<span data-ttu-id="6a48d-135">클래식에서 VNet 간 연결은 연결된 VNet의 로컬 사이트 표현을 만들어 구현하였습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-135">VNet to VNet connectivity in classic was achieved by creating a local site representation of the connected VNet.</span></span> <span data-ttu-id="6a48d-136">고객은 함께 연결하는 데 필요한 두 VNet을 나타내는 두 개의 로컬 사이트를 만들어야 했습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-136">Customers were required to create two local sites which represented the two VNets which needed to be connected together.</span></span> <span data-ttu-id="6a48d-137">그런 다음 이 사이트들은 두 Vnet간 연결을 설정하기 위해 IPsec 터널을 사용하여 해당 Vnet에 연결되었습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-137">These were then connected to the corresponding VNets using IPsec tunnel to establish connectivity between the two VNets.</span></span> <span data-ttu-id="6a48d-138">이 모델에서는 하나의 VNet에서 주소 범위가 변경되는 경우 해당 로컬 사이트 표시에서도 또한 유지되어야 하므로 관리 효율성 문제가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-138">This model has manageability challenges since any address range changes in one VNet must also be maintained in the corresponding local site representation.</span></span> <span data-ttu-id="6a48d-139">Resource Manager 모델에서 이 해결 방법은 더 이상 필요하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-139">In Resource Manager model this workaround is no longer needed.</span></span> <span data-ttu-id="6a48d-140">두 VNet 간의 연결은 연결 리소스에서 'Vnet2Vnet' 연결 형식을 사용하여 직접 구현할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-140">The connection between the two VNets can be directly achieved using 'Vnet2Vnet' connection type in Connection resource.</span></span> 

![VNet 간 마이그레이션 스크린샷.](./media/vpn-gateway-migration/migration1.png)

<span data-ttu-id="6a48d-142">VNet 마이그레이션 도중에 사용자는 현재 VNet의 VPN 게이트웨이에 연결된 엔터티가 또 다른 VNet인지 감지하고 두 VNet의 마이그레이션이 완료되면 다른 VNet을 나타내는 두 로컬 사이트가 더 이상 보이지 않는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-142">During VNet migration we detect that the connected entity to current VNet's VPN gateway is another VNet and ensure that once migration of both VNets is completed, you would no longer see two local sites representing the other VNet.</span></span> <span data-ttu-id="6a48d-143">두 VPN 게이트웨이, 두 로컬 사이트 및 이들 간의 두 연결로 이뤄진 클래식 모델은 두 VPN 게이트웨이 및 Vnet2Vnet 형식의 두 연결로 이뤄진 Resource Manager 모델로 변환됩니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-143">The classic model of two VPN gateways, two local sites and two connections between them is transformed to Resource Manager model with two VPN gateways and two connections of type Vnet2Vnet.</span></span>

## <a name="transit-vpn-connectivity"></a><span data-ttu-id="6a48d-144">전송 시 VPN 연결</span><span class="sxs-lookup"><span data-stu-id="6a48d-144">Transit VPN connectivity</span></span>
<span data-ttu-id="6a48d-145">VNet에 대한 온-프레미스 연결이 온-프레미스에 직접 연결된 또 다른 VNet에 연결하여 구현되도록 토폴로지에서 VPN 게이트웨이를 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-145">You can configure VPN gateways in a topology such that on-premises connectivity for a VNet is achieved by connecting to another VNet that is directly connected to on-premises.</span></span> <span data-ttu-id="6a48d-146">이것은 첫 번째 VNet에서의 인스턴스가 온-프레미스에 직접 연결된 VNet에 있는 VPN 게이트웨이에 대한 전송을 통해 온-프레미스 리소스에 연결된 전송 시 VPN 연결입니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-146">This is transit VPN connectivity where instances in first VNet are connected to on-premises resources via transit to the VPN gateway in connected VNet that is directly connected to on-premises.</span></span> <span data-ttu-id="6a48d-147">클래식 배포 모델에서 이 구성을 구축하기 위해 연결된 VNet 및 온-프레미스 주소 공간을 나타내는 집계된 접두사가 있는 로컬 사이트를 만들어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-147">To achieve this configuration in classic deployment model, you would need to create a local site which has aggregated prefixes representing both the connected VNet and on-premises address space.</span></span> <span data-ttu-id="6a48d-148">그런 다음 이 대표적 로컬 사이트는 전송 연결을 구축하기 위해 VNet에 연결됩니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-148">This representational local site is then connected to the VNet to achieve transit connectivity.</span></span> <span data-ttu-id="6a48d-149">또한 이 클래식 모델에는 온-프레미스 주소 범위의 변경 내용이 VNet 및 온-프레미스의 집계를 나타내는 로컬 사이트에도 유지되어야 하므로 비슷한 관리 효율성 문제가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-149">This classic model also has similar manageability challenges since any change in on-premises address range must also be maintained on the local site representing the aggregate of VNet and on-premises.</span></span> <span data-ttu-id="6a48d-150">Resource Manager가 지원되는 게이트웨이에서 BGP 지원 도입은 연결된 게이트웨이가 접두사를 수동 수정하지 않고도 온-프레미스에서 경로를 알 수 있으므로 관리 효율성을 간소화합니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-150">Introduction of BGP support in Resource Manager supported gateways simplifies manageability since the connected gateways can learn routes from on premises without manual modification to prefixes.</span></span>

![전송 라우팅 시나리오의 스크린샷.](./media/vpn-gateway-migration/migration2.png)

<span data-ttu-id="6a48d-152">로컬 사이트 없이 VNet 간 연결을 변환하기 때문에, 전송 시나리오는 온-프레미스에 간접 연결된 VNet에 대한 온-프레미스 연결을 잃습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-152">Since we transform VNet to VNet connectivity without requiring local sites, the transit scenario loses on-premises connectivity for VNet that is indirectly connected to on-premises.</span></span> <span data-ttu-id="6a48d-153">연결 손실은 마이그레이션이 완료된 후 다음 두 가지 방법으로 완화될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-153">The loss of connectivity can be mitigated in the following two ways, after migration is completed -</span></span> 

* <span data-ttu-id="6a48d-154">서로 연결되고 온-프레미스에 연결된 VPN 게이트웨이에서 BGP를 사용하도록 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-154">Enable BGP on VPN gateways that are connected together and to on-premises.</span></span> <span data-ttu-id="6a48d-155">BGP를 사용하도록 설정하면 경로가 VNet 게이트웨이 간에 학습되고 광고되기 때문에 다른 구성 변경 없이 연결을 복원합니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-155">Enabling BGP restores connectivity without any other configuration change since routes are learned and advertised between VNet gateways.</span></span> <span data-ttu-id="6a48d-156">BGP 옵션은 표준 및 상위 SKU에서만 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-156">Note that BGP option is only available on Standard and higher SKUs.</span></span>
* <span data-ttu-id="6a48d-157">영향을 받는 VNet에서 온-프레미스 위치를 나타내는 로컬 네트워크 게이트웨이로 명시적 연결을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-157">Establish an explicit connection from affected VNet to the local network gateway representing on-premises location.</span></span> <span data-ttu-id="6a48d-158">또한 IPsec 터널을 만들고 구성하기 위해 온-프레미스 라우터에서 구성을 변경해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-158">This would also require changing configuration on the on-premises router to create and configure the IPsec tunnel.</span></span>

## <a name="next-steps"></a><span data-ttu-id="6a48d-159">다음 단계</span><span class="sxs-lookup"><span data-stu-id="6a48d-159">Next steps</span></span>
<span data-ttu-id="6a48d-160">VPN 게이트웨이 마이그레이션 지원에 대해 학습한 후에 시작하려면 [클래식에서 Resource Manager로 IaaS 리소스의 플랫폼 지원 마이그레이션](../virtual-machines/windows/migration-classic-resource-manager-ps.md)으로 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="6a48d-160">After learning about VPN gateway migration support, go to [platform-supported migration of IaaS resources from classic to Resource Manager](../virtual-machines/windows/migration-classic-resource-manager-ps.md) to get started.</span></span>

