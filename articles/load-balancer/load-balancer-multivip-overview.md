---
title: "Azure Load Balancer에 대한 다중 VIP | Microsoft Docs"
description: "Azure Load Balancer의 다중 VIP에 대한 개요"
services: load-balancer
documentationcenter: na
author: chkuhtz
manager: narayan
editor: 
ms.assetid: 748e50cd-3087-4c2e-a9e1-ac0ecce4f869
ms.service: load-balancer
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 08/11/2016
ms.author: chkuhtz
ms.openlocfilehash: d9e88b859020be2a96a57a01e5624052ed134b64
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/11/2017
---
# <a name="multiple-vips-for-azure-load-balancer"></a><span data-ttu-id="4246e-103">Azure Load Balancer에 대한 다중 VIP</span><span class="sxs-lookup"><span data-stu-id="4246e-103">Multiple VIPs for Azure Load Balancer</span></span>

<span data-ttu-id="4246e-104">Azure Load Balancer를 사용해 여러 포트, 여러 IP 주소 또는 둘 다에서 부하 분산 서비스를 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-104">Azure Load Balancer allows you to load balance services on multiple ports, multiple IP addresses, or both.</span></span> <span data-ttu-id="4246e-105">공용 및 내부 부하 분산 장치 정의를 VM 집합 전반에 대한 부하 분산 흐름에 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-105">You can use public and internal load balancer definitions to load balance flows across a set of VMs.</span></span>

<span data-ttu-id="4246e-106">이 문서에서는 이 기능, 중요한 개념 및 제약 조건에 대한 기본 사항을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-106">This article describes the fundamentals of this ability, important concepts, and constraints.</span></span> <span data-ttu-id="4246e-107">서비스를 하나의 IP 주소에 노출만 하려는 경우 [공용](load-balancer-get-started-internet-portal.md) 또는 [내부](load-balancer-get-started-ilb-arm-portal.md) 부하 분산 장치 구성에 대한 단순화된 지침을 찾을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-107">If you only intend to expose services on one IP address, you can find simplified instructions for [public](load-balancer-get-started-internet-portal.md) or [internal](load-balancer-get-started-ilb-arm-portal.md) load balancer configurations.</span></span> <span data-ttu-id="4246e-108">여러 VIP 추가하면 단일 VIP 구성이 증대합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-108">Adding Multiple VIPs is incremental to a single VIP configuration.</span></span> <span data-ttu-id="4246e-109">이 문서의 개념을 사용하여 단순화된 구성을 언제라도 확장할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-109">Using the concepts in this article, you can expand a simplified configuration at any time.</span></span>

<span data-ttu-id="4246e-110">Azure Load Balancer를 정의할 때 프런트 엔드 및 백 엔드 구성이 규칙과 연결됩니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-110">When you define an Azure Load Balancer, a frontend and a backend configuration are connected with rules.</span></span> <span data-ttu-id="4246e-111">규칙에서 참조하는 상태 프로브는 새로운 흐름을 백 엔드 풀의 노드로 전송하는 방법을 결정하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-111">The health probe referenced by the rule is used to determine how new flows are sent to a node in the backend pool.</span></span> <span data-ttu-id="4246e-112">프런트 엔드는 가상 IP(VIP), 즉 IP 주소(공용 또는 내부), 전송 프로토콜(UDP 또는 TCP) 및 포트 번호로 구성된 3 튜플로 정의됩니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-112">The frontend is defined by a Virtual IP (VIP), which is a 3-tuple comprised of an IP address (public or internal), a transport protocol (UDP or TCP), and a port number.</span></span> <span data-ttu-id="4246e-113">DIP는 백 엔드 풀의 VM에 연결된 Azure virtual NIC의 IP 주소입니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-113">A DIP is an IP address on an Azure virtual NIC attached to a VM in the backend pool.</span></span>

<span data-ttu-id="4246e-114">다음 표에는 프런트 엔드 구성의 몇 가지 예가 들어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-114">The following table contains some example frontend configurations:</span></span>

| <span data-ttu-id="4246e-115">VIP</span><span class="sxs-lookup"><span data-stu-id="4246e-115">VIP</span></span> | <span data-ttu-id="4246e-116">IP 주소</span><span class="sxs-lookup"><span data-stu-id="4246e-116">IP address</span></span> | <span data-ttu-id="4246e-117">protocol</span><span class="sxs-lookup"><span data-stu-id="4246e-117">protocol</span></span> | <span data-ttu-id="4246e-118">포트</span><span class="sxs-lookup"><span data-stu-id="4246e-118">port</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="4246e-119">1</span><span class="sxs-lookup"><span data-stu-id="4246e-119">1</span></span> |<span data-ttu-id="4246e-120">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="4246e-120">65.52.0.1</span></span> |<span data-ttu-id="4246e-121">TCP</span><span class="sxs-lookup"><span data-stu-id="4246e-121">TCP</span></span> |<span data-ttu-id="4246e-122">80</span><span class="sxs-lookup"><span data-stu-id="4246e-122">80</span></span> |
| <span data-ttu-id="4246e-123">2</span><span class="sxs-lookup"><span data-stu-id="4246e-123">2</span></span> |<span data-ttu-id="4246e-124">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="4246e-124">65.52.0.1</span></span> |<span data-ttu-id="4246e-125">TCP</span><span class="sxs-lookup"><span data-stu-id="4246e-125">TCP</span></span> |<span data-ttu-id="4246e-126">*8080*</span><span class="sxs-lookup"><span data-stu-id="4246e-126">*8080*</span></span> |
| <span data-ttu-id="4246e-127">3</span><span class="sxs-lookup"><span data-stu-id="4246e-127">3</span></span> |<span data-ttu-id="4246e-128">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="4246e-128">65.52.0.1</span></span> |<span data-ttu-id="4246e-129">*UDP*</span><span class="sxs-lookup"><span data-stu-id="4246e-129">*UDP*</span></span> |<span data-ttu-id="4246e-130">80</span><span class="sxs-lookup"><span data-stu-id="4246e-130">80</span></span> |
| <span data-ttu-id="4246e-131">4</span><span class="sxs-lookup"><span data-stu-id="4246e-131">4</span></span> |<span data-ttu-id="4246e-132">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="4246e-132">*65.52.0.2*</span></span> |<span data-ttu-id="4246e-133">TCP</span><span class="sxs-lookup"><span data-stu-id="4246e-133">TCP</span></span> |<span data-ttu-id="4246e-134">80</span><span class="sxs-lookup"><span data-stu-id="4246e-134">80</span></span> |

<span data-ttu-id="4246e-135">표에 다른 네 개의 프런트엔드가 나옵니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-135">The table shows four different frontends.</span></span> <span data-ttu-id="4246e-136">프런트 엔드 #1, # 2 및 #3는 여러 규칙을 가진 단일 VIP입니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-136">Frontends #1, #2 and #3 are a single VIP with multiple rules.</span></span> <span data-ttu-id="4246e-137">같은 IP 주소가 사용되지만 포트 또는 프로토콜은 각 프런트 엔드마다 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-137">The same IP address is used but the port or protocol is different for each frontend.</span></span> <span data-ttu-id="4246e-138">프런트엔드 #1과 #4번은 다중 VIP의 한 예로 동일한 프런트 엔드 프로토콜 및 포트가 여러 VIP에 걸쳐 다시 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-138">Frontends #1 and #4 are an example of Multiple VIPs, where the same frontend protocol and port are reused across multiple VIPs.</span></span>

<span data-ttu-id="4246e-139">Azure Load Balancer는 부하 분산 규칙을 정의하는 데 유연성을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-139">Azure Load Balancer provides flexibility in defining the load balancing rules.</span></span> <span data-ttu-id="4246e-140">규칙은 프런트 엔드의 주소 및 포트가 백 엔드의 대상 주소 및 포트에 매핑되는 방식을 선언합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-140">A rule declares how an address and port on the frontend is mapped to the destination address and port on the backend.</span></span> <span data-ttu-id="4246e-141">백 엔드 포트를 규칙 전반에 재사용할지 여부는 규칙 유형에 따라 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-141">Whether or not backend ports are reused across rules depends on the type of the rule.</span></span> <span data-ttu-id="4246e-142">각 규칙 유형에는 호스트 구성 및 프로브 디자인에 영향을 줄 수 있는 특정 요구 사항이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-142">Each type of rule has specific requirements that can affect host configuration and probe design.</span></span> <span data-ttu-id="4246e-143">다음과 같은 두 가지 규칙 유형이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-143">There are two types of rules:</span></span>

1. <span data-ttu-id="4246e-144">백 엔드 포트 재사용이 없는 기본 규칙</span><span class="sxs-lookup"><span data-stu-id="4246e-144">The default rule with no backend port reuse</span></span>
2. <span data-ttu-id="4246e-145">백 엔드 포트가 재사용되는 부동 IP 규칙</span><span class="sxs-lookup"><span data-stu-id="4246e-145">The Floating IP rule where backend ports are reused</span></span>

<span data-ttu-id="4246e-146">Azure Load Balancer를 사용하면 동일한 부하 분산 장치 구성에서 두 규칙 유형을 혼합할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-146">Azure Load Balancer allows you to mix both rule types on the same load balancer configuration.</span></span> <span data-ttu-id="4246e-147">부하 분산 장치는 규칙의 제약 조건을 준수하는 한 주어진 VM이나 어떠한 조합에 대해서도 그것들을 동시에 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-147">The load balancer can use them simultaneously for a given VM, or any combination, as long as you abide by the constraints of the rule.</span></span> <span data-ttu-id="4246e-148">어떤 규칙 유형을 선택하는지는 응용 프로그램의 요구 사항 및 해당 구성을 지원하는 복잡성에 따라 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-148">Which rule type you choose depends on the requirements of your application and the complexity of supporting that configuration.</span></span> <span data-ttu-id="4246e-149">어떤 규칙 유형이 시나리오에 가장 적합한지 평가해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-149">You should evaluate which rule types are best for your scenario.</span></span>

<span data-ttu-id="4246e-150">기본 동작을 시작으로 이러한 시나리오를 더 자세히 알아봅니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-150">We explore these scenarios further by starting with the default behavior.</span></span>

## <a name="rule-type-1-no-backend-port-reuse"></a><span data-ttu-id="4246e-151">규칙 유형 #1: 백 엔드 포트 재사용하지 않음.</span><span class="sxs-lookup"><span data-stu-id="4246e-151">Rule type #1: No backend port reuse</span></span>

![MultiVIP 그림](./media/load-balancer-multivip-overview/load-balancer-multivip.png)

<span data-ttu-id="4246e-153">이 시나리오에서 프런트 엔드 VIP는 다음과 같이 구성됩니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-153">In this scenario, the frontend VIPs are configured as follows:</span></span>

| <span data-ttu-id="4246e-154">VIP</span><span class="sxs-lookup"><span data-stu-id="4246e-154">VIP</span></span> | <span data-ttu-id="4246e-155">IP 주소</span><span class="sxs-lookup"><span data-stu-id="4246e-155">IP address</span></span> | <span data-ttu-id="4246e-156">protocol</span><span class="sxs-lookup"><span data-stu-id="4246e-156">protocol</span></span> | <span data-ttu-id="4246e-157">포트</span><span class="sxs-lookup"><span data-stu-id="4246e-157">port</span></span> |
| --- | --- | --- | --- |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="4246e-159">1</span><span class="sxs-lookup"><span data-stu-id="4246e-159">1</span></span> |<span data-ttu-id="4246e-160">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="4246e-160">65.52.0.1</span></span> |<span data-ttu-id="4246e-161">TCP</span><span class="sxs-lookup"><span data-stu-id="4246e-161">TCP</span></span> |<span data-ttu-id="4246e-162">80</span><span class="sxs-lookup"><span data-stu-id="4246e-162">80</span></span> |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="4246e-164">2</span><span class="sxs-lookup"><span data-stu-id="4246e-164">2</span></span> |<span data-ttu-id="4246e-165">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="4246e-165">*65.52.0.2*</span></span> |<span data-ttu-id="4246e-166">TCP</span><span class="sxs-lookup"><span data-stu-id="4246e-166">TCP</span></span> |<span data-ttu-id="4246e-167">80</span><span class="sxs-lookup"><span data-stu-id="4246e-167">80</span></span> |

<span data-ttu-id="4246e-168">DIP는 인바운드 흐름의 대상입니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-168">The DIP is the destination of the inbound flow.</span></span> <span data-ttu-id="4246e-169">백 엔드 풀에서 각 VM은 DIP의 고유한 포트에 원하는 서비스를 노출합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-169">In the backend pool, each VM exposes the desired service on a unique port on a DIP.</span></span> <span data-ttu-id="4246e-170">이 서비스는 규칙 정의 통해 프런트 엔드와 연결됩니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-170">This service is associated with the frontend through a rule definition.</span></span>

<span data-ttu-id="4246e-171">두 가지 규칙을 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-171">We define two rules:</span></span>

| <span data-ttu-id="4246e-172">규칙</span><span class="sxs-lookup"><span data-stu-id="4246e-172">Rule</span></span> | <span data-ttu-id="4246e-173">맵 프론트 엔드</span><span class="sxs-lookup"><span data-stu-id="4246e-173">Map frontend</span></span> | <span data-ttu-id="4246e-174">백 엔드 풀에</span><span class="sxs-lookup"><span data-stu-id="4246e-174">To backend pool</span></span> |
| --- | --- | --- |
| <span data-ttu-id="4246e-175">1</span><span class="sxs-lookup"><span data-stu-id="4246e-175">1</span></span> |![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="4246e-177">VIP1:80</span><span class="sxs-lookup"><span data-stu-id="4246e-177">VIP1:80</span></span> |![백 엔드](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="4246e-179">DIP1:80,</span><span class="sxs-lookup"><span data-stu-id="4246e-179">DIP1:80,</span></span> ![백 엔드](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="4246e-181">DIP2:80</span><span class="sxs-lookup"><span data-stu-id="4246e-181">DIP2:80</span></span> |
| <span data-ttu-id="4246e-182">2</span><span class="sxs-lookup"><span data-stu-id="4246e-182">2</span></span> |![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="4246e-184">VIP2:80</span><span class="sxs-lookup"><span data-stu-id="4246e-184">VIP2:80</span></span> |![백 엔드](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="4246e-186">DIP1:81,</span><span class="sxs-lookup"><span data-stu-id="4246e-186">DIP1:81,</span></span> ![백 엔드](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="4246e-188">DIP2:81</span><span class="sxs-lookup"><span data-stu-id="4246e-188">DIP2:81</span></span> |

<span data-ttu-id="4246e-189">Azure Load Balancer에서 전체 매핑은 이제 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-189">The complete mapping in Azure Load Balancer is now as follows:</span></span>

| <span data-ttu-id="4246e-190">규칙</span><span class="sxs-lookup"><span data-stu-id="4246e-190">Rule</span></span> | <span data-ttu-id="4246e-191">VIP IP 주소</span><span class="sxs-lookup"><span data-stu-id="4246e-191">VIP IP address</span></span> | <span data-ttu-id="4246e-192">protocol</span><span class="sxs-lookup"><span data-stu-id="4246e-192">protocol</span></span> | <span data-ttu-id="4246e-193">포트</span><span class="sxs-lookup"><span data-stu-id="4246e-193">port</span></span> | <span data-ttu-id="4246e-194">대상</span><span class="sxs-lookup"><span data-stu-id="4246e-194">Destination</span></span> | <span data-ttu-id="4246e-195">포트</span><span class="sxs-lookup"><span data-stu-id="4246e-195">port</span></span> |
| --- | --- | --- | --- | --- | --- |
| ![규칙](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="4246e-197">1</span><span class="sxs-lookup"><span data-stu-id="4246e-197">1</span></span> |<span data-ttu-id="4246e-198">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="4246e-198">65.52.0.1</span></span> |<span data-ttu-id="4246e-199">TCP</span><span class="sxs-lookup"><span data-stu-id="4246e-199">TCP</span></span> |<span data-ttu-id="4246e-200">80</span><span class="sxs-lookup"><span data-stu-id="4246e-200">80</span></span> |<span data-ttu-id="4246e-201">DIP IP 주소</span><span class="sxs-lookup"><span data-stu-id="4246e-201">DIP IP Address</span></span> |<span data-ttu-id="4246e-202">80</span><span class="sxs-lookup"><span data-stu-id="4246e-202">80</span></span> |
| ![규칙](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="4246e-204">2</span><span class="sxs-lookup"><span data-stu-id="4246e-204">2</span></span> |<span data-ttu-id="4246e-205">65.52.0.2</span><span class="sxs-lookup"><span data-stu-id="4246e-205">65.52.0.2</span></span> |<span data-ttu-id="4246e-206">TCP</span><span class="sxs-lookup"><span data-stu-id="4246e-206">TCP</span></span> |<span data-ttu-id="4246e-207">80</span><span class="sxs-lookup"><span data-stu-id="4246e-207">80</span></span> |<span data-ttu-id="4246e-208">DIP IP 주소</span><span class="sxs-lookup"><span data-stu-id="4246e-208">DIP IP Address</span></span> |<span data-ttu-id="4246e-209">81</span><span class="sxs-lookup"><span data-stu-id="4246e-209">81</span></span> |

<span data-ttu-id="4246e-210">각 규칙은 대상 IP 주소 및 대상 포트의 고유한 조합으로 흐름을 생성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-210">Each rule must produce a flow with a unique combination of destination IP address and destination port.</span></span> <span data-ttu-id="4246e-211">흐름의 대상 포트를 변경함으로써 여러 규칙이 다른 포트의 동일한 DIP로 흐름을 전달할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-211">By varying the destination port of the flow, multiple rules can deliver flows to the same DIP on different ports.</span></span>

<span data-ttu-id="4246e-212">상태 프로브는 언제나 VM의 DIP에 전달됩니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-212">Health probes are always directed to the DIP of a VM.</span></span> <span data-ttu-id="4246e-213">프로브가 VM의 상태를 반영하는지 확인해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-213">You must ensure you that your probe reflects the health of the VM.</span></span>

## <a name="rule-type-2-backend-port-reuse-by-using-floating-ip"></a><span data-ttu-id="4246e-214">규칙 유형 #2: 부동 IP를 사용하여 백엔드 포트 재사용</span><span class="sxs-lookup"><span data-stu-id="4246e-214">Rule type #2: backend port reuse by using Floating IP</span></span>

<span data-ttu-id="4246e-215">Azure Load Balancer는 사용된 규칙 유형에 관계없이 여러 VIP 전반에 걸쳐 프런트 엔드 포트를 재사용할 수 있는 유연성을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-215">Azure Load Balancer provides the flexibility to reuse the frontend port across multiple VIPs regardless of the rule type used.</span></span> <span data-ttu-id="4246e-216">또한 일부 응용 프로그램 시나리오는 백 엔드 풀의 단일 VM에서 여러 응용 프로그램 인스턴스가 동일한 포트를 사용하는 것을 선호하거나 필요로 합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-216">Additionally, some application scenarios prefer or require the same port to be used by multiple application instances on a single VM in the backend pool.</span></span> <span data-ttu-id="4246e-217">포트 재사용의 일반적인 예에는 고가용성을 위한 클러스터링, 네트워크 가상 어플라이언스 및 재암호화 없이 다중 TLS 끝점 노출이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-217">Common examples of port reuse include clustering for high availability, network virtual appliances, and exposing multiple TLS endpoints without re-encryption.</span></span>

<span data-ttu-id="4246e-218">여러 규칙 전반에 백 엔드 포트를 재사용하려면 규칙 정의에 부동 IP를 사용하도록 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-218">If you want to reuse the backend port across multiple rules, you must enable Floating IP in the rule definition.</span></span>

<span data-ttu-id="4246e-219">부동 IP는 Direct Server Return (DSR)으로 알려진 것의 일부입니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-219">Floating IP is a portion of what is known as Direct Server Return (DSR).</span></span> <span data-ttu-id="4246e-220">DSR는 흐름 토폴로지와 IP 주소 매핑 구성표라는 두 부분으로 구성됩니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-220">DSR consists of two parts: a flow topology and an IP address mapping scheme.</span></span> <span data-ttu-id="4246e-221">플랫폼 수준에서 Azure Load Balancer는 부동 IP 사용 여부에 관계 없이 DSR 흐름 토폴로지에서 항상 작동합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-221">At a platform level, Azure Load Balancer always operates in a DSR flow topology regardless of whether Floating IP is enabled or not.</span></span> <span data-ttu-id="4246e-222">이는 아웃바운드 부분의 흐름이 다시 원점으로 직접 흘러가도록 언제나 올바르게 다시 작성되는 것을 의미합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-222">This means that the outbound part of a flow is always correctly rewritten to flow directly back to the origin.</span></span>

<span data-ttu-id="4246e-223">기본 규칙 유형을 사용하여 Azure는 사용 편의성을 위해 기존의 부하 분산 IP 주소 매핑 체계를 노출 합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-223">With the default rule type, Azure exposes a traditional load balancing IP address mapping scheme for ease of use.</span></span> <span data-ttu-id="4246e-224">부동 IP를 사용하도록 설정하면 아래에 설명한대로 IP 주소 매핑 구성표가 추가적인 유연성을 허용하도록 변경됩니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-224">Enabling Floating IP changes the IP address mapping scheme to allow for additional flexibility as explained below.</span></span>

<span data-ttu-id="4246e-225">아래 다이어그램은 이 구성을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-225">The following diagram illustrates this configuration:</span></span>

![MultiVIP 그림](./media/load-balancer-multivip-overview/load-balancer-multivip-dsr.png)

<span data-ttu-id="4246e-227">이 시나리오의 경우 백 엔드 풀의 모든 VM에 네트워크 인터페이스가 3개 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-227">For this scenario, every VM in the backend pool has three network interfaces:</span></span>

* <span data-ttu-id="4246e-228">DIP: VM과 연결된 Virtual NIC(Azure NIC 리소스의 IP 구성)</span><span class="sxs-lookup"><span data-stu-id="4246e-228">DIP: a Virtual NIC associated with the VM (IP configuration of Azure's NIC resource)</span></span>
* <span data-ttu-id="4246e-229">VIP1: VIP1의 IP 주소로 구성된 게스트 OS 내의루프백 인터페이스</span><span class="sxs-lookup"><span data-stu-id="4246e-229">VIP1: a loopback interface within guest OS that is configured with IP address of VIP1</span></span>
* <span data-ttu-id="4246e-230">VIP2: VIP2의 IP 주소로 구성된 게스트 OS 내의루프백 인터페이스</span><span class="sxs-lookup"><span data-stu-id="4246e-230">VIP2: a loopback interface within guest OS that is configured with IP address of VIP2</span></span>

> [!IMPORTANT]
> <span data-ttu-id="4246e-231">논리 인터페이스의 구성은 게스트 OS 내에서 수행됩니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-231">The configuration of the logical interfaces is performed within the guest OS.</span></span> <span data-ttu-id="4246e-232">이 구성은 Azure에서 수행하거나 관리하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-232">This configuration is not performed or managed by Azure.</span></span> <span data-ttu-id="4246e-233">이 구성 없이는 규칙이 작동하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-233">Without this configuration, the rules will not function.</span></span> <span data-ttu-id="4246e-234">상태 프로브 정의는 논리 VIP보다는 VM의 DIP를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-234">Health probe definitions use the DIP of the VM rather than the logical VIP.</span></span> <span data-ttu-id="4246e-235">따라서 서비스는 논리적 VIP에서 제공하는 서비스의 상태를 반영하는 DIP 포트에서의 프로브 응답을 제공해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-235">Therefore, your service must provide probe responses on a DIP port that reflect the status of the service offered on the logical VIP.</span></span>

<span data-ttu-id="4246e-236">이전 시나리오에서와 동일한 프런트 엔드 구성을 가정해 보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-236">Let's assume the same frontend configuration as in the previous scenario:</span></span>

| <span data-ttu-id="4246e-237">VIP</span><span class="sxs-lookup"><span data-stu-id="4246e-237">VIP</span></span> | <span data-ttu-id="4246e-238">IP 주소</span><span class="sxs-lookup"><span data-stu-id="4246e-238">IP address</span></span> | <span data-ttu-id="4246e-239">protocol</span><span class="sxs-lookup"><span data-stu-id="4246e-239">protocol</span></span> | <span data-ttu-id="4246e-240">포트</span><span class="sxs-lookup"><span data-stu-id="4246e-240">port</span></span> |
| --- | --- | --- | --- |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="4246e-242">1</span><span class="sxs-lookup"><span data-stu-id="4246e-242">1</span></span> |<span data-ttu-id="4246e-243">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="4246e-243">65.52.0.1</span></span> |<span data-ttu-id="4246e-244">TCP</span><span class="sxs-lookup"><span data-stu-id="4246e-244">TCP</span></span> |<span data-ttu-id="4246e-245">80</span><span class="sxs-lookup"><span data-stu-id="4246e-245">80</span></span> |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="4246e-247">2</span><span class="sxs-lookup"><span data-stu-id="4246e-247">2</span></span> |<span data-ttu-id="4246e-248">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="4246e-248">*65.52.0.2*</span></span> |<span data-ttu-id="4246e-249">TCP</span><span class="sxs-lookup"><span data-stu-id="4246e-249">TCP</span></span> |<span data-ttu-id="4246e-250">80</span><span class="sxs-lookup"><span data-stu-id="4246e-250">80</span></span> |

<span data-ttu-id="4246e-251">두 가지 규칙을 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-251">We define two rules:</span></span>

| <span data-ttu-id="4246e-252">규칙</span><span class="sxs-lookup"><span data-stu-id="4246e-252">Rule</span></span> | <span data-ttu-id="4246e-253">맵 프론트 엔드</span><span class="sxs-lookup"><span data-stu-id="4246e-253">Map frontend</span></span> | <span data-ttu-id="4246e-254">백 엔드 풀에</span><span class="sxs-lookup"><span data-stu-id="4246e-254">To backend pool</span></span> |
| --- | --- | --- |
| <span data-ttu-id="4246e-255">1</span><span class="sxs-lookup"><span data-stu-id="4246e-255">1</span></span> |![규칙](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="4246e-257">VIP1:80</span><span class="sxs-lookup"><span data-stu-id="4246e-257">VIP1:80</span></span> |![백 엔드](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="4246e-259">VIP1:80 (VM1 및 VM2에서)</span><span class="sxs-lookup"><span data-stu-id="4246e-259">VIP1:80 (in VM1 and VM2)</span></span> |
| <span data-ttu-id="4246e-260">2</span><span class="sxs-lookup"><span data-stu-id="4246e-260">2</span></span> |![규칙](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="4246e-262">VIP2:80</span><span class="sxs-lookup"><span data-stu-id="4246e-262">VIP2:80</span></span> |![백 엔드](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="4246e-264">VIP2:80 (VM1 및 VM2에서)</span><span class="sxs-lookup"><span data-stu-id="4246e-264">VIP2:80 (in VM1 and VM2)</span></span> |

<span data-ttu-id="4246e-265">다음 표는 부하 분산 장치에서의 전체 매핑을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-265">The following table shows the complete mapping in the load balancer:</span></span>

| <span data-ttu-id="4246e-266">규칙</span><span class="sxs-lookup"><span data-stu-id="4246e-266">Rule</span></span> | <span data-ttu-id="4246e-267">VIP IP 주소</span><span class="sxs-lookup"><span data-stu-id="4246e-267">VIP IP address</span></span> | <span data-ttu-id="4246e-268">protocol</span><span class="sxs-lookup"><span data-stu-id="4246e-268">protocol</span></span> | <span data-ttu-id="4246e-269">포트</span><span class="sxs-lookup"><span data-stu-id="4246e-269">port</span></span> | <span data-ttu-id="4246e-270">대상</span><span class="sxs-lookup"><span data-stu-id="4246e-270">Destination</span></span> | <span data-ttu-id="4246e-271">포트</span><span class="sxs-lookup"><span data-stu-id="4246e-271">port</span></span> |
| --- | --- | --- | --- | --- | --- |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="4246e-273">1</span><span class="sxs-lookup"><span data-stu-id="4246e-273">1</span></span> |<span data-ttu-id="4246e-274">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="4246e-274">65.52.0.1</span></span> |<span data-ttu-id="4246e-275">TCP</span><span class="sxs-lookup"><span data-stu-id="4246e-275">TCP</span></span> |<span data-ttu-id="4246e-276">80</span><span class="sxs-lookup"><span data-stu-id="4246e-276">80</span></span> |<span data-ttu-id="4246e-277">VIP (65.52.0.1)과 동일함</span><span class="sxs-lookup"><span data-stu-id="4246e-277">same as VIP (65.52.0.1)</span></span> |<span data-ttu-id="4246e-278">VIP (80)과 동일함</span><span class="sxs-lookup"><span data-stu-id="4246e-278">same as VIP (80)</span></span> |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="4246e-280">2</span><span class="sxs-lookup"><span data-stu-id="4246e-280">2</span></span> |<span data-ttu-id="4246e-281">65.52.0.2</span><span class="sxs-lookup"><span data-stu-id="4246e-281">65.52.0.2</span></span> |<span data-ttu-id="4246e-282">TCP</span><span class="sxs-lookup"><span data-stu-id="4246e-282">TCP</span></span> |<span data-ttu-id="4246e-283">80</span><span class="sxs-lookup"><span data-stu-id="4246e-283">80</span></span> |<span data-ttu-id="4246e-284">VIP (65.52.0.2)과 동일함</span><span class="sxs-lookup"><span data-stu-id="4246e-284">same as VIP (65.52.0.2)</span></span> |<span data-ttu-id="4246e-285">VIP (80)과 동일함</span><span class="sxs-lookup"><span data-stu-id="4246e-285">same as VIP (80)</span></span> |

<span data-ttu-id="4246e-286">인바운드 흐름의 대상은 VM에서 루프백 인터페이스의 VIP 주소입니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-286">The destination of the inbound flow is the VIP address on the loopback interface in the VM.</span></span> <span data-ttu-id="4246e-287">각 규칙은 대상 IP 주소 및 대상 포트의 고유한 조합으로 흐름을 생성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-287">Each rule must produce a flow with a unique combination of destination IP address and destination port.</span></span> <span data-ttu-id="4246e-288">흐름의 대상 IP 주소를 변경하면 동일한 VM에서 포트 재사용이 가능합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-288">By varying the destination IP address of the flow, port reuse is possible on the same VM.</span></span> <span data-ttu-id="4246e-289">VIP의 IP 주소 및 해당 루프백 인터페이스의 포트에 바인딩하면 서비스가 부하 분산 장치에 노출됩니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-289">Your service is exposed to the load balancer by binding it to the VIP’s IP address and port of the respective loopback interface.</span></span>

<span data-ttu-id="4246e-290">이 예는 대상 포트를 변경하지 않는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-290">Notice that this example does not change the destination port.</span></span> <span data-ttu-id="4246e-291">비록 부동 IP 시나리오이지만 Azure Load Balancer는 또한 백 엔드 대상 포트를 다시 작성하여 프런트 엔드 대상 포트와 다르도록 규칙을 정의하는 것을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-291">Even though this is a Floating IP scenario, Azure Load Balancer also supports defining a rule to rewrite the backend destination port and to make it different from the frontend destination port.</span></span>

<span data-ttu-id="4246e-292">부동 IP 규칙 유형은 여러 부하 분산 장치 구성 패턴의 기초입니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-292">The Floating IP rule type is the foundation of several load balancer configuration patterns.</span></span> <span data-ttu-id="4246e-293">현재 사용할 수 있는 한 가지 예로 [Multiple Listeners를 사용한 SQL AlwaysOn](../virtual-machines/windows/sql/virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md) 구성을 들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-293">One example that is currently available is the [SQL AlwaysOn with Multiple Listeners](../virtual-machines/windows/sql/virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md) configuration.</span></span> <span data-ttu-id="4246e-294">앞으로 이러한 시나리오 더욱 자세히 설명할 것입니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-294">Over time, we will document more of these scenarios.</span></span>

## <a name="limitations"></a><span data-ttu-id="4246e-295">제한 사항</span><span class="sxs-lookup"><span data-stu-id="4246e-295">Limitations</span></span>

* <span data-ttu-id="4246e-296">다중 VIP 구성은 IaaS VM을 사용할 때만 지원됩니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-296">Multiple VIP configurations are only supported with IaaS VMs.</span></span>
* <span data-ttu-id="4246e-297">부동 IP 규칙을 사용할 경우 응용 프로그램은 아웃바운드 흐름에 대해 DIP를 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-297">With the Floating IP rule, your application must use the DIP for outbound flows.</span></span> <span data-ttu-id="4246e-298">응용 프로그램이 게스트 OS에서 루프백 인터페이스에 구성된 VIP 주소에 바인딩하는 경우 아웃바운드 흐름을 재작성하기 위해 SNAT을 사용할 수 없어 흐름이 실패합니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-298">If your application binds to the VIP address configured on the loopback interface in the guest OS, then SNAT is not available to rewrite the outbound flow and the flow fails.</span></span>
* <span data-ttu-id="4246e-299">공용 IP 주소는 대금 청구에 영향을 미칩니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-299">Public IP addresses have an effect on billing.</span></span> <span data-ttu-id="4246e-300">자세한 내용은 [IP 주소 가격 책정](https://azure.microsoft.com/pricing/details/ip-addresses/)</span><span class="sxs-lookup"><span data-stu-id="4246e-300">For more information, see [IP Address pricing](https://azure.microsoft.com/pricing/details/ip-addresses/)</span></span>
* <span data-ttu-id="4246e-301">구독 제한이 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="4246e-301">Subscription limits apply.</span></span> <span data-ttu-id="4246e-302">자세한 내용은 [서비스 제한](../azure-subscription-service-limits.md#networking-limits) 을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="4246e-302">For more information, see [Service limits](../azure-subscription-service-limits.md#networking-limits) for details.</span></span>
