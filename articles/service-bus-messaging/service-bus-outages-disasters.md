---
title: "작동 중단 및 재해 로부터 aaaInsulating Azure 서비스 버스 응용 프로그램 | Microsoft Docs"
description: "잠재적인 서비스 버스 가동 중단에 대해 tooprotect 응용 프로그램을 사용할 수 있습니다 하는 기술을 설명 합니다."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: tysonn
ms.assetid: fd9fa8ab-f4c4-43f7-974f-c876df1614d4
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/12/2017
ms.author: sethm
ms.openlocfilehash: 349b4968456c9f15375753d83495246f5a3ddfdb
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/06/2017
---
# <a name="best-practices-for-insulating-applications-against-service-bus-outages-and-disasters"></a><span data-ttu-id="a95f5-103">서비스 버스 가동 중단 및 재해로부터 응용 프로그램을 보호하기 위한 모범 사례</span><span class="sxs-lookup"><span data-stu-id="a95f5-103">Best practices for insulating applications against Service Bus outages and disasters</span></span>
<span data-ttu-id="a95f5-104">중요 응용 프로그램 계획 되지 않은 가동 중단 또는 재해의 hello 존재 여부에도 계속 작동 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-104">Mission-critical applications must operate continuously, even in hello presence of unplanned outages or disasters.</span></span> <span data-ttu-id="a95f5-105">이 항목에서는 기술을 잠재적 서비스 중단 또는 재해 로부터 tooprotect 서비스 버스 응용 프로그램을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-105">This topic describes techniques you can use tooprotect Service Bus applications against a potential service outage or disaster.</span></span>

<span data-ttu-id="a95f5-106">가동 중단은 Azure 서비스 버스의 일시적인 장애가 hello로 정의 됩니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-106">An outage is defined as hello temporary unavailability of Azure Service Bus.</span></span> <span data-ttu-id="a95f5-107">hello 중단 메시징 저장소 또는 전체 데이터 센터에도 hello와 같은 서비스 버스의 일부 구성 요소에 영향을 줄 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-107">hello outage can affect some components of Service Bus, such as a messaging store, or even hello entire datacenter.</span></span> <span data-ttu-id="a95f5-108">Hello 문제가 해결 된 후 서비스 버스 다시 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-108">After hello problem has been fixed, Service Bus becomes available again.</span></span> <span data-ttu-id="a95f5-109">일반적으로 가동 중단으로 인해 메시지나 기타 데이터는 손실되지는 않습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-109">Typically, an outage does not cause loss of messages or other data.</span></span> <span data-ttu-id="a95f5-110">구성 요소 실패의 예로 hello는 특정 메시징 저장소를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-110">An example of a component failure is hello unavailability of a particular messaging store.</span></span> <span data-ttu-id="a95f5-111">데이터 센터 전체가 가동 중단의 예로 hello 데이터 센터 또는 결함이 있는 데이터 센터 네트워크 스위치의 전원 오류.</span><span class="sxs-lookup"><span data-stu-id="a95f5-111">An example of a datacenter-wide outage is a power failure of hello datacenter, or a faulty datacenter network switch.</span></span> <span data-ttu-id="a95f5-112">가동 중단 며칠에서 몇 분 tooa 지속 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-112">An outage can last from a few minutes tooa few days.</span></span>

<span data-ttu-id="a95f5-113">서비스 버스 배율 단위 또는 데이터 센터 hello 영구 손실 재해 정의 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-113">A disaster is defined as hello permanent loss of a Service Bus scale unit or datacenter.</span></span> <span data-ttu-id="a95f5-114">hello 데이터 센터 하지을 사용할 수 있게 다시 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-114">hello datacenter may or may not become available again.</span></span> <span data-ttu-id="a95f5-115">일반적으로 재해가 발생하면 메시지나 기타 데이터의 일부 또는 전체를 잃게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-115">Typically a disaster causes loss of some or all messages or other data.</span></span> <span data-ttu-id="a95f5-116">재해의 예로는 화재, 홍수 또는 지진이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-116">Examples of disasters are fire, flooding, or earthquake.</span></span>

## <a name="current-architecture"></a><span data-ttu-id="a95f5-117">현재 아키텍처</span><span class="sxs-lookup"><span data-stu-id="a95f5-117">Current architecture</span></span>
<span data-ttu-id="a95f5-118">서비스 버스 여러 메시징 저장소 toostore 전송 된 메시지를 tooqueues 또는 항목을 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-118">Service Bus uses multiple messaging stores toostore messages that are sent tooqueues or topics.</span></span> <span data-ttu-id="a95f5-119">분할 되지 않은 큐 또는 항목 메시지 저장소 tooone를 할당 됩니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-119">A non-partitioned queue or topic is assigned tooone messaging store.</span></span> <span data-ttu-id="a95f5-120">이 메시지 저장소를 사용할 수 없게 되면 해당 큐 또는 항목의 모든 작업이 실패하게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-120">If this messaging store is unavailable, all operations on that queue or topic will fail.</span></span>

<span data-ttu-id="a95f5-121">모든 서비스 버스 메시징 엔터티(큐, 항목, 릴레이)는 데이터센터와 연결된 서비스 네임스페이스에 상주합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-121">All Service Bus messaging entities (queues, topics, relays) reside in a service namespace, which is affiliated with a datacenter.</span></span> <span data-ttu-id="a95f5-122">서비스 버스의 데이터를 자동 지리적 복제를 사용 하지 않는 될 수 없습니다 네임 스페이스 toospan 여러 데이터 센터.</span><span class="sxs-lookup"><span data-stu-id="a95f5-122">Service Bus does not enable automatic geo-replication of data, nor does it allow a namespace toospan multiple datacenters.</span></span>

## <a name="protecting-against-acs-outages"></a><span data-ttu-id="a95f5-123">ACS 가동 중단으로부터 보호</span><span class="sxs-lookup"><span data-stu-id="a95f5-123">Protecting against ACS outages</span></span>
<span data-ttu-id="a95f5-124">ACS 자격 증명을 사용하는 경우 ACS를 사용할 수 없게 되면 클라이언트가 토큰을 가져올 수 없게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-124">If you are using ACS credentials, and ACS becomes unavailable, clients can no longer obtain tokens.</span></span> <span data-ttu-id="a95f5-125">ACS가 작동 해제 hello 시 한 토큰이 있는 클라이언트 hello 토큰 만료 될 때까지 toouse 서비스 버스를 계속 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-125">Clients that have a token at hello time ACS goes down can continue toouse Service Bus until hello tokens expire.</span></span> <span data-ttu-id="a95f5-126">hello 기본 토큰 수명은 3 시간입니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-126">hello default token lifetime is 3 hours.</span></span>

<span data-ttu-id="a95f5-127">ACS 가동 중단 으로부터 tooprotect 공유 액세스 서명 (SAS) 토큰을 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-127">tooprotect against ACS outages, use Shared Access Signature (SAS) tokens.</span></span> <span data-ttu-id="a95f5-128">이 경우 hello 클라이언트 비밀 키로 자체 생성 된 토큰을 서명 하 여 서비스 버스에 직접 인증 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-128">In this case, hello client authenticates directly with Service Bus by signing a self-minted token with a secret key.</span></span> <span data-ttu-id="a95f5-129">호출 tooACS 더 이상 필요 없는 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-129">Calls tooACS are no longer required.</span></span> <span data-ttu-id="a95f5-130">SAS 토큰에 대한 자세한 내용은 [Service Bus 인증][Service Bus authentication]을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="a95f5-130">For more information about SAS tokens, see [Service Bus authentication][Service Bus authentication].</span></span>

## <a name="protecting-queues-and-topics-against-messaging-store-failures"></a><span data-ttu-id="a95f5-131">메시지 저장소 오류로부터 큐와 항목 보호</span><span class="sxs-lookup"><span data-stu-id="a95f5-131">Protecting queues and topics against messaging store failures</span></span>
<span data-ttu-id="a95f5-132">분할 되지 않은 큐 또는 항목 메시지 저장소 tooone를 할당 됩니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-132">A non-partitioned queue or topic is assigned tooone messaging store.</span></span> <span data-ttu-id="a95f5-133">이 메시지 저장소를 사용할 수 없게 되면 해당 큐 또는 항목의 모든 작업이 실패하게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-133">If this messaging store is unavailable, all operations on that queue or topic will fail.</span></span> <span data-ttu-id="a95f5-134">A 반면 hello에 큐를 분할 여러 조각으로 구성 됩니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-134">A partitioned queue, on hello other hand, consists of multiple fragments.</span></span> <span data-ttu-id="a95f5-135">각 조각은 서로 다른 메시징 저장소에 저장됩니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-135">Each fragment is stored in a different messaging store.</span></span> <span data-ttu-id="a95f5-136">메시지 tooa 분할 된 큐 또는 항목을 보낼 때 서비스 버스 hello 메시지 tooone hello 조각에 할당 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-136">When a message is sent tooa partitioned queue or topic, Service Bus assigns hello message tooone of hello fragments.</span></span> <span data-ttu-id="a95f5-137">Hello 해당 메시징 저장소를 사용할 수 없는 서비스 버스 hello 메시지 tooa 다른 조각, 가능한 경우 기록 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-137">If hello corresponding messaging store is unavailable, Service Bus writes hello message tooa different fragment, if possible.</span></span> <span data-ttu-id="a95f5-138">분할된 엔터티에 대한 자세한 내용은 [분할된 메시징 엔터티][Partitioned messaging entities]를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="a95f5-138">For more information about partitioned entities, see [Partitioned messaging entities][Partitioned messaging entities].</span></span>

## <a name="protecting-against-datacenter-outages-or-disasters"></a><span data-ttu-id="a95f5-139">데이터센터 가동 중단 또는 재해로부터 보호</span><span class="sxs-lookup"><span data-stu-id="a95f5-139">Protecting against datacenter outages or disasters</span></span>
<span data-ttu-id="a95f5-140">두 데이터 센터 사이의 장애 조치에 대 한 tooallow, 각 데이터 센터에서 서비스 버스 서비스 네임 스페이스를 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-140">tooallow for a failover between two datacenters, you can create a Service Bus service namespace in each datacenter.</span></span> <span data-ttu-id="a95f5-141">예를 들어 서비스 버스 서비스 네임 스페이스를 hello **contosoPrimary.servicebus.windows.net** hello 미국 북부/중부 지역에 있을 수 있습니다 및 **contosoSecondary.servicebus.windows.net**hello 미국 남부/중부 지역에 있을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-141">For example, hello Service Bus service namespace **contosoPrimary.servicebus.windows.net** might be located in hello United States North/Central region, and **contosoSecondary.servicebus.windows.net** might be located in hello US South/Central region.</span></span> <span data-ttu-id="a95f5-142">서비스 버스 메시징 엔터티의 데이터 센터 가동 중단의 hello 존재에 액세스할 수 없으므로 유지 해야 하는 경우에 네임 스페이스 모두에 해당 엔터티를 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-142">If a Service Bus messaging entity must remain accessible in hello presence of a datacenter outage, you can create that entity in both namespaces.</span></span>

<span data-ttu-id="a95f5-143">자세한 내용은 hello "Azure 데이터 센터 내에서 서비스 버스 실패" 섹션을 참조 하십시오. [비동기 메시징 패턴 및 고가용성][Asynchronous messaging patterns and high availability]합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-143">For more information, see hello "Failure of Service Bus within an Azure datacenter" section in [Asynchronous messaging patterns and high availability][Asynchronous messaging patterns and high availability].</span></span>

## <a name="protecting-relay-endpoints-against-datacenter-outages-or-disasters"></a><span data-ttu-id="a95f5-144">데이터센터 가동 중단 또는 재해로부터 릴레이 끝점 보호</span><span class="sxs-lookup"><span data-stu-id="a95f5-144">Protecting relay endpoints against datacenter outages or disasters</span></span>
<span data-ttu-id="a95f5-145">릴레이 끝점의 지역 간 복제에는 서비스 버스 가동 중단의 hello 존재에 연결할 수 있는 릴레이 끝점 toobe 노출 하는 서비스 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-145">Geo-replication of relay endpoints allows a service that exposes a relay endpoint toobe reachable in hello presence of Service Bus outages.</span></span> <span data-ttu-id="a95f5-146">tooachieve 지리적 복제 hello 서비스 다른 네임 스페이스에 두 릴레이 끝점을 만들 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-146">tooachieve geo-replication, hello service must create two relay endpoints in different namespaces.</span></span> <span data-ttu-id="a95f5-147">hello 네임 스페이스는 서로 다른 데이터 센터에 있어야 합니다 및 hello 두 개의 끝점 이름과 달라 야 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-147">hello namespaces must reside in different datacenters and hello two endpoints must have different names.</span></span> <span data-ttu-id="a95f5-148">예를 들어, 기본 끝점은 **contosoPrimary.servicebus.windows.net/myPrimaryService**에서 연결할 수 있고 이에 상응하는 보조 끝점은 **contosoSecondary.servicebus.windows.net/mySecondaryService**에서 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-148">For example, a primary endpoint can be reached under **contosoPrimary.servicebus.windows.net/myPrimaryService**, while its secondary counterpart can be reached under **contosoSecondary.servicebus.windows.net/mySecondaryService**.</span></span>

<span data-ttu-id="a95f5-149">hello 서비스는 다음 두 끝점에서 수신 대기 하 고는 클라이언트 hello 서비스 중 하나를 호출할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-149">hello service then listens on both endpoints, and a client can invoke hello service via either endpoint.</span></span> <span data-ttu-id="a95f5-150">클라이언트 응용 프로그램은 임의로 hello 기본 끝점으로 hello 릴레이 중 하나를 선택 하 고 요청 toohello 활성 끝점을 보냅니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-150">A client application randomly picks one of hello relays as hello primary endpoint, and sends its request toohello active endpoint.</span></span> <span data-ttu-id="a95f5-151">Hello 작업이 오류 코드와 함께 실패 하면 해당 hello 릴레이 끝점을 사용할 수 없으면이 오류가 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-151">If hello operation fails with an error code, this failure indicates that hello relay endpoint is not available.</span></span> <span data-ttu-id="a95f5-152">hello 응용 프로그램 채널 toohello 백업 끝점 열리고 hello 요청을 다시 실행 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-152">hello application opens a channel toohello backup endpoint and reissues hello request.</span></span> <span data-ttu-id="a95f5-153">활성 hello 및 hello 백업 끝점 역할을 전환 시점: hello 클라이언트 응용 프로그램에서는 hello 이전 활성 끝점이 toobe 새 백업 끝점이 hello와 hello 이전 백업 끝점 toobe hello 새 활성 끝점이 간주 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-153">At that point hello active and hello backup endpoints switch roles: hello client application considers hello old active endpoint toobe hello new backup endpoint, and hello old backup endpoint toobe hello new active endpoint.</span></span> <span data-ttu-id="a95f5-154">전송 작업이 모두 실패, hello 두 엔터티의 역할 hello 그대로 유지 하 고 오류가 반환 됩니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-154">If both send operations fail, hello roles of hello two entities remain unchanged and an error is returned.</span></span>

<span data-ttu-id="a95f5-155">hello [헤더 블록이 릴레이 서비스 버스를 사용 하 여 지역 복제 메시지] [ Geo-replication with Service Bus relayed Messages] 샘플 tooreplicate 릴레이 하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-155">hello [Geo-replication with Service Bus relayed messages][Geo-replication with Service Bus relayed Messages] sample demonstrates how tooreplicate relays.</span></span>

## <a name="protecting-queues-and-topics-against-datacenter-outages-or-disasters"></a><span data-ttu-id="a95f5-156">데이터센터 가동 중단 또는 재해로부터 큐 또는 항목 보호</span><span class="sxs-lookup"><span data-stu-id="a95f5-156">Protecting queues and topics against datacenter outages or disasters</span></span>
<span data-ttu-id="a95f5-157">복원 력 tooachieve 조정 된 메시징을 사용할 경우 데이터 센터 가동 중단 으로부터 서비스 버스에서는 두 방법: *활성* 및 *수동* 복제 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-157">tooachieve resilience against datacenter outages when using brokered messaging, Service Bus supports two approaches: *active* and *passive* replication.</span></span> <span data-ttu-id="a95f5-158">각 접근 방식에 대 한 지정 된 큐 또는 항목을 데이터 센터 중단의 hello 존재에 액세스할 수 있어야 하는 경우에 두 네임 스페이스에서 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-158">For each approach, if a given queue or topic must remain accessible in hello presence of a datacenter outage, you can create it in both namespaces.</span></span> <span data-ttu-id="a95f5-159">두 엔터티 hello 점이 동일한 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-159">Both entities can have hello same name.</span></span> <span data-ttu-id="a95f5-160">예를 들어, 기본 큐는 **contosoPrimary.servicebus.windows.net/myQueue**에서 연결할 수 있고 이에 상응하는 보조 큐는 **contosoSecondary.servicebus.windows.net/myQueue**에서 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-160">For example, a primary queue can be reached under **contosoPrimary.servicebus.windows.net/myQueue**, while its secondary counterpart can be reached under **contosoSecondary.servicebus.windows.net/myQueue**.</span></span>

<span data-ttu-id="a95f5-161">Hello 응용 프로그램 영구 발신자-수신자 통신에 필요 하지 않으면 hello 응용 프로그램 내구성이 우수한 클라이언트 쪽 큐 tooprevent 메시지 손실 및 tooshield hello 보낸 모든 일시적인 서비스 버스 오류에서를 구현할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-161">If hello application does not require permanent sender-to-receiver communication, hello application can implement a durable client-side queue tooprevent message loss and tooshield hello sender from any transient Service Bus errors.</span></span>

## <a name="active-replication"></a><span data-ttu-id="a95f5-162">능동 복제</span><span class="sxs-lookup"><span data-stu-id="a95f5-162">Active replication</span></span>
<span data-ttu-id="a95f5-163">능동 복제는 모든 작업에서 양쪽 네임스페이스의 엔터티를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-163">Active replication uses entities in both namespaces for every operation.</span></span> <span data-ttu-id="a95f5-164">메시지를 보내는 모든 클라이언트가 보내는 hello의 두 복사본이 동일한 메시지입니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-164">Any client that sends a message sends two copies of hello same message.</span></span> <span data-ttu-id="a95f5-165">첫 번째 복사는 hello toohello 주 엔터티가 전송 됩니다 (예를 들어 **contosoPrimary.servicebus.windows.net/sales**), hello 메시지의 두 번째 복사본 hello toohello 보조 엔터티에 전송 됩니다 (예를 들어  **contosoSecondary.servicebus.windows.net/sales**).</span><span class="sxs-lookup"><span data-stu-id="a95f5-165">hello first copy is sent toohello primary entity (for example, **contosoPrimary.servicebus.windows.net/sales**), and hello second copy of hello message is sent toohello secondary entity (for example, **contosoSecondary.servicebus.windows.net/sales**).</span></span>

<span data-ttu-id="a95f5-166">클라이언트는 두 큐에서 모두 메시지를 받습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-166">A client receives messages from both queues.</span></span> <span data-ttu-id="a95f5-167">hello 수신기 프로세스는 메시지의 첫 번째 사본을 hello 및 hello 두 번째 사본은 표시 되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-167">hello receiver processes hello first copy of a message, and hello second copy is suppressed.</span></span> <span data-ttu-id="a95f5-168">toosuppress 중복 메시지 hello 보낸 고유 식별자를 가진 각 메시지를 태그 지정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-168">toosuppress duplicate messages, hello sender must tag each message with a unique identifier.</span></span> <span data-ttu-id="a95f5-169">Hello 메시지의 두 복사본 hello로 태그가 지정 되어야 동일한 식별자입니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-169">Both copies of hello message must be tagged with hello same identifier.</span></span> <span data-ttu-id="a95f5-170">Hello를 사용할 수 있습니다 [BrokeredMessage.MessageId] [ BrokeredMessage.MessageId] 또는 [BrokeredMessage.Label] [ BrokeredMessage.Label] 속성 또는 사용자 지정 속성 tootag hello 메시지.</span><span class="sxs-lookup"><span data-stu-id="a95f5-170">You can use hello [BrokeredMessage.MessageId][BrokeredMessage.MessageId] or [BrokeredMessage.Label][BrokeredMessage.Label] properties, or a custom property tootag hello message.</span></span> <span data-ttu-id="a95f5-171">hello 수신기 이미 수신 된 메시지의 목록을 유지 관리 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-171">hello receiver must maintain a list of messages that it has already received.</span></span>

<span data-ttu-id="a95f5-172">hello [서비스 버스 조정 메시지를 사용 하 여 지역 복제] [ Geo-replication with Service Bus Brokered Messages] 샘플에서는 메시징 엔터티의 능동 복제를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-172">hello [Geo-replication with Service Bus Brokered Messages][Geo-replication with Service Bus Brokered Messages] sample demonstrates active replication of messaging entities.</span></span>

> [!NOTE]
> <span data-ttu-id="a95f5-173">hello 능동 복제 접근 방식을 hello 작업 수가 두 배로 설정, 따라서이 방법은 toohigher 비용 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-173">hello active replication approach doubles hello number of operations, therefore this approach can lead toohigher cost.</span></span>
> 
> 

## <a name="passive-replication"></a><span data-ttu-id="a95f5-174">수동 복제</span><span class="sxs-lookup"><span data-stu-id="a95f5-174">Passive replication</span></span>
<span data-ttu-id="a95f5-175">Hello 오류가 없는 경우 수동 복제 hello 두 메시징 엔터티 중 하나만 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-175">In hello fault-free case, passive replication uses only one of hello two messaging entities.</span></span> <span data-ttu-id="a95f5-176">클라이언트는 hello 메시지 toohello 활성 엔터티를 보냅니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-176">A client sends hello message toohello active entity.</span></span> <span data-ttu-id="a95f5-177">Hello 연산을 hello 활성 엔터티 hello 데이터 센터 호스트 hello 활성 엔터티를 사용할 수 있는지를 나타내는 오류 코드와 함께 실패 하면 hello 클라이언트 hello 메시지 toohello 백업 엔터티의의 복사본을 보냅니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-177">If hello operation on hello active entity fails with an error code that indicates hello datacenter that hosts hello active entity might be unavailable, hello client sends a copy of hello message toohello backup entity.</span></span> <span data-ttu-id="a95f5-178">이때 hello 활성 및 백업 엔터티 hello 역할 전환: hello 보내는 클라이언트 hello 이전 활성 엔터티 toobe hello 새 백업 엔터티로 간주 되며 이전 백업 엔터티 hello hello 새 활성 엔터티로 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-178">At that point hello active and hello backup entities switch roles: hello sending client considers hello old active entity toobe hello new backup entity, and hello old backup entity is hello new active entity.</span></span> <span data-ttu-id="a95f5-179">전송 작업이 모두 실패, hello 두 엔터티의 역할 hello 그대로 유지 하 고 오류가 반환 됩니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-179">If both send operations fail, hello roles of hello two entities remain unchanged and an error is returned.</span></span>

<span data-ttu-id="a95f5-180">클라이언트는 두 큐에서 모두 메시지를 받습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-180">A client receives messages from both queues.</span></span> <span data-ttu-id="a95f5-181">해당 hello 수신기 동일 메시지, hello hello의 두 복사본을 받을 가능성이 있기 때문에 수신기 중복 메시지를 표시 하지 않아야 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-181">Because there is a chance that hello receiver receives two copies of hello same message, hello receiver must suppress duplicate messages.</span></span> <span data-ttu-id="a95f5-182">표시 하지 않을 수 hello 마찬가지 능동 복제에 대해 설명 하는 방식으로 복제 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-182">You can suppress duplicates in hello same way as described for active replication.</span></span>

<span data-ttu-id="a95f5-183">일반적으로 대부분의 경우 하나의 작업만 수행되기 때문에 수동 복제가 능동 복제보다 더 경제적입니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-183">In general, passive replication is more economical than active replication because in most cases only one operation is performed.</span></span> <span data-ttu-id="a95f5-184">대기 시간, 처리량 및 금전적 비용은 동일한 toohello 복제 되지 않은 시나리오 됩니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-184">Latency, throughput, and monetary cost are identical toohello non-replicated scenario.</span></span>

<span data-ttu-id="a95f5-185">수동 복제를 사용할 때는 hello에 다음과 같은 시나리오 메시지 수 손실 또는 수신 될 두 번:</span><span class="sxs-lookup"><span data-stu-id="a95f5-185">When using passive replication, in hello following scenarios messages can be lost or received twice:</span></span>

* <span data-ttu-id="a95f5-186">**메시지 지연 또는 손실**: hello 보낸 메시지 m1 toohello 기본 큐를 성공적으로 전송 하 고 다음 hello 큐가 hello 수신기 m 1에서 수신 하기 전에 사용할 수 없는 것으로 가정 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-186">**Message delay or loss**: Assume that hello sender successfully sent a message m1 toohello primary queue, and then hello queue becomes unavailable before hello receiver receives m1.</span></span> <span data-ttu-id="a95f5-187">hello 보낸 사람 이어서 나타나는 메시지 m2 toohello 보조 큐를 보냅니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-187">hello sender sends a subsequent message m2 toohello secondary queue.</span></span> <span data-ttu-id="a95f5-188">Hello 기본 큐를 일시적으로 사용할 수 없는 경우 hello 수신기 hello 큐를 다시 사용할 수 있게 m 1을 받습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-188">If hello primary queue is temporarily unavailable, hello receiver receives m1 after hello queue becomes available again.</span></span> <span data-ttu-id="a95f5-189">재해 발생 시 hello 수신기 m 1을 받지 못할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-189">In case of a disaster, hello receiver may never receive m1.</span></span>
* <span data-ttu-id="a95f5-190">**중복 수신**: 해당 hello 보내는 메시지 m toohello 기본 큐를 가정 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-190">**Duplicate reception**: Assume that hello sender sends a message m toohello primary queue.</span></span> <span data-ttu-id="a95f5-191">서비스 버스 m 처리 되었지만 toosend 응답 실패 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-191">Service Bus successfully processes m but fails toosend a response.</span></span> <span data-ttu-id="a95f5-192">보내기 작업의 제한 시간에 hello, hello 보낸 사람 m toohello 보조 큐의 동일한 복사본을 보냅니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-192">After hello send operation times out, hello sender sends an identical copy of m toohello secondary queue.</span></span> <span data-ttu-id="a95f5-193">Hello 약 hello에는 m의 두 사본을 모두 받습니다 이면 hello 수신기 수 tooreceive hello m의 첫 번째 복사본 hello 기본 큐를 사용할 수 없게 되기 전에 동시 합니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-193">If hello receiver is able tooreceive hello first copy of m before hello primary queue becomes unavailable, hello receiver receives both copies of m at approximately hello same time.</span></span> <span data-ttu-id="a95f5-194">이면 hello 수신기 수 tooreceive hello m의 첫 번째 복사본 hello 기본 큐를 사용할 수 없게 되기 전에 hello 수신기 처음 m의 두 번째 복사본 hello만를 수신 하지만 기본 큐 hello 사용 가능 해지면 m의 두 번째 복사본을 받습니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-194">If hello receiver is not able tooreceive hello first copy of m before hello primary queue becomes unavailable, hello receiver initially receives only hello second copy of m, but then receives a second copy of m when hello primary queue becomes available.</span></span>

<span data-ttu-id="a95f5-195">hello [서비스 버스를 사용 하 여 지역 복제 브로커 메시지] [ Geo-replication with Service Bus Brokered Messages] 샘플에서는 메시징 엔터티의 수동 복제를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="a95f5-195">hello [Geo-replication with Service Bus brokered messages][Geo-replication with Service Bus Brokered Messages] sample demonstrates passive replication of messaging entities.</span></span>

## <a name="next-steps"></a><span data-ttu-id="a95f5-196">다음 단계</span><span class="sxs-lookup"><span data-stu-id="a95f5-196">Next steps</span></span>
<span data-ttu-id="a95f5-197">다음이 문서를 참조 하는 toolearn 재해 복구에 대 한 자세한 정보:</span><span class="sxs-lookup"><span data-stu-id="a95f5-197">toolearn more about disaster recovery, see these articles:</span></span>

* <span data-ttu-id="a95f5-198">[Azure SQL Database 비즈니스 연속성][Azure SQL Database Business Continuity]</span><span class="sxs-lookup"><span data-stu-id="a95f5-198">[Azure SQL Database Business Continuity][Azure SQL Database Business Continuity]</span></span>
* <span data-ttu-id="a95f5-199">[Azure용 복원 응용 프로그램 디자인][Azure resiliency technical guidance]</span><span class="sxs-lookup"><span data-stu-id="a95f5-199">[Designing resilient applications for Azure][Azure resiliency technical guidance]</span></span>

[Service Bus Authentication]: service-bus-authentication-and-authorization.md
[Partitioned messaging entities]: service-bus-partitioning.md
[Asynchronous messaging patterns and high availability]: service-bus-async-messaging.md#failure-of-service-bus-within-an-azure-datacenter
[Geo-replication with Service Bus Relayed Messages]: http://code.msdn.microsoft.com/Geo-replication-with-16dbfecd
[BrokeredMessage.MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[BrokeredMessage.Label]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label
[Geo-replication with Service Bus Brokered Messages]: http://code.msdn.microsoft.com/Geo-replication-with-f5688664
[Azure SQL Database Business Continuity]: ../sql-database/sql-database-business-continuity.md
[Azure resiliency technical guidance]: /azure/architecture/resiliency
