---
title: "Windows Server에서 AD FS를 설치한 MFA 서버 | Microsoft Docs"
description: "이 문서에서는 Windows Server 2012 R2 및 2016에서 Azure Multi-Factor Authentication 및 AD FS로 시작하는 방법을 설명합니다."
services: multi-factor-authentication
documentationcenter: 
author: kgremban
manager: femila
editor: yossib
ms.assetid: 57208068-1e55-45b6-840f-fdcd13723074
ms.service: multi-factor-authentication
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 03/29/2017
ms.author: kgremban
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: f2481c18f12d74a90938ffb0353dd000fe73f440
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/11/2017
---
# <a name="configure-azure-multi-factor-authentication-server-to-work-with-ad-fs-in-windows-server"></a><span data-ttu-id="d229c-103">Windows Server에서 AD FS와 작동하도록 Azure Multi-Factor Authentication 서버 구성</span><span class="sxs-lookup"><span data-stu-id="d229c-103">Configure Azure Multi-Factor Authentication Server to work with AD FS in Windows Server</span></span>
<span data-ttu-id="d229c-104">AD FS(Active Directory Federation Services)를 사용하고 클라우드 또는 온-프레미스 리소스 보안을 유지하려는 경우, AD FS와 작동하도록 Azure Multi-Factor Authentication 서버를 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-104">If you use Active Directory Federation Services (AD FS) and want to secure cloud or on-premises resources, you can configure Azure Multi-Factor Authentication Server to work with AD FS.</span></span> <span data-ttu-id="d229c-105">이 구성은 높은 값의 끝점에 대해 2단계 인증을 트리거합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-105">This configuration triggers two-step verification for high-value endpoints.</span></span>

<span data-ttu-id="d229c-106">이 문서에서는 Windows Server 2012 R2 또는 Windows Server 2016에서 AD FS와 함께 Azure Multi-Factor Authentication 서버를 사용하는 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-106">In this article, we discuss using Azure Multi-Factor Authentication Server with AD FS in Windows Server 2012 R2 or Windows Server 2016.</span></span> <span data-ttu-id="d229c-107">자세한 내용은 [AD FS 2.0과 함께 Azure Multi-Factor Authentication 서버를 사용하여 클라우드 및 온-프레미스 리소스 보안을 유지](multi-factor-authentication-get-started-adfs-adfs2.md)하는 방법에 대해 읽어보세요.</span><span class="sxs-lookup"><span data-stu-id="d229c-107">For more information, read about how to [secure cloud and on-premises resources by using Azure Multi-Factor Authentication Server with AD FS 2.0](multi-factor-authentication-get-started-adfs-adfs2.md).</span></span>

## <a name="secure-windows-server-ad-fs-with-azure-multi-factor-authentication-server"></a><span data-ttu-id="d229c-108">Azure Multi-Factor Authentication 서버를 사용하여 Windows Server AD FS 보안 유지</span><span class="sxs-lookup"><span data-stu-id="d229c-108">Secure Windows Server AD FS with Azure Multi-Factor Authentication Server</span></span>
<span data-ttu-id="d229c-109">Azure Multi-Factor Authentication 서버를 설치하는 경우 다음과 같은 옵션을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-109">When you install Azure Multi-Factor Authentication Server, you have the following options:</span></span>

* <span data-ttu-id="d229c-110">AD FS와 동일한 서버에 로컬로 Azure Multi-factor Authentication 서버 설치</span><span class="sxs-lookup"><span data-stu-id="d229c-110">Install Azure Multi-Factor Authentication Server locally on the same server as AD FS</span></span>
* <span data-ttu-id="d229c-111">AD FS 서버에서 로컬로 Azure Multi-Factor Authentication 어댑터를 설치하고 다른 컴퓨터에 Multi-Factor Authentication 서버 설치</span><span class="sxs-lookup"><span data-stu-id="d229c-111">Install the Azure Multi-Factor Authentication adapter locally on the AD FS server, and then install Multi-Factor Authentication Server on a different computer</span></span>

<span data-ttu-id="d229c-112">이 작업을 시작하기 전에 다음 정보를 고려하세요.</span><span class="sxs-lookup"><span data-stu-id="d229c-112">Before you begin, be aware of the following information:</span></span>

* <span data-ttu-id="d229c-113">AD FS 서버에 Azure Multi-Factor Authentication 서버를 설치할 필요 없습니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-113">You are not required to install Azure Multi-Factor Authentication Server on your AD FS server.</span></span> <span data-ttu-id="d229c-114">그러나 AD FS를 실행하는 Windows Server 2012 R2 또한 Windows Server 2016에서 AD FS용 Multi-Factor Authentication 어댑터를 설치해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-114">However, you must install the Multi-Factor Authentication adapter for AD FS on a Windows Server 2012 R2 or Windows Server 2016 that is running AD FS.</span></span> <span data-ttu-id="d229c-115">지원되는 버전이면 다른 컴퓨터에 서버를 설치할 수 있으며, AD FS 어댑터를 AD FS 페더레이션 서버에 따로 설치할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-115">You can install the server on a different computer if it is a supported version and you install the AD FS adapter separately on your AD FS federation server.</span></span> <span data-ttu-id="d229c-116">어댑터를 별도로 설치하는 방법에 알아보려면 다음 절차를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="d229c-116">See the following procedures to learn how to install the adapter separately.</span></span>
* <span data-ttu-id="d229c-117">조직이 문자 메시지 또는 모바일 앱 확인 방법을 사용하는 경우, 회사 설정에서 정의된 문자열에는 <$*application_name*$> 자리 표시자가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-117">If your organization is using text message or mobile app verification methods, the strings defined in Company Settings contain a placeholder, <$*application_name*$>.</span></span> <span data-ttu-id="d229c-118">MFA 서버 v7.1에서 이 자리 표시자를 대체하는 응용 프로그램 이름을 제공할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-118">In MFA Server v7.1, you can provide an application name that replaces this placeholder.</span></span> <span data-ttu-id="d229c-119">v7.0 이상에서 이 자리 표시자는 AD FS 어댑터를 사용하는 경우 자동으로 대체되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-119">In v7.0 or older, this placeholder is not automatically replaced when you use the AD FS adapter.</span></span> <span data-ttu-id="d229c-120">이전 버전의 경우 AD FS 보안을 유지하면 적절 한 문자열에서 자리 표시자를 제거합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-120">For those older versions, remove the placeholder from the appropriate strings when you secure AD FS.</span></span>
* <span data-ttu-id="d229c-121">로그인에 사용하는 계정에는 Active Directory 서비스에서 보안 그룹을 만드는 사용자 권한이 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-121">The account that you use to sign in must have user rights to create security groups in your Active Directory service.</span></span>
* <span data-ttu-id="d229c-122">Multi-Factor Authentication AD FS 어댑터 설치 마법사는 Active Directory의 인스턴스에서 PhoneFactor Admins이라고 하는 보안 그룹을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-122">The Multi-Factor Authentication AD FS adapter installation wizard creates a security group called PhoneFactor Admins in your instance of Active Directory.</span></span> <span data-ttu-id="d229c-123">그런 다음 페더레이션 서비스의 AD FS 서비스 계정을 이 그룹에 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-123">It then adds the AD FS service account of your federation service to this group.</span></span> <span data-ttu-id="d229c-124">PhoneFactor Admins 그룹이 실제로 생성되고 AD FS 서비스 계정이 이 그룹의 멤버인 도메인 컨트롤러에서 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-124">Verify on your domain controller that the PhoneFactor Admins group is indeed created and that the AD FS service account is a member of this group.</span></span> <span data-ttu-id="d229c-125">필요한 경우 도메인 컨트롤러의 PhoneFactor Admins 그룹에 AD FS 서비스 계정을 수동으로 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-125">If necessary, manually add the AD FS service account to the PhoneFactor Admins group on your domain controller.</span></span>
* <span data-ttu-id="d229c-126">사용자 포털을 사용하여 웹 서비스 SDK를 설치하는 방법에 대한 내용은 [Azure Multi-Factor Authentication 서버에 사용자 포털 배포](multi-factor-authentication-get-started-portal.md)</span><span class="sxs-lookup"><span data-stu-id="d229c-126">For information about installing the Web Service SDK with the user portal, read about [deploying the user portal for Azure Multi-Factor Authentication Server.](multi-factor-authentication-get-started-portal.md)</span></span>

### <a name="install-azure-multi-factor-authentication-server-locally-on-the-ad-fs-server"></a><span data-ttu-id="d229c-127">AD FS 서버에 로컬로 Azure Multi-Factor Authentication 서버 설치</span><span class="sxs-lookup"><span data-stu-id="d229c-127">Install Azure Multi-Factor Authentication Server locally on the AD FS server</span></span>
1. <span data-ttu-id="d229c-128">AD FS 서버에 Azure Multi-Factor Authentication 서버를 다운로드하여 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-128">Download and install Azure Multi-Factor Authentication Server on your AD FS server.</span></span> <span data-ttu-id="d229c-129">설치에 대한 내용은 [Azure Multi-factor Authentication 서버로 시작](multi-factor-authentication-get-started-server.md)을 읽어보세요.</span><span class="sxs-lookup"><span data-stu-id="d229c-129">For installation information, read about [getting started with Azure Multi-Factor Authentication Server](multi-factor-authentication-get-started-server.md).</span></span>
2. <span data-ttu-id="d229c-130">Azure Multi-Factor Authentication 서버 관리 콘솔에서 **AD FS** 아이콘을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-130">In the Azure Multi-Factor Authentication Server management console, click the **AD FS** icon.</span></span> <span data-ttu-id="d229c-131">**사용자 등록 허용** 및 **사용자가 메서드를 선택하도록 허용** 옵션을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-131">Select the options **Allow user enrollment** and **Allow users to select method**.</span></span>
3. <span data-ttu-id="d229c-132">조직에 대해 지정하려는 추가 옵션을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-132">Select any additional options you'd like to specify for your organization.</span></span>
4. <span data-ttu-id="d229c-133">**AD FS 어댑터 설치**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-133">Click **Install AD FS Adapter**.</span></span>
   
   <span data-ttu-id="d229c-134"><center>![클라우드](./media/multi-factor-authentication-get-started-adfs-w2k12/server.png)</center></span><span class="sxs-lookup"><span data-stu-id="d229c-134"><center>![Cloud](./media/multi-factor-authentication-get-started-adfs-w2k12/server.png)</center></span></span>

5. <span data-ttu-id="d229c-135">Active Directory 창이 표시되는 경우 다음 두 가지를 의미합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-135">If the Active Directory window is displayed, that means two things.</span></span> <span data-ttu-id="d229c-136">컴퓨터가 도메인에 연결되어 있고 AD FS 어댑터와 Multi-Factor Authentication 서비스 간의 통신 보안 유지를 위한 Active Directory 구성이 완료되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-136">Your computer is joined to a domain, and the Active Directory configuration for securing communication between the AD FS adapter and the Multi-Factor Authentication service is incomplete.</span></span> <span data-ttu-id="d229c-137">**다음**을 클릭하여 이 구성을 자동으로 완료하거나, **자동 Active Directory 구성을 건너뛰고 수동으로 설정 구성** 확인란을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-137">Click **Next** to automatically complete this configuration, or select the **Skip automatic Active Directory configuration and configure settings manually** check box.</span></span> <span data-ttu-id="d229c-138">**다음**을 누릅니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-138">Click **Next**.</span></span>
6. <span data-ttu-id="d229c-139">로컬 그룹 창이 표시되는 경우 두 가지를 의미합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-139">If the Local Group windows is displayed, that means two things.</span></span> <span data-ttu-id="d229c-140">컴퓨터가 도메인에 가입되지 않고 AD FS 어댑터와 Multi-Factor Authentication 서비스 간의 통신 보안 유지를 위한 로컬 그룹 구성이 완료되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-140">Your computer is not joined to a domain, and the local group configuration for securing communication between the AD FS adapter and the Multi-Factor Authentication service is incomplete.</span></span> <span data-ttu-id="d229c-141">**다음**을 클릭하여 이 구성을 자동으로 완료하거나, **자동 로컬 그룹 구성을 건너뛰고 수동으로 설정 구성** 확인란을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-141">Click **Next** to automatically complete this configuration, or select the **Skip automatic Local Group configuration and configure settings manually** check box.</span></span> <span data-ttu-id="d229c-142">**다음**을 누릅니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-142">Click **Next**.</span></span>
7. <span data-ttu-id="d229c-143">설치 마법사에서 **다음**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-143">In the installation wizard, click **Next**.</span></span> <span data-ttu-id="d229c-144">Azure Multi-Factor Authentication 서버는 PhoneFactor Admins 그룹을 만들고 AD FS 서비스 계정을 PhoneFactor Admins 그룹에 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-144">Azure Multi-Factor Authentication Server creates the PhoneFactor Admins group and adds the AD FS service account to the PhoneFactor Admins group.</span></span>
   <span data-ttu-id="d229c-145"><center>![클라우드](./media/multi-factor-authentication-get-started-adfs-w2k12/adapter.png)</center></span><span class="sxs-lookup"><span data-stu-id="d229c-145"><center>![Cloud](./media/multi-factor-authentication-get-started-adfs-w2k12/adapter.png)</center></span></span>
8. <span data-ttu-id="d229c-146">**설치 관리자 시작** 페이지에서 **다음**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-146">On the **Launch Installer** page, click **Next**.</span></span>
9. <span data-ttu-id="d229c-147">Multi-Factor Authentication AD FS 어댑터 설치 관리자에서 **다음**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-147">In the Multi-Factor Authentication AD FS adapter installer, click **Next**.</span></span>
10. <span data-ttu-id="d229c-148">설치가 완료되면 **닫기** 를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-148">Click **Close** when the installation is finished.</span></span>
11. <span data-ttu-id="d229c-149">어댑터가 설치되면 이를 AD FS에 등록해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-149">When the adapter has been installed, you must register it with AD FS.</span></span> <span data-ttu-id="d229c-150">Windows PowerShell을 열고 다음 명령을 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-150">Open Windows PowerShell and run the following command:</span></span><br><span data-ttu-id="d229c-151">
    `C:\Program Files\Multi-Factor Authentication Server\Register-MultiFactorAuthenticationAdfsAdapter.ps1`
    <center>![클라우드](./media/multi-factor-authentication-get-started-adfs-w2k12/pshell.png)</center></span><span class="sxs-lookup"><span data-stu-id="d229c-151">
`C:\Program Files\Multi-Factor Authentication Server\Register-MultiFactorAuthenticationAdfsAdapter.ps1`
<center>![Cloud](./media/multi-factor-authentication-get-started-adfs-w2k12/pshell.png)</center></span></span>
12. <span data-ttu-id="d229c-152">새로 등록된 어댑터를 사용하려면 AD FS에서 전역 인증 정책을 편집합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-152">To use your newly registered adapter, edit the global authentication policy in AD FS.</span></span> <span data-ttu-id="d229c-153">AD FS 관리 콘솔에서 **인증 정책** 노드로 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-153">In the AD FS management console, go to the **Authentication Policies** node.</span></span> <span data-ttu-id="d229c-154">**Multi-factor Authentication** 섹션에서 **전역 설정** 섹션 옆에 있는 **편집** 링크를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-154">In the **Multi-factor Authentication** section, click the **Edit** link next to the **Global Settings** section.</span></span> <span data-ttu-id="d229c-155">**전역 인증 정책 편집** 창에서 추가 인증 방법으로 **Multi-Factor Authentication**을 선택하고 **확인**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-155">In the **Edit Global Authentication Policy** window, select **Multi-Factor Authentication** as an additional authentication method, and then click **OK**.</span></span> <span data-ttu-id="d229c-156">어댑터는 WindowsAzureMultiFactorAuthentication으로 등록됩니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-156">The adapter is registered as WindowsAzureMultiFactorAuthentication.</span></span> <span data-ttu-id="d229c-157">등록이 적용되려면 AD FS 서비스를 다시 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-157">Restart the AD FS service for the registration to take effect.</span></span>

<span data-ttu-id="d229c-158"><center>![클라우드](./media/multi-factor-authentication-get-started-adfs-w2k12/global.png)</center></span><span class="sxs-lookup"><span data-stu-id="d229c-158"><center>![Cloud](./media/multi-factor-authentication-get-started-adfs-w2k12/global.png)</center></span></span>

<span data-ttu-id="d229c-159">이제 Multi-Factor Authentication 서버가 AD FS와 함께 사용할 수 있도록 추가 인증 공급자로 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-159">At this point, Multi-Factor Authentication Server is set up to be an additional authentication provider to use with AD FS.</span></span>

## <a name="install-a-standalone-instance-of-the-ad-fs-adapter-by-using-the-web-service-sdk"></a><span data-ttu-id="d229c-160">웹 서비스 SDK를 사용하여 AD FS 어댑터의 독립 실행형 인스턴스를 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-160">Install a standalone instance of the AD FS adapter by using the Web Service SDK</span></span>
1. <span data-ttu-id="d229c-161">Multi-Factor Authentication 서버를 실행하는 서버에 웹 서비스 SDK를 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-161">Install the Web Service SDK on the server that is running Multi-Factor Authentication Server.</span></span>
2. <span data-ttu-id="d229c-162">\Program Files\Multi-Factor Authentication Server 디렉터리에서 다음 파일을 AD FS 어댑터를 설치하려는 서버에 복사합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-162">Copy the following files from the \Program Files\Multi-Factor Authentication Server directory to the server on which you plan to install the AD FS adapter:</span></span>
   * <span data-ttu-id="d229c-163">MultiFactorAuthenticationAdfsAdapterSetup64.msi</span><span class="sxs-lookup"><span data-stu-id="d229c-163">MultiFactorAuthenticationAdfsAdapterSetup64.msi</span></span>
   * <span data-ttu-id="d229c-164">Register-MultiFactorAuthenticationAdfsAdapter.ps1</span><span class="sxs-lookup"><span data-stu-id="d229c-164">Register-MultiFactorAuthenticationAdfsAdapter.ps1</span></span>
   * <span data-ttu-id="d229c-165">Unregister-MultiFactorAuthenticationAdfsAdapter.ps1</span><span class="sxs-lookup"><span data-stu-id="d229c-165">Unregister-MultiFactorAuthenticationAdfsAdapter.ps1</span></span>
   * <span data-ttu-id="d229c-166">MultiFactorAuthenticationAdfsAdapter.config</span><span class="sxs-lookup"><span data-stu-id="d229c-166">MultiFactorAuthenticationAdfsAdapter.config</span></span>
3. <span data-ttu-id="d229c-167">MultiFactorAuthenticationAdfsAdapterSetup64.msi 설치 파일을 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-167">Run the MultiFactorAuthenticationAdfsAdapterSetup64.msi installation file.</span></span>
4. <span data-ttu-id="d229c-168">Multi-Factor Authentication AD FS 어댑터 설치 관리자에서 **다음** 을 클릭하여 설치를 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-168">In the Multi-Factor Authentication AD FS adapter installer, click **Next** to start the installation.</span></span>
5. <span data-ttu-id="d229c-169">설치가 완료되면 **닫기** 를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-169">Click **Close** when the installation is finished.</span></span>

## <a name="edit-the-multifactorauthenticationadfsadapterconfig-file"></a><span data-ttu-id="d229c-170">MultiFactorAuthenticationAdfsAdapter.config 파일을 편집합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-170">Edit the MultiFactorAuthenticationAdfsAdapter.config file</span></span>
<span data-ttu-id="d229c-171">다음 단계를 따라 MultiFactorAuthenticationAdfsAdapter.config 파일을 편집합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-171">Follow these steps to edit the MultiFactorAuthenticationAdfsAdapter.config file:</span></span>

1. <span data-ttu-id="d229c-172">**UseWebServiceSdk** 노드를 **true**로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-172">Set the **UseWebServiceSdk** node to **true**.</span></span>  
2. <span data-ttu-id="d229c-173">**WebServiceSdkUrl** 의 값을 Multi-Factor Authentication 웹 서비스 SDK의 URL로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-173">Set the value for **WebServiceSdkUrl** to the URL of the Multi-Factor Authentication Web Service SDK.</span></span> <span data-ttu-id="d229c-174">예를 들어 *https://contoso.com/&lt;certificatename&gt;/MultiFactorAuthWebServiceSdk/PfWsSdk.asmx*에서 *certificatename*은 인증서의 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-174">For example:  *https://contoso.com/&lt;certificatename&gt;/MultiFactorAuthWebServiceSdk/PfWsSdk.asmx*, Where *certificatename* is the name of your certificate.</span></span>  
3. <span data-ttu-id="d229c-175">Register-MultiFactorAuthenticationAdfsAdapter.ps1 스크립트를 편집하고 `Register-AdfsAuthenticationProvider` 명령 끝에 *-ConfigurationFilePath &lt;path&gt;*를 추가합니다. 여기서 *&lt;path&gt;*는 MultiFactorAuthenticationAdfsAdapter.config 파일의 전체 경로입니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-175">Edit the Register-MultiFactorAuthenticationAdfsAdapter.ps1 script by adding *-ConfigurationFilePath &lt;path&gt;* to the end of the `Register-AdfsAuthenticationProvider` command, where *&lt;path&gt;* is the full path to the MultiFactorAuthenticationAdfsAdapter.config file.</span></span>

### <a name="configure-the-web-service-sdk-with-a-username-and-password"></a><span data-ttu-id="d229c-176">사용자 이름 및 암호를 사용하여 Web Service SDK 구성</span><span class="sxs-lookup"><span data-stu-id="d229c-176">Configure the Web Service SDK with a username and password</span></span>
<span data-ttu-id="d229c-177">Web Service SDK를 구성하는 데는 두 가지 옵션이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-177">There are two options for configuring the Web Service SDK.</span></span> <span data-ttu-id="d229c-178">첫 번째 옵션은 사용자 이름 및 암호를 사용하고 두 번째 옵션은 클라이언트 인증서를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-178">The first is with a username and password, the second is with a client certificate.</span></span> <span data-ttu-id="d229c-179">첫 번째 옵션의 경우 다음 단계를 수행하거나 두 번째 옵션으로 건너 뛰세요.</span><span class="sxs-lookup"><span data-stu-id="d229c-179">Follow these steps for the first option, or skip ahead for the second.</span></span>  

1. <span data-ttu-id="d229c-180">**WebServiceSdkUsername** 의 값을 PhoneFactor Admins 보안 그룹의 구성원인 계정으로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-180">Set the value for **WebServiceSdkUsername** to an account that is a member of the PhoneFactor Admins security group.</span></span> <span data-ttu-id="d229c-181">&lt;도메인&gt;&#92;&lt;사용자 이름&gt; 형식을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-181">Use the &lt;domain&gt;&#92;&lt;user name&gt; format.</span></span>  
2. <span data-ttu-id="d229c-182">**WebServiceSdkPassword** 값을 적절한 계정 암호로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-182">Set the value for **WebServiceSdkPassword** to the appropriate account password.</span></span>

### <a name="configure-the-web-service-sdk-with-a-client-certificate"></a><span data-ttu-id="d229c-183">클라이언트 인증서를 사용하여 Web Service SDK 구성</span><span class="sxs-lookup"><span data-stu-id="d229c-183">Configure the Web Service SDK with a client certificate</span></span>
<span data-ttu-id="d229c-184">사용자 이름 및 암호를 사용하지 않으려는 경우 다음 단계를 따라 클라이언트 인증서를 사용하는 Web Service SDK를 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-184">If you don't want to use a username and password, follow these steps to configure the Web Service SDK with a client certificate.</span></span>

1. <span data-ttu-id="d229c-185">인증 기관에서 웹 서비스 SDK를 실행하는 서버에 대한 클라이언트 인증서를 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-185">Obtain a client certificate from a certificate authority for the server that is running the Web Service SDK.</span></span> <span data-ttu-id="d229c-186">[클라이언트 인증서를 가져오는](https://technet.microsoft.com/library/cc770328.aspx)방법을 알아봅니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-186">Learn how to [obtain client certificates](https://technet.microsoft.com/library/cc770328.aspx).</span></span>  
2. <span data-ttu-id="d229c-187">웹 서비스 SDK를 실행하는 서버의 로컬 컴퓨터 개인 인증서 저장소로 클라이언트 인증서를 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-187">Import the client certificate to the local computer personal certificate store on the server that is running the Web Service SDK.</span></span> <span data-ttu-id="d229c-188">신뢰할 수 있는 루트 인증서 인증서 저장소에 인증 기관의 공용 인증서가 있는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-188">Make sure that the certificate authority's public certificate is in Trusted Root Certificates certificate store.</span></span>  
3. <span data-ttu-id="d229c-189">클라이언트 인증서의 공개 키 및 개인 키를 .pfx 파일로 내보냅니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-189">Export the public and private keys of the client certificate to a .pfx file.</span></span>  
4. <span data-ttu-id="d229c-190">Base64 형식인 공개 키를 .cer 파일로 내보냅니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-190">Export the public key in Base64 format to a .cer file.</span></span>  
5. <span data-ttu-id="d229c-191">Server Manager에서 Web Server (IIS)\Web Server\Security\IIS Client Certificate Mapping Authentication 기능이 설치되어 있는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-191">In Server Manager, verify that the Web Server (IIS)\Web Server\Security\IIS Client Certificate Mapping Authentication feature is installed.</span></span> <span data-ttu-id="d229c-192">이 기능이 설치되어 있지 않은 경우 **역할 및 기능 추가** 를 선택하여 이 기능을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-192">If it is not installed, select **Add Roles and Features** to add this feature.</span></span>  
6. <span data-ttu-id="d229c-193">IIS Manager에서 Web Service SDK 가상 디렉터리가 포함된 웹 사이트의 **구성 편집기** 를 두 번 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-193">In IIS Manager, double-click **Configuration Editor** in the website that contains the Web Service SDK virtual directory.</span></span> <span data-ttu-id="d229c-194">가상 디렉터리가 아니라 웹 사이트를 선택하는 것이 중요합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-194">It is important to select the website, not the virtual directory.</span></span>  
7. <span data-ttu-id="d229c-195">**system.webServer/security/authentication/iisClientCertificateMappingAuthentication** 섹션으로 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-195">Go to the **system.webServer/security/authentication/iisClientCertificateMappingAuthentication** section.</span></span>  
8. <span data-ttu-id="d229c-196">사용을 **true**로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-196">Set enabled to **true**.</span></span>  
9. <span data-ttu-id="d229c-197">oneToOneCertificateMappingsEnabled를 **true**로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-197">Set oneToOneCertificateMappingsEnabled to **true**.</span></span>  
10. <span data-ttu-id="d229c-198">oneToOneMappings 옆에 있는 **...** 단추를 클릭한 다음 **추가** 링크를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-198">Click the **...** button next to oneToOneMappings, and then click the **Add** link.</span></span>  
11. <span data-ttu-id="d229c-199">앞에서 내보낸 Base64 .cer 파일을 엽니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-199">Open the Base64 .cer file you exported earlier.</span></span> <span data-ttu-id="d229c-200">*-----BEGIN CERTIFICATE-----*, *-----END CERTIFICATE-----* 및 줄바꿈을 제거합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-200">Remove *-----BEGIN CERTIFICATE-----*, *-----END CERTIFICATE-----*, and any line breaks.</span></span> <span data-ttu-id="d229c-201">결과 문자열을 복사합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-201">Copy the resulting string.</span></span>  
12. <span data-ttu-id="d229c-202">인증서를 이전 단계에서 복사한 문자열로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-202">Set certificate to the string copied in the preceding step.</span></span>  
13. <span data-ttu-id="d229c-203">사용을 **true**로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-203">Set enabled to **true**.</span></span>  
14. <span data-ttu-id="d229c-204">userName을 PhoneFactor Admins 보안 그룹의 구성원인 계정으로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-204">Set userName to an account that is a member of the PhoneFactor Admins security group.</span></span> <span data-ttu-id="d229c-205">&lt;도메인&gt;&#92;&lt;사용자 이름&gt; 형식을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-205">Use the &lt;domain&gt;&#92;&lt;user name&gt; format.</span></span>  
15. <span data-ttu-id="d229c-206">적절한 계정 암호를 설정하고 Configuration Editor를 닫습니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-206">Set the password to the appropriate account password, and then close Configuration Editor.</span></span>  
16. <span data-ttu-id="d229c-207">**적용** 단추를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-207">Click the **Apply** link.</span></span>  
17. <span data-ttu-id="d229c-208">Web Service SDK 가상 디렉터리에서 **인증**을 두 번 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-208">In the Web Service SDK virtual directory, double-click **Authentication**.</span></span>  
18. <span data-ttu-id="d229c-209">ASP.NET 가장 및 기본 인증을 **사용**으로 설정하고 다른 모든 항목을 **사용 안 함**으로 설정했는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-209">Verify that ASP.NET Impersonation and Basic Authentication are set to **Enabled**, and that all other items are set to **Disabled**.</span></span>  
19. <span data-ttu-id="d229c-210">Web Service SDK 가상 디렉터리에서 **SSL 설정**을 두 번 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-210">In the Web Service SDK virtual directory, double-click **SSL Settings**.</span></span>  
20. <span data-ttu-id="d229c-211">클라이언트 인증서를 **허용**으로 설정한 다음 **적용**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-211">Set Client Certificates to **Accept**, and then click **Apply**.</span></span>  
21. <span data-ttu-id="d229c-212">AD FS 어댑터를 실행하는 서버에 앞서 내보낸 .pfx 파일을 복사합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-212">Copy the .pfx file you exported earlier to the server that is running the AD FS adapter.</span></span>  
22. <span data-ttu-id="d229c-213">.pfx 파일을 로컬 컴퓨터 개인 인증서 저장소로 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-213">Import the .pfx file to the local computer personal certificate store.</span></span>  
23. <span data-ttu-id="d229c-214">**개인 키 관리**를 마우스 오른쪽 단추로 클릭하고 선택한 다음 AD FS 서비스에 로그인할 때 사용한 계정에 읽기 액세스 권한을 부여합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-214">Right-click and select **Manage Private Keys**, and then grant read access to the account you used to sign in to the AD FS service.</span></span>  
24. <span data-ttu-id="d229c-215">클라이언트 인증서를 열고 **세부 정보** 탭에서 지문을 복사합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-215">Open the client certificate and copy the thumbprint from the **Details** tab.</span></span>  
25. <span data-ttu-id="d229c-216">MultiFactorAuthenticationAdfsAdapter.config 파일에서 **WebServiceSdkCertificateThumbprint** 를 이전 단계에서 복사한 문자열로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-216">In the MultiFactorAuthenticationAdfsAdapter.config file, set **WebServiceSdkCertificateThumbprint** to the string copied in the previous step.</span></span>  

<span data-ttu-id="d229c-217">마지막으로 어댑터를 등록하려면 PowerShell에서 \Program Files\Multi-Factor Authentication Server\Register-MultiFactorAuthenticationAdfsAdapter.ps1 스크립트를 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-217">Finally, to register the adapter, run the \Program Files\Multi-Factor Authentication Server\Register-MultiFactorAuthenticationAdfsAdapter.ps1 script in PowerShell.</span></span> <span data-ttu-id="d229c-218">어댑터는 WindowsAzureMultiFactorAuthentication으로 등록됩니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-218">The adapter is registered as WindowsAzureMultiFactorAuthentication.</span></span> <span data-ttu-id="d229c-219">등록이 적용되려면 AD FS 서비스를 다시 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-219">Restart the AD FS service for the registration to take effect.</span></span>

## <a name="secure-azure-ad-resources-using-ad-fs"></a><span data-ttu-id="d229c-220">AD FS를 사용하여 Azure AD 리소스 보안 유지</span><span class="sxs-lookup"><span data-stu-id="d229c-220">Secure Azure AD resources using AD FS</span></span>
<span data-ttu-id="d229c-221">클라우드 리소스를 보호하려면 사용자가 두 단계 인증을 성공적으로 수행했을 때 Active Directory Federation Services가 multipleauthn 클레임을 내보내도록 클레임 규칙을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-221">To secure your cloud resource, set up a claims rule so that Active Directory Federation Services emits the multipleauthn claim when a user performs two-step verification successfully.</span></span> <span data-ttu-id="d229c-222">이 클레임은 Azure AD에 전달됩니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-222">This claim is passed on to Azure AD.</span></span> <span data-ttu-id="d229c-223">다음 단계를 수행하려면 이 절차를 따르세요.</span><span class="sxs-lookup"><span data-stu-id="d229c-223">Follow this procedure to walk through the steps:</span></span>

1. <span data-ttu-id="d229c-224">AD FS 관리를 엽니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-224">Open AD FS Management.</span></span>
2. <span data-ttu-id="d229c-225">왼쪽에서 **신뢰 당사자 트러스트**를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-225">On the left, select **Relying Party Trusts**.</span></span>
3. <span data-ttu-id="d229c-226">**Microsoft Office 365 ID 플랫폼**을 마우스 오른쪽 단추로 클릭하고 **클레임 규칙 편집...**을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-226">Right-click on **Microsoft Office 365 Identity Platform** and select **Edit Claim Rules…**</span></span>

   ![클라우드](./media/multi-factor-authentication-get-started-adfs-cloud/trustedip1.png)

4. <span data-ttu-id="d229c-228">발급 변환 규칙에서 **규칙 추가**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-228">On Issuance Transform Rules, click **Add Rule.**</span></span>

   ![클라우드](./media/multi-factor-authentication-get-started-adfs-cloud/trustedip2.png)

5. <span data-ttu-id="d229c-230">변환 클레임 규칙 추가 마법사의 드롭다운 목록에서 **들어오는 클레임 통과 또는 필터링**을 선택하고 **다음**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-230">On the Add Transform Claim Rule Wizard, select **Pass Through or Filter an Incoming Claim** from the drop-down and click **Next**.</span></span>

   ![클라우드](./media/multi-factor-authentication-get-started-adfs-cloud/trustedip3.png)

6. <span data-ttu-id="d229c-232">규칙의 이름을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-232">Give your rule a name.</span></span>
7. <span data-ttu-id="d229c-233">들어오는 클레임 유형으로 **인증 방법 참조**를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-233">Select **Authentication Methods References** as the Incoming claim type.</span></span>
8. <span data-ttu-id="d229c-234">**모든 클레임 값 통과**를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-234">Select **Pass through all claim values**.</span></span>
    <span data-ttu-id="d229c-235">![변환 클레임 규칙 추가 마법사](./media/multi-factor-authentication-get-started-adfs-cloud/configurewizard.png)</span><span class="sxs-lookup"><span data-stu-id="d229c-235">![Add Transform Claim Rule Wizard](./media/multi-factor-authentication-get-started-adfs-cloud/configurewizard.png)</span></span>
9. <span data-ttu-id="d229c-236">**Finish**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-236">Click **Finish**.</span></span> <span data-ttu-id="d229c-237">AD FS 관리 콘솔을 닫습니다.</span><span class="sxs-lookup"><span data-stu-id="d229c-237">Close the AD FS Management console.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d229c-238">관련된 항목</span><span class="sxs-lookup"><span data-stu-id="d229c-238">Related topics</span></span>
<span data-ttu-id="d229c-239">문제 해결 도움말을 보려면 [Azure Multi-Factor Authentication FAQ](multi-factor-authentication-faq.md)</span><span class="sxs-lookup"><span data-stu-id="d229c-239">For troubleshooting help, see the [Azure Multi-Factor Authentication FAQs](multi-factor-authentication-faq.md)</span></span>
