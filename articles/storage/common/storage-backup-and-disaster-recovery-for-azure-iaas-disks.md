---
title: "Azure IaaS 디스크에 대한 백업 및 재해 복구 | Microsoft Docs"
description: "이 문서에서는 Azure에서 IaaS VM(가상 컴퓨터) 및 디스크의 디스크 백업 및 DR(재해 복구)을 계획하는 방법을 설명합니다. Managed Disks 및 Unmanaged Disks를 모두 다루고 있습니다."
services: storage
cloud: Azure
documentationcenter: na
author: luywang
manager: kavithag
ms.assetid: 
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/19/2017
ms.author: luywang
ms.openlocfilehash: 03d38bc3383b5fd39eca5ca67c315b34b98f0c39
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/29/2017
---
# <a name="backup-and-disaster-recovery-for-azure-iaas-disks"></a><span data-ttu-id="4606e-104">Azure IaaS 디스크에 대한 백업 및 재해 복구</span><span class="sxs-lookup"><span data-stu-id="4606e-104">Backup and disaster recovery for Azure IaaS disks</span></span>

<span data-ttu-id="4606e-105">이 문서에서는 Azure에서 IaaS VM(가상 컴퓨터) 및 디스크의 디스크 백업 및 DR(재해 복구)을 계획하는 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-105">In this article, we will explain how to plan for Backup and Disaster Recovery (DR) of IaaS virtual machines (VMs) and Disks in Azure.</span></span> <span data-ttu-id="4606e-106">Managed Disks 및 Unmanaged Disks를 모두 다루고 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-106">This document covers both Managed and Unmanaged Disks.</span></span>

<span data-ttu-id="4606e-107">Azure 플랫폼에 기본 제공되어 로컬 오류로부터 보호하는 데 도움이 되는 내결함성 기능에 대해 먼저 살펴보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-107">We’ll first talk about the built-in fault tolerance capabilities in the Azure platform which help guard against local failures.</span></span> <span data-ttu-id="4606e-108">그런 다음 이 문서에서 다루는 기본 주제인 기본 제공 기능에 완전히 포함되지 않은 재해 시나리오에 대해 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-108">We’ll then discuss the disaster scenarios not fully covered by the built-in capabilities, which is the main topic addressed by this document.</span></span> <span data-ttu-id="4606e-109">또한 다른 백업 및 DR 고려 사항이 적용될 수 있는 워크로드 시나리오의 몇 가지 예도 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-109">We’ll also show several examples of workload scenarios where different Backup and DR considerations may apply.</span></span> <span data-ttu-id="4606e-110">그런 다음 IaaS 디스크의 DR에 가능한 솔루션을 검토합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-110">We’ll then review possible solutions for DR of IaaS Disks.</span></span> 

## <a name="introduction"></a><span data-ttu-id="4606e-111">소개</span><span class="sxs-lookup"><span data-stu-id="4606e-111">Introduction</span></span>

<span data-ttu-id="4606e-112">Azure 플랫폼은 중복성 및 내결함성을 위해 다양한 방법을 사용하여 발생할 수 있는 지역화된 하드웨어 오류로부터 고객을 보호합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-112">The Azure platform uses various methods for redundancy and fault tolerance to help protect customers from localized hardware failures that can occur.</span></span> <span data-ttu-id="4606e-113">로컬 오류 문제에는 가상 디스크의 데이터 일부 또는 해당 서버의 SSD 또는 HDD 오류를 저장하는 Azure 저장소 서버 컴퓨터와 관련된 문제가 포함될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-113">Local failures may include problems with an Azure storage server machine that stores part of the data for a virtual disk or failures of an SSD or HDD on that server.</span></span> <span data-ttu-id="4606e-114">이러한 격리된 하드웨어 구성 요소 오류는 정상 작동 중에 발생할 수 있으며, 플랫폼은 이러한 오류에 탄력적으로 대처할 수 있도록 설계되었습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-114">Such isolated hardware component failures can happen during normal operations and the platform is designed to be resilient to these failures.</span></span> <span data-ttu-id="4606e-115">중요한 재해로 인해 많은 수의 저장소 서버 또는 전체 데이터 센터에 오류가 발생하거나 액세스할 수 없게 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-115">Major disasters can result in failures or inaccessibility of a large numbers of storage servers or a whole datacenter.</span></span> <span data-ttu-id="4606e-116">VM과 디스크는 일반적으로 지역화된 오류로부터 보호되지만, VM 및 디스크에 영향을 줄 수 있는 지역 전체의 치명적인 오류(예: 중요한 재해)로부터 작업을 보호하려면 추가 단계가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-116">While your VMs and disks are normally protected from localized failures, additional steps are necessary to protect your workload from region-wide catastrophic failures (such as a major disaster) that can affect your VM and disks.</span></span>

<span data-ttu-id="4606e-117">플랫폼 오류 가능성 외에도 고객 응용 프로그램 또는 데이터와 관련된 문제가 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-117">In addition to the possibility of platform failures, problems with the customer application or data can occur.</span></span> <span data-ttu-id="4606e-118">예를 들어 새 버전의 응용 프로그램에서 실수로 데이터를 심각하게 변경시킬 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-118">For example, a new version of your application may inadvertently make a breaking change to the data.</span></span> <span data-ttu-id="4606e-119">이 경우 응용 프로그램과 데이터를 마지막으로 알려진 양호한 상태의 이전 버전으로 되돌리려고 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-119">In that case, you may want to revert the application and the data to a prior version containing the last known good state.</span></span> <span data-ttu-id="4606e-120">이렇게 하려면 정기적으로 백업해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-120">This requires maintaining regular backups.</span></span>

<span data-ttu-id="4606e-121">지역적 재해 복구의 경우 IaaS VM 디스크를 다른 지역에 백업해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-121">For regional disaster recovery, you must backup your IaaS VM disks to a different region.</span></span> 

<span data-ttu-id="4606e-122">백업 및 DR 옵션을 살펴보기 전에 지역화된 오류를 처리하는 데 사용할 수 있는 몇 가지 방법을 요약해 보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-122">Before we look at Backup and DR options, let’s recap a few methods available for handling localized failures.</span></span>

### <a name="azure-iaas-resiliency"></a><span data-ttu-id="4606e-123">Azure IaaS 복원력</span><span class="sxs-lookup"><span data-stu-id="4606e-123">Azure IaaS Resiliency</span></span>

<span data-ttu-id="4606e-124">*복원력*은 하드웨어 구성 요소에서 발생하는 정상적인 오류에 대한 허용 오차를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-124">*Resiliency* refers to the tolerance for normal failures that occur in hardware components.</span></span> <span data-ttu-id="4606e-125">복원력은 오류로부터 복구하고 계속 작동할 수 있는 능력입니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-125">Resiliency is the ability to recover from failures and continue to function.</span></span> <span data-ttu-id="4606e-126">오류를 방지하는 것이 아니라 가동 중지 또는 데이터 손실을 방지하는 방법으로 오류에 대응하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-126">It's not about avoiding failures, but responding to failures in a way that avoids downtime or data loss.</span></span> <span data-ttu-id="4606e-127">복원력의 목표는 오류가 발생한 후 응용 프로그램을 완전히 작동하는 상태로 되돌리기 위한 것입니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-127">The goal of resiliency is to return the application to a fully functioning state following a failure.</span></span> <span data-ttu-id="4606e-128">Azure 가상 컴퓨터 및 디스크는 일반적인 하드웨어 결함에 탄력적으로 대처할 수 있도록 설계되었습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-128">Azure Virtual Machines and Disks are designed to be resilient to common hardware faults.</span></span> <span data-ttu-id="4606e-129">Azure IaaS 플랫폼에서 이러한 복원력을 어떻게 제공하는지 살펴보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-129">Let us look at how the Azure IaaS platform provides this resiliency.</span></span>

<span data-ttu-id="4606e-130">가상 컴퓨터는 크게 두 부분, 즉 (1) 계산 서버 및 (2) 영구 디스크로 구성됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-130">A virtual machine consists mainly of two parts: (1) A compute server, and (2) the persistent disks.</span></span> <span data-ttu-id="4606e-131">둘 다 가상 컴퓨터의 내결함성에 영향을 줍니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-131">Both affect the fault tolerance of a virtual machine.</span></span>

<span data-ttu-id="4606e-132">VM을 저장하는 Azure 계산 호스트 서버에 하드웨어 오류(자주 발생하지 않음)가 발생하는 경우 Azure는 다른 서버에서 해당 VM을 자동으로 복원하도록 설계되었습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-132">If the Azure compute host server that houses your VM experiences a hardware failure (which is rare), Azure is designed to automatically restore the VM on another server.</span></span> <span data-ttu-id="4606e-133">이 경우 다시 부팅이 발생하고 잠시 후에 VM이 백업됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-133">If this happens, you will experience a reboot, and the VM will be back up after some time.</span></span> <span data-ttu-id="4606e-134">Azure는 자동으로 이러한 하드웨어 오류를 감지하고 복구를 실행하여 가능한 한 빨리 고객의 VM을 사용할 수 있도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-134">Azure automatically detects such hardware failures and executes recoveries to help ensure the customer VM will be available as soon as possible.</span></span>

<span data-ttu-id="4606e-135">IaaS 디스크의 경우 데이터의 내구성이 영구 저장소 플랫폼에 중요합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-135">Regarding IaaS disks, durability of data is critical for the persistent storage platform.</span></span> <span data-ttu-id="4606e-136">Azure 고객은 IaaS에서 실행되는 중요한 비즈니스 응용 프로그램을 가지고 있으며 데이터의 지속성에 의존합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-136">Azure customers have important business applications running on IaaS and they depend on the persistence of the data.</span></span> <span data-ttu-id="4606e-137">Azure는 로컬에 저장된 3개의 중복 데이터 사본을 사용하여 이러한 IaaS 디스크를 보호하도록 설계하여 로컬 오류에 대해 높은 내구성을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-137">Azure designs protection for these IaaS disks with three redundant copies of data stored locally, providing high durability against local failures.</span></span> <span data-ttu-id="4606e-138">디스크를 보유하는 하드웨어 구성 요소 중 하나에 오류가 발생하면 디스크 요청을 지원하기 위해 두 개의 추가 사본이 있으므로 VM에 영향을 주지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-138">If one of the hardware components that holds your disk fails, your VM is not impacted because there are two additional copies to support disk requests.</span></span> <span data-ttu-id="4606e-139">디스크를 지원하는 두 개의 다른 하드웨어 구성 요소가 동시에 실패하는 경우에도 작동합니다(매우 드문 경우).</span><span class="sxs-lookup"><span data-stu-id="4606e-139">It works fine even if two different hardware components supporting a disk fail at the same time (which would be very rare).</span></span> <span data-ttu-id="4606e-140">항상 세 개의 복제본을 유지할 수 있도록 하기 위해 세 개의 복사본 중 하나를 사용할 수 없게 되면 Azure Storage 서비스는 백그라운드에서 새 데이터 복사본을 자동으로 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-140">To help ensure we always maintain three replicas, the Azure Storage service automatically spawns a new copy of data in the background if one of the three copies becomes unavailable.</span></span> <span data-ttu-id="4606e-141">따라서 내결함성을 위해 Azure 디스크와 함께 RAID를 사용할 필요는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-141">Therefore, it should not be necessary to use RAID with Azure disks for fault tolerance.</span></span> <span data-ttu-id="4606e-142">필요한 경우 더 큰 볼륨을 만들기 위해 디스크를 스트라이핑하는 데에는 간단한 RAID 0 구성으로 충분합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-142">A simple RAID 0 configuration should be sufficient for striping the disks if necessary to create larger volumes.</span></span>

<span data-ttu-id="4606e-143">이러한 아키텍처에 따라 **Azure는 업계 최고의 0% [연간 실패율](https://en.wikipedia.org/wiki/Annualized_failure_rate)로 IaaS 디스크에 엔터프라이즈급 내구성을 일관되게 제공하고 있습니다.**</span><span class="sxs-lookup"><span data-stu-id="4606e-143">Because of this architecture, **Azure has consistently delivered enterprise-grade durability for IaaS disks, with an industry-leading ZERO % [Annualized Failure Rate](https://en.wikipedia.org/wiki/Annualized_failure_rate).**</span></span>

<span data-ttu-id="4606e-144">계산 호스트 또는 저장소 플랫폼에서 지역화된 하드웨어 오류로 인해 때때로 VM 가용성에 대한 [Azure SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines/)가 적용되는 VM을 일시적으로 사용할 수 없게 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-144">Localized hardware faults on the compute host or in the storage platform can sometimes result in temporary unavailability for the VM which is covered by the [Azure SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines/) for VM Availability.</span></span> <span data-ttu-id="4606e-145">또한 Azure는 Premium Storage 디스크를 사용하는 단일 VM 인스턴스에 업계 최고의 SLA를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-145">Azure also provides an industry-leading SLA for single VM instances that use Premium Storage disks.</span></span>

<span data-ttu-id="4606e-146">디스크 또는 VM이 일시적으로 사용할 수 없으므로 가동 중지로부터 응용 프로그램 워크로드를 보호하기 위해 고객은 [가용성 집합](../../virtual-machines/windows/manage-availability.md)을 활용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-146">To safeguard application workloads from downtime due to the temporary unavailability of a disk or VM, customers can leverage [Availability Sets](../../virtual-machines/windows/manage-availability.md).</span></span> <span data-ttu-id="4606e-147">가용성 집합에 있는 둘 이상의 가상 컴퓨터는 응용 프로그램에 대한 중복성을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-147">Two or more virtual machines in an availability set provides redundancy for the application.</span></span> <span data-ttu-id="4606e-148">그런 다음 Azure는 서로 다른 전원, 네트워크 및 서버 구성 요소를 사용하여 별도의 장애 도메인에 이러한 VM 및 디스크를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-148">Azure then creates these VMs and disks in separate fault domains with different power, network, and server components.</span></span> <span data-ttu-id="4606e-149">따라서 지역화된 하드웨어 오류는 일반적으로 집합에 있는 여러 VM에 동시에 영향을 주지 않으므로 응용 프로그램에 대한 고가용성을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-149">Thus, localized hardware failures typically do not affect multiple VMs in the set at the same time, providing high availability for your application.</span></span> <span data-ttu-id="4606e-150">고가용성이 필요한 경우에는 가용성 집합을 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-150">It is considered a good practice to use availability sets when high availability is required.</span></span> <span data-ttu-id="4606e-151">자세한 내용은 아래에서 설명하는 재해 복구 부분을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="4606e-151">For more information, see the Disaster Recovery aspects detailed below.</span></span>

### <a name="backup-and-disaster-recovery"></a><span data-ttu-id="4606e-152">백업 및 재해 복구</span><span class="sxs-lookup"><span data-stu-id="4606e-152">Backup and Disaster Recovery</span></span>

<span data-ttu-id="4606e-153">DR(재해 복구)은 드물지만 중요한 사고, 즉 전체 지역에 영향을 주는 서비스 중단과 같이 일시적이지 않은 대규모 장애로부터 복구할 수 있는 기능입니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-153">Disaster recovery (DR) is the ability to recover from rare but major incidents: non-transient, wide-scale failures, such as service disruption that affects an entire region.</span></span> <span data-ttu-id="4606e-154">재해 복구에는 데이터 백업 및 보관이 포함되며, 백업에서 데이터베이스를 복원하는 것과 같은 수동 작업이 포함될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-154">Disaster recovery includes data backup and archiving, and may include manual intervention, such as restoring a database from backup.</span></span>

<span data-ttu-id="4606e-155">Azure 플랫폼의 지역화된 오류에 대한 기본 제공 보호 기능은 대규모 중단 발생 시 VM/디스크를 완전히 보호하지 못할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-155">The Azure platform’s built-in protection against localized failures may not fully protect the VMs/disks in the case of major disasters which can cause large-scale outages.</span></span> <span data-ttu-id="4606e-156">여기에는 태풍, 지진, 화재 또는 대규모 하드웨어 유닛 오류로 인해 큰 피해를 입는 데이터 센터와 같이 심각한 이벤트가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-156">This includes catastrophic events such as a data center being hit by a hurricane, earthquake, fire, or large scale hardware unit failures.</span></span> <span data-ttu-id="4606e-157">또한 응용 프로그램 또는 데이터 문제로 인해 오류가 발생할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-157">In addition, you may encounter failures due to application or data issues.</span></span>

<span data-ttu-id="4606e-158">중단으로부터 IaaS 작업을 보호하려면 복구할 수 있도록 중복성과 백업을 계획해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-158">To help protect your IaaS workloads from outages, you should plan for redundancy and backups to enable recovery.</span></span> <span data-ttu-id="4606e-159">재해 복구의 경우 기본 사이트에서 떨어진 다른 지리적 위치에 중복성 및 백업을 계획해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-159">For disaster recovery, you should plan redundancy and backup in a different geographic location away from the primary site.</span></span> <span data-ttu-id="4606e-160">이렇게 하면 원래 VM이나 디스크에 영향을 미친 동일한 이벤트로 영향받지 않도록 백업을 보호할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-160">This helps ensure your backup is not affected by the same event that originally impacted the VM or disks.</span></span> <span data-ttu-id="4606e-161">자세한 내용은 [Azure에 구축된 응용 프로그램의 재해 복구](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="4606e-161">For more information, see [Disaster Recovery for Applications built on Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications).</span></span>

<span data-ttu-id="4606e-162">DR 고려 사항에는 다음과 같은 측면이 포함될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-162">Your DR considerations may include the following aspects:</span></span>

1. <span data-ttu-id="4606e-163">HA(고가용성): 응용 프로그램에서 상당한 가동 중지 없이 정상 상태로 계속 실행할 수 있는 기능입니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-163">High Availability (HA) is the ability of the application to continue running in a healthy state, without significant downtime.</span></span> <span data-ttu-id="4606e-164">"정상 상태"는 응용 프로그램에서 응답하고 사용자가 응용 프로그램에 연결하여 응용 프로그램과 상호 작용할 수 있음을 의미합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-164">By "healthy state," we mean the application is responsive, and users can connect to the application and interact with it.</span></span> <span data-ttu-id="4606e-165">특정 중요 업무용 응용 프로그램 및 데이터베이스는 플랫폼에 오류가 발생하더라도 항상 사용할 수 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-165">Certain mission-critical applications and databases may be required to be available always, even when there are failures in the platform.</span></span> <span data-ttu-id="4606e-166">이러한 작업의 경우 응용 프로그램과 데이터에 대한 중복성을 계획해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-166">For these workloads, you may need to plan redundancy for the application as well as the data.</span></span>

2. <span data-ttu-id="4606e-167">데이터 내구성: 어떤 경우에는 주요 고려 사항에서 재해 발생 시 데이터가 보존되도록 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-167">Data Durability: In some cases, the main consideration is ensuring the data is preserved in the case of a disaster.</span></span> <span data-ttu-id="4606e-168">따라서 다른 사이트에 데이터를 백업해야 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-168">Therefore, you may need a backup of your data in a different site.</span></span> <span data-ttu-id="4606e-169">이러한 작업의 경우 응용 프로그램에 대한 전체 중복성이 필요하지는 않지만 디스크를 정기적으로 백업해야 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-169">For such workloads, you may not need full redundancy for the application, but a regular backup of the disks.</span></span>

## <a name="backup-and-dr-scenarios"></a><span data-ttu-id="4606e-170">백업 및 DR 시나리오</span><span class="sxs-lookup"><span data-stu-id="4606e-170">Backup and DR Scenarios</span></span>

<span data-ttu-id="4606e-171">응용 프로그램 워크로드 시나리오의 몇 가지 일반적인 예와 재해 복구 계획에 대한 고려 사항을 살펴보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-171">Let’s look at a few typical examples of application workload scenarios and the considerations for planning Disaster Recovery.</span></span>

### <a name="scenario-1-major-database-solutions"></a><span data-ttu-id="4606e-172">시나리오 1: 주 데이터베이스 솔루션</span><span class="sxs-lookup"><span data-stu-id="4606e-172">Scenario 1: Major Database Solutions</span></span>

<span data-ttu-id="4606e-173">고가용성을 지원할 수 있는 SQL Server 또는 Oracle과 같은 프로덕션 데이터베이스 서버를 살펴보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-173">Consider a production database server like SQL Server or Oracle that can support High Availability.</span></span> <span data-ttu-id="4606e-174">이 데이터베이스는 중요한 프로덕션 응용 프로그램 및 사용자가 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-174">Critical production applications and users depend on this database.</span></span> <span data-ttu-id="4606e-175">이 시스템에 대한 재해 복구 계획에서 지원해야 하는 요구 사항은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-175">The Disaster Recovery plan for this system may need to support the following requirements:</span></span>

1. <span data-ttu-id="4606e-176">데이터는 보호되고 복구할 수 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-176">Data must be protected and recoverable.</span></span>
2.  <span data-ttu-id="4606e-177">서버를 사용할 수 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-177">Server must be available for use.</span></span>

<span data-ttu-id="4606e-178">이 경우 다른 지역에 있는 데이터베이스의 복제본을 백업으로 유지 관리해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-178">This may require maintaining a replica of the database in a different region as a backup.</span></span> <span data-ttu-id="4606e-179">서버 가용성 및 데이터 복구에 대한 요구 사항에 따라 솔루션은 액티브-액티브 또는 액티브-패시브 복제본 사이트에서 정기적인 오프라인 데이터 백업에 이르기까지 다양할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-179">Depending on the requirements for server availability and data recovery, the solution could range from an Active-Active or Active-Passive replica site to periodic offline backups of the data.</span></span> <span data-ttu-id="4606e-180">SQL Server 및 Oracle과 같은 관계형 데이터베이스는 다양한 복제 옵션을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-180">Relational databases such as SQL Server and Oracle provide various options for replication.</span></span> <span data-ttu-id="4606e-181">SQL Server의 경우 [SQL Server Always On 가용성 그룹](https://msdn.microsoft.com/library/hh510230.aspx)을 사용하여 고가용성을 보장할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-181">For SQL Server, [SQL Server Always On Availability Groups](https://msdn.microsoft.com/library/hh510230.aspx) can be used for high availability.</span></span>

<span data-ttu-id="4606e-182">MongoDB와 같은 NoSQL 데이터베이스는 중복성을 위한 [복제본](https://docs.mongodb.com/manual/replication/)도 지원하므로</span><span class="sxs-lookup"><span data-stu-id="4606e-182">NoSQL databases like MongoDB also support [replicas](https://docs.mongodb.com/manual/replication/) for redundancy.</span></span> <span data-ttu-id="4606e-183">고가용성을 위한 복제본을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-183">The replicas for high availability can be used.</span></span>

### <a name="scenario-2-a-cluster-of-redundant-vms"></a><span data-ttu-id="4606e-184">시나리오 2: 중복된 VM 클러스터</span><span class="sxs-lookup"><span data-stu-id="4606e-184">Scenario 2: A cluster of redundant VMs</span></span>

<span data-ttu-id="4606e-185">중복성 및 부하 분산을 제공하는 VM 클러스터에서 처리하는 작업을 살펴보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-185">Consider a workload handled by a cluster of VMs that provide redundancy and load balancing.</span></span> <span data-ttu-id="4606e-186">한 예로 한 지역에 배포된 Cassandra 클러스터가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-186">One example would be a Cassandra cluster deployed in a region.</span></span> <span data-ttu-id="4606e-187">이러한 유형의 아키텍처는 이미 해당 지역에서 높은 수준의 중복성을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-187">This type of architecture already provides a high level of redundancy within that region.</span></span> <span data-ttu-id="4606e-188">그러나 지역 수준에서 작업을 보호하려면 클러스터를 두 지역에 분산하거나 다른 지역에 정기적으로 백업하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-188">However, to protect the workload from a regional level failure, you should consider spreading the cluster across two regions or making periodic backups to another region.</span></span>

### <a name="scenario-3-iaas-application-workload"></a><span data-ttu-id="4606e-189">시나리오 3: IaaS 응용 프로그램 작업</span><span class="sxs-lookup"><span data-stu-id="4606e-189">Scenario 3: IaaS Application Workload</span></span>

<span data-ttu-id="4606e-190">이 작업은 Azure VM에서 실행되는 일반적인 프로덕션 작업일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-190">This could be a typical production workload running on an Azure VM.</span></span> <span data-ttu-id="4606e-191">예를 들어 사이트의 콘텐츠 및 다른 리소스를 보유하고 있는 웹 서버 또는 파일 서버일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-191">For example, it could be a web server or file server holding the content and other resources of a site.</span></span> <span data-ttu-id="4606e-192">또한 VM 디스크에 대한 데이터, 리소스 및 응용 프로그램 상태를 저장한 VM에서 실행되는 사용자가 지정하여 빌드된 비즈니스 응용 프로그램일 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-192">It could also be a custom-built business application running on a VM that stored its data, resources, and application state on the VM disks.</span></span> <span data-ttu-id="4606e-193">이 경우 백업을 정기적으로 수행하는지 확인해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-193">In this case, it is important to make sure you take backups on a regular basis.</span></span> <span data-ttu-id="4606e-194">백업 빈도는 VM 워크로드의 특성을 기준으로 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-194">Backup frequency should be based on the nature of the VM workload.</span></span> <span data-ttu-id="4606e-195">예를 들어 응용 프로그램이 매일 실행되고 데이터가 수정되는 경우 백업은 매 시간마다 수행되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-195">For example, if the application runs every day and modifies data, then the backup should be taken every hour.</span></span>

<span data-ttu-id="4606e-196">또 다른 예로 다른 원본의 데이터를 끌어와서 집계된 보고서를 생성하는 보고 서버가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-196">Another example is a reporting server that pull data from other sources and generates aggregated reports.</span></span> <span data-ttu-id="4606e-197">이 VM 또는 디스크를 손실하면 보고서가 손실될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-197">Loss of this VM or disks will lead to the loss of the reports.</span></span> <span data-ttu-id="4606e-198">그러나 보고 프로세스를 다시 실행하여 해당 출력을 다시 생성할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-198">However, it may be possible to rerun the reporting process and regenerate the output.</span></span> <span data-ttu-id="4606e-199">이 경우 보고 서버에 재해가 발생하더라도 실제로 데이터가 손실되지 않으므로 보고 서버에서 데이터의 일부가 손실될 수 있는 더 높은 수준의 허용 오차를 적용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-199">In that case, you don’t really have a loss of data even if the reporting server is hit with a disaster, so you could have a higher level of tolerance for losing part of the data on the reporting server.</span></span> <span data-ttu-id="4606e-200">그리고 백업 빈도를 줄이면 비용을 절감할 수 있는 옵션이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-200">In that case, less frequent backups is an option to reduce the cost.</span></span>

### <a name="scenario-4-iaas-application-data-issues"></a><span data-ttu-id="4606e-201">시나리오 4: IaaS 응용 프로그램 데이터 문제</span><span class="sxs-lookup"><span data-stu-id="4606e-201">Scenario 4: IaaS Application data issues</span></span>

<span data-ttu-id="4606e-202">가격 정보와 같이 중요한 상용 데이터를 계산, 유지 관리 및 제공하는 응용 프로그램이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-202">You have an application that computes, maintains, and serves critical commercial data such as pricing information.</span></span> <span data-ttu-id="4606e-203">새 버전의 응용 프로그램에는 가격을 잘못 계산하고 플랫폼에서 제공하는 기존 상거래 데이터가 손상되는 소프트웨어 버그가 있었습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-203">A new version of your application had a software bug which incorrectly computed the pricing and corrupted the existing commerce data served by the platform.</span></span> <span data-ttu-id="4606e-204">여기서 가장 좋은 해결 방법은 먼저 이전 버전의 응용 프로그램과 데이터로 되돌리는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-204">Here, the best course of action would be to revert to the earlier version of the application and the data first.</span></span> <span data-ttu-id="4606e-205">이렇게 하려면 시스템을 정기적으로 백업해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-205">To enable this, take periodic backups of your system.</span></span>

## <a name="disaster-recovery-solution-azure-backup-service"></a><span data-ttu-id="4606e-206">재해 복구 솔루션: Azure Backup 서비스</span><span class="sxs-lookup"><span data-stu-id="4606e-206">Disaster Recovery Solution: Azure Backup Service</span></span>

<span data-ttu-id="4606e-207">[Azure Backup 서비스](https://azure.microsoft.com/services/backup/)는 백업 및 DR에 사용할 수 있으며, [Managed Disks](../../virtual-machines/windows/managed-disks-overview.md) 및 [Unmanaged Disks](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks)와 함께 작동합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-207">[Azure Backup Service](https://azure.microsoft.com/services/backup/) is can be used for Backup and DR, and it works with [Managed Disks](../../virtual-machines/windows/managed-disks-overview.md) as well as [Unmanaged Disks](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks).</span></span> <span data-ttu-id="4606e-208">시간 기반 백업, 손쉬운 VM 복원 및 백업 보존 정책을 사용하여 백업 작업을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-208">You can create a backup job with time-based backups, easy VM restoration and backup retention policies.</span></span> 

<span data-ttu-id="4606e-209">[Premium Storage 디스크](storage-premium-storage.md), [Managed Disks](../../virtual-machines/windows/managed-disks-overview.md) 또는 [LRS(로컬 중복 저장소)](storage-redundancy.md#locally-redundant-storage) 옵션이 있는 다른 디스크 유형을 사용하는 경우 정기적인 DR 백업을 활용하는 것이 특히 중요합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-209">If you use [Premium Storage disks](storage-premium-storage.md), [Managed Disks](../../virtual-machines/windows/managed-disks-overview.md), or other disk types with the [locally redundant storage (LRS)](storage-redundancy.md#locally-redundant-storage) option, it is especially important to leverage periodic DR backups.</span></span> <span data-ttu-id="4606e-210">Azure Backup은 장기 보존을 위해 Recovery Services 자격 증명 모음에 데이터를 저장합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-210">Azure Backup stores the data in your Recovery Services vault for long term retention.</span></span> <span data-ttu-id="4606e-211">Backup Recovery Services 자격 증명 모음에 대해 [GRS(지역 중복 저장소)](storage-redundancy.md#geo-redundant-storage) 옵션을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-211">Choose the [Geo-redundant storage (GRS)](storage-redundancy.md#geo-redundant-storage) option for the Backup Recovery Services vault.</span></span> <span data-ttu-id="4606e-212">이렇게 하면 지역 재해로부터 보호하기 위해 백업을 다른 Azure 지역으로 복제할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-212">That will ensure backups are replicated to a different Azure region for safeguarding from regional disasters.</span></span>

<span data-ttu-id="4606e-213">[Unmanaged Disks](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks)의 경우 IaaS 디스크에 대해 LRS 저장소 유형을 사용할 수 있지만, Azure Backup이 Recovery Services 자격 증명 모음에 대한 GRS 옵션으로 사용하도록 설정되어 있는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-213">For [Unmanaged Disks](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks), you can use the LRS storage type for IaaS disks, but ensure that Azure Backup is enabled with the GRS option for the Recovery Services Vault.</span></span>

<span data-ttu-id="4606e-214">**Unmanaged Disks에 대해 [GRS](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) 옵션을 사용하는 경우 백업 및 DR에 대해 일관성 있는 스냅숏도 필요합니다.**</span><span class="sxs-lookup"><span data-stu-id="4606e-214">**If you use the [GRS](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) option for your Unmanaged Disks, you still need consistent snapshots for Backup and DR.**</span></span> <span data-ttu-id="4606e-215">[Azure Backup 서비스](https://azure.microsoft.com/services/backup/) 또는 [일관성 있는 스냅숏](#alternative-solution-consistent-snapshots) 중 하나를 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-215">You must use either [Azure Backup Service](https://azure.microsoft.com/services/backup/) or [consistent snapshots](#alternative-solution-consistent-snapshots).</span></span>

<span data-ttu-id="4606e-216">다음은 DR 솔루션에 대한 요약입니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-216">The following is a summary of solutions for DR.</span></span>

| <span data-ttu-id="4606e-217">시나리오</span><span class="sxs-lookup"><span data-stu-id="4606e-217">Scenario</span></span> | <span data-ttu-id="4606e-218">자동 복제</span><span class="sxs-lookup"><span data-stu-id="4606e-218">Automatic Replication</span></span> | <span data-ttu-id="4606e-219">DR 솔루션</span><span class="sxs-lookup"><span data-stu-id="4606e-219">DR Solution</span></span> |
| --- | --- | --- |
| <span data-ttu-id="4606e-220">*Premium Storage 디스크*</span><span class="sxs-lookup"><span data-stu-id="4606e-220">*Premium Storage Disks*</span></span> | <span data-ttu-id="4606e-221">로컬([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="4606e-221">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="4606e-222">Azure 백업</span><span class="sxs-lookup"><span data-stu-id="4606e-222">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="4606e-223">*Managed Disks*</span><span class="sxs-lookup"><span data-stu-id="4606e-223">*Managed Disks*</span></span> | <span data-ttu-id="4606e-224">로컬([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="4606e-224">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="4606e-225">Azure 백업</span><span class="sxs-lookup"><span data-stu-id="4606e-225">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="4606e-226">*Unmanaged LRS Disks*</span><span class="sxs-lookup"><span data-stu-id="4606e-226">*Unmanaged LRS Disks*</span></span> | <span data-ttu-id="4606e-227">로컬([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="4606e-227">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="4606e-228">Azure 백업</span><span class="sxs-lookup"><span data-stu-id="4606e-228">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="4606e-229">*Unmanaged GRS Disks*</span><span class="sxs-lookup"><span data-stu-id="4606e-229">*Unmanaged GRS Disks*</span></span> | <span data-ttu-id="4606e-230">지역 간([GRS](storage-redundancy.md#geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="4606e-230">Cross region ([GRS](storage-redundancy.md#geo-redundant-storage))</span></span> | [<span data-ttu-id="4606e-231">Azure 백업</span><span class="sxs-lookup"><span data-stu-id="4606e-231">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="4606e-232">일관성 있는 스냅숏</span><span class="sxs-lookup"><span data-stu-id="4606e-232">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |
| <span data-ttu-id="4606e-233">*Unmanaged RA-GRS Disks*</span><span class="sxs-lookup"><span data-stu-id="4606e-233">*Unmanaged RA-GRS Disks*</span></span> | <span data-ttu-id="4606e-234">지역 간([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="4606e-234">Cross region ([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span></span> | [<span data-ttu-id="4606e-235">Azure 백업</span><span class="sxs-lookup"><span data-stu-id="4606e-235">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="4606e-236">일관성 있는 스냅숏</span><span class="sxs-lookup"><span data-stu-id="4606e-236">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |

<span data-ttu-id="4606e-237">고가용성은 Azure Backup과 함께 가용성 집합에서 Managed Disks를 사용할 때 가장 효과적일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-237">High availability can best by met through the use of Managed Disks in an Availability Set along with Azure Backup.</span></span> <span data-ttu-id="4606e-238">Unmanaged Disks를 사용하는 경우에도 DR을 위해 Azure Backup을 계속 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-238">If you are using Unmanaged Disks, you can still  use Azure Backup for DR.</span></span> <span data-ttu-id="4606e-239">Azure Backup을 사용할 수 없는 경우 백업 및 DR을 위한 대안 솔루션은 이후의 섹션에서 설명하는 [일관성 있는 스냅숏](#alternative-solution-consistent-snapshots)을 사용하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-239">If you are unable to use Azure Backup, then taking [consistent snapshots](#alternative-solution-consistent-snapshots) as described in a later section is an alternative solution for Backup and DR.</span></span>

<span data-ttu-id="4606e-240">응용 프로그램 또는 인프라 수준에서 고가용성, 백업 및 DR을 선택하는 경우 다음과 같이 나타낼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-240">Your choices for high availability, backup and DR at Application or Infrastructure levels can be represented as below:</span></span>

| <span data-ttu-id="4606e-241">*Level*</span><span class="sxs-lookup"><span data-stu-id="4606e-241">*Level*</span></span> | <span data-ttu-id="4606e-242">고가용성</span><span class="sxs-lookup"><span data-stu-id="4606e-242">High Availability</span></span>   | <span data-ttu-id="4606e-243">백업/DR</span><span class="sxs-lookup"><span data-stu-id="4606e-243">Backup / DR</span></span> |
| --- | --- | --- |
| <span data-ttu-id="4606e-244">*응용 프로그램*</span><span class="sxs-lookup"><span data-stu-id="4606e-244">*Application*</span></span> | <span data-ttu-id="4606e-245">SQL Always On</span><span class="sxs-lookup"><span data-stu-id="4606e-245">SQL Always On</span></span> | <span data-ttu-id="4606e-246">Azure 백업</span><span class="sxs-lookup"><span data-stu-id="4606e-246">Azure Backup</span></span> |
| <span data-ttu-id="4606e-247">*인프라*</span><span class="sxs-lookup"><span data-stu-id="4606e-247">*Infrastructure*</span></span>  | <span data-ttu-id="4606e-248">가용성 집합</span><span class="sxs-lookup"><span data-stu-id="4606e-248">Availability Set</span></span>  | <span data-ttu-id="4606e-249">일관성 있는 스냅숏이 포함된 GRS</span><span class="sxs-lookup"><span data-stu-id="4606e-249">GRS with consistent snapshots</span></span> |

### <a name="using-the-azure-backup-service"></a><span data-ttu-id="4606e-250">Azure Backup 서비스 사용</span><span class="sxs-lookup"><span data-stu-id="4606e-250">Using the Azure Backup Service</span></span>

<span data-ttu-id="4606e-251">[Azure Backup](../../backup/backup-azure-vms-introduction.md)은 Windows 또는 Linux를 실행 중인 VM을 Azure Recovery Services 자격 증명 모음으로 백업할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-251">[Azure Backup](../../backup/backup-azure-vms-introduction.md) can backup your VMs running Windows or Linux to the Azure Recovery Services Vault.</span></span> <span data-ttu-id="4606e-252">데이터를 생성하는 응용 프로그램이 실행되는 동안 중요 업무용 데이터를 백업해야 하므로 이러한 데이터를 백업하고 복원하는 것은 복잡합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-252">Backing up and restoring business-critical data is complicated by the fact that business-critical data must be backed up while the applications that produce the data are running.</span></span> <span data-ttu-id="4606e-253">이 문제를 해결하기 위해 Azure Backup에서는 VSS(Volume Shadow Service)를 사용하여 Microsoft 워크로드에 대해 응용 프로그램 일치 백업을 제공함으로써 데이터가 저장소에 올바르게 기록되도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-253">To address this, Azure Backup provides application-consistent backups for Microsoft workloads by using the Volume Shadow Service (VSS) to ensure that data is written correctly to storage.</span></span> <span data-ttu-id="4606e-254">Linux VM의 경우 VSS에 해당하는 기능이 Linux에 없기 때문에 파일 일치 백업만 가능합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-254">For Linux VMs, only file-consistent backups are possible, since Linux does not have functionality equivalent to VSS.</span></span>

![](./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-1.png)   

<span data-ttu-id="4606e-255">Azure Backup은 예약된 시간에 백업 작업을 시작할 때 VM에 설치된 백업 확장을 트리거하여 특정 시점의 스냅숏을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-255">When Azure Backup initiates a backup job at the scheduled time, it triggers the backup extension installed in the VM to take a point-in-time snapshot.</span></span> <span data-ttu-id="4606e-256">스냅숏은 VSS와 조정되어 가상 컴퓨터를 종료하지 않고도 가상 컴퓨터의 디스크에 대한 일관성 있는 스냅숏을 얻을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-256">A snapshot is taken in coordination with VSS to get a consistent snapshot of the disks in the virtual machine without having to shut it down.</span></span> <span data-ttu-id="4606e-257">VM의 백업 확장은 모든 디스크에 대한 일관성 있는 스냅숏을 만들기 전에 모든 쓰기를 플러시합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-257">The backup extension in the VM flushes all writes before taking the consistent snapshot of all the disks.</span></span> <span data-ttu-id="4606e-258">스냅숏을 만든 후에는 Azure Backup에서 백업 자격 증명 모음으로 데이터를 전송합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-258">After the snapshot is taken, the data is transferred by Azure Backup to the backup vault.</span></span> <span data-ttu-id="4606e-259">백업 프로세스의 효율성을 높이기 위해 Azure 백업 서비스는 마지막 백업 이후에 변경된 데이터 블록만 식별하여 전송합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-259">To make the backup process more efficient, the service identifies and transfers only the blocks of data that have changed since the last backup.</span></span>


<span data-ttu-id="4606e-260">복원하려면 Azure Backup을 통해 사용할 수 있는 백업을 확인한 다음 복원을 시작할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-260">To restore, you can view the available backups through Azure Backup and then initiate a restore.</span></span> <span data-ttu-id="4606e-261">[Azure Portal](https://portal.azure.com/), [PowerShell](../../backup/backup-azure-vms-automation.md ) 또는 [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install)를 사용하여 Azure 백업을 만들고 복원할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-261">You can create and restore Azure backups through the [Azure portal](https://portal.azure.com/), [using PowerShell](../../backup/backup-azure-vms-automation.md ), or using the [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install).</span></span> <span data-ttu-id="4606e-262">자세한 내용은 Azure Backup을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="4606e-262">For more information, see Azure Backup.</span></span>

### <a name="steps-to-enable-backup"></a><span data-ttu-id="4606e-263">백업을 사용하도록 설정하는 단계</span><span class="sxs-lookup"><span data-stu-id="4606e-263">Steps to Enable Backup</span></span>

<span data-ttu-id="4606e-264">다음 단계는 일반적으로 [Azure Portal](https://portal.azure.com/)을 사용하여 VM의 백업을 사용하도록 설정하는 데 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-264">The following steps are typically used to enable backups of your VMs using the [Azure Portal](https://portal.azure.com/).</span></span> <span data-ttu-id="4606e-265">정확한 시나리오에 따라 약간 변형될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-265">There will be some variations depending on your exact scenario.</span></span> <span data-ttu-id="4606e-266">자세한 내용은 [Azure Backup](../../backup/backup-azure-vms-introduction.md) 설명서를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="4606e-266">Refer to the [Azure Backup](../../backup/backup-azure-vms-introduction.md) documentation for full details.</span></span> <span data-ttu-id="4606e-267">또한 Azure Backup은 [Managed Disks가 있는 VM도 지원합니다](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span><span class="sxs-lookup"><span data-stu-id="4606e-267">Azure Backup also [supports VMs with Managed Disks](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span></span>

1.  <span data-ttu-id="4606e-268">다음 단계에 따라 VM에 대한 복구 서비스 자격 증명 모음을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-268">Create a recovery services vault for a VM using the following steps:</span></span>

    <span data-ttu-id="4606e-269">a.</span><span class="sxs-lookup"><span data-stu-id="4606e-269">a.</span></span>  <span data-ttu-id="4606e-270">[Azure Portal](https://portal.azure.com/)을 사용하여 모든 리소스를 찾아보고 "Recovery Services 자격 증명 모음"을 찾습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-270">Using the [Azure portal](https://portal.azure.com/), browse all resources and find “Recovery Services vaults”.</span></span>

    <span data-ttu-id="4606e-271">b.</span><span class="sxs-lookup"><span data-stu-id="4606e-271">b.</span></span>  <span data-ttu-id="4606e-272">Recovery Services 자격 증명 모음 메뉴에서 [추가]를 클릭하고, 단계에 따라 VM과 동일한 지역에 새 자격 증명 모음을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-272">On the Recovery Services vaults menu, click Add and follow the steps to create a new vault in the same region as the VM.</span></span> <span data-ttu-id="4606e-273">예를 들어 자신의 VM이 미국 서부 지역에 있으면 미국 서부를 선택하여 자격 증명 모음을 찾습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-273">For example, if your VM is in West US region, pick West US for the vault.</span></span>

2.  <span data-ttu-id="4606e-274">새로 만든 자격 증명 모음에 대한 저장소 복제를 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-274">Verify the Storage replication for the newly created vault.</span></span> <span data-ttu-id="4606e-275">이렇게 하려면 Recovery Services 자격 증명 모음 블레이드에서 자격 증명 모음에 액세스하고 [설정/백업 구성]으로 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-275">To do this, access the vault from the Recovery Services vaults blade and go to the settings/Backup Configuration.</span></span> <span data-ttu-id="4606e-276">기본적으로 GRS 옵션이 선택되어 있는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-276">Ensure the GRS option is selected by default.</span></span> <span data-ttu-id="4606e-277">이렇게 하면 자격 증명 모음이 보조 데이터 센터에 자동으로 복제됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-277">This will ensure that your vault is automatically replicated to a secondary data center.</span></span> <span data-ttu-id="4606e-278">예를 들어 미국 서부의 자격 증명 모음이 미국 동부에 자동으로 복제됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-278">For example, your vault in West US will be automatically replicated to East US.</span></span>

3.  <span data-ttu-id="4606e-279">백업 정책을 구성하고 동일한 UI에서 VM을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-279">Configure the backup policy and select the VM from the same UI.</span></span>

4.  <span data-ttu-id="4606e-280">백업 에이전트가 VM에 설치되어 있는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-280">Make sure the Backup Agent is installed on the VM.</span></span> <span data-ttu-id="4606e-281">Azure 갤러리 이미지를 사용하여 VM을 만든 경우 백업 에이전트가 이미 설치되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-281">If your VM is created using an Azure gallery image, then the Backup agent is already installed.</span></span> <span data-ttu-id="4606e-282">그렇지 않은 경우(즉, 사용자 지정 이미지를 사용하는 경우) [가상 컴퓨터에 VM 에이전트 설치](../../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine)에 대한 지침을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-282">Otherwise (that is, if you are using a custom image), use instructions to [Install the VM Agent on the virtual machine](../../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span></span>

5.  <span data-ttu-id="4606e-283">VM에서 백업 서비스가 작동할 수 있도록 네트워크 연결을 허용하는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-283">Make sure that the VM allows network connectivity for the backup service to function.</span></span> <span data-ttu-id="4606e-284">[네트워크 연결](../../backup/backup-azure-arm-vms-prepare.md#network-connectivity)을 위한 지침을 따릅니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-284">Follow these instructions for [Network connectivity](../../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span></span>

6.  <span data-ttu-id="4606e-285">위의 단계가 완료되면 백업 정책에서 지정한 대로 백업이 정기적으로 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-285">Once the above steps are completed, the backup will run at regular intervals as specified in the backup policy.</span></span> <span data-ttu-id="4606e-286">필요한 경우 Azure Portal의 자격 증명 모음 대시보드에서 첫 번째 백업을 수동으로 트리거할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-286">If necessary, you can trigger the first backup manually from the vault dashboard on the Azure portal.</span></span>

<span data-ttu-id="4606e-287">스크립트를 사용하여 Azure Backup을 자동화하려면 [VM 백업용 PowerShell cmdlet](../../backup/backup-azure-vms-automation.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="4606e-287">For automating Azure Backup using scripts, please refer to [PowerShell cmdlets for VM backup](../../backup/backup-azure-vms-automation.md).</span></span>

### <a name="steps-for-recovery"></a><span data-ttu-id="4606e-288">복구 단계</span><span class="sxs-lookup"><span data-stu-id="4606e-288">Steps for Recovery</span></span>

<span data-ttu-id="4606e-289">VM을 복구하거나 다시 작성해야 하는 경우 자격 증명 모음의 백업 복구 지점 중 하나에서 해당 VM을 복원할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-289">If you need to repair or rebuild a VM, you can restore the VM from any of the backup recovery points in the vault.</span></span> <span data-ttu-id="4606e-290">복구하기 위한 몇 가지 다른 옵션은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-290">There are a couple of different options for performing the recovery:</span></span>

1.  <span data-ttu-id="4606e-291">백업된 VM의 특정 시점 표현으로 새 VM을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-291">You can create a new VM as a point-in-time representation of your backed-up VM.</span></span>

2.  <span data-ttu-id="4606e-292">디스크를 복원한 다음 VM에 대한 템플릿을 사용하여 복원된 VM을 사용자 지정하고 다시 작성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-292">You can restore the disks and then use the template for the VM to customize and rebuild the restored VM.</span></span> 

<span data-ttu-id="4606e-293">[Azure Portal을 사용하여 가상 컴퓨터 복원](../../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster)에 대한 지침을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="4606e-293">See instructions to [Use Azure portal to restore virtual machines](../../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span></span> <span data-ttu-id="4606e-294">또한 이 문서는 기본 데이터 센터에서 재해가 발생한 경우 지역 중복 백업 자격 증명 모음을 사용하여 쌍으로 연결된 데이터 센터에 백업된 VM을 복원하는 특정 단계에 대해 설명하고 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-294">The document also explains the specific steps for restoring backed-up VMs to the paired data center using your geo-redundant backup vault in the case of a disaster at the primary data center.</span></span> <span data-ttu-id="4606e-295">이 경우 Azure Backup은 보조 지역의 Compute 서비스를 사용하여 복원된 가상 컴퓨터를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-295">In that case, Azure Backup uses the Compute service from the secondary region to create the restored virtual machine.</span></span>

<span data-ttu-id="4606e-296">또한 PowerShell을 사용하여 [VM을 복원](../../backup/backup-azure-vms-automation.md#restore-an-azure-vm)하거나 [복원된 디스크에서 새 VM을 만들](../../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks) 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-296">You can also use PowerShell for [restoring a VM](../../backup/backup-azure-vms-automation.md#restore-an-azure-vm) or for [creating a new VM from restored disks](../../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span></span>

## <a name="alternative-solution-consistent-snapshots"></a><span data-ttu-id="4606e-297">대체 솔루션: 일관성 있는 스냅숏</span><span class="sxs-lookup"><span data-stu-id="4606e-297">Alternative Solution: Consistent Snapshots</span></span>

<span data-ttu-id="4606e-298">Azure Backup 서비스를 사용할 수 없는 경우 스냅숏을 사용하여 사용자 고유의 백업 메커니즘을 구현할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-298">If you are unable to use the Azure Backup Service, you can implement your own backup mechanism using snapshots.</span></span> <span data-ttu-id="4606e-299">VM에서 사용하는 모든 디스크에 대해 일관성 있는 스냅숏을 만든 다음 다른 지역에 해당 스냅숏을 복제하는 것은 복잡합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-299">It is complicated to create consistent snapshots for all disks used by a VM and then replicate those snapshots to another region.</span></span> <span data-ttu-id="4606e-300">이러한 이유로 Azure는 사용자 지정 솔루션을 빌드하는 것보다 Backup 서비스를 활용하는 것이 더 나은 선택이라고 인식합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-300">For this reason, Azure considers leveraging the Backup Service a better option than building a custom solution.</span></span> <span data-ttu-id="4606e-301">디스크에 RA-GRS/GRS 저장소를 사용하는 경우 스냅숏이 보조 데이터 센터에 자동으로 복제됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-301">If you use RA-GRS/GRS storage for disks, snapshots are automatically replicated to a secondary data center.</span></span> <span data-ttu-id="4606e-302">디스크에 LRS 저장소를 사용하는 경우 데이터를 직접 복제해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-302">If you use LRS storage for disks, you will need to replicate the data yourself.</span></span> <span data-ttu-id="4606e-303">자세한 내용은 [증분 스냅숏을 사용하여 Azure 관리되지 않는 VM 디스크 백업](../../virtual-machines/windows/incremental-snapshots.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="4606e-303">For more information, see [Back up Azure unmanaged VM disks with incremental snapshots](../../virtual-machines/windows/incremental-snapshots.md).</span></span>

<span data-ttu-id="4606e-304">스냅숏은 특정 시점의 개체 표현입니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-304">A snapshot is a representation of an object at a specific point in time.</span></span> <span data-ttu-id="4606e-305">스냅숏은 저장된 데이터의 증분 크기에 대한 대금 청구를 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-305">A snapshot will incur billing for the incremental size of the data it holds.</span></span> <span data-ttu-id="4606e-306">자세한 내용은 [Blob 스냅숏 만들기](../blobs/storage-blob-snapshots.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="4606e-306">For more information, see [Create a blob snapshot](../blobs/storage-blob-snapshots.md).</span></span>

### <a name="creating-snapshots-while-the-vm-is-running"></a><span data-ttu-id="4606e-307">VM이 실행되는 동안 스냅숏 만들기</span><span class="sxs-lookup"><span data-stu-id="4606e-307">Creating snapshots while the VM is running</span></span>

<span data-ttu-id="4606e-308">스냅숏은 언제든지 가져올 수 있지만, VM이 실행 중이면 데이터가 디스크로 여전히 스트리밍되고 진행 중에 있던 일부 작업이 스냅숏에 포함될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-308">While you can take a snapshot at any time, if the VM is running, there is still data being streamed to the disks, and the snapshots may contain partial operations that were in flight.</span></span> <span data-ttu-id="4606e-309">또한 관련된 디스크가 여러 개 있는 경우 서로 다른 디스크의 스냅숏이 서로 다른 시간에 발생했을 수 있으므로 이러한 스냅숏은 조정되지 않을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-309">Also, if there are several disks involved, the snapshots of different disks may have occurred at different times, which means these snapshots may not be coordinated.</span></span> <span data-ttu-id="4606e-310">특히 백업 중에 변경되면 파일이 손상될 수 있는 스트라이프 볼륨의 경우 문제가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-310">This is especially problematic for striped volumes whose files can be corrupted if changes were being made during backup.</span></span>

<span data-ttu-id="4606e-311">이러한 상황을 방지하려면 백업 프로세스에서 다음 단계를 구현해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-311">To avoid this situation, the backup process must implement the following steps:</span></span>

1.  <span data-ttu-id="4606e-312">모든 디스크를 고정합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-312">Freeze all the disks</span></span>

2.  <span data-ttu-id="4606e-313">보류 중인 모든 쓰기를 플러시합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-313">Flush all the pending writes</span></span>

3.  <span data-ttu-id="4606e-314">그런 다음 모든 디스크에 대해 [Blob 스냅숏을 만듭니다](../blobs/storage-blob-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="4606e-314">Then, [create a blob snapshot](../blobs/storage-blob-snapshots.md) for all the disks</span></span>

<span data-ttu-id="4606e-315">SQL Server와 같은 일부 Windows 응용 프로그램에서는 VSS를 통해 조정된 백업 메커니즘을 제공하여 응용 프로그램 일치 백업을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-315">Some Windows applications like SQL Server provide a coordinated backup mechanism via VSS to create application-consistent backups.</span></span> <span data-ttu-id="4606e-316">Linux에서는 fsfreeze와 같은 도구를 사용하여 디스크를 조정할 수 있습니다. 이 도구는 파일 일치 백업을 제공하지만, 응용 프로그램 일치 스냅숏은 제공하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-316">On Linux, you can use a tool like fsfreeze for coordinating the disks, which will provide file-consistent backups, but not application-consistent snapshots.</span></span> <span data-ttu-id="4606e-317">이 프로세스는 복잡하므로 [Azure Backup](../../backup/backup-azure-vms-introduction.md) 또는 이미 이를 구현한 타사 백업 솔루션을 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-317">This process is complicated, so and you should consider using [Azure Backup](../../backup/backup-azure-vms-introduction.md) or a third-party backup solution which already implement this.</span></span>

<span data-ttu-id="4606e-318">위 프로세스를 수행하면 VM의 특정 시점 보기를 나타내는 모든 VM 디스크에 대해 조정된 스냅숏 모음이 만들어집니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-318">The above process will result in a collection of coordinated snapshots for all the VM disks, representing a specific point-in-time view of the VM.</span></span> <span data-ttu-id="4606e-319">이 시점은 VM에 대한 백업 복원 지점입니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-319">This is a backup restore point for the VM.</span></span> <span data-ttu-id="4606e-320">예약된 간격으로 프로세스를 반복하여 정기적으로 백업을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-320">You can repeat the process at scheduled intervals to create periodic backups.</span></span> <span data-ttu-id="4606e-321">DR에 대한 [백업을 다른 지역에 복사](#copy-the-snapshots-to-another-region)하는 단계는 아래를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="4606e-321">See below for the steps to [copy the backups to another region](#copy-the-snapshots-to-another-region) for DR.</span></span>

### <a name="creating-snapshots-while-the-vm-is-offline"></a><span data-ttu-id="4606e-322">VM이 오프라인일 때 스냅숏 만들기</span><span class="sxs-lookup"><span data-stu-id="4606e-322">Creating snapshots while the VM is offline</span></span>

<span data-ttu-id="4606e-323">일관성 있는 백업을 만드는 또 다른 옵션은 VM을 종료하고 각 디스크의 Blob 스냅숏을 만드는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-323">Another option to create consistent backups is shutting down the VM and taking blob snapshots of each disk.</span></span> <span data-ttu-id="4606e-324">이렇게 하면 실행 중인 VM의 스냅숏을 조정하는 것보다 쉽지만 몇 분 정도의 가동 중지 시간이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-324">This is easier than coordinating snapshots of a running VM, but it requires a few minutes of downtime.</span></span> <span data-ttu-id="4606e-325">이 프로세스의 경우 다음 단계를 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-325">For this process, follow these steps:</span></span>

1. <span data-ttu-id="4606e-326">VM을 종료합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-326">Shut down the VM.</span></span>

2. <span data-ttu-id="4606e-327">몇 초 안에 각 VHD Blob의 스냅숏을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-327">Create a snapshot of each VHD blob, which only takes a few seconds.</span></span>

    <span data-ttu-id="4606e-328">스냅숏을 만들려면 [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), [Azure Storage Rest API](https://msdn.microsoft.com/library/azure/ee691971.aspx), [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install) 또는 [.NET용 저장소 클라이언트 라이브러리](https://msdn.microsoft.com/library/azure/hh488361.aspx)와 같은 Azure Storage 클라이언트 라이브러리 중 하나를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-328">To create a snapshot, you can use [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), the [Azure Storage Rest API](https://msdn.microsoft.com/library/azure/ee691971.aspx), [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install), or one of the Azure Storage Client Libraries such as [the Storage client library for .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span></span>

3. <span data-ttu-id="4606e-329">가동 중지 시간이 종료된 VM을 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-329">Start the VM, which ends the downtime.</span></span> <span data-ttu-id="4606e-330">일반적으로 전체 프로세스는 몇 분 안에 완료됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-330">Typically the entire process completes within a few minutes.</span></span>

<span data-ttu-id="4606e-331">이 프로세스에서는 모든 디스크에 대해 일관성 있는 스냅숏 모음을 만들어 VM에 대한 백업 복원 지점을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-331">This process yields a collection of consistent snapshots for all the disks, providing a backup restore point for the VM.</span></span> <span data-ttu-id="4606e-332">DR에 대한 스냅숏을 다른 지역에 복사하는 단계는 아래를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="4606e-332">See below for the steps to copy the snapshots to another region for DR.</span></span>

### <a name="copy-the-snapshots-to-another-region"></a><span data-ttu-id="4606e-333">스냅숏을 다른 지역에 복사</span><span class="sxs-lookup"><span data-stu-id="4606e-333">Copy the snapshots to another region</span></span>

<span data-ttu-id="4606e-334">스냅숏을 만드는 데 DR만으로 충분하지 않을 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-334">Creation of the snapshots alone may not be sufficient for DR.</span></span> <span data-ttu-id="4606e-335">또한 스냅숏 백업을 다른 지역에 복제해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-335">You must also replicate the snapshot backups to another region.</span></span>

<span data-ttu-id="4606e-336">디스크에 GRS 또는 RA-GRS를 사용하는 경우 스냅숏은 보조 지역에 자동으로 복제됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-336">If you are using GRS or RA-GRS for your disks, then the snapshots are replicated to the secondary region automatically.</span></span> <span data-ttu-id="4606e-337">복제하기 전에 몇 분 정도 지연될 수 있으며, 스냅숏 복제를 완료하기 전에 기본 데이터 센터가 작동 중단되면 보조 데이터 센터에서 스냅숏에 액세스할 수 없게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-337">There can be a few minutes of lag before the replication, and if the primary data center goes down before the snapshots finish replicating, you will not be able to access the snapshots from the secondary data center.</span></span> <span data-ttu-id="4606e-338">이 경우는 거의 발생하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-338">The likelihood of this is small.</span></span>

> [!Note] 
> <span data-ttu-id="4606e-339">GRS 또는 RA-GRS 계정에만 디스크가 있는 경우 VM이 재해로부터 보호되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-339">Only having the disks in a GRS or RA-GRS account does not protect the VM from disasters.</span></span> <span data-ttu-id="4606e-340">또한 조정된 스냅숏을 만들거나 Azure Backup을 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-340">You must also create coordinated snapshots or use Azure Backup.</span></span> <span data-ttu-id="4606e-341">이는 VM을 일관성 있는 상태로 복구하는 데 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-341">This is required to recover a VM to a consistent state.</span></span>

<span data-ttu-id="4606e-342">LRS를 사용하는 경우 스냅숏을 만든 직후 다른 저장소 계정에 해당 스냅숏을 복사해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-342">If you are using LRS, you must copy the snapshots to a different storage account immediately after creating the snapshot.</span></span> <span data-ttu-id="4606e-343">복사 대상은 다른 지역에 있는 LRS 저장소 계정일 수 있으므로 복사본이 원격 지역에 있게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-343">The copy target could be an LRS storage account in a different region, resulting in the copy being in a remote region.</span></span> <span data-ttu-id="4606e-344">동일한 지역의 RA-GRS 저장소 계정에 스냅숏을 복사할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-344">You can also copy the snapshot to an RA-GRS storage account in the same region.</span></span> <span data-ttu-id="4606e-345">이 경우 스냅숏은 원격 보조 지역에 지연 복제됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-345">In this case, the snapshot will be lazily replicated to the remote secondary region.</span></span> <span data-ttu-id="4606e-346">복사 및 복제가 완료되면 기본 사이트의 재해로부터 백업이 보호됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-346">Your backup is protected from disasters at the primary site once the copying and replication is complete.</span></span>

<span data-ttu-id="4606e-347">DR에 대한 증분 스냅숏을 효율적으로 복사하려면 [증분 스냅숏을 사용하여 관리되지 않는 VM 디스크 백업](../../virtual-machines/windows/incremental-snapshots.md)에 있는 지침을 검토하세요.</span><span class="sxs-lookup"><span data-stu-id="4606e-347">To copy your incremental snapshots for DR efficiently, review the instructions in [Back up Azure unmanaged VM disks with incremental snapshots](../../virtual-machines/windows/incremental-snapshots.md).</span></span>

![](./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-2.png)   

### <a name="recovery-from-snapshots"></a><span data-ttu-id="4606e-348">스냅숏에서 복구</span><span class="sxs-lookup"><span data-stu-id="4606e-348">Recovery from Snapshots</span></span>

<span data-ttu-id="4606e-349">스냅숏을 검색하려면 복사하여 새 Blob을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-349">To retrieve a snapshot, copy it to make a new blob.</span></span> <span data-ttu-id="4606e-350">기본 계정에서 스냅숏을 복사하는 경우 스냅숏의 기본 Blob에 스냅숏을 복사하여 디스크를 스냅숏으로 되돌릴 수 있습니다. 이 작업을 스냅숏 승격이라고 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-350">If you are copying the snapshot from the primary account, you can copy the snapshot over to the base blob of the snapshot, thus reverting the disk to the snapshot; this is known as promoting the snapshot.</span></span> <span data-ttu-id="4606e-351">보조 계정(RA-GRS의 경우)에서 스냅숏 백업을 복사하는 경우 기본 계정에 복사해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-351">If you are copying the snapshot backup from a secondary account (in the case of RA-GRS), it must be copied to a primary account.</span></span> <span data-ttu-id="4606e-352">[PowerShell](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) 또는 AzCopy 유틸리티를 사용하여 스냅숏을 복사할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-352">You can copy a snapshot [using PowerShell](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) or using the AzCopy utility.</span></span> <span data-ttu-id="4606e-353">자세한 내용은 [AzCopy 명령줄 유틸리티를 사용하여 데이터 전송](storage-use-azcopy.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="4606e-353">For more information, see [Transfer data with the AzCopy Command-Line Utility](storage-use-azcopy.md).</span></span>

<span data-ttu-id="4606e-354">여러 디스크가 있는 VM의 경우 조정된 동일한 복원 지점의 일부인 모든 스냅숏을 복사해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-354">In the case of VMs with multiple disks, you must copy all the snapshots that are part of the same coordinated restore point.</span></span> <span data-ttu-id="4606e-355">일단 쓰기 가능한 VHD Blob에 스냅숏을 복사하면 Blob을 사용하여 VM에 대한 템플릿으로 VM을 다시 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-355">Once you copy the snapshots to writable VHD blobs, you can use the blobs to recreate your VM using the template for the VM.</span></span>

## <a name="other-options"></a><span data-ttu-id="4606e-356">기타 옵션</span><span class="sxs-lookup"><span data-stu-id="4606e-356">Other options</span></span>

### <a name="sql-server"></a><span data-ttu-id="4606e-357">SQL Server</span><span class="sxs-lookup"><span data-stu-id="4606e-357">SQL Server</span></span>

<span data-ttu-id="4606e-358">VM에서 실행되는 SQL Server에는 SQL Server 데이터베이스를 Azure Blob 저장소 또는 파일 공유에 백업하는 자체의 기본 제공 기능이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-358">SQL Server running in a VM has its own built-in capabilities to backup your SQL Server database to Azure Blob storage or a file share.</span></span> <span data-ttu-id="4606e-359">저장소 계정이 GRS 또는 RA-GRS인 경우 재해 발생 시 저장소 계정의 보조 데이터 센터에 있는 백업에 액세스할 수 있으며 앞에서 설명한 것과 동일한 제한 사항이 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-359">If the storage account is GRS or RA-GRS, you can access those backups in the storage account’s secondary data center in the event of a disaster, with the same restrictions as discussed previously.</span></span> <span data-ttu-id="4606e-360">자세한 내용은 [Azure 가상 컴퓨터에서 SQL Server의 백업 및 복원](../../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="4606e-360">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](../../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span></span> <span data-ttu-id="4606e-361">백업 및 복원 외에도 [SQL Server Always On 가용성 그룹](../../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md)은 데이터베이스의 보조 복제본을 유지 관리하여 재해 복구 시간을 크게 줄일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-361">In addition to backup and restore, [SQL Server Always On Availability Groups](../../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) can maintain secondary replicas of databases to greatly reduce the disaster recovery time.</span></span>

## <a name="other-considerations"></a><span data-ttu-id="4606e-362">기타 고려 사항</span><span class="sxs-lookup"><span data-stu-id="4606e-362">Other considerations</span></span>

<span data-ttu-id="4606e-363">이 문서에서는 VM 및 해당 디스크의 스냅숏을 백업하거나 가져와서 재해 복구를 지원하고 이를 사용하여 복구하는 방법에 대해 설명했습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-363">This article has discussed how to backup or take snapshots of your VMs and their disks to support disaster recovery, and how to use those to recover.</span></span> <span data-ttu-id="4606e-364">Azure Resource Manager 모델을 사용하면 Azure에서 많은 사람들이 템플릿을 사용하여 VM 및 기타 인프라를 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-364">With the Azure Resource Manager model, many people use templates to create their VMs and other infrastructure in Azure.</span></span> <span data-ttu-id="4606e-365">템플릿을 사용하여 매번 동일한 구성을 갖는 VM을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-365">You can use a template to create a VM that has the same configuration every time.</span></span> <span data-ttu-id="4606e-366">VM을 만드는 데 사용자 지정 이미지를 사용하는 경우 이미지를 저장할 RA-GRS 계정을 사용하여 해당 이미지를 보호해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-366">If you use custom images for creating your VMs, you must also make sure your images are protected by using an RA-GRS account to store them.</span></span>

<span data-ttu-id="4606e-367">따라서 백업 프로세스는 다음 두 항목의 조합이 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-367">Consequently, your backup process may be a combination of two things:</span></span>

1. <span data-ttu-id="4606e-368">데이터(디스크) 백업</span><span class="sxs-lookup"><span data-stu-id="4606e-368">Backup the data (disks)</span></span>
2. <span data-ttu-id="4606e-369">구성(템플릿, 사용자 지정 이미지) 백업</span><span class="sxs-lookup"><span data-stu-id="4606e-369">Backup the configuration (templates, custom images)</span></span>

<span data-ttu-id="4606e-370">선택한 백업 옵션에 따라 데이터와 구성의 백업을 처리해야 할 수도 있고, 백업 서비스에서 모든 백업을 처리할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-370">Depending on the backup option you choose, you may have to handle the backup of both the data and the configuration, or the backup service may handle all of that for you.</span></span>

## <a name="appendix---understanding-the-impact-of-lrs-grs-and-ra-grs"></a><span data-ttu-id="4606e-371">부록 - LRS, GRS 및 RA-GRS 효과에 대한 이해</span><span class="sxs-lookup"><span data-stu-id="4606e-371">Appendix - Understanding the impact of LRS, GRS, and RA-GRS</span></span>

<span data-ttu-id="4606e-372">Azure에 있는 저장소 계정의 경우 재해 복구와 관련하여 세 가지 유형의 데이터 중복성, 즉 LRS(로컬 중복), GRS(지역 중복) 또는 RA-GRS(지역 중복 읽기 액세스)를 고려해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-372">For storage accounts in Azure, there are three types of data redundancy that you should consider regarding disaster recovery – locally redundant (LRS), geo-redundant (GRS), or geo-redundant with read access (RA-GRS).</span></span> 

<span data-ttu-id="4606e-373">LRS(로컬 중복 저장소)는 동일한 데이터 센터에서 세 개의 데이터 복사본을 유지합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-373">Locally Redundant Storage (LRS) retains three copies of the data in the same data center.</span></span> <span data-ttu-id="4606e-374">데이터를 작성할 때 성공이 호출자에게 반환되기 전에 세 복사본 모두가 업데이트되어 동일하다는 것을 알 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-374">When writing the data, all three copies are updated before success is returned to the caller, so you know they are identical.</span></span> <span data-ttu-id="4606e-375">세 복사본이 모두 동시에 영향을 받을 가능성이 거의 없으므로 디스크가 로컬 오류로부터 보호됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-375">Your disk is protected from local failures, since it is extremely unlikely that all three copies would be impacted at the same time.</span></span> <span data-ttu-id="4606e-376">LRS의 경우 지역 중복이 없으므로 전체 데이터 센터 또는 저장소 유닛에 영향을 줄 수 있는 치명적인 오류로부터 디스크가 보호될 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-376">In the case of LRS, there is no geo-redundancy, so the disk is not protected from catastrophic failures that can impact an entire data center or storage unit.</span></span>

<span data-ttu-id="4606e-377">GRS 및 RA-GRS를 사용하면 세 개의 데이터 복사본이 주 지역(사용자가 선택한 지역)에서 유지되는 한편, 세 개의 추가 데이터 복사본이 해당 보조 지역(Azure에서 설정)에서 유지됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-377">With GRS and RA-GRS, three copies of your data are retained in the primary region (selected by you), and three more copies of your data are retained in a corresponding secondary region (set by Azure).</span></span> <span data-ttu-id="4606e-378">예를 들어 미국 서부에 데이터를 저장하면 미국 동부에 데이터가 복제됩니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-378">For example, if you store data in West US, the data will be replicated to East US.</span></span> <span data-ttu-id="4606e-379">이는 비동기적으로 수행되며, 주 지역 및 보조 지역의 업데이트 간에 약간의 지연이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-379">This is done asynchronously, and there is a small delay between updates to the primary and secondary.</span></span> <span data-ttu-id="4606e-380">보조 사이트의 디스크 복제본은 디스크마다 일관성이 있지만(지연 포함), 여러 활성 디스크의 복제본은 **서로** 동기화되지 않을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-380">Replicas of the disks on the secondary site are consistent on a per-disk basis (with the delay), but replicas of multiple active disks may not be in sync **with each other**.</span></span> <span data-ttu-id="4606e-381">여러 디스크에서 일관성 있는 복제본을 유지하려면 일관성 있는 스냅숏이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-381">To have consistent replicas across multiple disks, consistent snapshots are needed.</span></span>

<span data-ttu-id="4606e-382">GRS와 RA-GRS의 주요 차이점은 RA-GRS를 사용하면 언제든지 보조 복사본을 읽을 수 있다는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-382">The main difference between GRS and RA-GRS is that with RA-GRS, you can read the secondary copy at any time.</span></span> <span data-ttu-id="4606e-383">주 지역의 데이터를 액세스할 수 없게 렌더링하는 문제가 있는 경우 Azure 팀은 액세스를 복원하기 위해 모든 노력을 다할 것입니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-383">If there is a problem that renders the data in the primary region inaccessible, the Azure team will make every effort to restore access.</span></span> <span data-ttu-id="4606e-384">RA-GRS를 사용하도록 설정하면 기본 데이터 센터가 작동 중단되어 있는 동안에도 보조 데이터 센터의 데이터에 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-384">While the primary is down, if you have RA-GRS enabled, you can access the data in the secondary data center.</span></span> <span data-ttu-id="4606e-385">따라서 기본 데이터 센터에 액세스할 수 없는 동안에 복제본을 읽으려는 경우 RA-GRS를 고려해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-385">Therefore, if you plan to read from the replica while the primary is inaccessible, then RA-GRS should be considered.</span></span>

<span data-ttu-id="4606e-386">심각한 중단으로 판명되면 Azure 팀에서 지리적 장애 조치를 트리거하고 기본 DNS 항목을 보조 저장소를 가리키도록 변경할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-386">If it turns out to be a significant outage, the Azure team may trigger a geo-failover and change the primary DNS entries to point to secondary storage.</span></span> <span data-ttu-id="4606e-387">이 시점에서 GRS 또는 RA-GRS를 사용하도록 설정한 경우에는 보조 데이터 센터였던 지역의 데이터에 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-387">At this point, if you have either GRS or RA-GRS enabled, you can access the data in the region that used to be the secondary.</span></span> <span data-ttu-id="4606e-388">즉 저장소 계정이 GRS이고 문제가 있을 때 지리적 장애 조치가 있는 경우에만 보조 저장소에 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-388">In other words, if your storage account is GRS and there is a problem, you can access the secondary storage only if there is a geo-failover.</span></span>

<span data-ttu-id="4606e-389">자세한 내용은 [Azure Storage 중단이 발생할 경우 수행할 작업](storage-disaster-recovery-guidance.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="4606e-389">For more information, see [What to do if an Azure Storage outage occurs](storage-disaster-recovery-guidance.md).</span></span> 

<span data-ttu-id="4606e-390">Microsoft는 장애 조치가 발생하는지 여부를 제어합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-390">Note that Microsoft controls whether a failover occurs.</span></span> <span data-ttu-id="4606e-391">장애 조치는 저장소 계정별로 제어되지 않으므로 개별 고객이 결정할 수는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-391">Failover is not controlled per storage account, therefore it is not decided by individual customers.</span></span> <span data-ttu-id="4606e-392">특정 저장소 계정 또는 가상 컴퓨터 디스크에 대한 재해 복구를 구현하려면 이 문서의 앞부분에서 설명한 기술을 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4606e-392">To implement Disaster Recovery for specific storage accounts or virtual machine disks, you must use the techniques described previously in this article.</span></span>
