---
title: "진단 및 메시지 분석기를 사용한 Azure Storage 문제 해결 | Microsoft Docs"
description: "Azure 저장소 분석, AzCopy 및 Microsoft Message Analyzer를 사용한 종단 간 문제 해결을 보여 주는 자습서"
services: storage
documentationcenter: dotnet
author: robinsh
manager: timlt
ms.assetid: 643372a3-1c07-4e88-b4ef-042512a43086
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 03/15/2017
ms.author: robinsh
ms.openlocfilehash: 1aa40c4de48c0117e9d3f9d434972adecccdb548
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/29/2017
---
# <a name="end-to-end-troubleshooting-using-azure-storage-metrics-and-logging-azcopy-and-message-analyzer"></a><span data-ttu-id="8ebb1-103">Azure Storage 메트릭 및 로깅, AzCopy 및 메시지 분석기를 사용한 종단 간 문제 해결</span><span class="sxs-lookup"><span data-stu-id="8ebb1-103">End-to-End Troubleshooting using Azure Storage metrics and logging, AzCopy, and Message Analyzer</span></span>
[!INCLUDE [storage-selector-portal-e2e-troubleshooting](../../../includes/storage-selector-portal-e2e-troubleshooting.md)]

<span data-ttu-id="8ebb1-104">진단 및 문제 해결은 Microsoft Azure 저장소를 사용하는 클라이언트 응용 프로그램을 빌드 및 지원하기 위한 핵심 기술입니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-104">Diagnosing and troubleshooting is a key skill for building and supporting client applications with Microsoft Azure Storage.</span></span> <span data-ttu-id="8ebb1-105">오류 및 성능 문제의 진단 및 문제 해결은 Azure 응용 프로그램의 분산된 특성 때문에 기존 환경에서보다 더욱 복잡할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-105">Due to the distributed nature of an Azure application, diagnosing and troubleshooting errors and performance issues may be more complex than in traditional environments.</span></span>

<span data-ttu-id="8ebb1-106">이 자습서에서는 성능에 영향을 줄 수 있는 특정 오류를 확인하는 방법 및 클라이언트 응용 프로그램을 최적화하기 위해 Microsoft 및 Azure Storage에서 제공하는 도구를 사용하여 종단 간에서 비롯한 해당 오류의 문제 해결 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-106">In this tutorial, we demonstrate how to identify certain errors that may affect performance, and troubleshoot those errors from end-to-end using tools provided by Microsoft and Azure Storage, in order to optimize the client application.</span></span>

<span data-ttu-id="8ebb1-107">이 자습서는 종단 간 문제 해결 시나리오의 실습 탐색을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-107">This tutorial provides a hands-on exploration of an end-to-end troubleshooting scenario.</span></span> <span data-ttu-id="8ebb1-108">Azure 저장소 응용 프로그램의 문제 해결에 대한 심층적인 개념 가이드는 [Microsoft Azure 저장소 모니터링, 진단 및 문제 해결](storage-monitoring-diagnosing-troubleshooting.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-108">For an in-depth conceptual guide to troubleshooting Azure storage applications, see [Monitor, diagnose, and troubleshoot Microsoft Azure Storage](storage-monitoring-diagnosing-troubleshooting.md).</span></span>

## <a name="tools-for-troubleshooting-azure-storage-applications"></a><span data-ttu-id="8ebb1-109">Azure 저장소 응용 프로그램 문제 해결 도구</span><span class="sxs-lookup"><span data-stu-id="8ebb1-109">Tools for troubleshooting Azure Storage applications</span></span>
<span data-ttu-id="8ebb1-110">Microsoft Azure 저장소를 사용하는 클라이언트 응용 프로그램 문제를 해결하기 위해 여러 도구 조합을 사용하여 문제가 발생한 시기 및 문제의 가능한 원인을 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-110">To troubleshoot client applications using Microsoft Azure Storage, you can use a combination of tools to determine when an issue has occurred and what the cause of the problem may be.</span></span> <span data-ttu-id="8ebb1-111">이러한 도구로는 다음이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-111">These tools include:</span></span>

* <span data-ttu-id="8ebb1-112">**Azure 저장소 분석**.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-112">**Azure Storage Analytics**.</span></span> <span data-ttu-id="8ebb1-113">[Azure 저장소 분석](/rest/api/storageservices/Storage-Analytics) 은 Azure 저장소에 대한 로깅 및 메트릭을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-113">[Azure Storage Analytics](/rest/api/storageservices/Storage-Analytics) provides metrics and logging for Azure Storage.</span></span>
  
  * <span data-ttu-id="8ebb1-114">**저장소 메트릭** 은 저장소 계정에 대한 트랜잭션 메트릭 및 용량 메트릭을 추적합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-114">**Storage metrics** tracks transaction metrics and capacity metrics for your storage account.</span></span> <span data-ttu-id="8ebb1-115">메트릭을 사용하여 다양한 여러 측정값에 따른 응용 프로그램의 성능을 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-115">Using metrics, you can determine how your application is performing according to a variety of different measures.</span></span> <span data-ttu-id="8ebb1-116">저장소 분석에서 추적하는 메트릭 유형에 대한 자세한 내용은 [저장소 분석 메트릭 테이블 스키마](/rest/api/storageservices/Storage-Analytics-Metrics-Table-Schema) 를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-116">See [Storage Analytics Metrics Table Schema](/rest/api/storageservices/Storage-Analytics-Metrics-Table-Schema) for more information about the types of metrics tracked by Storage Analytics.</span></span>
  * <span data-ttu-id="8ebb1-117">**저장소 로깅** 은 Azure 저장소 서비스에 대한 각 요청을 서버 쪽 로그에 기록합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-117">**Storage logging** logs each request to the Azure Storage services to a server-side log.</span></span> <span data-ttu-id="8ebb1-118">로그는 수행된 작업, 작업의 상태 및 대기 시간 정보를 비롯하여 각 요청의 자세한 데이터를 추적합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-118">The log tracks detailed data for each request, including the operation performed, the status of the operation, and latency information.</span></span> <span data-ttu-id="8ebb1-119">저장소 분석에서 로그에 기록한 요청 및 응답 데이터에 대한 자세한 내용은 [저장소 분석 로그 형식](/rest/api/storageservices/Storage-Analytics-Log-Format) 을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-119">See [Storage Analytics Log Format](/rest/api/storageservices/Storage-Analytics-Log-Format) for more information about the request and response data that is written to the logs by Storage Analytics.</span></span>

> [!NOTE]
> <span data-ttu-id="8ebb1-120">영역 중복 저장소(ZRS)의 복제 유형이 있는 저장소 계정에는 현재 활성화된 메트릭 또는 로깅 기능이 없습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-120">Storage accounts with a replication type of Zone-Redundant Storage (ZRS) do not have the metrics or logging capability enabled at this time.</span></span> 
> 
> 

* <span data-ttu-id="8ebb1-121">**Azure Portal**.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-121">**Azure portal**.</span></span> <span data-ttu-id="8ebb1-122">[Azure Portal](https://portal.azure.com)에서 저장소 계정에 대한 메트릭 및 로깅을 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-122">You can configure metrics and logging for your storage account in the [Azure portal](https://portal.azure.com).</span></span> <span data-ttu-id="8ebb1-123">또한 시간이 지남에 따라 응용 프로그램이 어떻게 수행되는지 보여 주는 차트 및 그래프를 볼 수 있으며, 응용 프로그램이 지정된 메트릭에 대해 예상과 다르게 수행되는 경우 이를 알려 주도록 경고를 구성할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-123">You can also view charts and graphs that show how your application is performing over time, and configure alerts to notify you if your application performs differently than expected for a specified metric.</span></span>
  
    <span data-ttu-id="8ebb1-124">Azure Portal에서 모니터링 구성에 대한 자세한 내용은 [Azure Portal에서 저장소 계정 모니터링](storage-monitor-storage-account.md) 을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-124">See [Monitor a storage account in the Azure portal](storage-monitor-storage-account.md) for information about configuring monitoring in the Azure portal.</span></span>
* <span data-ttu-id="8ebb1-125">**AzCopy**.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-125">**AzCopy**.</span></span> <span data-ttu-id="8ebb1-126">Azure 저장소의 서버 로그는 Blob으로 저장되므로 AzCopy를 사용하여 해당 로그 Blob을, Microsoft Message Analyzer를 사용한 분석의 로컬 디렉터리로 복사할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-126">Server logs for Azure Storage are stored as blobs, so you can use AzCopy to copy the log blobs to a local directory for analysis using Microsoft Message Analyzer.</span></span> <span data-ttu-id="8ebb1-127">AzCopy에 대한 자세한 내용은 [AzCopy 명령줄 유틸리티로 데이터 전송](storage-use-azcopy.md) 을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-127">See [Transfer data with the AzCopy Command-Line Utility](storage-use-azcopy.md) for more information about AzCopy.</span></span>
* <span data-ttu-id="8ebb1-128">**Microsoft Message Analyzer**.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-128">**Microsoft Message Analyzer**.</span></span> <span data-ttu-id="8ebb1-129">Message Analyzer는 로그 파일을 사용하여 로그 데이터를 시각적 형식으로 표시하는 도구입니다. 이 도구를 이용하면 오류 및 성능 문제를 분석하는 데 사용할 수 있는 유용한 집합으로 로그 데이터를 필터링, 검색 및 그룹화할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-129">Message Analyzer is a tool that consumes log files and displays log data in a visual format that makes it easy to filter, search, and group log data into useful sets that you can use to analyze errors and performance issues.</span></span> <span data-ttu-id="8ebb1-130">Message Analyzer에 대한 자세한 내용은 [Microsoft Message Analyzer 운영 가이드](http://technet.microsoft.com/library/jj649776.aspx)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-130">See [Microsoft Message Analyzer Operating Guide](http://technet.microsoft.com/library/jj649776.aspx) for more information about Message Analyzer.</span></span>

## <a name="about-the-sample-scenario"></a><span data-ttu-id="8ebb1-131">샘플 시나리오 정보</span><span class="sxs-lookup"><span data-stu-id="8ebb1-131">About the sample scenario</span></span>
<span data-ttu-id="8ebb1-132">이 자습서에서는 Azure 저장소 메트릭이 Azure 저장소를 호출하는 응용 프로그램에 대한 낮은 성공률을 나타내는 시나리오를 살펴보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-132">For this tutorial, we'll examine a scenario where Azure Storage metrics indicates a low percent success rate for an application that calls Azure storage.</span></span> <span data-ttu-id="8ebb1-133">낮은 성공률 메트릭( **Azure Portal** 및 메트릭 테이블에서 [PercentSuccess](https://portal.azure.com) 로 표시됨)은 성공은 했지만 299보다 큰 HTTP 상태 코드를 반환하는 작업을 추적합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-133">The low percent success rate metric (shown as **PercentSuccess** in the [Azure portal](https://portal.azure.com) and in the metrics tables) tracks operations that succeed, but that return an HTTP status code that is greater than 299.</span></span> <span data-ttu-id="8ebb1-134">서버 쪽 저장소 로그 파일에서 이러한 작업은 트랜잭션 상태 **ClientOtherErrors**로 기록됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-134">In the server-side storage log files, these operations are recorded with a transaction status of **ClientOtherErrors**.</span></span> <span data-ttu-id="8ebb1-135">낮은 비율의 성공 메트릭에 대한 자세한 내용은 [메트릭에 PercentSuccess가 낮게 표시되거나 분석 로그 항목에 트랜잭션 상태가 ClientOtherErrors 상태인 작업이 있음](storage-monitoring-diagnosing-troubleshooting.md#metrics-show-low-percent-success)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-135">For more details about the low percent success metric, see [Metrics show low PercentSuccess or analytics log entries have operations with transaction status of ClientOtherErrors](storage-monitoring-diagnosing-troubleshooting.md#metrics-show-low-percent-success).</span></span>

<span data-ttu-id="8ebb1-136">Azure 저장소 작업은 299보다 큰 HTTP 상태 코드를 정상적인 기능의 일부로 반환할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-136">Azure Storage operations may return HTTP status codes greater than 299 as part of their normal functionality.</span></span> <span data-ttu-id="8ebb1-137">그러나 일부의 경우에 이러한 오류는 성능 향상을 위해 클라이언트 응용 프로그램을 최적화할 수 있음을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-137">But these errors in some cases indicate that you may be able to optimize your client application for improved performance.</span></span>

<span data-ttu-id="8ebb1-138">이 시나리오에서는 100%보다 낮으면 낮은 성공률로 생각합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-138">In this scenario, we'll consider a low percent success rate to be anything below 100%.</span></span> <span data-ttu-id="8ebb1-139">그러나에 필요에 따라 다른 메트릭 수준을 선택할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-139">You can choose a different metric level, however, according to your needs.</span></span> <span data-ttu-id="8ebb1-140">응용 프로그램을 테스트하는 동안 주요 성능 메트릭에 대해 기준 허용 오차를 설정하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-140">We recommend that during testing of your application, you establish a baseline tolerance for your key performance metrics.</span></span> <span data-ttu-id="8ebb1-141">예를 들어 테스트에 따라 응용 프로그램이 90% 또는 85%의 일관된 성공률(백분율)을 유지해야 한다고 결정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-141">For example, you might determine, based on testing, that your application should have a consistent percent success rate of 90%, or 85%.</span></span> <span data-ttu-id="8ebb1-142">메트릭 데이터를 통해 응용 프로그램이 해당 수치에서 벗어난 것을 알게 되면 증가를 일으키는 원인을 조사할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-142">If your metrics data shows that the application is deviating from that number, then you can investigate what may be causing the increase.</span></span>

<span data-ttu-id="8ebb1-143">샘플 시나리오의 경우, 성공률 메트릭을 100% 미만으로 설정하면 로그를 검토하여 메트릭과 상관관계가 있는 오류를 찾아 이를 활용하여 낮은 성공률을 일으키는 원인을 알아냅니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-143">For our sample scenario, once we've established that the percent success rate metric is below 100%, we will examine the logs to find the errors that correlate to the metrics, and use them to figure out what is causing the lower percent success rate.</span></span> <span data-ttu-id="8ebb1-144">구체적으로 400번대 오류를 살펴보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-144">We'll look specifically at errors in the 400 range.</span></span> <span data-ttu-id="8ebb1-145">그런 다음 404(찾을 수 없음) 오류를 더욱 자세하게 조사합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-145">Then we'll more closely investigate 404 (Not Found) errors.</span></span>

### <a name="some-causes-of-400-range-errors"></a><span data-ttu-id="8ebb1-146">400번대 오류의 몇 가지 원인</span><span class="sxs-lookup"><span data-stu-id="8ebb1-146">Some causes of 400-range errors</span></span>
<span data-ttu-id="8ebb1-147">아래 예제에서는 Azure Blob 저장소에 대한 몇 가지 400번대 요청 오류 및 가능한 해당 원인의 샘플링을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-147">The examples below shows a sampling of some 400-range errors for requests against Azure Blob Storage, and their possible causes.</span></span> <span data-ttu-id="8ebb1-148">이러한 오류는 물론 300번대 및 500번대 오류로 인해 낮은 성공률이 나타날 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-148">Any of these errors, as well as errors in the 300 range and the 500 range, can contribute to a low percent success rate.</span></span>

<span data-ttu-id="8ebb1-149">참고로 아래 목록이 전체 목록은 아닙니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-149">Note that the lists below are far from complete.</span></span> <span data-ttu-id="8ebb1-150">Azure 저장소 일반 오류 및 각 저장소 서비스에 고유한 오류에 대한 자세한 내용은 MSDN에서 [상태 및 오류 코드](http://msdn.microsoft.com/library/azure/dd179382.aspx) 를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-150">See [Status and Error Codes](http://msdn.microsoft.com/library/azure/dd179382.aspx) on MSDN for details about general Azure Storage errors and about errors specific to each of the storage services.</span></span>

<span data-ttu-id="8ebb1-151">**상태 코드 404(찾을 수 없음) 예제**</span><span class="sxs-lookup"><span data-stu-id="8ebb1-151">**Status Code 404 (Not Found) Examples**</span></span>

<span data-ttu-id="8ebb1-152">Blob 또는 컨테이너를 찾을 수 없어서 컨테이너 또는 Blob에 대한 읽기 작업이 실패할 때 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-152">Occurs when a read operation against a container or blob fails because the blob or container is not found.</span></span>

* <span data-ttu-id="8ebb1-153">이 요청 이전에 다른 클라이언트가 컨테이너 또는 Blob을 삭제한 경우에 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-153">Occurs if a container or blob has been deleted by another client before this request.</span></span>
* <span data-ttu-id="8ebb1-154">컨테이너 또는 Blob이 있는지를 확인한 이후 컨테이너 또는 Blob을 생성한 API 호출을 사용하는 경우에 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-154">Occurs if you are using an API call that creates the container or blob after checking whether it exists.</span></span> <span data-ttu-id="8ebb1-155">CreateIfNotExists API가 컨테이너 또는 Blob이 있는지 확인하기 위해 첫 번째 HEAD 호출을 실행합니다. 그런 다음 컨테이너 또는 Blob이 존재하지 않는 경우 404 오류가 반환되고 컨테이너 또는 Blob을 작성하기 위한 두 번째 PUT 호출이 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-155">The CreateIfNotExists APIs make a HEAD call first to check for the existence of the container or blob; if it does not exist, a 404 error is returned, and then a second PUT call is made to write the container or blob.</span></span>

<span data-ttu-id="8ebb1-156">**상태 코드 409(충돌) 예제**</span><span class="sxs-lookup"><span data-stu-id="8ebb1-156">**Status Code 409 (Conflict) Examples**</span></span>

* <span data-ttu-id="8ebb1-157">해당 이름을 가진 컨테이너 또는 Blob이 있는지 먼저 확인하지 않고 만들기 API를 사용하여 새로운 컨테이너 또는 Blob을 생성하는 경우 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-157">Occurs if you use a Create API to create a new container or blob, without checking for existence first, and a container or blob with that name already exists.</span></span>
* <span data-ttu-id="8ebb1-158">컨테이너를 삭제하는데 이 삭제 작업이 완료되기 전에 같은 이름의 새 컨테이너를 생성하려고 시도하는 경우에 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-158">Occurs if a container is being deleted, and you attempt to create a new container with the same name before the deletion operation is complete.</span></span>
* <span data-ttu-id="8ebb1-159">컨테이너 또는 Blob에서 임대를 지정하는데 임대가 이미 존재하는 경우에 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-159">Occurs if you specify a lease on a container or blob, and there is already a lease present.</span></span>

<span data-ttu-id="8ebb1-160">**상태 코드 412(전제 조건 실패) 예제**</span><span class="sxs-lookup"><span data-stu-id="8ebb1-160">**Status Code 412 (Precondition Failed) Examples**</span></span>

* <span data-ttu-id="8ebb1-161">조건부 헤더에서 지정한 조건이 충족되지 않은 경우에 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-161">Occurs when the condition specified by a conditional header has not been met.</span></span>
* <span data-ttu-id="8ebb1-162">지정된 임대 ID가 컨테이너 또는 Blob의 임대 ID와 일치하지 않은 경우에 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-162">Occurs when the lease ID specified does not match the lease ID on the container or blob.</span></span>

## <a name="generate-log-files-for-analysis"></a><span data-ttu-id="8ebb1-163">분석에 대한 로그 파일 생성</span><span class="sxs-lookup"><span data-stu-id="8ebb1-163">Generate log files for analysis</span></span>
<span data-ttu-id="8ebb1-164">이 자습서에서는 Message Analyzer를 사용하여 세 가지 유형의 로그 파일로 작업할 수 있지만, 다음과 같이 해당 로그 중 하나를 선택하여 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-164">In this tutorial, we'll use Message Analyzer to work with three different types of log files, although you could choose to work with any one of these:</span></span>

* <span data-ttu-id="8ebb1-165">**서버 로그**, Azure 저장소 로깅을 사용하도록 설정한 경우 생성됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-165">The **server log**, which is created when you enable Azure Storage logging.</span></span> <span data-ttu-id="8ebb1-166">서버 로그에는 Blob, 큐, 테이블, 파일 등의 Azure 저장소 서비스 중 하나에 대해 호출된 각 작업에 관한 데이터가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-166">The server log contains data about each operation called against one of the Azure Storage services - blob, queue, table, and file.</span></span> <span data-ttu-id="8ebb1-167">서버 로그는 요청 및 응답에 대한 기타 세부 정보뿐만 아니라 어떤 작업이 호출되었는지와 어떤 상태 코드가 반환되었는지도 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-167">The server log indicates which operation was called and what status code was returned, as well as other details about the request and response.</span></span>
* <span data-ttu-id="8ebb1-168">**.NET 클라이언트 로그**, .NET 응용 프로그램 내에서 클라이언트 쪽 로깅을 사용하도록 설정한 경우 생성됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-168">The **.NET client log**, which is created when you enable client-side logging from within your .NET application.</span></span> <span data-ttu-id="8ebb1-169">클라이언트 로그에는 클라이언트가 요청을 준비하고 응답을 받아 처리하는 방법에 대한 자세한 정보가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-169">The client log includes detailed information about how the client prepares the request and receives and processes the response.</span></span>
* <span data-ttu-id="8ebb1-170">**HTTP 네트워크 추적 로그**, Azure 저장소에 대한 작업을 비롯하여 HTTP/HTTPS 요청 및 응답 데이터에 대한 데이터를 수집합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-170">The **HTTP network trace log**, which collects data on HTTP/HTTPS request and response data, including for operations against Azure Storage.</span></span> <span data-ttu-id="8ebb1-171">이 자습서에서는 Message Analyzer를 통해 네트워크 추적을 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-171">In this tutorial, we'll generate the network trace via Message Analyzer.</span></span>

### <a name="configure-server-side-logging-and-metrics"></a><span data-ttu-id="8ebb1-172">서버 쪽 로깅 및 메트릭 구성</span><span class="sxs-lookup"><span data-stu-id="8ebb1-172">Configure server-side logging and metrics</span></span>
<span data-ttu-id="8ebb1-173">먼저 Azure 저장소 로깅 및 메트릭을 구성하여 분석할 클라이언트 응용 프로그램의 데이터를 수집해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-173">First, we'll need to configure Azure Storage logging and metrics, so that we have data from the client application to analyze.</span></span> <span data-ttu-id="8ebb1-174">[Azure Portal](https://portal.azure.com)을 통해, PowerShell을 사용하여 또는 프로그래밍 방식 등의 다양한 방법으로 로깅 및 메트릭을 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-174">You can configure logging and metrics in a variety of ways - via the [Azure portal](https://portal.azure.com), by using PowerShell, or programmatically.</span></span> <span data-ttu-id="8ebb1-175">로깅 및 메트릭 구성에 대한 자세한 내용은 MSDN에서 [저장소 메트릭 사용 및 메트릭 데이터 보기](http://msdn.microsoft.com/library/azure/dn782843.aspx) 및 [저장소 로깅 사용 및 로그 데이터 액세스](http://msdn.microsoft.com/library/azure/dn782840.aspx)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-175">See [Enabling Storage Metrics and Viewing Metrics Data](http://msdn.microsoft.com/library/azure/dn782843.aspx) and [Enabling Storage Logging and Accessing Log Data](http://msdn.microsoft.com/library/azure/dn782840.aspx) on MSDN for details about configuring logging and metrics.</span></span>

<span data-ttu-id="8ebb1-176">**Azure Portal을 통해**</span><span class="sxs-lookup"><span data-stu-id="8ebb1-176">**Via the Azure portal**</span></span>

<span data-ttu-id="8ebb1-177">[Azure Portal](https://portal.azure.com)을 사용하여 저장소 계정의 로깅 및 메트릭을 구성하려면 [Azure Portal에서 저장소 계정 모니터링](storage-monitor-storage-account.md)의 지침을 따릅니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-177">To configure logging and metrics for your storage account using the [Azure portal](https://portal.azure.com), follow the instructions at [Monitor a storage account in the Azure portal](storage-monitor-storage-account.md).</span></span>

> [!NOTE]
> <span data-ttu-id="8ebb1-178">Azure Portal을 사용하여 분 메트릭을 설정할 수는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-178">It's not possible to set minute metrics using the Azure portal.</span></span> <span data-ttu-id="8ebb1-179">그러나 이 자습서의 목적에 맞게 그리고 응용 프로그램의 성능 문제를 조사하도록 메트릭을 설정하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-179">However, we recommend that you do set them for the purposes of this tutorial, and for investigating performance issues with your application.</span></span> <span data-ttu-id="8ebb1-180">아래와 같이 PowerShell을 사용하거나 저장소 클라이언트 라이브러리를 사용하여 프로그래밍 방식으로 분 메트릭을 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-180">You can set minute metrics using PowerShell as shown below, or programmatically using the storage client library.</span></span>
> 
> <span data-ttu-id="8ebb1-181">Azure Portal은 분 메트릭을 표시할 수 없으며 시간별 메트릭만 표시할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-181">Note that the Azure portal cannot display minute metrics, only hourly metrics.</span></span>
> 
> 

<span data-ttu-id="8ebb1-182">**PowerShell을 통해**</span><span class="sxs-lookup"><span data-stu-id="8ebb1-182">**Via PowerShell**</span></span>

<span data-ttu-id="8ebb1-183">Azure용 PowerShell을 시작하려면 [Azure PowerShell을 설치 및 구성하는 방법](/powershell/azure/overview)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-183">To get started with PowerShell for Azure, see [How to install and configure Azure PowerShell](/powershell/azure/overview).</span></span>

1. <span data-ttu-id="8ebb1-184">다음과 같이 [Add-azureaccount](/powershell/module/azure/add-azureaccount?view=azuresmps-3.7.0) cmdlet을 사용하여 PowerShell 창에 Azure 사용자 계정을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-184">Use the [Add-AzureAccount](/powershell/module/azure/add-azureaccount?view=azuresmps-3.7.0) cmdlet to add your Azure user account to the PowerShell window:</span></span>
   
    ```powershell
    Add-AzureAccount
    ```

2. <span data-ttu-id="8ebb1-185">**Microsoft Azure에 로그인** 창에서 계정과 연결된 메일 주소와 암호를 입력합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-185">In the **Sign in to Microsoft Azure** window, type the email address and password associated with your account.</span></span> <span data-ttu-id="8ebb1-186">Azure가 자격 증명 정보를 인증 및 저장한 후 창을 닫습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-186">Azure authenticates and saves the credential information, and then closes the window.</span></span>
3. <span data-ttu-id="8ebb1-187">다음과 같이 PowerShell 창에서 다음 명령을 실행하여 기본 저장소 계정을 자습서에서 사용하는 저장소 계정으로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-187">Set the default storage account to the storage account you are using for the tutorial by executing these commands in the PowerShell window:</span></span>
   
    ```powershell
    $SubscriptionName = 'Your subscription name'
    $StorageAccountName = 'yourstorageaccount'
    Set-AzureSubscription -CurrentStorageAccountName $StorageAccountName -SubscriptionName $SubscriptionName
    ```

4. <span data-ttu-id="8ebb1-188">다음과 같이 Blob 서비스에 대한 저장소 로깅을 사용하도록 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-188">Enable storage logging for the Blob service:</span></span>
   
    ```powershell
    Set-AzureStorageServiceLoggingProperty -ServiceType Blob -LoggingOperations Read,Write,Delete -PassThru -RetentionDays 7 -Version 1.0
    ```

5. <span data-ttu-id="8ebb1-189">다음과 같이 Blob service의 저장소 메트릭을 사용하도록 설정하고 **-MetricsType**을 `Minute`으로 설정했는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-189">Enable storage metrics for the Blob service, making sure to set **-MetricsType** to `Minute`:</span></span>
   
    ```powershell
    Set-AzureStorageServiceMetricsProperty -ServiceType Blob -MetricsType Minute -MetricsLevel ServiceAndApi -PassThru -RetentionDays 7 -Version 1.0
    ```

### <a name="configure-net-client-side-logging"></a><span data-ttu-id="8ebb1-190">.NET 클라이언트 쪽 로깅 구성</span><span class="sxs-lookup"><span data-stu-id="8ebb1-190">Configure .NET client-side logging</span></span>
<span data-ttu-id="8ebb1-191">.NET 응용 프로그램에 대해 클라이언트 쪽 로깅을 구성하려면 응용 프로그램의 구성 파일(web.config 또는 app.config)에서 .NET 진단을 사용하도록 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-191">To configure client-side logging for a .NET application, enable .NET diagnostics in the application's configuration file (web.config or app.config).</span></span> <span data-ttu-id="8ebb1-192">자세한 내용은 MSDN에서 [.NET 저장소 클라이언트 라이브러리를 사용한 클라이언트 쪽 로깅](http://msdn.microsoft.com/library/azure/dn782839.aspx) 및 [Microsoft Azure Storage SDK for Java를 사용한 클라이언트 쪽 로깅](http://msdn.microsoft.com/library/azure/dn782844.aspx)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-192">See [Client-side Logging with the .NET Storage Client Library](http://msdn.microsoft.com/library/azure/dn782839.aspx) and [Client-side Logging with the Microsoft Azure Storage SDK for Java](http://msdn.microsoft.com/library/azure/dn782844.aspx) on MSDN for details.</span></span>

<span data-ttu-id="8ebb1-193">클라이언트 쪽 로그에는 클라이언트가 요청을 준비하고 응답을 받아 처리하는 방법에 대한 자세한 정보가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-193">The client-side log includes detailed information about how the client prepares the request and receives and processes the response.</span></span>

<span data-ttu-id="8ebb1-194">저장소 클라이언트 라이브러리는 응용 프로그램의 구성 파일(web.config 또는 app.config)에 지정된 위치에 클라이언트 쪽 로그 데이터를 저장합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-194">The Storage Client Library stores client-side log data in the location specified in the application's configuration file (web.config or app.config).</span></span>

### <a name="collect-a-network-trace"></a><span data-ttu-id="8ebb1-195">네트워크 추적 수집</span><span class="sxs-lookup"><span data-stu-id="8ebb1-195">Collect a network trace</span></span>
<span data-ttu-id="8ebb1-196">클라이언트 응용 프로그램이 실행되는 동안 Message Analyzer를 사용하여 HTTP/HTTPS 네트워크 추적을 수집할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-196">You can use Message Analyzer to collect an HTTP/HTTPS network trace while your client application is running.</span></span> <span data-ttu-id="8ebb1-197">Message Analyzer는 백 엔드에서 [Fiddler](http://www.telerik.com/fiddler) 를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-197">Message Analyzer uses [Fiddler](http://www.telerik.com/fiddler) on the back end.</span></span> <span data-ttu-id="8ebb1-198">네트워크 추적을 수집하기 전에 다음과 같이 암호화되지 않은 HTTPS 트래픽을 기록하도록 Fiddler를 구성하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-198">Before you collect the network trace, we recommend that you configure Fiddler to record unencrypted HTTPS traffic:</span></span>

1. <span data-ttu-id="8ebb1-199">[Fiddler](http://www.telerik.com/download/fiddler)를 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-199">Install [Fiddler](http://www.telerik.com/download/fiddler).</span></span>
2. <span data-ttu-id="8ebb1-200">Fiddler를 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-200">Launch Fiddler.</span></span>
3. <span data-ttu-id="8ebb1-201">**도구 | Fiddler 옵션**을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-201">Select **Tools | Fiddler Options**.</span></span>
4. <span data-ttu-id="8ebb1-202">옵션 대화 상자에서 아래와 같이 **HTTPS 연결 캡처** 및 **HTTPS 트래픽 해독**이 모두 선택되어 있는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-202">In the Options dialog, ensure that **Capture HTTPS CONNECTs** and **Decrypt HTTPS Traffic** are both selected, as shown below.</span></span>

![Fiddler 옵션 구성](./media/storage-e2e-troubleshooting/fiddler-options-1.png)

<span data-ttu-id="8ebb1-204">자습서의 경우 먼저 Message Analyzer에서 네트워크 추적을 수집 및 저장한 후 분석 세션을 생성하여 추적 및 로그를 분석합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-204">For the tutorial, collect and save a network trace first in Message Analyzer, then create an analysis session to analyze the trace and the logs.</span></span> <span data-ttu-id="8ebb1-205">Message Analyzer에서 네트워크 추적을 수집하려면 다음을 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-205">To collect a network trace in Message Analyzer:</span></span>

1. <span data-ttu-id="8ebb1-206">Message Analyzer에서 **파일 | 빠른 추적 | 암호화되지 않은 HTTPS**를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-206">In Message Analyzer, select **File | Quick Trace | Unencrypted HTTPS**.</span></span>
2. <span data-ttu-id="8ebb1-207">추적이 즉시 시작됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-207">The trace will begin immediately.</span></span> <span data-ttu-id="8ebb1-208">**Stop(중지)** 을 선택하여 추적을 중지한 후 저장소 트래픽만 추적하도록 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-208">Select **Stop** to stop the trace so that we can configure it to trace storage traffic only.</span></span>
3. <span data-ttu-id="8ebb1-209">**Edit(편집)** 를 선택하여 추적 세션을 편집할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-209">Select **Edit** to edit the tracing session.</span></span>
4. <span data-ttu-id="8ebb1-210">**Microsoft-Pef-WebProxy** ETW 공급자의 오른쪽에 있는 **구성** 링크를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-210">Select the **Configure** link to the right of the **Microsoft-Pef-WebProxy** ETW provider.</span></span>
5. <span data-ttu-id="8ebb1-211">**고급 설정** 대화 상자에서 **공급자** 탭을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-211">In the **Advanced Settings** dialog, click the **Provider** tab.</span></span>
6. <span data-ttu-id="8ebb1-212">**호스트 이름 필터** 필드에서 공백으로 구분하여 저장소 끝점을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-212">In the **Hostname Filter** field, specify your storage endpoints, separated by spaces.</span></span> <span data-ttu-id="8ebb1-213">예를 들어 다음과 같이 끝점을 지정할 수 있습니다. `storagesample`를 사용 중인 저장소 계정 이름으로 변경합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-213">For example, you can specify your endpoints as follows; change `storagesample` to the name of your storage account:</span></span>

    ```   
    storagesample.blob.core.windows.net storagesample.queue.core.windows.net storagesample.table.core.windows.net
    ```

7. <span data-ttu-id="8ebb1-214">대화 상자를 종료하고 **다시 시작**을 클릭하여 적절한 호스트 이름 필터가 있는 추적의 수집을 시작합니다. 그러면 Azure Storage 네트워크 트래픽만 추적에 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-214">Exit the dialog, and click **Restart** to begin collecting the trace with the hostname filter in place, so that only Azure Storage network traffic is included in the trace.</span></span>

> [!NOTE]
> <span data-ttu-id="8ebb1-215">네트워크 추적의 수집을 완료한 후 HTTPS 트래픽을 해독하기 위해 Fiddler에서 변경한 설정을 되돌리는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-215">After you have finished collecting your network trace, we strongly recommend that you revert the settings that you may have changed in Fiddler to decrypt HTTPS traffic.</span></span> <span data-ttu-id="8ebb1-216">Fiddler의 옵션 대화 상자에서 **HTTPS 연결 캡처** 및 **HTTPS 트래픽 해독** 확인란의 선택을 취소합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-216">In the Fiddler Options dialog, deselect the **Capture HTTPS CONNECTs** and **Decrypt HTTPS Traffic** checkboxes.</span></span>
> 
> 

<span data-ttu-id="8ebb1-217">자세한 내용은 Technet의 [네트워크 추적 기능 사용(영문)](http://technet.microsoft.com/library/jj674819.aspx) 을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-217">See [Using the Network Tracing Features](http://technet.microsoft.com/library/jj674819.aspx) on Technet for more details.</span></span>

## <a name="review-metrics-data-in-the-azure-portal"></a><span data-ttu-id="8ebb1-218">Azure Portal에서 메트릭 데이터 검토</span><span class="sxs-lookup"><span data-stu-id="8ebb1-218">Review metrics data in the Azure portal</span></span>
<span data-ttu-id="8ebb1-219">응용 프로그램을 일정 기간 실행하면 [Azure Portal](https://portal.azure.com)에 표시되는 메트릭 차트를 검토하여 서비스가 수행된 방법을 관찰할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-219">Once your application has been running for a period of time, you can review the metrics charts that appear in the [Azure portal](https://portal.azure.com) to observe how your service has been performing.</span></span>

<span data-ttu-id="8ebb1-220">먼저 Azure Portal의 저장소 계정으로 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-220">First, navigate to your storage account in the Azure portal.</span></span> <span data-ttu-id="8ebb1-221">기본적으로 **성공 비율**이 포함된 모니터링 차트가 계정 블레이드에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-221">By default, a monitoring chart with the **Success percentage** metric is displayed on the account blade.</span></span> <span data-ttu-id="8ebb1-222">이전에 다른 메트릭을 표시하도록 차트를 수정한 경우 **성공 비율** 메트릭을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-222">If you've previously modified the chart to display different metrics, add the **Success percentage** metric.</span></span>

<span data-ttu-id="8ebb1-223">이제 추가한 다른 메트릭과 함께 **성공 비율**이 모니터링 차트에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-223">You'll now see **Success percentage** in the monitoring chart, along with any other metrics you may have added.</span></span> <span data-ttu-id="8ebb1-224">Message Analyzer에서 로그를 분석하여 조사하는 시나리오에서 성공률이 100% 아래인 몇 가지를 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-224">In the scenario we'll investigate next by analyzing the logs in Message Analyzer, the percent success rate is somewhat below 100%.</span></span>

<span data-ttu-id="8ebb1-225">메트릭 차트 추가 및 사용자 지정에 대한 자세한 내용은 [메트릭 차트 사용자 지정](storage-monitor-storage-account.md#customize-metrics-charts)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-225">For more details on adding and customizing metrics charts, see [Customize metrics charts](storage-monitor-storage-account.md#customize-metrics-charts).</span></span>

> [!NOTE]
> <span data-ttu-id="8ebb1-226">저장소 메트릭을 사용하도록 설정한 이후 Azure Portal에 메트릭 데이터가 표시되는 데 약간의 시간이 걸릴 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-226">It may take some time for your metrics data to appear in the Azure portal after you enable storage metrics.</span></span> <span data-ttu-id="8ebb1-227">현재 시간이 경과할 때까지 이전 시간에 대한 시간별 메트릭이 Azure Portal에 표시되지 않기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-227">This is because hourly metrics for the previous hour are not displayed in the Azure portal until the current hour has elapsed.</span></span> <span data-ttu-id="8ebb1-228">현재는 분 메트릭도 Azure Portal에 표시되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-228">Also, minute metrics are not currently displayed in the Azure portal.</span></span> <span data-ttu-id="8ebb1-229">따라서 메트릭을 사용하도록 설정한 시간에 따라 메트릭 데이터가 표시되는 데에는 최대 2시간까지 걸릴 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-229">So depending on when you enable metrics, it may take up to two hours to see metrics data.</span></span>
> 
> 

## <a name="use-azcopy-to-copy-server-logs-to-a-local-directory"></a><span data-ttu-id="8ebb1-230">AzCopy를 사용하여 로컬 디렉터리에 서버 로그 복사</span><span class="sxs-lookup"><span data-stu-id="8ebb1-230">Use AzCopy to copy server logs to a local directory</span></span>
<span data-ttu-id="8ebb1-231">Azure 저장소는 메트릭이 테이블에 기록되는 동안 서버 로그 데이터를 Blob에 작성합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-231">Azure Storage writes server log data to blobs, while metrics are written to tables.</span></span> <span data-ttu-id="8ebb1-232">로그 Blob은 저장소 계정의 잘 알려진 `$logs` 컨테이너에서 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-232">Log blobs are available in the well-known `$logs` container for your storage account.</span></span> <span data-ttu-id="8ebb1-233">로그 Blob은 조사하려는 시간 범위를 쉽게 찾을 수 있도록 연도, 월, 일 및 시간별로 계층적으로 명명됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-233">Log blobs are named hierarchically by year, month, day, and hour, so that you can easily locate the range of time you wish to investigate.</span></span> <span data-ttu-id="8ebb1-234">예를 들어 `storagesample` 계정에서 2015년 1월 2일, 오전 8-9시에 대한 로그 Blob의 컨테이너는 `https://storagesample.blob.core.windows.net/$logs/blob/2015/01/08/0800`입니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-234">For example, in the `storagesample` account, the container for the log blobs for 01/02/2015, from 8-9 am, is `https://storagesample.blob.core.windows.net/$logs/blob/2015/01/08/0800`.</span></span> <span data-ttu-id="8ebb1-235">이 컨테이너의 개별 Blob은 `000000.log`부터 시작하여 순차적으로 명명됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-235">The individual blobs in this container are named sequentially, beginning with `000000.log`.</span></span>

<span data-ttu-id="8ebb1-236">AzCopy 명령줄 도구를 사용하여 이러한 서버 쪽 로그 파일을 로컬 컴퓨터의 원하는 위치에 다운로드할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-236">You can use the AzCopy command-line tool to download these server-side log files to a location of your choice on your local machine.</span></span> <span data-ttu-id="8ebb1-237">예를 들어 다음 명령을 사용하여 2015년 1월 2일에 발생한 Blob 작업의 로그 파일을 `C:\Temp\Logs\Server` 폴더로 다운로드할 수 있습니다. `<storageaccountname>`은 저장소 계정의 이름으로, `<storageaccountkey>`는 계정 액세스 키로 바꿉니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-237">For example, you can use the following command to download the log files for blob operations that took place on January 2, 2015 to the folder `C:\Temp\Logs\Server`; replace `<storageaccountname>` with the name of your storage account, and `<storageaccountkey>` with your account access key:</span></span>

```azcopy
AzCopy.exe /Source:http://<storageaccountname>.blob.core.windows.net/$logs /Dest:C:\Temp\Logs\Server /Pattern:"blob/2015/01/02" /SourceKey:<storageaccountkey> /S /V
```
<span data-ttu-id="8ebb1-238">AzCopy는 [Azure 다운로드](https://azure.microsoft.com/downloads/) 페이지에서 다운로드할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-238">AzCopy is available for download on the [Azure Downloads](https://azure.microsoft.com/downloads/) page.</span></span> <span data-ttu-id="8ebb1-239">AzCopy 사용에 대한 자세한 내용은 [AzCopy 명령줄 유틸리티로 데이터 전송](storage-use-azcopy.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-239">For details about using AzCopy, see [Transfer data with the AzCopy Command-Line Utility](storage-use-azcopy.md).</span></span>

<span data-ttu-id="8ebb1-240">서버 쪽 로그를 다운로드하는 방법에 대한 자세한 내용은 [저장소 로깅 로그 데이터 다운로드](http://msdn.microsoft.com/library/azure/dn782840.aspx#DownloadingStorageLogginglogdata)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-240">For additional information about downloading server-side logs, see [Download Storage Logging log data](http://msdn.microsoft.com/library/azure/dn782840.aspx#DownloadingStorageLogginglogdata).</span></span>

## <a name="use-microsoft-message-analyzer-to-analyze-log-data"></a><span data-ttu-id="8ebb1-241">Microsoft Message Analyzer를 사용하여 로그 데이터 분석</span><span class="sxs-lookup"><span data-stu-id="8ebb1-241">Use Microsoft Message Analyzer to analyze log data</span></span>
<span data-ttu-id="8ebb1-242">Microsoft Message Analyzer는 문제 해결 및 진단 시나리오에서 프로토콜 메시징 트래픽, 이벤트 및 기타 시스템 또는 응용 프로그램 메시지를 캡처, 표시 및 분석하는 도구입니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-242">Microsoft Message Analyzer is a tool for capturing, displaying, and analyzing protocol messaging traffic, events, and other system or application messages in troubleshooting and diagnostic scenarios.</span></span> <span data-ttu-id="8ebb1-243">또한, Message Analyzer를 통해 로그 및 저장된 추적 파일의 데이터를 로드, 집계 및 분석할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-243">Message Analyzer also enables you to load, aggregate, and analyze data from log and saved trace files.</span></span> <span data-ttu-id="8ebb1-244">Message Analyzer에 대한 자세한 내용은 [Microsoft Message Analyzer 운영 가이드(영문)](http://technet.microsoft.com/library/jj649776.aspx)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-244">For more information about Message Analyzer, see [Microsoft Message Analyzer Operating Guide](http://technet.microsoft.com/library/jj649776.aspx).</span></span>

<span data-ttu-id="8ebb1-245">Message Analyzer에는 서버, 클라이언트 및 네트워크 로그를 분석하는 데 도움이 되는 Azure 저장소에 대한 자산이 포함되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-245">Message Analyzer includes assets for Azure Storage that help you to analyze server, client, and network logs.</span></span> <span data-ttu-id="8ebb1-246">이 섹션에서는 이러한 도구를 사용하여 저장소 로그에서의 낮은 성공 비율 문제를 해결하는 방법에 대해 논의합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-246">In this section, we'll discuss how to use those tools to address the issue of low percent success in the storage logs.</span></span>

### <a name="download-and-install-message-analyzer-and-the-azure-storage-assets"></a><span data-ttu-id="8ebb1-247">Message Analyzer 및 Azure 저장소 자산 다운로드 및 설치</span><span class="sxs-lookup"><span data-stu-id="8ebb1-247">Download and install Message Analyzer and the Azure Storage Assets</span></span>
1. <span data-ttu-id="8ebb1-248">Microsoft 다운로드 센터에서 [Message Analyzer](http://www.microsoft.com/download/details.aspx?id=44226) 를 다운로드하고 설치 관리자를 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-248">Download [Message Analyzer](http://www.microsoft.com/download/details.aspx?id=44226) from the Microsoft Download Center, and run the installer.</span></span>
2. <span data-ttu-id="8ebb1-249">Message Analyzer를 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-249">Launch Message Analyzer.</span></span>
3. <span data-ttu-id="8ebb1-250">**도구** 메뉴에서 **자산 관리자**를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-250">From the **Tools** menu, select **Asset Manager**.</span></span> <span data-ttu-id="8ebb1-251">**자산 관리자** 대화 상자에서 **다운로드**를 선택한 다음 **Azure Storage**에 필터링합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-251">In the **Asset Manager** dialog, select **Downloads**, then filter on **Azure Storage**.</span></span> <span data-ttu-id="8ebb1-252">아래 그림에 표시된 대로 Azure 저장소 자산이 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-252">You will see the Azure Storage Assets, as shown in the picture below.</span></span>
4. <span data-ttu-id="8ebb1-253">**Sync All Displayed Items(표시된 모든 항목 동기화)** 를 클릭하여 Azure 저장소 자산을 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-253">Click **Sync All Displayed Items** to install the Azure Storage Assets.</span></span> <span data-ttu-id="8ebb1-254">사용 가능한 자산은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-254">The available assets include:</span></span>
   * <span data-ttu-id="8ebb1-255">**Azure Storage Color Rules(Azure 저장소 색 규칙):** Azure 저장소 색 규칙을 통해 색상, 텍스트 및 글꼴 스타일을 사용하여 추적에 특정 정보를 포함하는 메시지를 강조 표시하는 특수 필터를 정의할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-255">**Azure Storage Color Rules:** Azure Storage color rules enable you to define special filters that use color, text, and font styles to highlight messages that contain specific information in a trace.</span></span>
   * <span data-ttu-id="8ebb1-256">**Azure 저장소 차트:** Azure 저장소 차트는 서버 로그 데이터를 그래프로 표시하는 미리 정의된 차트입니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-256">**Azure Storage Charts:** Azure Storage charts are predefined charts that graph server log data.</span></span> <span data-ttu-id="8ebb1-257">이번에 Azure 저장소 차트를 사용하려면 서버 로그를 분석 격자로 로드하기만 하면 됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-257">Note that to use Azure Storage charts at this time, you may only load the server log into the Analysis Grid.</span></span>
   * <span data-ttu-id="8ebb1-258">**Azure 저장소 파서:** Azure 저장소 파서는 Azure 저장소 클라이언트, 서버 및 HTTP 로그를 분석 그리드에 표시하기 위해 구문 분석합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-258">**Azure Storage Parsers:** The Azure Storage parsers parse the Azure Storage client, server, and HTTP logs in order to display them in the Analysis Grid.</span></span>
   * <span data-ttu-id="8ebb1-259">**Azure 저장소 필터:** Azure 저장소 필터는 분석 그리드의 데이터를 쿼리하는 데 사용할 수 있는 미리 정의된 조건입니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-259">**Azure Storage Filters:** Azure Storage filters are predefined criteria that you can use to query your data in the Analysis Grid.</span></span>
   * <span data-ttu-id="8ebb1-260">**Azure 저장소 보기 레이아웃:** Azure 저장소 보기 레이아웃은 분석 그리드의 미리 정의된 열 레이아웃 및 그룹화입니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-260">**Azure Storage View Layouts:** Azure Storage view layouts are predefined column layouts and groupings in the Analysis Grid.</span></span>
5. <span data-ttu-id="8ebb1-261">자산을 설치한 후 Message Analyzer를 다시 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-261">Restart Message Analyzer after you've installed the assets.</span></span>

![메시지 분석기 자산 관리자](./media/storage-e2e-troubleshooting/mma-start-page-1.png)

> [!NOTE]
> <span data-ttu-id="8ebb1-263">이 자습서의 용도에 맞는 Azure 저장소 자산을 모두 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-263">Install all of the Azure Storage assets shown for the purposes of this tutorial.</span></span>
> 
> 

### <a name="import-your-log-files-into-message-analyzer"></a><span data-ttu-id="8ebb1-264">Message Analyzer로 로그 파일 가져오기</span><span class="sxs-lookup"><span data-stu-id="8ebb1-264">Import your log files into Message Analyzer</span></span>
<span data-ttu-id="8ebb1-265">Microsoft Message Analyzer에서 분석을 위해 저장된 모든 로그 파일(서버 쪽, 클라이언트 쪽 및 네트워크)을 단일 세션으로 가져올 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-265">You can import all of your saved log files (server-side, client-side, and network) into a single session in Microsoft Message Analyzer for analysis.</span></span>

1. <span data-ttu-id="8ebb1-266">Microsoft Message Analyzer에서 **파일** 메뉴의 **새 세션**을 클릭한 후 **빈 세션**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-266">On the **File** menu in Microsoft Message Analyzer, click **New Session**, and then click **Blank Session**.</span></span> <span data-ttu-id="8ebb1-267">**New Session(새 세션)** 대화 상자에서 분석 세션의 이름을 입력합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-267">In the **New Session** dialog, enter a name for your analysis session.</span></span> <span data-ttu-id="8ebb1-268">**세션 정보** 패널에서 **파일** 단추를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-268">In the **Session Details** panel, click on the **Files** button.</span></span>
2. <span data-ttu-id="8ebb1-269">Message Analyzer에서 생성한 네트워크 추적 데이터를 로드하려면 **파일 추가**를 클릭하고, 웹 추적 세션의 .matp 파일을 저장한 위치를 찾아 .matp 파일을 선택하고 **열기**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-269">To load the network trace data generated by Message Analyzer, click on **Add Files**, browse to the location where you saved your .matp file from your web tracing session, select the .matp file, and click **Open**.</span></span>
3. <span data-ttu-id="8ebb1-270">서버 쪽 로그 데이터를 로드하려면 **파일 추가**를 클릭하고, 서버 쪽 로그를 다운로드한 위치를 찾아 분석하려는 시간 범위의 로그 파일을 선택하고 **열기**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-270">To load the server-side log data, click on **Add Files**, browse to the location where you downloaded your server-side logs, select the log files for the time range you want to analyze, and click **Open**.</span></span> <span data-ttu-id="8ebb1-271">그런 다음 **세션 정보** 패널에서 각 서버 쪽 로그 파일의 **텍스트 로그 구성** 드롭다운을 **AzureStorageLog**로 설정하여 Microsoft Message Analyzer가 로그 파일을 올바르게 구문 분석할 수 있도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-271">Then, in the **Session Details** panel, set the **Text Log Configuration** drop-down for each server-side log file to **AzureStorageLog** to ensure that Microsoft Message Analyzer can parse the log file correctly.</span></span>
4. <span data-ttu-id="8ebb1-272">클라이언트 쪽 로그 데이터를 로드하려면 **파일 추가**를 클릭하고, 클라이언트 쪽 로그를 저장한 위치를 찾아 분석할 로그 파일을 선택하고 **열기**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-272">To load the client-side log data, click on **Add Files**, browse to the location where you saved your client-side logs, select the log files you want to analyze, and click **Open**.</span></span> <span data-ttu-id="8ebb1-273">그런 다음 **세션 정보** 패널에서 각 클라이언트 쪽 로그 파일의 **텍스트 로그 구성** 드롭다운을 **AzureStorageClientDotNetV4**로 설정하여 Microsoft Message Analyzer가 로그 파일을 올바르게 구문 분석할 수 있도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-273">Then, in the **Session Details** panel, set the **Text Log Configuration** drop-down for each client-side log file to **AzureStorageClientDotNetV4** to ensure that Microsoft Message Analyzer can parse the log file correctly.</span></span>
5. <span data-ttu-id="8ebb1-274">**새 세션** 대화 상자에서 **시작**을 클릭하여 로그 데이터를 로드하고 구문 분석합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-274">Click **Start** in the **New Session** dialog to load and parse the log data.</span></span> <span data-ttu-id="8ebb1-275">Message Analyzer 분석 그리드에 로그 데이터가 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-275">The log data displays in the Message Analyzer Analysis Grid.</span></span>

<span data-ttu-id="8ebb1-276">아래 그림은 서버, 클라이언트 및 네트워크 추적 로그 파일에 구성된 예제 세션을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-276">The picture below shows an example session configured with server, client, and network trace log files.</span></span>

![Message Analyzer 세션 구성](./media/storage-e2e-troubleshooting/configure-mma-session-1.png)

<span data-ttu-id="8ebb1-278">Message Analyzer는 로그 파일을 메모리에 로드합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-278">Note that Message Analyzer loads log files into memory.</span></span> <span data-ttu-id="8ebb1-279">로그 데이터 집합이 큰 경우 Message Analyzer에서 최상의 성능을 얻으려면 로그를 필터링합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-279">If you have a large set of log data, you will want to filter it in order to get the best performance from Message Analyzer.</span></span>

<span data-ttu-id="8ebb1-280">먼저, 검토하고 싶은 시간 프레임을 결정하고 이 시간 프레임을 가능한 한 작게 유지합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-280">First, determine the time frame that you are interested in reviewing, and keep this time frame as small as possible.</span></span> <span data-ttu-id="8ebb1-281">대부분의 경우 몇 분 또는 많아야 몇 시간의 기간을 검토합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-281">In many cases you will want to review a period of minutes or hours at most.</span></span> <span data-ttu-id="8ebb1-282">이러한 요구를 충족할 수 있는 로그의 최소 집합을 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-282">Import the smallest set of logs that can meet your needs.</span></span>

<span data-ttu-id="8ebb1-283">여전히 로그 데이터의 양이 많으면 해당 데이터를 로드하기 전에 먼저 세션 필터를 지정하여 로그 데이터를 필터링할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-283">If you still have a large amount of log data, then you may want to specify a session filter to filter your log data before you load it.</span></span> <span data-ttu-id="8ebb1-284">**세션 필터** 상자에서 **라이브러리** 단추를 선택하여 미리 정의된 필터를 선택합니다. 예를 들어 Azure Storage 필터에서 **전역 시간 필터 I**을 선택하여 시간 간격을 필터링합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-284">In the **Session Filter** box, select the **Library** button to choose a predefined filter; for example, choose **Global Time Filter I** from the Azure Storage filters to filter on a time interval.</span></span> <span data-ttu-id="8ebb1-285">그런 다음 필터 조건을 편집하여 확인하려는 간격에 대한 시작 및 끝 타임스탬프를 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-285">You can then edit the filter criteria to specify the starting and ending timestamp for the interval you want to see.</span></span> <span data-ttu-id="8ebb1-286">또한, 특정 상태 코드를 필터링할 수 있습니다. 예를 들어 상태 코드가 404인 로그 항목만 로드하도록 선택할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-286">You can also filter on a particular status code; for example, you can choose to load only log entries where the status code is 404.</span></span>

<span data-ttu-id="8ebb1-287">로그 데이터를 Microsoft Message Analyzer로 가져오는 방법에 대한 자세한 내용은 TechNet에서 [메시지 데이터 검색(영문)](http://technet.microsoft.com/library/dn772437.aspx) 을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-287">For more information about importing log data into Microsoft Message Analyzer, see [Retrieving Message Data](http://technet.microsoft.com/library/dn772437.aspx) on TechNet.</span></span>

### <a name="use-the-client-request-id-to-correlate-log-file-data"></a><span data-ttu-id="8ebb1-288">클라이언트 요청 ID를 사용하여 로그 파일 데이터의 상관관계 지정</span><span class="sxs-lookup"><span data-stu-id="8ebb1-288">Use the client request ID to correlate log file data</span></span>
<span data-ttu-id="8ebb1-289">Azure 저장소 클라이언트 라이브러리는 모든 요청에 대해 고유한 클라이언트 요청 ID를 자동으로 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-289">The Azure Storage Client Library automatically generates a unique client request ID for every request.</span></span> <span data-ttu-id="8ebb1-290">이 값은 클라이언트 로그, 서버 로그 및 네트워크 추적에 기록되므로 해당 값을 사용하여 Message Analyzer 내에서 세 로그 모두에 대해 데이터의 상관관계를 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-290">This value is written to the client log, the server log, and the network trace, so you can use it to correlate data across all three logs within Message Analyzer.</span></span> <span data-ttu-id="8ebb1-291">클라이언트 요청 ID에 대한 자세한 내용은 [클라이언트 요청 ID](storage-monitoring-diagnosing-troubleshooting.md#client-request-id) 를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-291">See [Client request ID](storage-monitoring-diagnosing-troubleshooting.md#client-request-id) for additional information about the client request ID.</span></span>

<span data-ttu-id="8ebb1-292">다음 섹션에서는 미리 구성된 사용자 지정 레이아웃 보기를 사용하여 클라이언트 요청 ID에 따라 데이터의 상관관계를 지정하고 그룹화하는 방법에 관해 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-292">The sections below describe how to use pre-configured and custom layout views to correlate and group data based on the client request ID.</span></span>

### <a name="select-a-view-layout-to-display-in-the-analysis-grid"></a><span data-ttu-id="8ebb1-293">분석 그리드에 표시할 보기 레이아웃 선택</span><span class="sxs-lookup"><span data-stu-id="8ebb1-293">Select a view layout to display in the Analysis Grid</span></span>
<span data-ttu-id="8ebb1-294">Message Analyzer의 저장소 자산에는 다양한 시나리오에서 유용한 그룹화 및 열을 이용하여 데이터를 표시하는 데 사용할 수 있는 미리 구성된 보기인 Azure 저장소 보기 레이아웃이 포함되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-294">The Storage Assets for Message Analyzer include Azure Storage View Layouts, which are pre-configured views that you can use to display your data with useful groupings and columns for different scenarios.</span></span> <span data-ttu-id="8ebb1-295">또한, 사용자 지정 보기 레이아웃을 생성하고 다시 사용하기 위해 저장할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-295">You can also create custom view layouts and save them for reuse.</span></span>

<span data-ttu-id="8ebb1-296">아래 그림은 도구 모음 리본에서 **보기 레이아웃**을 선택하여 사용할 수 있는 **보기 레이아웃** 메뉴를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-296">The picture below shows the **View Layout** menu, available by selecting **View Layout** from the toolbar ribbon.</span></span> <span data-ttu-id="8ebb1-297">Azure 저장소의 보기 레이아웃은 메뉴의 **Azure 저장소** 노드에서 그룹화됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-297">The view layouts for Azure Storage are grouped under the **Azure Storage** node in the menu.</span></span> <span data-ttu-id="8ebb1-298">검색 상자에서 `Azure Storage` 를 검색하여 Azure 저장소 보기 레이아웃만 필터링할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-298">You can search for `Azure Storage` in the search box to filter on Azure Storage view layouts only.</span></span> <span data-ttu-id="8ebb1-299">보기 레이아웃 옆에 있는 별표를 선택하여 즐겨찾기로 만들고 메뉴의 맨 위에 표시되도록 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-299">You can also select the star next to a view layout to make it a favorite and display it at the top of the menu.</span></span>

![보기 레이아웃 메뉴](./media/storage-e2e-troubleshooting/view-layout-menu.png)

<span data-ttu-id="8ebb1-301">먼저 **Grouped by ClientRequestID and Module(ClientRequestID 및 모듈별로 그룹화)**을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-301">To begin with, select **Grouped by ClientRequestID and Module**.</span></span> <span data-ttu-id="8ebb1-302">이 보기 레이아웃은 먼저 세 로그 모두의 로그 데이터를 클라이언트 요청 ID별로 그룹화한 후 원본 로그 파일(또는 Message Analyzer의 **모듈** )별로 그룹화합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-302">This view layout groups log data from all three logs first by client request ID, then by source log file (or **Module** in Message Analyzer).</span></span> <span data-ttu-id="8ebb1-303">이 보기를 사용하여 특정 클라이언트 요청 ID로 드릴다운하고 해당 클라이언트 요청 ID에 대한 세 로그 파일 모두의 데이터를 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-303">With this view, you can drill down into a particular client request ID, and see data from all three log files for that client request ID.</span></span>

<span data-ttu-id="8ebb1-304">아래 그림은 샘플 로그 데이터에 적용된 이 레이아웃 보기와 표시된 열의 하위 집합을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-304">The picture below shows this layout view applied to the sample log data, with a subset of columns displayed.</span></span> <span data-ttu-id="8ebb1-305">특정 클라이언트 요청 ID의 레이아웃을 볼 수 있습니다. 분석 그리드에는 클라이언트 로그, 서버 로그 및 네트워크 추적의 데이터가 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-305">You can see that for a particular client request ID, the Analysis Grid displays data from the client log, server log, and network trace.</span></span>

![Azure 저장소 보기 레이아웃](./media/storage-e2e-troubleshooting/view-layout-client-request-id-module.png)

> [!NOTE]
> <span data-ttu-id="8ebb1-307">다른 로그 파일에는 다른 열이 있으므로 여러 로그 파일의 데이터가 분석 그리드에 표시될 때 일부 열이 지정된 행의 데이터를 포함하지 않을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-307">Different log files have different columns, so when data from multiple log files is displayed in the Analysis Grid, some columns may not contain any data for a given row.</span></span> <span data-ttu-id="8ebb1-308">클라이언트 로그 행은 **Timestamp**, **TimeElapsed**, **Source** 및 **Destination** 열의 데이터를 표시하지 않습니다. 이러한 열이 클라이언트 로그에 존재하지 않지만, 네트워크 추적에는 존재하기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-308">For example, in the picture above, the client log rows do not show any data for the **Timestamp**, **TimeElapsed**, **Source**, and **Destination** columns, because these columns do not exist in the client log, but do exist in the network trace.</span></span> <span data-ttu-id="8ebb1-309">마찬가지로 **Timestamp** 열에는 서버 로그의 타임스탬프 데이터가 표시되지만, 서버 로그의 일부가 아닌 **TimeElapsed**, **Source** 및 **Destination** 열에는 데이터가 표시되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-309">Similarly, the **Timestamp** column displays timestamp data from the server log, but no data is displayed for the **TimeElapsed**, **Source**, and **Destination** columns, which are not part of the server log.</span></span>
> 
> 

<span data-ttu-id="8ebb1-310">Azure 저장소 보기 레이아웃을 사용할 뿐만 아니라 고유의 보기 레이아웃을 정의 및 저장할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-310">In addition to using the Azure Storage view layouts, you can also define and save your own view layouts.</span></span> <span data-ttu-id="8ebb1-311">그룹화 데이터에 대해 원하는 다른 필드를 선택하고 해당 그룹화를 사용자 지정 레이아웃의 일부로 저장할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-311">You can select other desired fields for grouping data and save the grouping as part of your custom layout as well.</span></span>

### <a name="apply-color-rules-to-the-analysis-grid"></a><span data-ttu-id="8ebb1-312">분석 그리드에 색 규칙 적용</span><span class="sxs-lookup"><span data-stu-id="8ebb1-312">Apply color rules to the Analysis Grid</span></span>
<span data-ttu-id="8ebb1-313">저장소 자산에는 분석 그리드에서 여러 유형의 오류를 식별하는 시각적 수단을 제공하는 색 규칙도 포함되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-313">The Storage Assets also include color rules, which offer a visual means to identify different types of errors in the Analysis Grid.</span></span> <span data-ttu-id="8ebb1-314">미리 정의된 색 규칙이 HTTP 오류에 적용되면 서버 로그 및 네트워크 추적에 대해서만 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-314">The predefined color rules apply to HTTP errors, so they appear only for the server log and network trace.</span></span>

<span data-ttu-id="8ebb1-315">색 규칙을 적용하려면 도구 모음 리본에서 **Color Rules(색 규칙)** 를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-315">To apply color rules, select **Color Rules** from the toolbar ribbon.</span></span> <span data-ttu-id="8ebb1-316">메뉴에서 Azure 저장소 색 규칙을 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-316">You'll see the Azure Storage color rules in the menu.</span></span> <span data-ttu-id="8ebb1-317">자습서의 경우 아래 그림에 표시된 대로 **Client Errors (StatusCode between 400 and 499)[클라이언트 오류(400과 499 사이의 StatusCode)]**를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-317">For the tutorial, select **Client Errors (StatusCode between 400 and 499)**, as shown in the picture below.</span></span>

![Azure 저장소 보기 레이아웃](./media/storage-e2e-troubleshooting/color-rules-menu.png)

<span data-ttu-id="8ebb1-319">Azure 저장소 색 규칙을 사용할 뿐만 아니라 고유의 색 규칙을 정의 및 저장할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-319">In addition to using the Azure Storage color rules, you can also define and save your own color rules.</span></span>

### <a name="group-and-filter-log-data-to-find-400-range-errors"></a><span data-ttu-id="8ebb1-320">로그 데이터를 그룹화 및 필터링하여 400번대 오류 찾기</span><span class="sxs-lookup"><span data-stu-id="8ebb1-320">Group and filter log data to find 400-range errors</span></span>
<span data-ttu-id="8ebb1-321">다음은 로그 데이터를 그룹화 및 필터링하여 400번대의 모든 오류를 찾습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-321">Next, we'll group and filter the log data to find all errors in the 400 range.</span></span>

1. <span data-ttu-id="8ebb1-322">분석 그리드에서 **StatusCode** 열을 찾아 열 제목을 마우스 오른쪽 단추로 클릭하고 **그룹**을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-322">Locate the **StatusCode** column in the Analysis Grid, right-click the column heading, and select **Group**.</span></span>
2. <span data-ttu-id="8ebb1-323">그러면 **ClientRequestId** 열이 그룹화됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-323">Next, group on the **ClientRequestId** column.</span></span> <span data-ttu-id="8ebb1-324">이제 분석 그리드의 데이터가 상태 코드 및 클라이언트 요청 ID별로 구성되어 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-324">You'll see that the data in the Analysis Grid is now organized by status code and by client request ID.</span></span>
3. <span data-ttu-id="8ebb1-325">표시되지 않은 경우 보기 필터 도구 창을 표시합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-325">Display the View Filter tool window if it is not already displayed.</span></span> <span data-ttu-id="8ebb1-326">도구 모음 리본에서 **도구 창**, **필터 보기**를 차례로 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-326">On the toolbar ribbon, select **Tool Windows**, then **View Filter**.</span></span>
4. <span data-ttu-id="8ebb1-327">400번대 오류만 표시되도록 로그 데이터를 필터링하려면 다음과 같은 필터 조건을 **필터 보기** 창에 추가하고 **적용**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-327">To filter the log data to display only 400-range errors, add the following filter criteria to the **View Filter** window, and click **Apply**:</span></span>

    ```   
    (AzureStorageLog.StatusCode >= 400 && AzureStorageLog.StatusCode <=499) || (HTTP.StatusCode >= 400 && HTTP.StatusCode <= 499)
    ```

<span data-ttu-id="8ebb1-328">아래 그림은 이 그룹화 및 필터의 결과를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-328">The picture below shows the results of this grouping and filter.</span></span> <span data-ttu-id="8ebb1-329">예를 들어 상태 코드 409의 그룹화 아래에 있는 **ClientRequestID** 필드를 확장하면 해당 상태 코드를 야기한 작업이 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-329">Expanding the **ClientRequestID** field beneath the grouping for status code 409, for example, shows an operation that resulted in that status code.</span></span>

![Azure 저장소 보기 레이아웃](./media/storage-e2e-troubleshooting/400-range-errors1.png)

<span data-ttu-id="8ebb1-331">이 필터를 적용한 이후 클라이언트 로그가 **StatusCode** 열을 포함하지 않기 때문에 클라이언트 로그에서 행이 제외되는 것을 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-331">After applying this filter, you'll see that rows from the client log are excluded, as the client log does not include a **StatusCode** column.</span></span> <span data-ttu-id="8ebb1-332">먼저 서버 및 네트워크 추적 로그를 검토하여 404 오류를 찾은 후 클라이언트 로그로 돌아가 해당 오류를 야기한 클라이언트 작업을 검사합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-332">To begin with, we'll review the server and network trace logs to locate 404 errors, and then we'll return to the client log to examine the client operations that led to them.</span></span>

> [!NOTE]
> <span data-ttu-id="8ebb1-333">상태 코드가 null인 로그 항목을 포함하는 필터에 식을 추가한 경우 **StatusCode** 열을 필터링하고 클라이언트 로그를 비롯하여 세 로그 모두의 데이터를 여전히 표시할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-333">You can filter on the **StatusCode** column and still display data from all three logs, including the client log, if you add an expression to the filter that includes log entries where the status code is null.</span></span> <span data-ttu-id="8ebb1-334">이 필터 식을 생성하려면 다음을 사용하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-334">To construct this filter expression, use:</span></span>
> 
> <code>&#42;StatusCode >= 400 or !&#42;StatusCode</code>
> 
> <span data-ttu-id="8ebb1-335">이 필터는 클라이언트 로그의 모든 행과 상태 코드가 400보다 큰 서버 로그 및 HTTP 로그의 행만 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-335">This filter returns all rows from the client log and only rows from the server log and HTTP log where the status code is greater than 400.</span></span> <span data-ttu-id="8ebb1-336">클라이언트 요청 ID 및 모듈별로 그룹화한 보기 레이아웃에 이 필터를 적용할 경우 로그 항목을 검색하거나 스크롤하여 세 로그 모두가 표시되는 항목을 찾을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-336">If you apply it to the view layout grouped by client request ID and module, you can search or scroll through the log entries to find ones where all three logs are represented.</span></span>   
> 
> 

### <a name="filter-log-data-to-find-404-errors"></a><span data-ttu-id="8ebb1-337">로그 데이터를 필터링하여 404 오류 찾기</span><span class="sxs-lookup"><span data-stu-id="8ebb1-337">Filter log data to find 404 errors</span></span>
<span data-ttu-id="8ebb1-338">저장소 자산에는 로그 데이터 범위를 좁혀 찾고 있는 오류 또는 추세를 찾는 데 사용할 수 있는 미리 정의된 필터가 포함되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-338">The Storage Assets include predefined filters that you can use to narrow log data to find the errors or trends you are looking for.</span></span> <span data-ttu-id="8ebb1-339">이제 두 가지 미리 정의된 필터 즉, 404 오류에 대해 서버 및 네트워크 추적 로그를 필터링하는 필터와 지정한 시간 범위에서 데이터를 필터링하는 필터를 적용하겠습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-339">Next, we'll apply two predefined filters: one that filters the server and network trace logs for 404 errors, and one that filters the data on a specified time range.</span></span>

1. <span data-ttu-id="8ebb1-340">표시되지 않은 경우 보기 필터 도구 창을 표시합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-340">Display the View Filter tool window if it is not already displayed.</span></span> <span data-ttu-id="8ebb1-341">도구 모음 리본에서 **도구 창**, **필터 보기**를 차례로 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-341">On the toolbar ribbon, select **Tool Windows**, then **View Filter**.</span></span>
2. <span data-ttu-id="8ebb1-342">보기 필터 창에서 **라이브러리**를 선택하고 `Azure Storage`를 검색하여 Azure Storage 필터를 찾습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-342">In the View Filter window, select **Library**, and search on `Azure Storage` to find the Azure Storage filters.</span></span> <span data-ttu-id="8ebb1-343">**모든 로그의 404(찾을 수 없음) 메시지**에 대한 필터를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-343">Select the filter for **404 (Not Found) messages in all logs**.</span></span>
3. <span data-ttu-id="8ebb1-344">**라이브러리** 메뉴를 다시 표시하고 **전역 시간 필터**를 찾아 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-344">Display the **Library** menu again, and locate and select the **Global Time Filter**.</span></span>
4. <span data-ttu-id="8ebb1-345">필터에 있는 타임스탬프를 표시하려는 범위로 편집합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-345">Edit the timestamps shown in the filter to the range you wish to view.</span></span> <span data-ttu-id="8ebb1-346">이 작업은 분석할 데이터의 범위를 좁히는 데 도움이 됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-346">This will help to narrow the range of data to analyze.</span></span>
5. <span data-ttu-id="8ebb1-347">필터는 아래 예제와 같이 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-347">Your filter should appear similar to the example below.</span></span> <span data-ttu-id="8ebb1-348">**Apply(적용)** 를 클릭하여 분석 그리드에 필터를 적용합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-348">Click **Apply** to apply the filter to the Analysis Grid.</span></span>

    ```   
    ((AzureStorageLog.StatusCode == 404 || HTTP.StatusCode == 404)) And
    (#Timestamp >= 2014-10-20T16:36:38 and #Timestamp <= 2014-10-20T16:36:39)
    ```

    ![Azure 저장소 보기 레이아웃](./media/storage-e2e-troubleshooting/404-filtered-errors1.png)

### <a name="analyze-your-log-data"></a><span data-ttu-id="8ebb1-350">로그 데이터 분석</span><span class="sxs-lookup"><span data-stu-id="8ebb1-350">Analyze your log data</span></span>
<span data-ttu-id="8ebb1-351">데이터를 그룹화하고 필터링했으므로 404 오류를 생성한 개별 요청의 세부 정보를 검사할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-351">Now that you have grouped and filtered your data, you can examine the details of individual requests that generated 404 errors.</span></span> <span data-ttu-id="8ebb1-352">현재 보기 레이아웃에서 데이터는 클라이언트 요청 ID별로 그룹화된 후 로그 원본별로 그룹화됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-352">In the current view layout, the data is grouped by client request ID, then by log source.</span></span> <span data-ttu-id="8ebb1-353">StatusCode 필드에 404가 포함된 요청을 필터링하고 있으므로 클라이언트 로그 데이터가 아니라 서버 및 네트워크 추적 데이터만 살펴보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-353">Since we are filtering on requests where the StatusCode field contains 404, we'll see only the server and network trace data, not the client log data.</span></span>

<span data-ttu-id="8ebb1-354">아래 그림은 Blob이 존재하지 않기 때문에 Blob 가져오기 작업에서 404 오류를 생성한 구체적인 요청을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-354">The picture below shows a specific request where a Get Blob operation yielded a 404 because the blob did not exist.</span></span> <span data-ttu-id="8ebb1-355">관련 데이터를 표시하기 위해 표준 보기에서 일부 열이 제거되었습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-355">Note that some columns have been removed from the standard view in order to display the relevant data.</span></span>

![필터링 된 서버 및 네트워크 추적 로그](./media/storage-e2e-troubleshooting/server-filtered-404-error.png)

<span data-ttu-id="8ebb1-357">이제, 이 클라이언트 요청 ID를 클라이언트 로그 데이터와 상호 연결하여 오류가 발생했을 때 클라이언트가 수행한 작업을 알아보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-357">Next, we'll correlate this client request ID with the client log data to see what actions the client was taking when the error happened.</span></span> <span data-ttu-id="8ebb1-358">다음과 같이 이 세션의 새 분석 그리드 보기를 표시하여 두 번째 탭에서 열리는 클라이언트 로그 데이터를 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-358">You can display a new Analysis Grid view for this session to view the client log data, which opens in a second tab:</span></span>

1. <span data-ttu-id="8ebb1-359">먼저 **ClientRequestId** 필드의 값을 클립보드로 복사합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-359">First, copy the value of the **ClientRequestId** field to the clipboard.</span></span> <span data-ttu-id="8ebb1-360">행을 선택하고 **ClientRequestId** 필드를 찾아 데이터 값을 마우스 오른쪽 단추로 클릭하고 **'ClientRequestId' 복사**를 선택하여 이 작업을 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-360">You can do this by selecting either row, locating the **ClientRequestId** field, right-clicking on the data value, and choosing **Copy 'ClientRequestId'**.</span></span>
2. <span data-ttu-id="8ebb1-361">도구 모음 리본에서 **새 뷰어**를 선택한 후 **분석 그리드**를 선택하여 새 탭을 엽니다. 새 탭에 그룹화, 필터링 또는 색 규칙 없이 로그 파일의 모든 데이터가 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-361">On the toolbar ribbon, select **New Viewer**, then select **Analysis Grid** to open a new tab. The new tab shows all data in your log files, without grouping, filtering, or color rules.</span></span>
3. <span data-ttu-id="8ebb1-362">도구 모음 리본에서 **보기 레이아웃**을 선택한 후 **Azure Storage** 섹션의 **모든 .NET 클라이언트 열**를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-362">On the toolbar ribbon, select **View Layout**, then select **All .NET Client Columns** under the **Azure Storage** section.</span></span> <span data-ttu-id="8ebb1-363">이 보기 레이아웃은 서버 및 네트워크 추적 로그는 물론 클라이언트 로그의 데이터를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-363">This view layout shows data from the client log as well as the server and network trace logs.</span></span> <span data-ttu-id="8ebb1-364">기본적으로 **MessageNumber** 열을 기준으로 정렬됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-364">By default it is sorted on the **MessageNumber** column.</span></span>
4. <span data-ttu-id="8ebb1-365">그런 다음 클라이언트 요청 ID의 클라이언트 로그를 검색합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-365">Next, search the client log for the client request ID.</span></span> <span data-ttu-id="8ebb1-366">도구 모음 리본에서 **메시지 찾기**를 선택한 후 **찾기** 필드에서 클라이언트 요청 ID에 대한 사용자 지정 필터를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-366">On the toolbar ribbon, select **Find Messages**, then specify a custom filter on the client request ID in the **Find** field.</span></span> <span data-ttu-id="8ebb1-367">이 필터에 다음 구문을 사용하여 고유의 클라이언트 요청 ID를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-367">Use this syntax for the filter, specifying your own client request ID:</span></span>

    ```
    *ClientRequestId == "398bac41-7725-484b-8a69-2a9e48fc669a"
    ```

<span data-ttu-id="8ebb1-368">Message Analyzer에서 검색 조건이 클라이언트 요청 ID와 일치하는 첫 번째 로그 항목을 찾아 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-368">Message Analyzer locates and selects the first log entry where the search criteria matches the client request ID.</span></span> <span data-ttu-id="8ebb1-369">클라이언트 로그에 각 클라이언트 요청 ID에 대한 여러 항목이 있으므로 모두 함께 쉽게 볼 수 있도록 **ClientRequestId** 필드에서 그룹화하려 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-369">In the client log, there are several entries for each client request ID, so you may want to group them on the **ClientRequestId** field to make it easier to see them all together.</span></span> <span data-ttu-id="8ebb1-370">아래 그림은 지정된 클라이언트 요청 ID에 대한 클라이언트 로그의 모든 메시지를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-370">The picture below shows all of the messages in the client log for the specified client request ID.</span></span>

![404 오류를 표시하는 클라이언트 로그 ](./media/storage-e2e-troubleshooting/client-log-analysis-grid1.png)

<span data-ttu-id="8ebb1-372">이러한 두 탭에서 보기 레이아웃에 표시된 데이터를 사용하여 요청 데이터를 분석해 오류를 일으킨 원인을 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-372">Using the data shown in the view layouts in these two tabs, you can analyze the request data to determine what may have caused the error.</span></span> <span data-ttu-id="8ebb1-373">또한, 이보다 앞선 요청을 살펴보고 이전 이벤트가 404 오류를 발생시킬 수 있었는지 확인할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-373">You can also look at requests that preceded this one to see if a previous event may have led to the 404 error.</span></span> <span data-ttu-id="8ebb1-374">예를 들어 이 클라이언트 요청 ID에 앞선 클라이언트 로그 항목을 검토하여 Blob이 삭제될 수 있었는지 여부 또는 오류가 컨테이너 또는 Blob에서 CreateIfNotExists API를 호출하는 클라이언트 응용 프로그램 때문인지를 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-374">For example, you can review the client log entries preceding this client request ID to determine whether the blob may have been deleted, or if the error was due to the client application calling a CreateIfNotExists API on a container or blob.</span></span> <span data-ttu-id="8ebb1-375">클라이언트 로그의 **설명** 필드에서 Blob의 주소를 찾을 수 있습니다. 서버 및 네트워크 추적 로그에서 이 정보는 **요약** 필드에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-375">In the client log, you can find the blob's address in the **Description** field; in the server and network trace logs, this information appears in the **Summary** field.</span></span>

<span data-ttu-id="8ebb1-376">404 오류를 생성한 Blob의 주소를 알고 있다면 추가로 조사할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-376">Once you know the address of the blob that yielded the 404 error, you can investigate further.</span></span> <span data-ttu-id="8ebb1-377">동일한 Blob에서 작업과 연결된 다른 메시지의 로그 항목을 검색하는 경우 클라이언트가 이전에 엔터티를 삭제했는지 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-377">If you search the log entries for other messages associated with operations on the same blob, you can check whether the client previously deleted the entity.</span></span>

## <a name="analyze-other-types-of-storage-errors"></a><span data-ttu-id="8ebb1-378">다른 유형의 저장소 오류 분석</span><span class="sxs-lookup"><span data-stu-id="8ebb1-378">Analyze other types of storage errors</span></span>
<span data-ttu-id="8ebb1-379">Message Analyzer를 사용하여 로그 데이터를 분석하는 데 익숙해졌으므로 보기 레이아웃, 색 규칙 및 검색/필터링을 사용하여 다른 유형의 오류를 분석할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-379">Now that you are familiar with using Message Analyzer to analyze your log data, you can analyze other types of errors using view layouts, color rules, and searching/filtering.</span></span> <span data-ttu-id="8ebb1-380">다음 표는 발생할 수 있는 일부 문제 및 찾는데 사용할 수 있는 필터 조건을 나열합니다.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-380">The tables below lists some issues you may encounter and the filter criteria you can use to locate them.</span></span> <span data-ttu-id="8ebb1-381">필터 및 Message Analyzer 필터링 언어를 생성하는 방법에 대한 자세한 내용은 [메시지 데이터 필터링(영문)](http://technet.microsoft.com/library/jj819365.aspx)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-381">For more information on constructing filters and the Message Analyzer filtering language, see [Filtering Message Data](http://technet.microsoft.com/library/jj819365.aspx).</span></span>

| <span data-ttu-id="8ebb1-382">조사하려면...</span><span class="sxs-lookup"><span data-stu-id="8ebb1-382">To Investigate…</span></span> | <span data-ttu-id="8ebb1-383">필터 식 사용...</span><span class="sxs-lookup"><span data-stu-id="8ebb1-383">Use Filter Expression…</span></span> | <span data-ttu-id="8ebb1-384">식을 로그(클라이언트, 서버, 네트워크, 모두)에 적용</span><span class="sxs-lookup"><span data-stu-id="8ebb1-384">Expression Applies to Log (Client, Server,   Network, All)</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8ebb1-385">큐에서 메시지 배달의 예기치 않은 지연</span><span class="sxs-lookup"><span data-stu-id="8ebb1-385">Unexpected delays in message delivery on a queue</span></span> |<span data-ttu-id="8ebb1-386">AzureStorageClientDotNetV4.Description은 "다시 시도 중 작업이 실패 했습니다."를 포함</span><span class="sxs-lookup"><span data-stu-id="8ebb1-386">AzureStorageClientDotNetV4.Description   contains "Retrying failed operation."</span></span> |<span data-ttu-id="8ebb1-387">클라이언트</span><span class="sxs-lookup"><span data-stu-id="8ebb1-387">Client</span></span> |
| <span data-ttu-id="8ebb1-388">PercentThrottlingError에서 HTTP 증가</span><span class="sxs-lookup"><span data-stu-id="8ebb1-388">HTTP Increase in PercentThrottlingError</span></span> |<span data-ttu-id="8ebb1-389">HTTP.Response.StatusCode   == 500 &#124;&#124; HTTP.Response.StatusCode == 503</span><span class="sxs-lookup"><span data-stu-id="8ebb1-389">HTTP.Response.StatusCode   == 500 &#124;&#124; HTTP.Response.StatusCode == 503</span></span> |<span data-ttu-id="8ebb1-390">네트워크</span><span class="sxs-lookup"><span data-stu-id="8ebb1-390">Network</span></span> |
| <span data-ttu-id="8ebb1-391">PercentTimeoutError의 증가</span><span class="sxs-lookup"><span data-stu-id="8ebb1-391">Increase in PercentTimeoutError</span></span> |<span data-ttu-id="8ebb1-392">HTTP.Response.StatusCode   == 500</span><span class="sxs-lookup"><span data-stu-id="8ebb1-392">HTTP.Response.StatusCode   == 500</span></span> |<span data-ttu-id="8ebb1-393">네트워크</span><span class="sxs-lookup"><span data-stu-id="8ebb1-393">Network</span></span> |
| <span data-ttu-id="8ebb1-394">PercentTimeoutError의 증가(모두)</span><span class="sxs-lookup"><span data-stu-id="8ebb1-394">Increase in PercentTimeoutError (all)</span></span> |<span data-ttu-id="8ebb1-395">*StatusCode   == 500</span><span class="sxs-lookup"><span data-stu-id="8ebb1-395">*StatusCode   == 500</span></span> |<span data-ttu-id="8ebb1-396">모두</span><span class="sxs-lookup"><span data-stu-id="8ebb1-396">All</span></span> |
| <span data-ttu-id="8ebb1-397">PercentNetworkError의 증가</span><span class="sxs-lookup"><span data-stu-id="8ebb1-397">Increase in PercentNetworkError</span></span> |<span data-ttu-id="8ebb1-398">AzureStorageClientDotNetV4.EventLogEntry.Level   < 2</span><span class="sxs-lookup"><span data-stu-id="8ebb1-398">AzureStorageClientDotNetV4.EventLogEntry.Level   < 2</span></span> |<span data-ttu-id="8ebb1-399">클라이언트</span><span class="sxs-lookup"><span data-stu-id="8ebb1-399">Client</span></span> |
| <span data-ttu-id="8ebb1-400">HTTP 403(사용할 수 없음) 메시지</span><span class="sxs-lookup"><span data-stu-id="8ebb1-400">HTTP 403 (Forbidden) messages</span></span> |<span data-ttu-id="8ebb1-401">HTTP.Response.StatusCode   == 403</span><span class="sxs-lookup"><span data-stu-id="8ebb1-401">HTTP.Response.StatusCode   == 403</span></span> |<span data-ttu-id="8ebb1-402">네트워크</span><span class="sxs-lookup"><span data-stu-id="8ebb1-402">Network</span></span> |
| <span data-ttu-id="8ebb1-403">HTTP 404(찾을 수 없음) 메시지</span><span class="sxs-lookup"><span data-stu-id="8ebb1-403">HTTP 404 (Not found) messages</span></span> |<span data-ttu-id="8ebb1-404">HTTP.Response.StatusCode   == 404</span><span class="sxs-lookup"><span data-stu-id="8ebb1-404">HTTP.Response.StatusCode   == 404</span></span> |<span data-ttu-id="8ebb1-405">네트워크</span><span class="sxs-lookup"><span data-stu-id="8ebb1-405">Network</span></span> |
| <span data-ttu-id="8ebb1-406">404(모두)</span><span class="sxs-lookup"><span data-stu-id="8ebb1-406">404 (all)</span></span> |<span data-ttu-id="8ebb1-407">*StatusCode   == 404</span><span class="sxs-lookup"><span data-stu-id="8ebb1-407">*StatusCode   == 404</span></span> |<span data-ttu-id="8ebb1-408">모두</span><span class="sxs-lookup"><span data-stu-id="8ebb1-408">All</span></span> |
| <span data-ttu-id="8ebb1-409">SAS(공유 액세스 서명) 권한 부여 문제</span><span class="sxs-lookup"><span data-stu-id="8ebb1-409">Shared Access Signature (SAS) authorization issue</span></span> |<span data-ttu-id="8ebb1-410">AzureStorageLog.RequestStatus ==  "SASAuthorizationError"</span><span class="sxs-lookup"><span data-stu-id="8ebb1-410">AzureStorageLog.RequestStatus ==  "SASAuthorizationError"</span></span> |<span data-ttu-id="8ebb1-411">네트워크</span><span class="sxs-lookup"><span data-stu-id="8ebb1-411">Network</span></span> |
| <span data-ttu-id="8ebb1-412">HTTP 409(충돌) 메시지</span><span class="sxs-lookup"><span data-stu-id="8ebb1-412">HTTP 409 (Conflict) messages</span></span> |<span data-ttu-id="8ebb1-413">HTTP.Response.StatusCode   == 409</span><span class="sxs-lookup"><span data-stu-id="8ebb1-413">HTTP.Response.StatusCode   == 409</span></span> |<span data-ttu-id="8ebb1-414">네트워크</span><span class="sxs-lookup"><span data-stu-id="8ebb1-414">Network</span></span> |
| <span data-ttu-id="8ebb1-415">409(모두)</span><span class="sxs-lookup"><span data-stu-id="8ebb1-415">409 (all)</span></span> |<span data-ttu-id="8ebb1-416">*StatusCode   == 409</span><span class="sxs-lookup"><span data-stu-id="8ebb1-416">*StatusCode   == 409</span></span> |<span data-ttu-id="8ebb1-417">모두</span><span class="sxs-lookup"><span data-stu-id="8ebb1-417">All</span></span> |
| <span data-ttu-id="8ebb1-418">PercentSuccess가 낮게 표시되거나 분석 로그 항목에 트랜잭션 상태가 ClientOtherErrors 상태인 작업이 있음</span><span class="sxs-lookup"><span data-stu-id="8ebb1-418">Low PercentSuccess or analytics log entries have   operations with transaction status of ClientOtherErrors</span></span> |<span data-ttu-id="8ebb1-419">AzureStorageLog.RequestStatus ==   "ClientOtherError"</span><span class="sxs-lookup"><span data-stu-id="8ebb1-419">AzureStorageLog.RequestStatus ==   "ClientOtherError"</span></span> |<span data-ttu-id="8ebb1-420">서버</span><span class="sxs-lookup"><span data-stu-id="8ebb1-420">Server</span></span> |
| <span data-ttu-id="8ebb1-421">Nagle 경고</span><span class="sxs-lookup"><span data-stu-id="8ebb1-421">Nagle   Warning</span></span> |<span data-ttu-id="8ebb1-422">((AzureStorageLog.EndToEndLatencyMS   - AzureStorageLog.ServerLatencyMS) > (AzureStorageLog.ServerLatencyMS *   1.5)) 및 (AzureStorageLog.RequestPacketSize <1460) 및 (AzureStorageLog.EndToEndLatencyMS -   AzureStorageLog.ServerLatencyMS >= 200)</span><span class="sxs-lookup"><span data-stu-id="8ebb1-422">((AzureStorageLog.EndToEndLatencyMS   - AzureStorageLog.ServerLatencyMS) > (AzureStorageLog.ServerLatencyMS *   1.5)) and (AzureStorageLog.RequestPacketSize <1460) and (AzureStorageLog.EndToEndLatencyMS -   AzureStorageLog.ServerLatencyMS >= 200)</span></span> |<span data-ttu-id="8ebb1-423">서버</span><span class="sxs-lookup"><span data-stu-id="8ebb1-423">Server</span></span> |
| <span data-ttu-id="8ebb1-424">서버 및 네트워크 로그의 시간 범위</span><span class="sxs-lookup"><span data-stu-id="8ebb1-424">Range of   time in Server and Network logs</span></span> |<span data-ttu-id="8ebb1-425">#Timestamp   >= 2014-10-20T16:36:38 and #Timestamp <= 2014-10-20T16:36:39</span><span class="sxs-lookup"><span data-stu-id="8ebb1-425">#Timestamp   >= 2014-10-20T16:36:38 and #Timestamp <= 2014-10-20T16:36:39</span></span> |<span data-ttu-id="8ebb1-426">서버, 네트워크</span><span class="sxs-lookup"><span data-stu-id="8ebb1-426">Server, Network</span></span> |
| <span data-ttu-id="8ebb1-427">서버 로그의 시간 범위</span><span class="sxs-lookup"><span data-stu-id="8ebb1-427">Range of   time in Server logs</span></span> |<span data-ttu-id="8ebb1-428">AzureStorageLog.Timestamp   >= 2014-10-20T16:36:38 및 AzureStorageLog.Timestamp <=   2014-10-20T16:36:39</span><span class="sxs-lookup"><span data-stu-id="8ebb1-428">AzureStorageLog.Timestamp   >= 2014-10-20T16:36:38 and AzureStorageLog.Timestamp <=   2014-10-20T16:36:39</span></span> |<span data-ttu-id="8ebb1-429">서버</span><span class="sxs-lookup"><span data-stu-id="8ebb1-429">Server</span></span> |

## <a name="next-steps"></a><span data-ttu-id="8ebb1-430">다음 단계</span><span class="sxs-lookup"><span data-stu-id="8ebb1-430">Next steps</span></span>
<span data-ttu-id="8ebb1-431">Azure 저장소의 종단 간 시나리오 문제 해결에 대한 자세한 내용은 다음 리소스를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8ebb1-431">For more information about troubleshooting end-to-end scenarios in Azure Storage, see these resources:</span></span>

* [<span data-ttu-id="8ebb1-432">Microsoft Azure 저장소 모니터링, 진단 및 문제 해결</span><span class="sxs-lookup"><span data-stu-id="8ebb1-432">Monitor, diagnose, and troubleshoot Microsoft Azure Storage</span></span>](storage-monitoring-diagnosing-troubleshooting.md)
* [<span data-ttu-id="8ebb1-433">저장소 분석</span><span class="sxs-lookup"><span data-stu-id="8ebb1-433">Storage Analytics</span></span>](http://msdn.microsoft.com/library/azure/hh343270.aspx)
* [<span data-ttu-id="8ebb1-434">Azure Portal에서 저장소 계정 모니터링</span><span class="sxs-lookup"><span data-stu-id="8ebb1-434">Monitor a storage account in the Azure portal</span></span>](storage-monitor-storage-account.md)
* [<span data-ttu-id="8ebb1-435">AzCopy 명령줄 유틸리티로 데이터 전송</span><span class="sxs-lookup"><span data-stu-id="8ebb1-435">Transfer data with the AzCopy Command-Line Utility</span></span>](storage-use-azcopy.md)
* [<span data-ttu-id="8ebb1-436">Microsoft Message Analyzer 운영 가이드</span><span class="sxs-lookup"><span data-stu-id="8ebb1-436">Microsoft Message Analyzer Operating Guide</span></span>](http://technet.microsoft.com/library/jj649776.aspx)
