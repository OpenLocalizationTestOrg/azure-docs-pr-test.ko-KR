---
title: "응용 프로그램 업그레이드: 데이터 직렬화 | Microsoft Docs"
description: "데이터 직렬화 모범 사례 및 응용 프로그램 업그레이드 배포에 미치는 영향"
services: service-fabric
documentationcenter: .net
author: vturecek
manager: timlt
editor: 
ms.assetid: a5f36366-a2ab-4ae3-bb08-bc2f9533bc5a
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/29/2017
ms.author: vturecek
ms.openlocfilehash: 6aa3ac7842df4657fca7f6b4264e1c6fe52dc0c6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/11/2017
---
# <a name="how-data-serialization-affects-an-application-upgrade"></a><span data-ttu-id="78bce-103">데이터 serialization이 응용 프로그램 업그레이드에 미치는 영향</span><span class="sxs-lookup"><span data-stu-id="78bce-103">How data serialization affects an application upgrade</span></span>
<span data-ttu-id="78bce-104">[롤링 응용 프로그램 업그레이드](service-fabric-application-upgrade.md)에서는 한번에 하나의 업그레이드 도메인에서 노드의 하위 집합에 업그레이드가 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-104">In a [rolling application upgrade](service-fabric-application-upgrade.md), the upgrade is applied to a subset of nodes, one upgrade domain at a time.</span></span> <span data-ttu-id="78bce-105">이 과정에서 일부 업그레이드 도메인은 응용 프로그램의 최신 버전에, 일부 업그레이드 도메인은 응용 프로그램의 이전 버전에 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-105">During this process, some upgrade domains are on the newer version of your application, and some upgrade domains are on the older version of your application.</span></span> <span data-ttu-id="78bce-106">롤아웃 동안 최신 버전의 응용 프로그램에서 이전 버전의 데이터를 읽을 수 있고 이전 버전의 응용 프로그램에서 최신 버전의 데이터를 읽을 수 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-106">During the rollout, the new version of your application must be able to read the old version of your data, and the old version of your application must be able to read the new version of your data.</span></span> <span data-ttu-id="78bce-107">데이터 서식이 최신 버전과 이전 버전에서 호환되지 않으면 업그레이드가 실패하거나 데이터가 손실되거나 손상될 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-107">If the data format is not forward and backward compatible, the upgrade may fail, or worse, data may be lost or corrupted.</span></span> <span data-ttu-id="78bce-108">이 문서에서는 데이터 서식을 구성하는 요소에 대해 설명하며 데이터가 상위 버전 및 하위 버전과 호환되도록 하는 모범 사례를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-108">This article discusses what constitutes your data format and offers best practices for ensuring that your data is forward and backward compatible.</span></span>

## <a name="what-makes-up-your-data-format"></a><span data-ttu-id="78bce-109">데이터 형식을 구성하는 요소</span><span class="sxs-lookup"><span data-stu-id="78bce-109">What makes up your data format?</span></span>
<span data-ttu-id="78bce-110">Azure 서비스 패브릭에서 유지 및 복제되는 데이터는 C# 클래스에서 제공됩니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-110">In Azure Service Fabric, the data that is persisted and replicated comes from your C# classes.</span></span> <span data-ttu-id="78bce-111">[신뢰할 수 있는 컬렉션](service-fabric-reliable-services-reliable-collections.md)을 사용하는 응용 프로그램의 경우 데이터는 신뢰할 수 있는 사전 및 큐의 개체입니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-111">For applications that use [Reliable Collections](service-fabric-reliable-services-reliable-collections.md), that data is the objects in the reliable dictionaries and queues.</span></span> <span data-ttu-id="78bce-112">[Reliable Actors](service-fabric-reliable-actors-introduction.md)를 사용하는 응용 프로그램의 경우 행위자에 대한 백업 상태입니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-112">For applications that use [Reliable Actors](service-fabric-reliable-actors-introduction.md), that is the backing state for the actor.</span></span> <span data-ttu-id="78bce-113">이러한 C# 클래스를 유지 및 복제하려면 직렬화해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-113">These C# classes must be serializable to be persisted and replicated.</span></span> <span data-ttu-id="78bce-114">따라서 직렬화된 필드 및 속성을 통해 데이터 형식과 직렬화 방법을 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-114">Therefore, the data format is defined by the fields and properties that are serialized, as well as how they are serialized.</span></span> <span data-ttu-id="78bce-115">예를 들어 `IReliableDictionary<int, MyClass>`에서 데이터는 직렬화된 `int` 및 직렬화된 `MyClass`입니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-115">For example, in an `IReliableDictionary<int, MyClass>` the data is a serialized `int` and a serialized `MyClass`.</span></span>

### <a name="code-changes-that-result-in-a-data-format-change"></a><span data-ttu-id="78bce-116">데이터 형식 변경이 발생하는 코드 변경</span><span class="sxs-lookup"><span data-stu-id="78bce-116">Code changes that result in a data format change</span></span>
<span data-ttu-id="78bce-117">데이터 형식은 C# 클래스에 의해 결정되기 때문에 클래스를 변경하면 데이터 형식이 변경될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-117">Since the data format is determined by C# classes, changes to the classes may cause a data format change.</span></span> <span data-ttu-id="78bce-118">롤링 업그레이드에서 데이터 서식 변경을 처리할 수 있도록 주의를 기울여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-118">Care must be taken to ensure that a rolling upgrade can handle the data format change.</span></span> <span data-ttu-id="78bce-119">다음은 데이터 형식이 변경될 수 있는 예입니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-119">Examples that may cause data format changes:</span></span>

* <span data-ttu-id="78bce-120">필드/속성 추가 또는 제거</span><span class="sxs-lookup"><span data-stu-id="78bce-120">Adding or removing fields or properties</span></span>
* <span data-ttu-id="78bce-121">필드 또는 속성의 이름 변경</span><span class="sxs-lookup"><span data-stu-id="78bce-121">Renaming fields or properties</span></span>
* <span data-ttu-id="78bce-122">필드 또는 속성의 유형 변경</span><span class="sxs-lookup"><span data-stu-id="78bce-122">Changing the types of fields or properties</span></span>
* <span data-ttu-id="78bce-123">클래스 이름 또는 네임스페이스 변경</span><span class="sxs-lookup"><span data-stu-id="78bce-123">Changing the class name or namespace</span></span>

### <a name="data-contract-as-the-default-serializer"></a><span data-ttu-id="78bce-124">기본 직렬 변환기인 데이터 계약</span><span class="sxs-lookup"><span data-stu-id="78bce-124">Data Contract as the default serializer</span></span>
<span data-ttu-id="78bce-125">직렬 변환기는 일반적으로 데이터가 이전 버전이든 *최신* 버전이든 데이터를 읽고 현재 버전으로 역직렬화하는 역할을 담당합니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-125">The serializer is generally responsible for reading the data and deserializing it into the current version, even if the data is in an older or *newer* version.</span></span> <span data-ttu-id="78bce-126">기본 직렬 변환기는 버전 관리 규칙이 잘 정의된 [데이터 계약 직렬 변환기](https://msdn.microsoft.com/library/ms733127.aspx)입니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-126">The default serializer is the [Data Contract serializer](https://msdn.microsoft.com/library/ms733127.aspx), which has well-defined versioning rules.</span></span> <span data-ttu-id="78bce-127">신뢰할 수 있는 컬렉션을 사용하면 직렬 변환기를 재정의할 수 있지만 Reliable Actors를 사용하면 직렬 변환기를 재정의할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-127">Reliable Collections allow the serializer to be overridden, but Reliable Actors currently do not.</span></span> <span data-ttu-id="78bce-128">데이터 직렬 변환기는 롤링 업그레이드에서 중요한 역할을 합니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-128">The data serializer plays an important role in enabling rolling upgrades.</span></span> <span data-ttu-id="78bce-129">데이터 계약 직렬 변환기는 서비스 패브릭 응용 프로그램에 권장되는 직렬 변환기입니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-129">The Data Contract serializer is the serializer that we recommend for Service Fabric applications.</span></span>

## <a name="how-the-data-format-affects-a-rolling-upgrade"></a><span data-ttu-id="78bce-130">데이터 서식이 롤링 업그레이드에 미치는 영향</span><span class="sxs-lookup"><span data-stu-id="78bce-130">How the data format affects a rolling upgrade</span></span>
<span data-ttu-id="78bce-131">롤링 업그레이드가 진행되는 동안 직렬 변환기가 이전 또는 *최신* 버전의 데이터와 만나는 두 가지 시나리오가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-131">During a rolling upgrade, there are two main scenarios where the serializer may encounter an older or *newer* version of your data:</span></span>

1. <span data-ttu-id="78bce-132">노드가 업그레이드되고 백업이 시작된 후 새로운 직렬 변환기가 이전 버전에서 디스크에 보관하던 데이터를 로드합니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-132">After a node is upgraded and starts back up, the new serializer will load the data that was persisted to disk by the old version.</span></span>
2. <span data-ttu-id="78bce-133">롤링 업그레이드가 진행되는 동안 클러스터에 이전 버전 코드와 새 버전 코드가 동시에 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-133">During the rolling upgrade, the cluster will contain a mix of the old and new versions of your code.</span></span> <span data-ttu-id="78bce-134">복제본이 서로 다른 업그레이드 도메인에 있을 수 있고 복제본은 서로 간에 데이터를 보내기 때문에 신규 및/또는 구 데이터 버전이 직렬 변환기의 신규 및/또는 구 버전과 만날 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-134">Since replicas may be placed in different upgrade domains, and replicas send data to each other, the new and/or old version of your data may be encountered by the new and/or old version of your serializer.</span></span>

> [!NOTE]
> <span data-ttu-id="78bce-135">여기서 "최신 버전" 및 "이전 버전"이란 실행 중인 코드의 버전을 말합니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-135">The "new version" and "old version" here refer to the version of your code that is running.</span></span> <span data-ttu-id="78bce-136">"최신 직렬 변환기"는 최신 버전의 응용 프로그램에서 실행되는 직렬 변환기 코드를 말합니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-136">The "new serializer" refers to the serializer code that is executing in the new version of your application.</span></span> <span data-ttu-id="78bce-137">"최신 데이터"는 최신 버전의 응용 프로그램에서 직렬화된 C# 클래스를 말합니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-137">The "new data" refers to the serialized C# class from the new version of your application.</span></span>
> 
> 

<span data-ttu-id="78bce-138">코드와 데이터 형식의 두 버전 모두 앞뒤로 호환되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-138">The two versions of code and data format must be both forward and backward compatible.</span></span> <span data-ttu-id="78bce-139">버전 간에 호환되지 않을 경우 롤링 업그레이드가 실패하거나 데이터가 손실될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-139">If they are not compatible, the rolling upgrade may fail or data may be lost.</span></span> <span data-ttu-id="78bce-140">다른 버전을 만났을 때 코드 또는 직렬 변환기에서 예외를 throw하거나 실패할 경우 롤링 업그레이드가 실패할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-140">The rolling upgrade may fail because the code or serializer may throw exceptions or a fault when it encounters the other version.</span></span> <span data-ttu-id="78bce-141">예를 들어 새 속성이 추가되었지만 이전 직렬 변환기가 역직렬화 과정에서 해당 속성을 삭제할 경우 데이터가 손실될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-141">Data may be lost if, for example, a new property was added but the old serializer discards it during deserialization.</span></span>

<span data-ttu-id="78bce-142">데이터 계약은 데이터 호환성을 보장하기 위해 권장되는 솔루션입니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-142">Data Contract is the recommended solution for ensuring that your data is compatible.</span></span> <span data-ttu-id="78bce-143">데이터 계약에는 필드의 추가, 제거 및 변경에 대해 잘 정의된 버전 관리 규칙이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-143">It has well-defined versioning rules for adding, removing, and changing fields.</span></span> <span data-ttu-id="78bce-144">또한 알 수 없는 필드를 처리하는 기능, serialization 및 역직렬화 프로세스에 연결하는 기능 및 클래스 상속을 처리하는 기능을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-144">It also has support for dealing with unknown fields, hooking into the serialization and deserialization process, and dealing with class inheritance.</span></span> <span data-ttu-id="78bce-145">자세한 내용은 [데이터 계약 사용](https://msdn.microsoft.com/library/ms733127.aspx)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="78bce-145">For more information, see [Using Data Contract](https://msdn.microsoft.com/library/ms733127.aspx).</span></span>

## <a name="next-steps"></a><span data-ttu-id="78bce-146">다음 단계</span><span class="sxs-lookup"><span data-stu-id="78bce-146">Next steps</span></span>
<span data-ttu-id="78bce-147">[Visual Studio를 사용하여 응용 프로그램 업그레이드](service-fabric-application-upgrade-tutorial.md) 에서는 Visual Studio를 사용하여 응용 프로그램 업그레이드를 진행하는 방법을 안내합니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-147">[Upgrading your Application Using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="78bce-148">[Powershell을 사용하여 응용 프로그램 업그레이드](service-fabric-application-upgrade-tutorial-powershell.md) 에서는 PowerShell을 사용하여 응용 프로그램 업그레이드를 진행하는 방법을 안내합니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-148">[Upgrading your Application Using Powershell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="78bce-149">[업그레이드 매개 변수](service-fabric-application-upgrade-parameters.md)를 사용하여 응용 프로그램 업그레이드 방법을 제어합니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-149">Control how your application upgrades by using [Upgrade Parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="78bce-150">[고급 항목](service-fabric-application-upgrade-advanced.md)을 참조하여 응용 프로그램을 업그레이드하는 동안 고급 기능을 사용하는 방법에 대해 알아봅니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-150">Learn how to use advanced functionality while upgrading your application by referring to [Advanced Topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="78bce-151">[응용 프로그램 업그레이드 문제 해결 ](service-fabric-application-upgrade-troubleshooting.md)의 단계를 참조하여 응용 프로그램 업그레이드 중 발생하는 일반적인 문제를 해결합니다.</span><span class="sxs-lookup"><span data-stu-id="78bce-151">Fix common problems in application upgrades by referring to the steps in [Troubleshooting Application Upgrades ](service-fabric-application-upgrade-troubleshooting.md).</span></span>

