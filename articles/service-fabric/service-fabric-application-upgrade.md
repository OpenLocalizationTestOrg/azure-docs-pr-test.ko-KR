---
title: "Service Fabric 응용 프로그램 업그레이드 | Microsoft Docs"
description: "이 문서에서는 업그레이드 모드 선택 및 상태 확인 수행 등을 포함하여 서비스 패브릭 응용 프로그램 업그레이드를 소개합니다."
services: service-fabric
documentationcenter: .net
author: mani-ramaswamy
manager: timlt
editor: 
ms.assetid: 803c9c63-373a-4d6a-8ef2-ea97e16e88dd
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 8/9/2017
ms.author: subramar
ms.openlocfilehash: 4c2752bee8e9a859b23dbf47662d15798b551bb5
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/18/2017
---
# <a name="service-fabric-application-upgrade"></a><span data-ttu-id="e04ad-103">서비스 패브릭 응용 프로그램 업그레이드</span><span class="sxs-lookup"><span data-stu-id="e04ad-103">Service Fabric application upgrade</span></span>
<span data-ttu-id="e04ad-104">Azure 서비스 패브릭 응용 프로그램은 서비스의 컬렉션입니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-104">An Azure Service Fabric application is a collection of services.</span></span> <span data-ttu-id="e04ad-105">업그레이드가 진행되는 동안 서비스 패브릭은 새로운 [응용 프로그램 매니페스트](service-fabric-application-model.md#describe-an-application) 를 이전 버전과 비교하여 응용 프로그램의 어떤 서비스를 업데이트해야 하는지 결정합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-105">During an upgrade, Service Fabric compares the new [application manifest](service-fabric-application-model.md#describe-an-application) with the previous version and determines which services in the application require updates.</span></span> <span data-ttu-id="e04ad-106">서비스 패브릭은 이전 버전의 버전 번호를 가진 서비스 매니페스트의 버전 번호를 비교합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-106">Service Fabric compares the version numbers in the service manifests with the version numbers in the previous version.</span></span> <span data-ttu-id="e04ad-107">서비스가 변경되지 않으면 해당 서비스가 업그레이드되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-107">If a service has not changed, that service is not upgraded.</span></span>

## <a name="rolling-upgrades-overview"></a><span data-ttu-id="e04ad-108">롤링 업그레이드 개요</span><span class="sxs-lookup"><span data-stu-id="e04ad-108">Rolling upgrades overview</span></span>
<span data-ttu-id="e04ad-109">롤링 응용 프로그램 업그레이드에서 업그레이드는 여러 단계로 수행됩니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-109">In a rolling application upgrade, the upgrade is performed in stages.</span></span> <span data-ttu-id="e04ad-110">각 단계에서 업데이트 도메인이라고 하는 클러스터의 노드 하위 집합에 업그레이드가 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-110">At each stage, the upgrade is applied to a subset of nodes in the cluster, called an update domain.</span></span> <span data-ttu-id="e04ad-111">결과적으로, 전체 업그레이드 과정에서 응용 프로그램 가용성이 유지됩니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-111">As a result, the application remains available throughout the upgrade.</span></span> <span data-ttu-id="e04ad-112">업그레이드가 진행되는 동안 클러스터에 이전 버전과 새 버전이 동시에 포함될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-112">During the upgrade, the cluster may contain a mix of the old and new versions.</span></span>

<span data-ttu-id="e04ad-113">이러한 이유로 두 버전이 호환되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-113">For that reason, the two versions must be forward and backward compatible.</span></span> <span data-ttu-id="e04ad-114">호환되지 않을 경우 응용 프로그램 관리자는 가용성을 유지하려면 다단계 업그레이드를 준비해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-114">If they are not compatible, the application administrator is responsible for staging a multiple-phase upgrade to maintain availability.</span></span> <span data-ttu-id="e04ad-115">다단계 업그레이드에서 첫 번째 단계는 이전 버전과 호환되는 응용 프로그램의 중간 버전으로 업그레이드하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-115">In a multiple-phase upgrade, the first step is upgrading to an intermediate version of the application that is compatible with the previous version.</span></span> <span data-ttu-id="e04ad-116">두 번째 단계는 최종 버전을 업그레이드하는 것입니다. 이러한 최종 버전은 업데이트 전 버전과는 호환되지 않지만 중간 버전과는 호환됩니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-116">The second step is to upgrade the final version that breaks compatibility with the pre-update version, but is compatible with the intermediate version.</span></span>

<span data-ttu-id="e04ad-117">업데이트 도메인은 사용자가 클러스터를 구성할 때 클러스터 매니페스트에 지정됩니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-117">Update domains are specified in the cluster manifest when you configure the cluster.</span></span> <span data-ttu-id="e04ad-118">업데이트 도메인은 업데이트를 특정 순서로 받지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-118">Update domains do not receive updates in a particular order.</span></span> <span data-ttu-id="e04ad-119">업데이트 도메인은 응용 프로그램에 대한 배포의 논리 단위입니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-119">An update domain is a logical unit of deployment for an application.</span></span> <span data-ttu-id="e04ad-120">업데이트 도메인을 사용하면 서비스에 업그레이드가 진행되는 동안 고가용성을 유지합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-120">Update domains allow the services to remain at high availability during an upgrade.</span></span>

<span data-ttu-id="e04ad-121">클러스터의 모든 노드에 업그레이드가 적용되는 경우 비롤링 업그레이드도 가능합니다. 응용 프로그램에 업데이트 도메인이 하나뿐인 경우가 이에 해당합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-121">Non-rolling upgrades are possible if the upgrade is applied to all nodes in the cluster, which is the case when the application has only one update domain.</span></span> <span data-ttu-id="e04ad-122">업그레이드가 진행되는 동안 서비스 제공이 중지되기 때문에 권장하지 않는 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-122">This approach is not recommended, since the service goes down and isn't available at the time of upgrade.</span></span> <span data-ttu-id="e04ad-123">또한 업데이트 도메인 하나로 클러스터를 설정할 경우 Azure에서 어떤 보증도 제공하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-123">Additionally, Azure doesn't provide any guarantees when a cluster is set up with only one update domain.</span></span>

## <a name="health-checks-during-upgrades"></a><span data-ttu-id="e04ad-124">업그레이드 동안 상태 검사</span><span class="sxs-lookup"><span data-stu-id="e04ad-124">Health checks during upgrades</span></span>
<span data-ttu-id="e04ad-125">업그레이드에 대해 상태 정책을 설정해야 합니다. 설정하지 않으면 기본값이 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-125">For an upgrade, health policies have to be set (or default values may be used).</span></span> <span data-ttu-id="e04ad-126">모든 업데이트 도메인이 지정된 시간 제한 내에 업그레이드되고 모든 업데이트 도메인이 정상 상태로 보이면 업그레이드에 성공했다고 합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-126">An upgrade is termed successful when all update domains are upgraded within the specified time-outs, and when all update domains are deemed healthy.</span></span>  <span data-ttu-id="e04ad-127">정상 업데이트 도메인이란 업데이트 도메인이 상태 정책에 지정된 모든 상태 검사를 통과했다는 의미입니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-127">A healthy update domain means that the update domain passed all the health checks specified in the health policy.</span></span> <span data-ttu-id="e04ad-128">예를 들어 상태 정책에 따라 응용 프로그램 인스턴스의 모든 서비스가 *정상*이어야 하고, 상태는 Service Fabric에서 정의됩니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-128">For example, a health policy may mandate that all services within an application instance must be *healthy*, as health is defined by Service Fabric.</span></span>

<span data-ttu-id="e04ad-129">업그레이드가 진행되는 동안 서비스 패브릭에서 수행하는 상태 정책 및 상태 검사는 서비스 및 응용 프로그램을 구분하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-129">Health policies and checks during upgrade by Service Fabric are service and application agnostic.</span></span> <span data-ttu-id="e04ad-130">즉, 서비스별 테스트를 수행하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-130">That is, no service-specific tests are done.</span></span>  <span data-ttu-id="e04ad-131">예를 들어 서비스에는 처리량 요구 사항이 있을 수 있지만 서비스 패브릭에는 처리량을 확인하기 위한 정보가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-131">For example, your service might have a throughput requirement, but Service Fabric does not have the information to check throughput.</span></span> <span data-ttu-id="e04ad-132">수행되는 검사는 [상태 문서](service-fabric-health-introduction.md) 를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="e04ad-132">Refer to the [health articles](service-fabric-health-introduction.md) for the checks that are performed.</span></span> <span data-ttu-id="e04ad-133">업그레이드 중에 발생하는 확인은 응용 프로그램 패키지가 올바르게 복사되었는지, 인스턴스가 시작되었는지 등과 같은 여부에 대한 테스트를 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-133">The checks that happen during an upgrade include tests for whether the application package was copied correctly, whether the instance was started, and so on.</span></span>

<span data-ttu-id="e04ad-134">응용 프로그램 상태는 응용 프로그램의 자식 엔터티를 집계한 것입니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-134">The application health is an aggregation of the child entities of the application.</span></span> <span data-ttu-id="e04ad-135">간단히 말해서 서비스 패브릭에서는 응용 프로그램에 대해 보고되는 상태를 통해 응용 프로그램의 상태를 평가합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-135">In short, Service Fabric evaluates the health of the application through the health that is reported on the application.</span></span> <span data-ttu-id="e04ad-136">또한 응용 프로그램에 대한 모든 서비스의 상태 이러한 방식으로 평가합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-136">It also evaluates the health of all the services for the application this way.</span></span> <span data-ttu-id="e04ad-137">서비스 패브릭은 서비스 복제본과 같은 자식의 상태를 집계하여 보다 구체적으로 응용 프로그램 서비스의 상태를 평가합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-137">Service Fabric further evaluates the health of the application services by aggregating the health of their children, such as the service replica.</span></span> <span data-ttu-id="e04ad-138">응용 프로그램 상태 정책이 충족되면 업그레이드를 계속할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-138">Once the application health policy is satisfied, the upgrade can proceed.</span></span> <span data-ttu-id="e04ad-139">상태 정책이 위반되면 응용 프로그램 업그레이드는 실패합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-139">If the health policy is violated, the application upgrade fails.</span></span>

## <a name="upgrade-modes"></a><span data-ttu-id="e04ad-140">업그레이드 모드</span><span class="sxs-lookup"><span data-stu-id="e04ad-140">Upgrade modes</span></span>
<span data-ttu-id="e04ad-141">응용 프로그램 업그레이드에 대해 권장되는 모드는 모니터링된 모드이며 이는 일반적으로 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-141">The mode that we recommend for application upgrade is the monitored mode, which is the commonly used mode.</span></span> <span data-ttu-id="e04ad-142">모니터링 모드는 하나의 업데이트 도메인에서 업그레이드를 수행하고 정책에 지정된 모든 상태 검사를 통과하면 자동으로 다음 업데이트 도메인으로 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-142">Monitored mode performs the upgrade on one update domain, and if all health checks pass (per the policy specified), moves on to the next update domain automatically.</span></span>  <span data-ttu-id="e04ad-143">상태 검사가 실패하거나 시간 제한에 도달하면 업그레이드가 업데이트 도메인에 대해 롤백되거나 모드가 모니터링되지 않는 수동으로 변경됩니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-143">If health checks fail and/or time-outs are reached, the upgrade is either rolled back for the update domain, or the mode is changed to unmonitored manual.</span></span> <span data-ttu-id="e04ad-144">실패한 업그레이드에 대해 이러한 두 가지 모드 중 하나를 선택하도록 업그레이드를 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-144">You can configure the upgrade to choose one of those two modes for failed upgrades.</span></span> 

<span data-ttu-id="e04ad-145">모니터링되지 않는 수동 모드는 업데이트 도메인에서 업그레이드가 수행될 때마다 다음 업데이트 도메인에서 업그레이드가 시작하도록 수동 작업이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-145">Unmonitored manual mode needs manual intervention after every upgrade on an update domain, to kick off the upgrade on the next update domain.</span></span> <span data-ttu-id="e04ad-146">서비스 패브릭 상태 검사가 수행되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-146">No Service Fabric health checks are performed.</span></span> <span data-ttu-id="e04ad-147">관리자는 다음 업데이트 도메인에서 업그레이드가 시작되기 전에 상태 또는 상태 검사를 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-147">The administrator performs the health or status checks before starting the upgrade in the next update domain.</span></span>

## <a name="upgrade-default-services"></a><span data-ttu-id="e04ad-148">기본 서비스 업그레이드</span><span class="sxs-lookup"><span data-stu-id="e04ad-148">Upgrade default services</span></span>
<span data-ttu-id="e04ad-149">응용 프로그램의 업그레이드 프로세스 동안 Service Fabric 응용 프로그램 내의 기본 서비스를 업그레이드할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-149">Default services within Service Fabric application can be upgraded during the upgrade process of an application.</span></span> <span data-ttu-id="e04ad-150">기본 서비스는 [응용 프로그램 매니페스트](service-fabric-application-model.md#describe-an-application)에 정의됩니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-150">Default services are defined in the [application manifest](service-fabric-application-model.md#describe-an-application).</span></span> <span data-ttu-id="e04ad-151">기본 서비스를 업그레이드하는 표준 규칙은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-151">The standard rules of upgrading default services are:</span></span>

1. <span data-ttu-id="e04ad-152">클러스터에 존재하지 않는 새 [응용 프로그램 매니페스트](service-fabric-application-model.md#describe-an-application)의 기본 서비스가 만들어집니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-152">Default services in the new [application manifest](service-fabric-application-model.md#describe-an-application) that do not exist in the cluster are created.</span></span>
> [!TIP]
> <span data-ttu-id="e04ad-153">[EnableDefaultServicesUpgrade](service-fabric-cluster-fabric-settings.md#fabric-settings-that-you-can-customize)를 true로 설정하여 다음 규칙을 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-153">[EnableDefaultServicesUpgrade](service-fabric-cluster-fabric-settings.md#fabric-settings-that-you-can-customize) needs to be set to true to enable the following rules.</span></span> <span data-ttu-id="e04ad-154">이 기능은 v5.5에서 지원됩니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-154">This feature is supported from v5.5.</span></span>

2. <span data-ttu-id="e04ad-155">이전 [응용 프로그램 매니페스트](service-fabric-application-model.md#describe-an-application) 및 새 버전 모두에 있는 기존 서비스가 업데이트됩니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-155">Default services existing in both previous [application manifest](service-fabric-application-model.md#describe-an-application) and new version are updated.</span></span> <span data-ttu-id="e04ad-156">클러스터에 있는 설명을 새 버전의 서비스 설명으로 덮어씁니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-156">Service descriptions in the new version would overwrite those already in the cluster.</span></span> <span data-ttu-id="e04ad-157">기본 서비스 실패를 업데이트하는 경우 응용 프로그램 업그레이드가 자동으로 롤백됩니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-157">Application upgrade would rollback automatically upon updating default service failure.</span></span>
3. <span data-ttu-id="e04ad-158">이전 [응용 프로그램 매니페스트](service-fabric-application-model.md#describe-an-application)에 있지만 새 버전에 없는 기본 서비스가 삭제됩니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-158">Default services in the previous [application manifest](service-fabric-application-model.md#describe-an-application) but not in the new version are deleted.</span></span> <span data-ttu-id="e04ad-159">**기본 서비스를 삭제하는 작업은 되돌릴 수 없습니다.**</span><span class="sxs-lookup"><span data-stu-id="e04ad-159">**Note that this deleting default services can not be reverted.**</span></span>

<span data-ttu-id="e04ad-160">응용 프로그램의 경우 업그레이드가 롤백되면 기본 서비스가 업그레이드를 시작하기 전의 상태로 되돌아갑니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-160">In case of an application upgrade is rolled back, default services are reverted to the status before upgrade started.</span></span> <span data-ttu-id="e04ad-161">하지만 삭제된 서비스를 만들 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-161">But deleted services can never be created.</span></span>

## <a name="application-upgrade-flowchart"></a><span data-ttu-id="e04ad-162">응용 프로그램 업그레이드 순서도</span><span class="sxs-lookup"><span data-stu-id="e04ad-162">Application upgrade flowchart</span></span>
<span data-ttu-id="e04ad-163">이 단락 다음에 나오는 순서도는 서비스 패브릭 응용 프로그램의 업그레이드 프로세스를 이해하는 데 도움이 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-163">The flowchart following this paragraph can help you understand the upgrade process of a Service Fabric application.</span></span> <span data-ttu-id="e04ad-164">특히 *HealthCheckStableDuration*, *HealthCheckRetryTimeout* 및 *UpgradeHealthCheckInterval*을 비롯한 시간 제한이 한 업데이트 도메인의 업그레이드를 성공 또는 실패로 간주하는 시간을 어떻게 제어하는지 잘 설명되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-164">In particular, the flow describes how the time-outs, including *HealthCheckStableDuration*, *HealthCheckRetryTimeout*, and *UpgradeHealthCheckInterval*, help control when the upgrade in one update domain is considered a success or a failure.</span></span>

![서비스 패브릭 응용 프로그램의 업그레이드 프로세스][image]

## <a name="next-steps"></a><span data-ttu-id="e04ad-166">다음 단계</span><span class="sxs-lookup"><span data-stu-id="e04ad-166">Next steps</span></span>
<span data-ttu-id="e04ad-167">[Visual Studio를 사용하여 응용 프로그램 업그레이드](service-fabric-application-upgrade-tutorial.md) 에서는 Visual Studio를 사용하여 응용 프로그램 업그레이드를 진행하는 방법을 안내합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-167">[Upgrading your Application Using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="e04ad-168">[Powershell을 사용하여 응용 프로그램 업그레이드](service-fabric-application-upgrade-tutorial-powershell.md) 에서는 PowerShell을 사용하여 응용 프로그램 업그레이드를 진행하는 방법을 안내합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-168">[Upgrading your Application Using Powershell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="e04ad-169">[업그레이드 매개 변수](service-fabric-application-upgrade-parameters.md)를 사용하여 응용 프로그램 업그레이드 방법을 제어합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-169">Control how your application upgrades by using [Upgrade Parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="e04ad-170">[데이터 직렬화](service-fabric-application-upgrade-data-serialization.md)사용 방법을 익혀 응용 프로그램 업그레이드와 호환되도록 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-170">Make your application upgrades compatible by learning how to use [Data Serialization](service-fabric-application-upgrade-data-serialization.md).</span></span>

<span data-ttu-id="e04ad-171">[고급 항목](service-fabric-application-upgrade-advanced.md)을 참조하여 응용 프로그램을 업그레이드하는 동안 고급 기능을 사용하는 방법에 대해 알아봅니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-171">Learn how to use advanced functionality while upgrading your application by referring to [Advanced Topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="e04ad-172">[응용 프로그램 업그레이드 문제 해결](service-fabric-application-upgrade-troubleshooting.md)의 단계를 참조하여 응용 프로그램 업그레이드 중 발생하는 일반적인 문제를 해결합니다.</span><span class="sxs-lookup"><span data-stu-id="e04ad-172">Fix common problems in application upgrades by referring to the steps in [Troubleshooting Application Upgrades](service-fabric-application-upgrade-troubleshooting.md).</span></span>

[image]: media/service-fabric-application-upgrade/service-fabric-application-upgrade-flowchart.png
