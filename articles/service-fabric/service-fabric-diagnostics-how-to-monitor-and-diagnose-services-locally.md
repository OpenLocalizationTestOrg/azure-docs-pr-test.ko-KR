---
title: "Windows에서 Azure 마이크로 서비스 디버그 | Microsoft Docs"
description: "로컬 개발 컴퓨터에서 Microsoft Azure 서비스 패브릭을 사용하여 작성된 서비스를 모니터링하고 진단하는 방법에 대해 알아보세요."
services: service-fabric
documentationcenter: .net
author: dkkapur
manager: timlt
editor: 
ms.assetid: edcc0631-ed2d-45a3-851d-2c4fa0f4a326
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/24/2017
ms.author: dekapur
ms.openlocfilehash: 08998340afb2f242b9a268331607b0d1ddb9b0c6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/11/2017
---
# <a name="monitor-and-diagnose-services-in-a-local-machine-development-setup"></a><span data-ttu-id="e04cf-103">로컬 컴퓨터 개발 설정에서의 모니터링 및 진단 서비스</span><span class="sxs-lookup"><span data-stu-id="e04cf-103">Monitor and diagnose services in a local machine development setup</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="e04cf-104">Windows</span><span class="sxs-lookup"><span data-stu-id="e04cf-104">Windows</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)
> * [<span data-ttu-id="e04cf-105">Linux</span><span class="sxs-lookup"><span data-stu-id="e04cf-105">Linux</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally-linux.md)
> 
> 

<span data-ttu-id="e04cf-106">모니터링, 감지, 진단 및 문제 해결을 통해 사용자 환경에 미치는 영향을 최소화하면서 서비스를 계속할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-106">Monitoring, detecting, diagnosing, and troubleshooting allow for services to continue with minimal disruption to the user experience.</span></span> <span data-ttu-id="e04cf-107">실제 배포된 프로덕션 환경에서 모니터링 및 진단이 매우 중요한데, 실제 사용 설정으로 이전했을 때 정상적으로 작동하도록 서비스 개발 과정에서 얼마나 유사한 모델을 채택하느냐에 따라 그 효율성이 좌우됩니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-107">While monitoring and diagnostics are critical in an actual deployed production environment, the efficiency will depend on adopting a similar model during development of services to ensure they work when you move to a real-world setup.</span></span> <span data-ttu-id="e04cf-108">서비스 패브릭을 사용하면 서비스 개발자가 단일 컴퓨터 로컬 개발 설정과 실제 사용 프로덕션 클러스터 설정 양쪽에서 매끄럽게 작동하는 진단 기능을 간편하게 구현할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-108">Service Fabric makes it easy for service developers to implement diagnostics that can seamlessly work across both single-machine local development setups and real-world production cluster setups.</span></span>

## <a name="event-tracing-for-windows"></a><span data-ttu-id="e04cf-109">Windows용 이벤트 추적</span><span class="sxs-lookup"><span data-stu-id="e04cf-109">Event Tracing for Windows</span></span>
<span data-ttu-id="e04cf-110">[Windows용 이벤트 추적](https://msdn.microsoft.com/library/windows/desktop/bb968803.aspx) (ETW)은 서비스 패브릭의 추적 메시지용으로 바람직한 기술입니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-110">[Event Tracing for Windows](https://msdn.microsoft.com/library/windows/desktop/bb968803.aspx) (ETW) is the recommended technology for tracing messages in Service Fabric.</span></span> <span data-ttu-id="e04cf-111">ETW를 사용하면 다음과 같은 이점이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-111">Some benefits of using ETW are:</span></span>

* <span data-ttu-id="e04cf-112">**ETW는 속도가 빠릅니다.**</span><span class="sxs-lookup"><span data-stu-id="e04cf-112">**ETW is fast.**</span></span> <span data-ttu-id="e04cf-113">코드 실행 시간에 미치는 영향을 최소화하도록 설계된 추적 기술입니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-113">It was built as a tracing technology that has minimal impact on code execution times.</span></span>
* <span data-ttu-id="e04cf-114">**ETW 추적은 로컬 개발 환경 및 실제 사용 클러스터 설정에서도 매끄럽게 작동합니다.**</span><span class="sxs-lookup"><span data-stu-id="e04cf-114">**ETW tracing works seamlessly across local development environments and also real-world cluster setups.**</span></span> <span data-ttu-id="e04cf-115">즉, 실제 클러스터에 코드를 배포할 준비가 되었을 때 추적 코드를 다시 쓸 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-115">This  means you don't have to rewrite your tracing code when you are ready to deploy your code to a real cluster.</span></span>
* <span data-ttu-id="e04cf-116">**서비스 패브릭은 내부 추적에도 ETW를 사용합니다.**</span><span class="sxs-lookup"><span data-stu-id="e04cf-116">**Service Fabric system code also uses ETW for internal tracing.**</span></span> <span data-ttu-id="e04cf-117">따라서 서비스 패브릭 시스템 추적으로 인터리브된 응용 프로그램 추적을 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-117">This allows you to view your application traces interleaved with Service Fabric system traces.</span></span> <span data-ttu-id="e04cf-118">또한 기본 시스템에서 응용 프로그램 코드와 이벤트 간의 시퀀스 및 상호 관계를 보다 쉽게 이해할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-118">It also helps you to more easily understand the sequences and interrelationships between your application code and events in the underlying system.</span></span>
* <span data-ttu-id="e04cf-119">**서비스 패브릭 Visual Studio 도구는 ETW 이벤트 보기를 내부적으로 지원합니다.**</span><span class="sxs-lookup"><span data-stu-id="e04cf-119">**There is built-in support in Service Fabric Visual Studio tools to view ETW events.**</span></span> <span data-ttu-id="e04cf-120">Service Fabric을 통해 Visual Studio를 올바르게 구성하고 나면 ETW 이벤트가 Visual Studio의 진단 이벤트 보기에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-120">ETW events appear in the Diagnostic Events view of Visual Studio once Visual Studio is correctly configured with Service Fabric.</span></span> 

## <a name="view-service-fabric-system-events-in-visual-studio"></a><span data-ttu-id="e04cf-121">Visual Studio에서 서비스 패브릭 시스템 이벤트 보기</span><span class="sxs-lookup"><span data-stu-id="e04cf-121">View Service Fabric system events in Visual Studio</span></span>
<span data-ttu-id="e04cf-122">서비스 패브릭은 ETW 이벤트를 내보내서 응용 프로그램 개발자가 플랫폼에서 일어나는 일을 이해할 수 있도록 도와줍니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-122">Service Fabric emits ETW events to help application developers understand what's happening in the platform.</span></span> <span data-ttu-id="e04cf-123">아직 응용 프로그램을 만들지 않은 경우 [Visual Studio에서 응용 프로그램 처음 만들기](service-fabric-create-your-first-application-in-visual-studio.md)의 단계에 따라 지금 만드세요.</span><span class="sxs-lookup"><span data-stu-id="e04cf-123">If you haven't already done so, go ahead and follow the steps in [Creating your first application in Visual Studio](service-fabric-create-your-first-application-in-visual-studio.md).</span></span> <span data-ttu-id="e04cf-124">이 정보는 응용 프로그램이 실행되는 동안 진단 이벤트 뷰어에 추적 메시지를 표시하는 데 도움이 될 것입니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-124">This information will help you get an application up and running with the Diagnostics Events Viewer showing the trace messages.</span></span>

1. <span data-ttu-id="e04cf-125">진단 이벤트 창이 자동으로 표시되지 않으면, Visual Studio에서 **보기** 탭으로 이동하여 **다른 창**, **진단 이벤트 뷰어**를 차례로 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-125">If the diagnostics events window does not automatically show, Go to the **View** tab in Visual Studio, choose **Other Windows** and then **Diagnostic Events Viewer**.</span></span>
2. <span data-ttu-id="e04cf-126">각 이벤트는 이벤트가 기인하는 노드, 응용 프로그램 및 서비스를 알려 주는 표준 메타데이터 정보를 가지고 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-126">Each event has standard metadata information that tells you the node, application and service the event is coming from.</span></span> <span data-ttu-id="e04cf-127">이벤트 창 상단의 **이벤트 필터링** 상자를 사용하여 이벤트 목록을 필터링할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-127">You can also filter the list of events by using the **Filter events** box at the top of the events window.</span></span> <span data-ttu-id="e04cf-128">예를 들어 **노드 이름**이나 **서비스 이름**으로 필터링할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-128">For example, you can filter on **Node Name** or **Service Name.**</span></span> <span data-ttu-id="e04cf-129">또한 이벤트 상세 정보를 볼 때 이벤트 창 상단의 단추를 사용하여 **일시 중지**하고 나중에 이벤트 손실 없이 재개할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-129">And when you're looking at event details, you can also pause by using the **Pause** button at the top of the events window and resume later without any loss of events.</span></span>
   
   ![Visual Studio 진단 이벤트 뷰어](./media/service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally/DiagEventsExamples2.png)

## <a name="add-your-own-custom-traces-to-the-application-code"></a><span data-ttu-id="e04cf-131">응용 프로그램 코드에 독자적인 사용자 지정 추적 추가</span><span class="sxs-lookup"><span data-stu-id="e04cf-131">Add your own custom traces to the application code</span></span>
<span data-ttu-id="e04cf-132">서버 패브릭 Visual Studio 프로젝트 템플릿에는 샘플 코드가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-132">The Service Fabric Visual Studio project templates contain sample code.</span></span> <span data-ttu-id="e04cf-133">이 코드는 서비스 패브릭에서 시스템 추적과 함께 Visual Studio ETW 뷰어에 표시되는 사용자 지정 응용 프로그램 코드 ETW 추적을 추가하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-133">The code shows how to add custom application code ETW traces that show up in the Visual Studio ETW viewer alongside system traces from Service Fabric.</span></span> <span data-ttu-id="e04cf-134">이 방법의 장점은 메타데이터가 추적에 자동으로 추가되고 Visual Studio 진단 이벤트 뷰어가 이를 표시하도록 이미 구성되어 있다는 점입니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-134">The advantage of this method is that metadata is automatically added to traces, and the Visual Studio Diagnostic Events Viewer is already configured to display them.</span></span>

<span data-ttu-id="e04cf-135">**서비스 템플릿**(상태 비저장 또는 상태 저장)에서 만들어진 프로젝트의 경우 `RunAsync` 구현을 검색하기만 하면 됩니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-135">For projects created from the **service templates** (stateless or stateful) just search for the `RunAsync` implementation:</span></span>

1. <span data-ttu-id="e04cf-136">`ServiceEventSource.Current.ServiceMessage` in the `RunAsync` 호출은 응용 프로그램 코드에서 사용자 지정 ETW 추적의 예를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-136">The call to `ServiceEventSource.Current.ServiceMessage` in the `RunAsync` method shows an example of a custom ETW trace from the application code.</span></span>
2. <span data-ttu-id="e04cf-137">**ServiceEventSource.cs`ServiceEventSource.ServiceMessage` 파일을 보면 성능상의 이유로 빈도가 높은 이벤트에 사용해야 하는** 메서드에서 오버로드를 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-137">In the **ServiceEventSource.cs** file, you will find an overload for the `ServiceEventSource.ServiceMessage` method that should be used for high-frequency events due to performance reasons.</span></span>

<span data-ttu-id="e04cf-138">**행위자 템플릿** (상태 비저장 또는 상태 저장)에서 만들어진 프로젝트의 경우:</span><span class="sxs-lookup"><span data-stu-id="e04cf-138">For projects created from the **actor templates** (stateless or stateful):</span></span>

1. <span data-ttu-id="e04cf-139">**ProjectName** 이 Visual Studio 프로젝트용으로 선택한 이름인 *“ProjectName”.cs* 파일을 엽니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-139">Open the **"ProjectName".cs** file where *ProjectName* is the name you chose for your Visual Studio project.</span></span>  
2. <span data-ttu-id="e04cf-140">*DoWorkAsync* 메서드에서 `ActorEventSource.Current.ActorMessage(this, "Doing Work");` 코드를 찾습니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-140">Find the code `ActorEventSource.Current.ActorMessage(this, "Doing Work");` in the *DoWorkAsync* method.</span></span>  <span data-ttu-id="e04cf-141">이는 응용 프로그램 코드에서 작성된 사용자 지정 ETW의 예제입니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-141">This is an example of a custom ETW trace written from application code.</span></span>  
3. <span data-ttu-id="e04cf-142">**ActorEventSource.cs** 파일을 보면 성능상의 이유로 빈도가 높은 이벤트에 사용해야 하는 `ActorEventSource.ActorMessage` 메서드에서 오버로드를 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-142">In file **ActorEventSource.cs**, you will find an overload for the `ActorEventSource.ActorMessage` method that should be used for high-frequency events due to performance reasons.</span></span>

<span data-ttu-id="e04cf-143">서비스 코드에 사용자 지정 ETW 추적을 추가한 다음에는 응용 프로그램을 다시 빌드, 배포, 실행하여 진단 이벤트 뷰어에서 이벤트를 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-143">After adding custom ETW tracing to your service code, you can build, deploy, and run the application again to see your event(s) in the Diagnostic Events Viewer.</span></span> <span data-ttu-id="e04cf-144">**F5**키를 눌러서 응용 프로그램을 디버깅하면 진단 이벤트 뷰어가 자동으로 열립니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-144">If you debug the application with **F5**, the Diagnostic Events Viewer will open automatically.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e04cf-145">다음 단계</span><span class="sxs-lookup"><span data-stu-id="e04cf-145">Next steps</span></span>
<span data-ttu-id="e04cf-146">위에서 로컬 진단을 위해 응용 프로그램에 추가한 것과 동일한 추적 코드는 Azure 클러스터에서 응용 프로그램을 실행할 때 이 이벤트를 보는 데 이용할 수 있는 도구와 함께 작동합니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-146">The same tracing code that you added to your application above for local diagnostics will work with tools that you can use to view these events when running your application on an Azure cluster.</span></span> <span data-ttu-id="e04cf-147">도구에 대한 다양한 옵션과 도구를 설정하는 방법에 대해 설명하는 이러한 문서를 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="e04cf-147">Check out these articles that discuss the different options for the tools and describe how you can set them up.</span></span>

* [<span data-ttu-id="e04cf-148">Azure 진단을 사용하여 로그를 수집하는 방법</span><span class="sxs-lookup"><span data-stu-id="e04cf-148">How to collect logs with Azure Diagnostics</span></span>](service-fabric-diagnostics-how-to-setup-wad.md)
* [<span data-ttu-id="e04cf-149">EventFlow를 사용하여 이벤트 집계 및 수집</span><span class="sxs-lookup"><span data-stu-id="e04cf-149">Event aggregation and collection using EventFlow</span></span>](service-fabric-diagnostics-event-aggregation-eventflow.md)

