---
title: "서비스 패브릭 응용 프로그램 추적 저장소로 Elasticsearch aaaUsing | Microsoft Docs"
description: "Elasticsearch 및 Kibana toostore, 인덱스 및 응용 프로그램 추적 (로그)을 통해 검색 서비스 패브릭 응용 프로그램에서 사용 하 여 방법 설명"
services: service-fabric
documentationcenter: .net
author: karolz-ms
manager: adegeo
editor: 
ms.assetid: e59b0c39-e468-4d9e-b453-d5f2a8ad20d8
ms.service: service-fabric
ms.devlang: dotNet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/07/2017
ms.author: karolz@microsoft.com
redirect_url: /azure/service-fabric/service-fabric-diagnostics-event-aggregation-eventflow
ms.openlocfilehash: b5977c54e69319e3caa376e44a02f971b66a3254
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/06/2017
---
# <a name="use-elasticsearch-as-a-service-fabric-application-trace-store"></a><span data-ttu-id="e3558-103">서비스 패브릭 응용 프로그램 추적 저장소로 ElasticSearch 사용</span><span class="sxs-lookup"><span data-stu-id="e3558-103">Use Elasticsearch as a Service Fabric application trace store</span></span>
## <a name="introduction"></a><span data-ttu-id="e3558-104">소개</span><span class="sxs-lookup"><span data-stu-id="e3558-104">Introduction</span></span>
<span data-ttu-id="e3558-105">이 문서에서는 [Azure Service Fabric](https://azure.microsoft.com/documentation/services/service-fabric/) 응용 프로그램이 프로그램 추적 저장소, 인덱싱 및 검색을 위해 **Elasticsearch** 및 **Kibana**를 사용할 수 있는 방법에 대해 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-105">This article describes how [Azure Service Fabric](https://azure.microsoft.com/documentation/services/service-fabric/) applications can use **Elasticsearch** and **Kibana** for application trace storage, indexing, and search.</span></span> <span data-ttu-id="e3558-106">[Elasticsearch](https://www.elastic.co/guide/index.html)는 이 작업에 적합한 공개 소스, 분산 및 확장 가능한 실시간 검색 및 분석 엔진이며</span><span class="sxs-lookup"><span data-stu-id="e3558-106">[Elasticsearch](https://www.elastic.co/guide/index.html) is an open-source, distributed, and scalable real-time search and analytics engine that is well-suited for this task.</span></span> <span data-ttu-id="e3558-107">Microsoft Azure에서 실행되는 Windows 및 Linux 가상 컴퓨터에 설치할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-107">It can be installed on Windows and Linux virtual machines running in Microsoft Azure.</span></span> <span data-ttu-id="e3558-108">Elasticsearch는 **ETW(Windows용 이벤트 추적)**와 같은 기술을 사용하여 생성된 *구조화된* 추적을 효율적으로 처리할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-108">Elasticsearch can efficiently process *structured* traces produced using technologies such as **Event Tracing for Windows (ETW)**.</span></span>

<span data-ttu-id="e3558-109">ETW는 서비스 패브릭 런타임에서 toosource 진단 정보 (추적)에서 사용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-109">ETW is used by Service Fabric runtime toosource diagnostic information (traces).</span></span> <span data-ttu-id="e3558-110">Hello 권장 되는 방법에 대 한 서비스 패브릭 응용 프로그램 toosource의 진단 정보를 너무 이며</span><span class="sxs-lookup"><span data-stu-id="e3558-110">It is hello recommended method for Service Fabric applications toosource their diagnostic information, too.</span></span> <span data-ttu-id="e3558-111">런타임에서 제공 하 고 응용 프로그램에서 제공 하는 추적 및 쉽게 관련 된 문제 해결 간의 상관 관계에 대 한 동일한 메커니즘을 사용 하면 hello를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-111">Using hello same mechanism allows for correlation between runtime-supplied and application-supplied traces and makes troubleshooting easier.</span></span> <span data-ttu-id="e3558-112">로깅 API를 포함 하는 Visual Studio에서 서비스 패브릭 프로젝트 템플릿 (hello.NET 기반 **EventSource** 클래스)는가 기본적으로 ETW 추적을 내보냅니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-112">Service Fabric project templates in Visual Studio include a logging API (based on hello .NET **EventSource** class) that emits ETW traces by default.</span></span> <span data-ttu-id="e3558-113">ETW를 사용한 서비스 패브릭 응용 프로그램 추적에 대한 일반적인 개요는 [로컬 컴퓨터 개발 설정에서의 모니터링 및 진단 서비스](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="e3558-113">For a general overview of Service Fabric application tracing using ETW, see [Monitoring and diagnosing services in a local machine development setup](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md).</span></span>

<span data-ttu-id="e3558-114">Hello 추적 tooshow를에서 Elasticsearch에 대 한 toobe (hello 응용 프로그램 실행 중) 실시간으로 hello 서비스 패브릭 클러스터 노드에서 캡처된 및 tooan Elasticsearch 끝점으로 전송 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-114">For hello traces tooshow up in Elasticsearch, they need toobe captured at hello Service Fabric cluster nodes in real time (while hello application is running) and sent tooan Elasticsearch endpoint.</span></span> <span data-ttu-id="e3558-115">추적 캡처에 대한 두 가지 주요 옵션이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-115">There are two major options for trace capturing:</span></span>

* <span data-ttu-id="e3558-116">**In Process 추적 캡처**</span><span class="sxs-lookup"><span data-stu-id="e3558-116">**In-process trace capturing**</span></span>  
  <span data-ttu-id="e3558-117">hello 응용 프로그램 또는 서비스 프로세스를 보다 정확 하 게 hello 진단 데이터 toohello 추적 저장소 (Elasticsearch)을 보내는 담당 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-117">hello application, or more precisely, service process, is responsible for sending out hello diagnostic data toohello trace store (Elasticsearch).</span></span>
* <span data-ttu-id="e3558-118">**Out of Process 추적 캡처**</span><span class="sxs-lookup"><span data-stu-id="e3558-118">**Out-of-process trace capturing**</span></span>  
  <span data-ttu-id="e3558-119">별도 에이전트 hello 서비스 프로세스 또는 프로세스에서 추적을 캡처할 이며 toohello 추적 저장소 보내기.</span><span class="sxs-lookup"><span data-stu-id="e3558-119">A separate agent is capturing traces from hello service process or processes and sending them toohello trace store.</span></span>

<span data-ttu-id="e3558-120">아래 tooset Azure에서 Elasticsearch 논의 hello 전문가 방법과 단점 모두에 대 한 옵션을 캡처하고 tooconfigure 서비스 패브릭 toosend 데이터 tooElasticsearch를 서비스 하는 방법에 대해 설명 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-120">Below, we describe how tooset up Elasticsearch on Azure, discuss hello pros and cons for both capture options, and explain how tooconfigure a Service Fabric service toosend data tooElasticsearch.</span></span>

## <a name="set-up-elasticsearch-on-azure"></a><span data-ttu-id="e3558-121">Azure에 Elasticsearch 설정</span><span class="sxs-lookup"><span data-stu-id="e3558-121">Set up Elasticsearch on Azure</span></span>
<span data-ttu-id="e3558-122">hello Azure에서 Elasticsearch 서비스 hello 가장 간단한 방법은 tooset 방식은 [ **Azure 리소스 관리자 템플릿을**](../azure-resource-manager/resource-group-overview.md)합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-122">hello most straightforward way tooset up hello Elasticsearch service on Azure is through [**Azure Resource Manager templates**](../azure-resource-manager/resource-group-overview.md).</span></span> <span data-ttu-id="e3558-123">포괄적인 [Elasticsearch에 대한 빠른 시작 Azure 리소스 관리자 템플릿](https://github.com/Azure/azure-quickstart-templates/tree/master/elasticsearch) 은 Azure 빠른 시작 템플릿 리포지토리에서 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-123">A comprehensive [Quickstart Azure Resource Manager template for Elasticsearch](https://github.com/Azure/azure-quickstart-templates/tree/master/elasticsearch) is available from Azure Quickstart templates repository.</span></span> <span data-ttu-id="e3558-124">이 템플릿에서는 규모 단위(노드 그룹)에 대한 별도의 저장소 계정을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-124">This template uses separate storage accounts for scale units (groups of nodes).</span></span> <span data-ttu-id="e3558-125">또한 서로 다른 구성 및 여러 개의 연결된 데이터 디스크를 사용하여 별개의 클라이언트 및 서버 노드를 프로비전할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-125">It can also provision separate client and server nodes with different configurations and various numbers of data disks attached.</span></span>

<span data-ttu-id="e3558-126">여기서 이라는 다른 서식 파일 사용 **ES MultiNode** hello에서 [진단 도구를 Azure 저장소](https://github.com/Azure/azure-diagnostics-tools)합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-126">Here, we use another template, called **ES-MultiNode** from hello [Azure diagnostic tools repository](https://github.com/Azure/azure-diagnostics-tools).</span></span> <span data-ttu-id="e3558-127">이 서식 파일은 쉽게 toouse 하 고 HTTP 기본 인증으로 보호 하는 Elasticsearch 클러스터를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-127">This template is easier toouse, and it creates an Elasticsearch cluster protected by HTTP basic authentication.</span></span> <span data-ttu-id="e3558-128">계속 진행 하기 전에 hello 리포지토리 복제 또는 zip 파일 다운로드) 하는 것 (여 hello 리포지토리 GitHub tooyour 컴퓨터에서 다운로드 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-128">Before you proceed, download hello repository from GitHub tooyour machine (by either cloning hello repository or downloading a zip file).</span></span> <span data-ttu-id="e3558-129">hello로 hello 폴더에 있는 hello ES MultiNode 템플릿을 동일한 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-129">hello ES-MultiNode template is located in hello folder with hello same name.</span></span>

### <a name="prepare-a-machine-toorun-elasticsearch-installation-scripts"></a><span data-ttu-id="e3558-130">컴퓨터 toorun Elasticsearch 설치 스크립트 준비</span><span class="sxs-lookup"><span data-stu-id="e3558-130">Prepare a machine toorun Elasticsearch installation scripts</span></span>
<span data-ttu-id="e3558-131">hello 가장 쉬운 방법은 toouse hello ES MultiNode 서식 파일은 호출 하는 제공 된 Azure PowerShell 스크립트를 통해 `CreateElasticSearchCluster`합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-131">hello easiest way toouse hello ES-MultiNode template is through a provided Azure PowerShell script called `CreateElasticSearchCluster`.</span></span> <span data-ttu-id="e3558-132">toouse tooinstall PowerShell 모듈 및 도구가 필요한이 스크립트 **openssl**합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-132">toouse this script, you need tooinstall PowerShell modules and a tool called **openssl**.</span></span> <span data-ttu-id="e3558-133">후자의 hello Elasticsearch 클러스터 tooadminister 사용된 될 수 있는 SSH 키를 원격으로 만드는 데 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-133">hello latter is needed for creating an SSH key that can be used tooadminister your Elasticsearch cluster remotely.</span></span>

<span data-ttu-id="e3558-134">`CreateElasticSearchCluster`스크립트는 Windows 컴퓨터의 hello ES MultiNode 템플릿으로 사용 편의성을 위해 설계 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-134">`CreateElasticSearchCluster` script is designed for ease of use with hello ES-MultiNode template from a Windows machine.</span></span> <span data-ttu-id="e3558-135">비 Windows 컴퓨터에서 가능한 toouse hello 템플릿을 이지만 시나리오는이 문서의 hello 다루지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-135">It is possible toouse hello template on a non-Windows machine, but that scenario is beyond hello scope of this article.</span></span>

1. <span data-ttu-id="e3558-136">아직 설치하지 않은 경우 [**Azure PowerShell 모듈**](http://aka.ms/webpi-azps)을 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-136">If you haven't installed them already, install [**Azure PowerShell modules**](http://aka.ms/webpi-azps).</span></span> <span data-ttu-id="e3558-137">메시지가 표시되면 **실행**을 클릭한 다음 **설치**합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-137">When prompted, click **Run**, then **Install**.</span></span> <span data-ttu-id="e3558-138">Azure PowerShell 1.3 이상이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-138">Azure PowerShell 1.3 or newer is required.</span></span>
2. <span data-ttu-id="e3558-139">hello **openssl** 도구의 hello 배포에 포함 되어 [ **Windows 용 Git**](http://www.git-scm.com/downloads)합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-139">hello **openssl** tool is included in hello distribution of [**Git for Windows**](http://www.git-scm.com/downloads).</span></span> <span data-ttu-id="e3558-140">[Windows용 GIT](http://www.git-scm.com/downloads) 를 아직 설치하지 않은 경우 지금 설치하세요.</span><span class="sxs-lookup"><span data-stu-id="e3558-140">If you have not done so already, install [Git for Windows](http://www.git-scm.com/downloads) now.</span></span> <span data-ttu-id="e3558-141">(hello 기본 설치 옵션은 확인 합니다.)</span><span class="sxs-lookup"><span data-stu-id="e3558-141">(hello default installation options are OK.)</span></span>
3. <span data-ttu-id="e3558-142">Git 설치 되었지만 hello 시스템 경로에 포함 되지 않은 가정할 Microsoft Azure PowerShell 창을 열고 다음 명령 hello를 실행 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-142">Assuming that Git has been installed but not included in hello system path, open a Microsoft Azure PowerShell window and run hello following commands:</span></span>
   
    ```powershell
    $ENV:PATH += ";<Git installation folder>\usr\bin"
    $ENV:OPENSSL_CONF = "<Git installation folder>\usr\ssl\openssl.cnf"
    ```
   
    <span data-ttu-id="e3558-143">Hello 대체 `<Git installation folder>` hello 기본값은 시스템에서 hello Git 위치와 **"C:\Program Files\Git"**합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-143">Replace hello `<Git installation folder>` with hello Git location on your machine; hello default is **"C:\Program Files\Git"**.</span></span> <span data-ttu-id="e3558-144">첫 번째 경로 hello의 hello 시작 부분에서 세미콜론 문자 hello note 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-144">Note hello semicolon character at hello beginning of hello first path.</span></span>
4. <span data-ttu-id="e3558-145">TooAzure 로그온 되어 있는지 확인 (통해 [ `Add-AzureRmAccount` ](https://msdn.microsoft.com/library/mt619267.aspx) cmdlet) toocreate 탄력적 검색 클러스터 사용 되어야 하는 hello 구독을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-145">Ensure that you are logged on tooAzure (via [`Add-AzureRmAccount`](https://msdn.microsoft.com/library/mt619267.aspx) cmdlet) and that you have selected hello subscription that should be used toocreate your Elastic Search cluster.</span></span> <span data-ttu-id="e3558-146">`Get-AzureRmContext` 및 `Get-AzureRmSubscription` cmdlet를 사용하여 올바른 구독을 선택했는지 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-146">You can verify that correct subscription is selected using `Get-AzureRmContext` and `Get-AzureRmSubscription` cmdlets.</span></span>
5. <span data-ttu-id="e3558-147">아직 수행 하지 않은 경우 hello 현재 디렉터리 toohello ES MultiNode 폴더를 변경 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-147">If you haven't done so already, change hello current directory toohello ES-MultiNode folder.</span></span>

### <a name="run-hello-createelasticsearchcluster-script"></a><span data-ttu-id="e3558-148">Hello CreateElasticSearchCluster 스크립트 실행</span><span class="sxs-lookup"><span data-stu-id="e3558-148">Run hello CreateElasticSearchCluster script</span></span>
<span data-ttu-id="e3558-149">Hello 스크립트를 실행 하기 전에 hello 열고 `azuredeploy-parameters.json` 파일을 확인 하거나 hello 스크립트 매개 변수 값을 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-149">Before you run hello script, open hello `azuredeploy-parameters.json` file and verify or provide values for hello script parameters.</span></span> <span data-ttu-id="e3558-150">hello 매개 변수 뒤에 제공 됩니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-150">hello following parameters are provided:</span></span>

| <span data-ttu-id="e3558-151">매개 변수 이름</span><span class="sxs-lookup"><span data-stu-id="e3558-151">Parameter Name</span></span> | <span data-ttu-id="e3558-152">설명</span><span class="sxs-lookup"><span data-stu-id="e3558-152">Description</span></span> |
| --- | --- |
| <span data-ttu-id="e3558-153">dnsNameForLoadBalancerIP</span><span class="sxs-lookup"><span data-stu-id="e3558-153">dnsNameForLoadBalancerIP</span></span> |<span data-ttu-id="e3558-154">hello 이름 (hello Azure 지역 도메인 제공 toohello 이름 추가) 하 여 hello 탄력적 검색 클러스터에 대 한 사용 되는 toocreate hello 공개적으로 표시 DNS 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-154">hello name that is used toocreate hello publicly visible DNS name for hello Elastic Search cluster (by appending hello Azure region domain toohello provided name).</span></span> <span data-ttu-id="e3558-155">예를 들어이 매개 변수 값은 "myBigCluster" 하는 경우 Azure 지역을 선택 하는 hello는 미국 서 부 hello hello 클러스터 결과 DNS 이름은 myBigCluster.westus.cloudapp.azure.com입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-155">For example, if this parameter value is "myBigCluster" and hello chosen Azure region is West US, hello resulting DNS name for hello cluster is myBigCluster.westus.cloudapp.azure.com.</span></span> <br /><br /><span data-ttu-id="e3558-156">이 이름은 데이터 노드 이름 예: hello 탄력적 검색 클러스터와 연결 된 여러 아티팩트에 대 한 루트 이름으로도 사용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-156">This name also serves as a root name for many artifacts associated with hello Elastic Search cluster, such as data node names.</span></span> |
| <span data-ttu-id="e3558-157">adminUsername</span><span class="sxs-lookup"><span data-stu-id="e3558-157">adminUsername</span></span> |<span data-ttu-id="e3558-158">hello 탄력적 검색 클러스터를 관리 하기 위한 hello 관리자 계정의 hello 이름 (해당 SSH 키는 자동으로 생성 되며 않음).</span><span class="sxs-lookup"><span data-stu-id="e3558-158">hello name of hello administrator account for managing hello Elastic Search cluster (corresponding SSH keys are generated automatically).</span></span> |
| <span data-ttu-id="e3558-159">dataNodeCount</span><span class="sxs-lookup"><span data-stu-id="e3558-159">dataNodeCount</span></span> |<span data-ttu-id="e3558-160">hello hello 탄력적 검색 클러스터의 노드 수입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-160">hello number of nodes in hello Elastic Search cluster.</span></span> <span data-ttu-id="e3558-161">hello hello 스크립트의 현재 버전에서 데이터 및 쿼리 노드; 구분 하지 않습니다. 모든 노드가 두 역할을 수행 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-161">hello current version of hello script does not distinguish between data and query nodes; all nodes play both roles.</span></span> <span data-ttu-id="e3558-162">기본값 too3 노드입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-162">Defaults too3 nodes.</span></span> |
| <span data-ttu-id="e3558-163">dataDiskSize</span><span class="sxs-lookup"><span data-stu-id="e3558-163">dataDiskSize</span></span> |<span data-ttu-id="e3558-164">각 데이터 노드에 대해 할당 되는 (GB)에 있는 데이터 디스크의 hello 크기입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-164">hello size of data disks (in GB) that is allocated for each data node.</span></span> <span data-ttu-id="e3558-165">4 데이터 디스크를 단독으로 전용된 tooElastic 검색 서비스를 수신 하는 각 노드에 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-165">Each node receives 4 data disks, exclusively dedicated tooElastic Search service.</span></span> |
| <span data-ttu-id="e3558-166">region</span><span class="sxs-lookup"><span data-stu-id="e3558-166">region</span></span> |<span data-ttu-id="e3558-167">hello 이름 여기서 hello 탄력적 검색 클러스터를 배치 해야 하는 Azure 지역입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-167">hello name of Azure region where hello Elastic Search cluster should be located.</span></span> |
| <span data-ttu-id="e3558-168">esUserName</span><span class="sxs-lookup"><span data-stu-id="e3558-168">esUserName</span></span> |<span data-ttu-id="e3558-169">hello hello 사용자의 사용자 이름 구성 toohave 액세스 tooES 클러스터 (제목 tooHTTP 기본 인증).</span><span class="sxs-lookup"><span data-stu-id="e3558-169">hello user name of hello user that is configured toohave access tooES cluster (subject tooHTTP basic authentication).</span></span> <span data-ttu-id="e3558-170">hello 암호 매개 변수 파일의 일부가 아니며 제공 해야 합니다 `CreateElasticSearchCluster` 스크립트를 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-170">hello password is not part of parameters file and must be provided when `CreateElasticSearchCluster` script is invoked.</span></span> |
| <span data-ttu-id="e3558-171">vmSizeDataNodes</span><span class="sxs-lookup"><span data-stu-id="e3558-171">vmSizeDataNodes</span></span> |<span data-ttu-id="e3558-172">hello 탄력적 검색 클러스터 노드에 대 한 Azure 가상 컴퓨터 크기입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-172">hello Azure virtual machine size for Elastic Search cluster nodes.</span></span> <span data-ttu-id="e3558-173">기본값 tooStandard_D2 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-173">Defaults tooStandard_D2.</span></span> |

<span data-ttu-id="e3558-174">이제 준비 toorun hello 스크립트 됩니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-174">Now you are ready toorun hello script.</span></span> <span data-ttu-id="e3558-175">Hello 다음 명령을 실행 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-175">Issue hello following command:</span></span>

```powershell
CreateElasticSearchCluster -ResourceGroupName <es-group-name> -Region <azure-region> -EsPassword <es-password>
```

<span data-ttu-id="e3558-176">여기서,</span><span class="sxs-lookup"><span data-stu-id="e3558-176">where</span></span> 

| <span data-ttu-id="e3558-177">매개 변수 이름</span><span class="sxs-lookup"><span data-stu-id="e3558-177">Script Parameter Name</span></span> | <span data-ttu-id="e3558-178">설명</span><span class="sxs-lookup"><span data-stu-id="e3558-178">Description</span></span> |
| --- | --- |
| `<es-group-name>` |<span data-ttu-id="e3558-179">탄력적 검색 클러스터 리소스를 모두 포함 될 hello Azure 리소스 그룹의 hello 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-179">hello name of hello Azure resource group that will contain all Elastic Search cluster resources.</span></span> |
| `<azure-region>` |<span data-ttu-id="e3558-180">hello 이름 hello hello 탄력적 검색 클러스터를 만들 Azure 지역입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-180">hello name of hello Azure region where hello Elastic Search cluster should be created.</span></span> |
| `<es-password>` |<span data-ttu-id="e3558-181">hello 탄력적 검색 사용자에 대 한 hello 암호입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-181">hello password for hello Elastic Search user.</span></span> |

> [!NOTE]
> <span data-ttu-id="e3558-182">TooAzure에 toolog 잊은 hello 테스트 AzureResourceGroup cmdlet에서 NullReferenceException을 받아야 하는 경우 (`Add-AzureRmAccount`).</span><span class="sxs-lookup"><span data-stu-id="e3558-182">If you get a NullReferenceException from hello Test-AzureResourceGroup cmdlet, you have forgotten toolog on tooAzure (`Add-AzureRmAccount`).</span></span>
> 
> 

<span data-ttu-id="e3558-183">Hello 매개 변수 파일을 수정 hello 스크립트 실행에서 오류가 발생 하는 hello ц 잘못 된 템플릿 매개 변수 값을 판단 하는 경우에 다른 리소스 그룹 이름으로 hello 스크립트를 다시 실행 하십시오.</span><span class="sxs-lookup"><span data-stu-id="e3558-183">If you get an error from running hello script and you determine that hello error was caused by a wrong template parameter value, correct hello parameter file and run hello script again with a different resource group name.</span></span> <span data-ttu-id="e3558-184">다시 사용할 수도 hello를 추가 하 여 hello 스크립트 이전과 hello 정리 했으며 동일한 리소스 그룹 이름 hello `-RemoveExistingResourceGroup` toohello 매개 변수에서의 스크립트 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-184">You can also reuse hello same resource group name and have hello script clean up hello old one by adding hello `-RemoveExistingResourceGroup` parameter toohello script invocation.</span></span>

### <a name="result-of-running-hello-createelasticsearchcluster-script"></a><span data-ttu-id="e3558-185">Hello CreateElasticSearchCluster 스크립트 실행의 결과</span><span class="sxs-lookup"><span data-stu-id="e3558-185">Result of running hello CreateElasticSearchCluster script</span></span>
<span data-ttu-id="e3558-186">Hello를 실행 한 후 `CreateElasticSearchCluster` 스크립트를 다음 주 아티팩트 hello 생성 됩니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-186">After you run hello `CreateElasticSearchCluster` script, hello following main artifacts will be created.</span></span> <span data-ttu-id="e3558-187">이 예에서는 "myBigCluster" hello의 hello 값으로 사용 했다고 가정 `dnsNameForLoadBalancerIP` 매개 변수 및 해당 hello 지역 hello 클러스터를 만들 위치는 West US입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-187">For this example we assume that you have used "myBigCluster" as hello value of hello `dnsNameForLoadBalancerIP` parameter and that hello region where you created hello cluster is West US.</span></span>

| <span data-ttu-id="e3558-188">아티팩트</span><span class="sxs-lookup"><span data-stu-id="e3558-188">Artifact</span></span> | <span data-ttu-id="e3558-189">이름, 위치 및 설명</span><span class="sxs-lookup"><span data-stu-id="e3558-189">Name, location, and remarks</span></span> |
| --- | --- |
| <span data-ttu-id="e3558-190">원격 관리를 위한 SSH 키</span><span class="sxs-lookup"><span data-stu-id="e3558-190">SSH key for remote administration</span></span> |<span data-ttu-id="e3558-191">myBigCluster.key 파일 (hello는 hello CreateElasticSearchCluster가 실행 디렉터리에에서).</span><span class="sxs-lookup"><span data-stu-id="e3558-191">myBigCluster.key file (in hello directory from which hello CreateElasticSearchCluster was run).</span></span> <br /><br /><span data-ttu-id="e3558-192">이 키 파일에 사용 되는 tooconnect toohello 관리 노드일 수 있습니다 (관리자 노드를 hello)를 통해 및 hello 클러스터의 toodata 노드.</span><span class="sxs-lookup"><span data-stu-id="e3558-192">This key file can be used tooconnect toohello admin node and (through hello admin node) toodata nodes in hello cluster.</span></span> |
| <span data-ttu-id="e3558-193">관리 노드</span><span class="sxs-lookup"><span data-stu-id="e3558-193">Admin node</span></span> |<span data-ttu-id="e3558-194">myBigCluster-admin.westus.cloudapp.azure.com </span><span class="sxs-lookup"><span data-stu-id="e3558-194">myBigCluster-admin.westus.cloudapp.azure.com</span></span> <br /><br /><span data-ttu-id="e3558-195">외부 SSH 연결을 허용 하는 원격 Elasticsearch 클러스터 관리-하나만 hello에 대 한 전용된 VM입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-195">A dedicated VM for remote Elasticsearch cluster administration--hello only one that allows external SSH connections.</span></span> <span data-ttu-id="e3558-196">모든 Elasticsearch 서비스를 실행 하지 않는 모든 hello Elasticsearch 클러스터 않지만와 동일한 가상 네트워크 hello 실행 됩니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-196">It runs on hello same virtual network as all hello Elasticsearch cluster nodes, but it does not run any Elasticsearch services.</span></span> |
| <span data-ttu-id="e3558-197">데이터 노드</span><span class="sxs-lookup"><span data-stu-id="e3558-197">Data nodes</span></span> |<span data-ttu-id="e3558-198">myBigCluster1 …</span><span class="sxs-lookup"><span data-stu-id="e3558-198">myBigCluster1 …</span></span> <span data-ttu-id="e3558-199">myBigCluster*N*</span><span class="sxs-lookup"><span data-stu-id="e3558-199">myBigCluster*N*</span></span> <br /><br /><span data-ttu-id="e3558-200">Elasticsearch 및 Kibana 서비스를 실행하는 데이터 노드입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-200">Data nodes that are running Elasticsearch and Kibana services.</span></span> <span data-ttu-id="e3558-201">SSH tooeach 노드를 통해 하지만 hello 관리자 노드를 통해서만 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-201">You can connect via SSH tooeach node, but only via hello admin node.</span></span> |
| <span data-ttu-id="e3558-202">Elasticsearch 클러스터</span><span class="sxs-lookup"><span data-stu-id="e3558-202">Elasticsearch cluster</span></span> |<span data-ttu-id="e3558-203">http://myBigCluster.westus.cloudapp.azure.com/es/</span><span class="sxs-lookup"><span data-stu-id="e3558-203">http://myBigCluster.westus.cloudapp.azure.com/es/</span></span> <br /><br /><span data-ttu-id="e3558-204">hello hello Elasticsearch 클러스터 (참고 hello /es 접미사)에 대 한 기본 끝점입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-204">hello primary endpoint for hello Elasticsearch cluster (note hello /es suffix).</span></span> <span data-ttu-id="e3558-205">기본 HTTP 인증으로 보호 됩니다 (hello 자격 증명의 hello ES MultiNode 템플릿의 esUserName/esPassword 매개 변수를 지정 하는 hello 때문).</span><span class="sxs-lookup"><span data-stu-id="e3558-205">It is protected by basic HTTP authentication (hello credentials were hello specified esUserName/esPassword parameters of hello ES-MultiNode template).</span></span> <span data-ttu-id="e3558-206">기본 클러스터 관리에 대 한 hello 클러스터에 hello h e a d 플러그 인 설치 (http://myBigCluster.westus.cloudapp.azure.com/es/_plugin/head)도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-206">hello cluster has also hello head plug-in installed (http://myBigCluster.westus.cloudapp.azure.com/es/_plugin/head) for basic cluster administration.</span></span> |
| <span data-ttu-id="e3558-207">Kibana 서비스</span><span class="sxs-lookup"><span data-stu-id="e3558-207">Kibana service</span></span> |<span data-ttu-id="e3558-208">http://myBigCluster.westus.cloudapp.azure.com</span><span class="sxs-lookup"><span data-stu-id="e3558-208">http://myBigCluster.westus.cloudapp.azure.com</span></span> <br /><br /><span data-ttu-id="e3558-209">hello Kibana 서비스에서 Elasticsearch 클러스터를 만든 hello tooshow 데이터 설정 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-209">hello Kibana service is set up tooshow data from hello created Elasticsearch cluster.</span></span> <span data-ttu-id="e3558-210">Hello로 보호 됩니다 hello와 같은 인증 자격 증명 자체를 클러스터 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-210">It is protected by hello same authentication credentials as hello cluster itself.</span></span> |

## <a name="in-process-versus-out-of-process-trace-capturing"></a><span data-ttu-id="e3558-211">In-proces와 out-of-process 추적 캡처 비교</span><span class="sxs-lookup"><span data-stu-id="e3558-211">In-process versus out-of-process trace capturing</span></span>
<span data-ttu-id="e3558-212">진단 데이터 수집의 두 가지 기본 방법의 hello 소개에서에서 설명한: in-process 및 out-of-process-합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-212">In hello introduction, we mentioned two fundamental ways of collecting diagnostic data: in-process and out-of-process.</span></span> <span data-ttu-id="e3558-213">각각은 강점 및 약점이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-213">Each has strengths and weaknesses.</span></span>

<span data-ttu-id="e3558-214">Hello의 장점 **프로세스 추적 캡처** 포함:</span><span class="sxs-lookup"><span data-stu-id="e3558-214">Advantages of hello **in-process trace capturing** include:</span></span>

1. <span data-ttu-id="e3558-215">*쉬운 구성 및 배포*</span><span class="sxs-lookup"><span data-stu-id="e3558-215">*Easy configuration and deployment*</span></span>
   
   * <span data-ttu-id="e3558-216">진단 데이터 수집의 hello 구성은 hello 응용 프로그램 구성의 일부입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-216">hello configuration of diagnostic data collection is just part of hello application configuration.</span></span> <span data-ttu-id="e3558-217">것 hello 응용 프로그램의 놓을 것 "동기화" hello로 쉽게 tooalways 유지 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-217">It is easy tooalways keep it "in sync" with hello rest of hello application.</span></span>
   * <span data-ttu-id="e3558-218">응용 프로그램당 또는 서비스당 구성은 쉽게 달성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-218">Per-application or per-service configuration is easily achievable.</span></span>
   * <span data-ttu-id="e3558-219">작업 중이 아닌 추적에서 캡처에 별도 배포 및 구성을 추가 관리 작업 및 오류의 잠재적 소스 hello 진단 에이전트의 일반적으로 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-219">Out-of-process trace capturing usually requires a separate deployment and configuration of hello diagnostic agent, which is an extra administrative task and a potential source of errors.</span></span> <span data-ttu-id="e3558-220">hello 에이전트에 따라 기술에는 종종 hello 에이전트 당 가상 컴퓨터 (노드)의 인스턴스가 하나만 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-220">hello particular agent technology often allows only one instance of hello agent per virtual machine (node).</span></span> <span data-ttu-id="e3558-221">즉, 해당 구성을 hello 컬렉션 hello 진단 구성의 모든 응용 프로그램 간에 공유 되 고 해당 노드에서 실행 되는 서비스.</span><span class="sxs-lookup"><span data-stu-id="e3558-221">This means that configuration for hello collection of hello diagnostic configuration is shared among all applications and services running on that node.</span></span>
2. <span data-ttu-id="e3558-222">*유연성*</span><span class="sxs-lookup"><span data-stu-id="e3558-222">*Flexibility*</span></span>
   
   * <span data-ttu-id="e3558-223">hello 응용 프로그램 데이터 보낼 수 있습니다 hello toogo, 필요한 경우 항상으로 hello 대상 데이터 저장소 시스템을 지 원하는 수 있는 클라이언트 라이브러리입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-223">hello application can send hello data wherever it needs toogo, as long as there is a client library that supports hello targeted data storage system.</span></span> <span data-ttu-id="e3558-224">새로운 싱크를 원하는 대로 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-224">New sinks can be added as desired.</span></span>
   * <span data-ttu-id="e3558-225">복잡한 캡처, 필터링 및 데이터 집계 규칙을 구현할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-225">Complex capture, filtering, and data-aggregation rules can be implemented.</span></span>
   * <span data-ttu-id="e3558-226">캡처하는 작업 중이 아닌 추적 에이전트 지원 hello hello 데이터 싱크에 종종 제한 됩니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-226">An out-of-process trace capturing is often limited by hello data sinks that hello agent supports.</span></span> <span data-ttu-id="e3558-227">일부 에이전트는 확장할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-227">Some agents are extensible.</span></span>
3. <span data-ttu-id="e3558-228">*액세스 toointernal 응용 프로그램 데이터와 컨텍스트*</span><span class="sxs-lookup"><span data-stu-id="e3558-228">*Access toointernal application data and context*</span></span>
   
   * <span data-ttu-id="e3558-229">hello 진단 하위 시스템 hello 응용 프로그램/서비스 프로세스 내에서 실행 컨텍스트 정보를 사용 하 여 hello 추적을 쉽게 강화할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-229">hello diagnostic subsystem running inside hello application/service process can easily augment hello traces with contextual information.</span></span>
   * <span data-ttu-id="e3558-230">Hello 작업 중이 아닌 경우에서 hello 데이터 전송 해야 tooan 에이전트 일부 프로세스 간 통신 메커니즘을 통해 Windows 용 이벤트 추적 등입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-230">In hello out-of-process approach, hello data must be sent tooan agent via some inter-process communication mechanism, such as Event Tracing for Windows.</span></span> <span data-ttu-id="e3558-231">이 메커니즘에 따라 추가 제한 사항이 적용될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-231">This mechanism could impose additional limitations.</span></span>

<span data-ttu-id="e3558-232">Hello의 장점 **out-of-process-추적 캡처** 포함:</span><span class="sxs-lookup"><span data-stu-id="e3558-232">Advantages of hello **out-of-process trace capturing** include:</span></span>

1. <span data-ttu-id="e3558-233">*크래시 덤프를 수집 하 고 hello 기능 toomonitor hello 응용 프로그램*</span><span class="sxs-lookup"><span data-stu-id="e3558-233">*hello ability toomonitor hello application and collect crash dumps*</span></span>
   
   * <span data-ttu-id="e3558-234">캡처 프로세스에서 추적 실패할 수 있습니다 hello 응용 프로그램 toostart 못하거나가 충돌 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-234">In-process trace capturing may be unsuccessful if hello application fails toostart or crashes.</span></span> <span data-ttu-id="e3558-235">독립 에이전트는 중요한 문제 해결 정보를 캡처할 가능성이 훨씬 큽니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-235">An independent agent has a much better chance of capturing crucial troubleshooting information.</span></span><br /><br />
2. <span data-ttu-id="e3558-236">*완성도, 견고성 및 검증된 성능*</span><span class="sxs-lookup"><span data-stu-id="e3558-236">*Maturity, robustness, and proven performance*</span></span>
   
   * <span data-ttu-id="e3558-237">에이전트 (예: Microsoft Azure 진단 에이전트가) 플랫폼 공급 업체에서 개발 된 주체 toorigorous 테스트 및 전투 강화 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-237">An agent developed by a platform vendor (such as a Microsoft Azure Diagnostics agent) has been subject toorigorous testing and battle-hardening.</span></span>
   * <span data-ttu-id="e3558-238">캡처 프로세스에서 추적을으로 주의 해야 tooensure 응용 프로그램 프로세스에서 진단 데이터를 보내는 hello 활동 hello 응용 프로그램의 주요 작업에 방해가 하거나 타이밍 또는 성능 문제가 발생 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-238">With in-process trace capturing, care must be taken tooensure that hello activity of sending diagnostic data from an application process does not interfere with hello application's main tasks or introduce timing or performance problems.</span></span> <span data-ttu-id="e3558-239">독립적으로 실행 중인 에이전트 발생할 가능성이 적으므로 toothese 문제 이며 특별히 디자인 된 toolimit hello 시스템에 미치는 영향입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-239">An independently running agent is less prone toothese issues and is specifically designed toolimit its impact on hello system.</span></span>

<span data-ttu-id="e3558-240">두 방법 중 하나를 혜택 및 가능한 toocombine 않습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-240">It is possible toocombine and benefit from both approaches.</span></span> <span data-ttu-id="e3558-241">실제로 대부분의 응용 프로그램에 대 한 최상의 솔루션 hello 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-241">Indeed, it might be hello best solution for many applications.</span></span>

<span data-ttu-id="e3558-242">여기서 hello 사용 **Microsoft.Diagnostic.Listeners 라이브러리** 및 서비스 패브릭 응용 프로그램 tooan Elasticsearch 클러스터에서 toosend 데이터 캡처 hello 프로세스에서 추적 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-242">Here, we use hello **Microsoft.Diagnostic.Listeners library** and hello in-process trace capturing toosend data from a Service Fabric application tooan Elasticsearch cluster.</span></span>

## <a name="use-hello-listeners-library-toosend-diagnostic-data-tooelasticsearch"></a><span data-ttu-id="e3558-243">Hello 수신기 라이브러리 toosend tooElasticsearch 진단 데이터를 사용 하 여</span><span class="sxs-lookup"><span data-stu-id="e3558-243">Use hello Listeners library toosend diagnostic data tooElasticsearch</span></span>
<span data-ttu-id="e3558-244">hello Microsoft.Diagnostic.Listeners 라이브러리는 PartyCluster 샘플 서비스 패브릭 응용 프로그램의 일부입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-244">hello Microsoft.Diagnostic.Listeners library is part of PartyCluster sample Service Fabric application.</span></span> <span data-ttu-id="e3558-245">toouse 하기:</span><span class="sxs-lookup"><span data-stu-id="e3558-245">toouse it:</span></span>

1. <span data-ttu-id="e3558-246">다운로드 [hello PartyCluster 샘플](https://github.com/Azure-Samples/service-fabric-dotnet-management-party-cluster) GitHub에서 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-246">Download [hello PartyCluster sample](https://github.com/Azure-Samples/service-fabric-dotnet-management-party-cluster) from GitHub.</span></span>
2. <span data-ttu-id="e3558-247">Hello Microsoft.Diagnostics.Listeners 및 Microsoft.Diagnostics.Listeners.Fabric 프로젝트 (전체 폴더) hello PartyCluster 샘플 디렉터리 toohello 솔루션의 폴더에서 복사 toosend hello 데이터 tooElasticsearch 되어 있는 hello 응용 프로그램 .</span><span class="sxs-lookup"><span data-stu-id="e3558-247">Copy hello Microsoft.Diagnostics.Listeners and Microsoft.Diagnostics.Listeners.Fabric projects (whole folders) from hello PartyCluster sample directory toohello solution folder of hello application that is supposed toosend hello data tooElasticsearch.</span></span>
3. <span data-ttu-id="e3558-248">Hello 대상 솔루션을 열고 hello 솔루션 탐색기에서에서 hello 솔루션 노드를 마우스 오른쪽 단추로 클릭 하 고 선택 **기존 프로젝트 추가**합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-248">Open hello target solution, right-click hello solution node in hello Solution Explorer, and choose **Add Existing Project**.</span></span> <span data-ttu-id="e3558-249">Hello Microsoft.Diagnostics.Listeners 프로젝트 toohello 솔루션을 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-249">Add hello Microsoft.Diagnostics.Listeners project toohello solution.</span></span> <span data-ttu-id="e3558-250">반복을 hello hello Microsoft.Diagnostics.Listeners.Fabric 프로젝트에 대해 동일 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-250">Repeat hello same for hello Microsoft.Diagnostics.Listeners.Fabric project.</span></span>
4. <span data-ttu-id="e3558-251">서비스는 프로젝트가 toohello 두 개의 추가 된 프로젝트에서 프로젝트 참조를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-251">Add a project reference from your service project(s) toohello two added projects.</span></span> <span data-ttu-id="e3558-252">(Toosend 데이터 tooElasticsearch 되어 있는 각 서비스를 참조 해야 Microsoft.Diagnostics.EventListeners 및 Microsoft.Diagnostics.EventListeners.Fabric).</span><span class="sxs-lookup"><span data-stu-id="e3558-252">(Each service that is supposed toosend data tooElasticsearch should reference Microsoft.Diagnostics.EventListeners and Microsoft.Diagnostics.EventListeners.Fabric).</span></span>
   
    ![프로젝트에서 tooMicrosoft.Diagnostics.EventListeners 및 Microsoft.Diagnostics.EventListeners.Fabric 라이브러리 참조][1]

### <a name="service-fabric-general-availability-release-and-microsoftdiagnosticstracing-nuget-package"></a><span data-ttu-id="e3558-254">서비스 패브릭 일반 공급 릴리스 및 Microsoft.Diagnostics.Tracing Nuget 패키지</span><span class="sxs-lookup"><span data-stu-id="e3558-254">Service Fabric General Availability release and Microsoft.Diagnostics.Tracing Nuget package</span></span>
<span data-ttu-id="e3558-255">서비스 패브릭 일반 공급 릴리스(2.0.135, 2016년 3월 31일 출시)를 사용하여 빌드한 응용 프로그램은 **.NET Framework 4.5.2**를 대상으로 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-255">Applications built with Service Fabric General Availability release (2.0.135, released March 31, 2016) target **.NET Framework 4.5.2**.</span></span> <span data-ttu-id="e3558-256">이 버전에는 hello hello GA 릴리스의 hello 시 Azure에서 지 원하는.NET Framework의 hello 가장 높은 버전이입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-256">This version is hello highest version of hello .NET Framework supported by Azure at hello time of hello GA release.</span></span> <span data-ttu-id="e3558-257">그러나이 버전의 hello framework 특정 EventListener Api 해당 hello 라이브러리가 Microsoft.Diagnostics.Listeners에 부족 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-257">Unfortunately, this version of hello framework lacks certain EventListener APIs that hello Microsoft.Diagnostics.Listeners library needs.</span></span> <span data-ttu-id="e3558-258">EventSource (패브릭 응용 프로그램에서 Api 로깅 hello 기본을 형성 하는 hello 구성) 및 EventListener 밀접 하 게 결합 된 hello Microsoft.Diagnostics.Listeners 라이브러리를 사용 하는 모든 프로젝트의 대체 구현을 사용 해야 EventSource 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-258">Because EventSource (hello component that forms hello basis of logging APIs in Fabric applications) and EventListener are tightly coupled, every project that uses hello Microsoft.Diagnostics.Listeners library must use an alternative implementation of EventSource.</span></span> <span data-ttu-id="e3558-259">이 구현 hello **Microsoft.Diagnostics.Tracing Nuget 패키지**, Microsoft에서 작성 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-259">This implementation is provided by hello **Microsoft.Diagnostics.Tracing Nuget package**, authored by Microsoft.</span></span> <span data-ttu-id="e3558-260">hello 패키지에에서 포함 되어 있으면 hello 프레임 워크 코드 변경 없이 참조 네임 스페이스 변경 외 필요가 EventSource와 완벽 하 게 이전 버전과 호환은입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-260">hello package is fully backward-compatible with EventSource included in hello framework, so no code changes should be necessary other than referenced namespace changes.</span></span>

<span data-ttu-id="e3558-261">toostart toosend 데이터 tooElasticsearch 필요한 각 서비스 프로젝트에 대해 다음이 단계를 수행 hello Microsoft.Diagnostics.Tracing 구현의 hello EventSource 클래스를 사용 하 여:</span><span class="sxs-lookup"><span data-stu-id="e3558-261">toostart using hello Microsoft.Diagnostics.Tracing implementation of hello EventSource class, follow these steps for each service project that needs toosend data tooElasticsearch:</span></span>

1. <span data-ttu-id="e3558-262">Hello 서비스 프로젝트를 마우스 오른쪽 단추로 클릭 하 고 선택 **Nuget 패키지 관리**합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-262">Right-click on hello service project and choose **Manage Nuget Packages**.</span></span>
2. <span data-ttu-id="e3558-263">(선택 되지 않은 이미) 하는 경우 toohello nuget.org 패키지 원본 및 검색에 대 한 전환 "**Microsoft.Diagnostics.Tracing**"입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-263">Switch toohello nuget.org package source (if it is not already selected) and search for "**Microsoft.Diagnostics.Tracing**".</span></span>
3. <span data-ttu-id="e3558-264">Hello 설치 `Microsoft.Diagnostics.Tracing.EventSource` 패키지 (및 해당 종속성).</span><span class="sxs-lookup"><span data-stu-id="e3558-264">Install hello `Microsoft.Diagnostics.Tracing.EventSource` package (and its dependencies).</span></span>
4. <span data-ttu-id="e3558-265">열기 hello **ServiceEventSource.cs** 또는 **ActorEventSource.cs** 서비스 프로젝트에서 파일 및 hello 바꾸기 `using System.Diagnostics.Tracing` hello로 hello 파일 맨 위에 지시문 `using Microsoft.Diagnostics.Tracing` 지시문입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-265">Open hello **ServiceEventSource.cs** or **ActorEventSource.cs** file in your service project and replace hello `using System.Diagnostics.Tracing` directive on top of hello file with hello `using Microsoft.Diagnostics.Tracing` directive.</span></span>

<span data-ttu-id="e3558-266">이러한 단계는 필요한 됩니다 한 번 hello **.NET Framework 4.6** Microsoft Azure에서 지원 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-266">These steps will not be necessary once hello **.NET Framework 4.6** is supported by Microsoft Azure.</span></span>

### <a name="elasticsearch-listener-instantiation-and-configuration"></a><span data-ttu-id="e3558-267">Elasticsearch 수신기 인스턴스화 및 구성</span><span class="sxs-lookup"><span data-stu-id="e3558-267">Elasticsearch listener instantiation and configuration</span></span>
<span data-ttu-id="e3558-268">hello tooElasticsearch 진단 데이터를 보내기 위한 마지막 단계 toocreate의 인스턴스가 `ElasticSearchListener` 고 Elasticsearch 연결 데이터를 구성 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-268">hello final step for sending diagnostic data tooElasticsearch is toocreate an instance of `ElasticSearchListener` and configure it with Elasticsearch connection data.</span></span> <span data-ttu-id="e3558-269">hello 수신기는 자동으로 hello 서비스 프로젝트에 정의 된 EventSource 클래스를 통해 발생 하는 모든 이벤트를 캡처합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-269">hello listener automatically captures all events raised via EventSource classes defined in hello service project.</span></span> <span data-ttu-id="e3558-270">필요한 toobe hello 서비스의 hello 수명 동안 활성 상태로 hello 최상의 toocreate hello 서비스 초기화 코드에 배치 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-270">It needs toobe alive during hello lifetime of hello service, so hello best place toocreate it is in hello service initialization code.</span></span> <span data-ttu-id="e3558-271">상태 비저장 서비스에 대 한 hello 초기화 코드 hello 필요한 변경 된 후 방식을 보여 줍니다 다음과 같습니다 (추가부터 시작 하는 주석에서 지적 `****`):</span><span class="sxs-lookup"><span data-stu-id="e3558-271">Here is how hello initialization code for a stateless service could look after hello necessary changes (additions pointed out in comments starting with `****`):</span></span>

```csharp
using System;
using System.Diagnostics;
using System.Fabric;
using System.Threading;
using System.Threading.Tasks;
using Microsoft.ServiceFabric.Services.Runtime;

// **** Add hello following directives
using Microsoft.Diagnostics.EventListeners;
using Microsoft.Diagnostics.EventListeners.Fabric;

namespace Stateless1
{
    internal static class Program
    {
        /// <summary>
        /// This is hello entry point of hello service host process.
        /// </summary>        
        private static void Main()
        {
            try
            {
                // **** Instantiate ElasticSearchListener
                var configProvider = new FabricConfigurationProvider("ElasticSearchEventListener");
                ElasticSearchListener esListener = null;
                if (configProvider.HasConfiguration)
                {
                    esListener = new ElasticSearchListener(configProvider, new FabricHealthReporter("ElasticSearchEventListener"));
                }

                // hello ServiceManifest.XML file defines one or more service type names.
                // Registering a service maps a service type name tooa .NET type.
                // When Service Fabric creates an instance of this service type,
                // an instance of hello class is created in this host process.

                ServiceRuntime.RegisterServiceAsync("Stateless1Type", 
                    context => new Stateless1(context)).GetAwaiter().GetResult();

                ServiceEventSource.Current.ServiceTypeRegistered(Process.GetCurrentProcess().Id, typeof(Stateless1).Name);

                // Prevents this host process from terminating so services keep running.
                Thread.Sleep(Timeout.Infinite);

                // **** Ensure that hello ElasticSearchListner instance is not garbage-collected prematurely
                GC.KeepAlive(esListener);
            }
            catch (Exception e)
            {
                ServiceEventSource.Current.ServiceHostInitializationFailed(e);
                throw;
            }
        }
    }
}
```

<span data-ttu-id="e3558-272">Elasticsearch 연결 데이터 hello 서비스 구성 파일에서 별도 섹션에 저장 되어야 합니다 (**PackageRoot\Config\Settings.xml**).</span><span class="sxs-lookup"><span data-stu-id="e3558-272">Elasticsearch connection data should be put in a separate section in hello service configuration file (**PackageRoot\Config\Settings.xml**).</span></span> <span data-ttu-id="e3558-273">hello 섹션의 hello 이름 toohello 전달 된 값이 toohello 일치 해야 `FabricConfigurationProvider` 생성자 예:</span><span class="sxs-lookup"><span data-stu-id="e3558-273">hello name of hello section must correspond toohello value passed toohello `FabricConfigurationProvider` constructor, for example:</span></span>

```xml
<Section Name="ElasticSearchEventListener">
  <Parameter Name="serviceUri" Value="http://myBigCluster.westus.cloudapp.azure.com/es/" />
  <Parameter Name="userName" Value="(ES user name)" />
  <Parameter Name="password" Value="(ES user password)" />
  <Parameter Name="indexNamePrefix" Value="myapp" />
</Section>
```
<span data-ttu-id="e3558-274">값을 hello `serviceUri`, `userName` 및 `password` 매개 변수 toohello Elasticsearch 클러스터 끝점 주소, Elasticsearch 사용자 이름 및 암호를 해당 각각.</span><span class="sxs-lookup"><span data-stu-id="e3558-274">hello values of `serviceUri`, `userName` and `password` parameters correspond toohello Elasticsearch cluster endpoint address, Elasticsearch user name, and password, respectively.</span></span> <span data-ttu-id="e3558-275">`indexNamePrefix`Elasticsearch 인덱스;에 대 한 hello 접두사 hello Microsoft.Diagnostics.Listeners 라이브러리는 매일의 데이터에 대 한 새 인덱스를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-275">`indexNamePrefix` is hello prefix for Elasticsearch indexes; hello Microsoft.Diagnostics.Listeners library creates a new index for its data daily.</span></span>

### <a name="verification"></a><span data-ttu-id="e3558-276">확인</span><span class="sxs-lookup"><span data-stu-id="e3558-276">Verification</span></span>
<span data-ttu-id="e3558-277">이것으로 끝입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-277">That's it!</span></span> <span data-ttu-id="e3558-278">이제 hello 서비스가 실행 될 때마다 시작 hello 구성에 지정 된 추적 toohello Elasticsearch 서비스를 전송 합니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-278">Now, whenever hello service is run, it starts sending traces toohello Elasticsearch service specified in hello configuration.</span></span> <span data-ttu-id="e3558-279">Opening hello Kibana UI hello 대상 Elasticsearch 인스턴스와 연관 하 여이 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-279">You can verify this by opening hello Kibana UI associated with hello target Elasticsearch instance.</span></span> <span data-ttu-id="e3558-280">예에서 hello 페이지 주소 http://myBigCluster.westus.cloudapp.azure.com/는입니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-280">In our example, hello page address is http://myBigCluster.westus.cloudapp.azure.com/.</span></span> <span data-ttu-id="e3558-281">Hello에 대 한 선택 hello 이름 접두사를 사용 하 여 인덱스 검사 `ElasticSearchListener` 인스턴스 실제로 생성 되어 데이터로 채워집니다.</span><span class="sxs-lookup"><span data-stu-id="e3558-281">Check that indexes with hello name prefix chosen for hello `ElasticSearchListener` instance have indeed been created and populated with data.</span></span>

![PartyCluster 응용 프로그램 이벤트를 보여 주는 Kibana][2]

## <a name="next-steps"></a><span data-ttu-id="e3558-283">다음 단계</span><span class="sxs-lookup"><span data-stu-id="e3558-283">Next steps</span></span>
* [<span data-ttu-id="e3558-284">서비스 패브릭 서비스 진단 및 모니터링에 대한 자세한 정보</span><span class="sxs-lookup"><span data-stu-id="e3558-284">Learn more about diagnosing and monitoring a Service Fabric service</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)

<!--Image references-->
[1]: ./media/service-fabric-diagnostics-how-to-use-elasticsearch/listener-lib-references.png
[2]: ./media/service-fabric-diagnostics-how-to-use-elasticsearch/kibana.png
