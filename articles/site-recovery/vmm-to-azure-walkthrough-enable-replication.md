---
title: "Azure Site Recovery를 사용하여 VMM 클라우드의 Hyper-V VM을 Azure로 복제할 수 있도록 설정 | Microsoft 문서"
description: "Azure Site Recovery 서비스를 사용하여 VMM 클라우드의 Hyper-V VM을 Azure로 복제할 수 있도록 설정하는 방법을 설명합니다."
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: carmonm
editor: 
ms.assetid: 89a2c4fc-7e03-4a86-a2c0-52831ccebc1a
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/23/2017
ms.author: raynew
ms.openlocfilehash: 96a817e43a830e836f2faa4603fc88ed9c0b1828
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/29/2017
---
# <a name="step-11-enable-replication-to-azure-for-hyper-v-vms-in-vmm-clouds"></a><span data-ttu-id="b1e18-103">11단계: VMM 클라우드의 Hyper-V VM을 Azure로 복제할 수 있도록 설정</span><span class="sxs-lookup"><span data-stu-id="b1e18-103">Step 11: Enable replication to Azure for Hyper-V VMs in VMM clouds</span></span>

<span data-ttu-id="b1e18-104">복제 정책을 설정한 후 이 문서의 내용을 참조하여 Azure Portal에서 [Azure Site Recovery](site-recovery-overview.md) 서비스를 사용해 System Center Virtual Machine Manager(VMM) 클라우드에서 관리되는 온-프레미스 Hyper-V VM(가상 컴퓨터)을 Azure로 복제하도록 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-104">After you've set up a replication policy, use this article to enable replication for on-premises Hyper-V virtual machines (VMs) managed in System Center Virtual Machine Manager (VMM) clouds), to Azure, using the [Azure Site Recovery](site-recovery-overview.md) service in the Azure portal.</span></span>

<span data-ttu-id="b1e18-105">이 문서의 하단 또는 [Azure Recovery Services 포럼](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr)에서 의견이나 질문을 게시합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-105">Post comments and questions at the bottom of this article, or on the [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>


## <a name="before-you-start"></a><span data-ttu-id="b1e18-106">시작하기 전에</span><span class="sxs-lookup"><span data-stu-id="b1e18-106">Before you start</span></span>

<span data-ttu-id="b1e18-107">Azure 계정에 Azure VM을 만들기 위한 올바른 [권한](site-recovery-role-based-linked-access-control.md#permissions-required-to-enable-replication-for-new-virtual-machines)이 있는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-107">Make sure your Azure account has the correct [permissions](site-recovery-role-based-linked-access-control.md#permissions-required-to-enable-replication-for-new-virtual-machines)to create Azure VMs.</span></span> <span data-ttu-id="b1e18-108">Azure 역할 기반 액세스 제어에 대해 자세히 알아보려면 [여기](../active-directory/role-based-access-built-in-roles.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="b1e18-108">[Learn more](../active-directory/role-based-access-built-in-roles.md) about Azure role-based access control.</span></span>

## <a name="exclude-disks-from-replication"></a><span data-ttu-id="b1e18-109">복제에서 디스크 제외</span><span class="sxs-lookup"><span data-stu-id="b1e18-109">Exclude disks from replication</span></span>

<span data-ttu-id="b1e18-110">기본적으로 컴퓨터의 모든 디스크가 복제됩니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-110">By default all disks on a machine are replicated.</span></span> <span data-ttu-id="b1e18-111">디스크를 복제에서 제외할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-111">You can exclude disks from replication.</span></span> <span data-ttu-id="b1e18-112">예를 들어 임시 데이터 또는 컴퓨터나 응용 프로그램이 다시 시작할 때마다 새로 고쳐지는 데이터(예: pagefile.sys 또는 SQL Server tempdb)가 포함된 디스크를 복제하고 싶지 않을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-112">For example you might not want to replicate disks with temporary data, or data that's refreshed each time a machine or application restarts (for example pagefile.sys or SQL Server tempdb).</span></span> [<span data-ttu-id="b1e18-113">자세히 알아보기</span><span class="sxs-lookup"><span data-stu-id="b1e18-113">Learn more</span></span>](site-recovery-exclude-disk.md)

## <a name="replicate-vms"></a><span data-ttu-id="b1e18-114">VM 복제</span><span class="sxs-lookup"><span data-stu-id="b1e18-114">Replicate VMs</span></span>

<span data-ttu-id="b1e18-115">다음과 같이 VM에 대해 복제를 활성화합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-115">Enable replication for VMs as follows:</span></span>  

1. <span data-ttu-id="b1e18-116">**2단계: 응용 프로그램 복제** > **원본**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-116">Click **Step 2: Replicate application** > **Source**.</span></span> <span data-ttu-id="b1e18-117">처음으로 복제를 활성화한 후 자격 증명 모음에서 **+복제**를 클릭하여 추가 컴퓨터에 대해 복제를 활성화합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-117">After you've enabled replication for the first time, click **+Replicate** in the vault to enable replication for additional machines.</span></span>

    ![복제 활성화](./media/vmm-to-azure-walkthrough-enable-replication/enable-replication1.png)
2. <span data-ttu-id="b1e18-119">**원본** 블레이드에서 Hyper-V 호스트가 있는 VMM 서버 및 클라우드를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-119">In the **Source** blade, select the VMM server, and the cloud in which the Hyper-V hosts are located.</span></span> <span data-ttu-id="b1e18-120">그런 후 **OK**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-120">Then click **OK**.</span></span>

    ![복제 활성화](./media/vmm-to-azure-walkthrough-enable-replication/enable-replication-source.png)
3. <span data-ttu-id="b1e18-122">**대상**에서 구독, 장애 조치(failover) 후 배포 모델 및 복제된 데이터에 사용 중인 저장소 계정을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-122">In **Target**, select the subscription, post-failover deployment model, and the storage account you're using for replicated data.</span></span>

    ![복제 활성화](./media/vmm-to-azure-walkthrough-enable-replication/enable-replication-target.png)
4. <span data-ttu-id="b1e18-124">사용하려는 저장소 계정을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-124">Select the storage account you want to use.</span></span> <span data-ttu-id="b1e18-125">갖고 있는 저장소 계정 말고 다른 저장소 계정을 사용하려면 [새로 만듭니다](#set-up-an-azure-storage-account).</span><span class="sxs-lookup"><span data-stu-id="b1e18-125">If you want to use a different storage account than those you have, you can [create one](#set-up-an-azure-storage-account).</span></span> <span data-ttu-id="b1e18-126">복제된 데이터에 프리미엄 저장소 계정을 사용하는 경우 온-프레미스 데이터에 지속적인 변화를 캡처하는 복제 로그를 저장하는 추가 표준 저장소 계정을 선택해야 합니다. Resource Manager 모델을 사용하여 저장소 계정을 만들려면 **새로 만들기**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-126">If you’re using a premium storage account for replicated data, you need to select  an additional standard storage account to store replication logs that capture ongoing changes to on-premises data.To create a storage account using the Resource Manager model click **Create new**.</span></span> <span data-ttu-id="b1e18-127">클래식 모델을 사용하여 저장소 계정을 만들려면 [Azure 포털](../storage/common/storage-create-storage-account.md)에서 만들면 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-127">If you want to create a storage account using the classic model, do that [in the Azure portal](../storage/common/storage-create-storage-account.md).</span></span> <span data-ttu-id="b1e18-128">그런 후 **OK**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-128">Then click **OK**.</span></span>
5. <span data-ttu-id="b1e18-129">장애 조치(failover) 후 Azure VM이 생성될 때 연결될 Azure 네트워크 및 서브넷을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-129">Select the Azure network and subnet to which Azure VMs will connect, when they're created after failover.</span></span> <span data-ttu-id="b1e18-130">컴퓨터마다 Azure 네트워크를 선택하려면 **나중에 구성**을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-130">Select **Configure now for selected machines**, to apply the network setting to all machines you select for protection.</span></span> <span data-ttu-id="b1e18-131">갖고 있는 네트워크 말고 다른 네트워크를 사용하려면 **새로 만듭니다**.</span><span class="sxs-lookup"><span data-stu-id="b1e18-131">Select **Configure later**, to select the Azure network per machine.</span></span> <span data-ttu-id="b1e18-132">Resource Manager 모델을 사용하여 네트워크를 만들려면 [새로 만들기](#set-up-an-azure-network)를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-132">If you want to use a different network from those you have, you can [create one](#set-up-an-azure-network).</span></span> <span data-ttu-id="b1e18-133">Resource Manager 모델을 사용하여 네트워크를 만들려면 **새로 만들기**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-133">To create a network using the Resource Manager model click **Create new**.</span></span> <span data-ttu-id="b1e18-134">클래식 모델을 사용하여 네트워크를 만들려면 [Azure 포털](../virtual-network/virtual-networks-create-vnet-classic-pportal.md)에서 만들면 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-134">If you want to create a network using the classic model, do that [in the Azure portal](../virtual-network/virtual-networks-create-vnet-classic-pportal.md).</span></span> <span data-ttu-id="b1e18-135">해당하는 경우 서브넷을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-135">Select a subnet if applicable.</span></span> <span data-ttu-id="b1e18-136">그런 후 **OK**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-136">Then click **OK**.</span></span>
6. <span data-ttu-id="b1e18-137">**Virtual Machines** > **가상 컴퓨터 선택**에서 복제하려는 각 컴퓨터를 클릭하여 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-137">In **Virtual Machines** > **Select virtual machines**, click and select each machine you want to replicate.</span></span> <span data-ttu-id="b1e18-138">복제를 활성화할 수 있는 컴퓨터만 선택할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-138">You can only select machines for which replication can be enabled.</span></span> <span data-ttu-id="b1e18-139">그런 후 **OK**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-139">Then click **OK**.</span></span>

    ![복제 활성화](./media/vmm-to-azure-walkthrough-enable-replication/enable-replication5.png)

7. <span data-ttu-id="b1e18-141">**속성** > **속성 구성**에서 선택한 VM의 운영 체제 및 OS 디스크를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-141">In **Properties** > **Configure properties**, select the operating system for the selected VMs, and the OS disk.</span></span>

    - <span data-ttu-id="b1e18-142">Azure VM 이름(대상 이름)이 [Azure Virtual Machine 요구 사항](site-recovery-support-matrix-to-azure.md#failed-over-azure-vm-requirements)을 충족하는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-142">Verify that the Azure VM name (target name) complies with [Azure virtual machine requirements](site-recovery-support-matrix-to-azure.md#failed-over-azure-vm-requirements).</span></span>   
    - <span data-ttu-id="b1e18-143">기본적으로 VM의 모든 디스크가 복제에 선택되지만 디스크를 지워서 제외할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-143">By default all the disks of the VM are selected for replication, but you can clear disks to exclude them.</span></span>

        - <span data-ttu-id="b1e18-144">복제 대역폭을 줄이기 위해 디스크를 제외할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-144">You might want to exclude disks to reduce replication bandwidth.</span></span> <span data-ttu-id="b1e18-145">예를 들어 임시 데이터 또는 컴퓨터나 앱이 다시 시작할 때마다 새로 고쳐지는 데이터(예: pagefile.sys 또는 SQL Server tempdb)가 포함된 디스크를 복제에서 제외하려는 경우가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-145">For example, you might not want to replicate disks with temporary data, or data that's refreshed each time a machine or apps restarts (such as pagefile.sys or Microsoft SQL Server tempdb).</span></span> <span data-ttu-id="b1e18-146">디스크를 선택 취소하여 복제에서 해당 디스크를 제외할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-146">You can exclude the disk from replication by unselecting the disk.</span></span>
        - <span data-ttu-id="b1e18-147">기본 디스크만 제외할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-147">Only basic disks can be exclude.</span></span> <span data-ttu-id="b1e18-148">OS 디스크는 제외할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-148">You can't exclude OS disks.</span></span>
        - <span data-ttu-id="b1e18-149">동적 디스크는 제외하지 않는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-149">We recommend that you don't exclude dynamic disks.</span></span> <span data-ttu-id="b1e18-150">Site Recovery는 게스트 VM 내의 가상 하드 디스크가 기본 디스크인지 아니면 동적 디스크인지 식별할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-150">Site Recovery can't identify whether a virtual hard disk inside a guest VM is basic or dynamic.</span></span> <span data-ttu-id="b1e18-151">모든 종속적인 동적 볼륨 디스크가 제외되지 않으면, 보호된 동적 디스크는 VM이 장애 조치되면 실패한 디스크로 나타나며 해당 디스크에 있는 데이터는 액세스할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-151">If all dependent dynamic volume disks aren't excluded, the protected dynamic disk will show as a failed disk when the VM fails over, and the data on that disk won't be accessible.</span></span>
        - <span data-ttu-id="b1e18-152">복제를 사용하도록 설정한 후 복제에 대해 디스크를 추가 또는 제거할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-152">After replication is enabled, you can't add or remove disks for replication.</span></span> <span data-ttu-id="b1e18-153">디스크를 추가하거나 제외하려는 경우 VM에 대한 보호를 사용하지 않도록 설정한 다음 다시 사용하도록 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-153">If you want to add or exclude a disk, you need to disable protection for the VM, and then re-enable it.</span></span>
        - <span data-ttu-id="b1e18-154">Azure에서 수동으로 만드는 디스크는 장애 복구되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-154">Disks you create manually in Azure aren't failed back.</span></span> <span data-ttu-id="b1e18-155">예를 들어 디스크 3장을 장애 조치하고 2장을 직접 Azure VM에서 만든다면 장애 조치된 3장의 디스크만이 Azure에서 다시 Hyper-V로 장애 복구됩니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-155">For example, if you fail over three disks, and create two directly in Azure VM, only the three disks which were failed over will be failed back from Azure to Hyper-V.</span></span> <span data-ttu-id="b1e18-156">장애 복구 또는 Hyper-V에서 Azure로 역방향 복제에서 수동으로 만든 디스크를 포함할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-156">You can't include disks created manually in failback, or in reverse replication from Hyper-V to Azure.</span></span>
        - <span data-ttu-id="b1e18-157">응용 프로그램 작동에 필요한 디스크를 제외하면 Azure로 장애 조치(failover) 후 복제된 응용 프로그램이 실행될 수 있도록 디스크를 Azure에 수동으로 만들어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-157">If you exclude a disk that's needed for an application to operate, after failover to Azure you need to create it manually in Azure, so that the replicated application can run.</span></span> <span data-ttu-id="b1e18-158">또는 Azure Automation을 복구 계획에 통합하여 컴퓨터의 장애 조치(failover) 동안 디스크를 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-158">Alternatively, you could integrate Azure automation into a recovery plan, to create the disk during failover of the machine.</span></span>

    <span data-ttu-id="b1e18-159">**확인**을 클릭하여 변경 내용을 저장합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-159">Click **OK** to save changes.</span></span> <span data-ttu-id="b1e18-160">나중에 추가 속성을 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-160">You can set additional properties later.</span></span>

    ![복제 활성화](./media/vmm-to-azure-walkthrough-enable-replication/enable-replication6-with-exclude-disk.png)

8. <span data-ttu-id="b1e18-162">**복제 설정** > **복제 설정 구성**에서 보호되는 VM에 적용할 복제 정책을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-162">In **Replication settings** > **Configure replication settings**, select the replication policy you want to apply for the protected VMs.</span></span> <span data-ttu-id="b1e18-163">그런 후 **OK**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-163">Then click **OK**.</span></span> <span data-ttu-id="b1e18-164">**복제 정책** > 정책 이름 > **설정 편집**에서 복제 정책을 수정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-164">You can modify the replication policy in **Replication policies** > policy name > **Edit Settings**.</span></span> <span data-ttu-id="b1e18-165">적용하는 변경 사항은 이미 복제 중인 컴퓨터와 새 컴퓨터에 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-165">Changes you apply are used for machines that are already replicating, and new machines.</span></span>

   ![복제 활성화](./media/vmm-to-azure-walkthrough-enable-replication/enable-replication7.png)

<span data-ttu-id="b1e18-167">**작업** > **Site Recovery 작업**에서 **보호 사용** 작업의 진행률을 추적할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-167">You can track progress of the **Enable Protection** job in **Jobs** > **Site Recovery jobs**.</span></span> <span data-ttu-id="b1e18-168">**보호 완료** 작업이 실행된 후에는 컴퓨터가 장애 조치(failover)를 수행할 준비가 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-168">After the **Finalize Protection** job runs, the machine is ready for failover.</span></span>



## <a name="next-steps"></a><span data-ttu-id="b1e18-169">다음 단계</span><span class="sxs-lookup"><span data-stu-id="b1e18-169">Next steps</span></span>

<span data-ttu-id="b1e18-170">[12단계: 테스트 장애 조치(failover) 실행](vmm-to-azure-walkthrough-test-failover.md)으로 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="b1e18-170">Go to [Step 12: Run a test failover](vmm-to-azure-walkthrough-test-failover.md)</span></span>
