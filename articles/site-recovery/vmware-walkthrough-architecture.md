---
title: "Azure에 대한 VMware 복제를 위한 아키텍처 검토 | Microsoft Docs"
description: "이 문서에서는 Azure Site Recovery 서비스를 사용하여 온-프레미스 VMware VM을 Azure로 복제할 때 사용되는 구성 요소 및 아키텍처 개요를 제공합니다."
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: carmonm
editor: 
ms.assetid: c413efcd-d750-4b22-b34b-15bcaa03934a
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/27.017
ms.author: raynew
ms.openlocfilehash: 4aae04a793bab11562c20ceec0e1ae8f1a035a0f
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/11/2017
---
# <a name="step-1-review-the-architecture-for-vmware-replication-to-azure"></a><span data-ttu-id="b7a04-103">1단계: Azure에 VMware 복제를 위한 아키텍처 검토</span><span class="sxs-lookup"><span data-stu-id="b7a04-103">Step 1: Review the architecture for VMware replication to Azure</span></span>

<span data-ttu-id="b7a04-104">이 문서에서는 Azure Portal에서 [Azure Site Recovery](site-recovery-overview.md) 서비스를 사용하여 온-프레미스 VMware 가상 컴퓨터를 Azure에 복제할 때 사용된 구성 요소 및 프로세스를 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-104">This article describes the components and processes used when replicating on-premises VMware virtual machines to Azure using the [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="b7a04-105">이 문서의 하단에서 의견을 게시하거나 [Azure Recovery Services 포럼](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr)에서 질문하세요.</span><span class="sxs-lookup"><span data-stu-id="b7a04-105">Post any comments at the bottom of this article, or ask questions in the [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="b7a04-106">아키텍처 구성 요소</span><span class="sxs-lookup"><span data-stu-id="b7a04-106">Architectural components</span></span>

<span data-ttu-id="b7a04-107">표에는 필요한 구성 요소가 요약되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-107">The table summarizes the components you need.</span></span>

<span data-ttu-id="b7a04-108">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="b7a04-108">**Component**</span></span> | <span data-ttu-id="b7a04-109">**요구 사항**</span><span class="sxs-lookup"><span data-stu-id="b7a04-109">**Requirement**</span></span> | <span data-ttu-id="b7a04-110">**세부 정보**</span><span class="sxs-lookup"><span data-stu-id="b7a04-110">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="b7a04-111">**Azure**</span><span class="sxs-lookup"><span data-stu-id="b7a04-111">**Azure**</span></span> | <span data-ttu-id="b7a04-112">Azure 구독, Azure Storage 계정 및 Azure 네트워크가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-112">You need an Azure subscription, an Azure storage account, and an Azure network.</span></span> | <span data-ttu-id="b7a04-113">복제된 데이터는 저장소 계정에 저장됩니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-113">Replicated data is stored in the storage account.</span></span> <span data-ttu-id="b7a04-114">온-프레미스 사이트에서 장애 조치가 발생한 경우 복제된 데이터를 사용하여 Azure VM을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-114">Azure VMs are created with the replicated data when failover from your on-premises site occurs.</span></span> <span data-ttu-id="b7a04-115">Azure VM을 만들 때 Azure 가상 네트워크에 연결합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-115">The Azure VMs connect to the Azure virtual network when they're created.</span></span>
<span data-ttu-id="b7a04-116">**구성 서버**</span><span class="sxs-lookup"><span data-stu-id="b7a04-116">**Configuration server**</span></span> | <span data-ttu-id="b7a04-117">배포를 위해 모든 온-프레미스 Site Recovery 구성 요소를 실행하는 단일 온-프레미스 관리 서버(VMware VM).</span><span class="sxs-lookup"><span data-stu-id="b7a04-117">A single on-premises management server (VMware VM) that runs all the on-premises Site Recovery components for the deployment.</span></span> <span data-ttu-id="b7a04-118">여기에는 구성 서버, 프로세스 서버, 마스터 대상 서버가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-118">These include a configuration server, process server, master target server.</span></span> | <span data-ttu-id="b7a04-119">구성 서버 구성 요소는 온-프레미스와 Azure 간의 통신을 조정하여 데이터 복제를 관리합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-119">The configuration server component coordinates communications between on-premises and Azure, and manages data replication.</span></span>
 <span data-ttu-id="b7a04-120">**프로세스 서버**:</span><span class="sxs-lookup"><span data-stu-id="b7a04-120">**Process server**:</span></span>  | <span data-ttu-id="b7a04-121">기본적으로 구성 서버에 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-121">Installed by default on the configuration server.</span></span> | <span data-ttu-id="b7a04-122">복제 게이트웨이의 역할을 합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-122">Acts as a replication gateway.</span></span> <span data-ttu-id="b7a04-123">복제 데이터를 수신하고 캐싱, 압축 및 암호화를 사용하여 최적화하며 복제 데이터를 Azure Storage로 전송합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-123">Receives replication data, optimizes it with caching, compression, and encryption, and sends it to Azure storage.</span></span><br/><br/> <span data-ttu-id="b7a04-124">또한 프로세스 서버는 보호되는 컴퓨터에서 모바일 서비스의 푸시 설치를 처리하며 VMware VM의 자동 복구를 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-124">The process server also handles push installation of the Mobility service to protected machines, and performs automatic discovery of VMware VMs.</span></span><br/><br/> <span data-ttu-id="b7a04-125">배포가 늘어나면 프로세스 서버로 실행하는 별도의 추가 전용 서버를 추가하여 증가하는 복제 트래픽을 처리할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-125">As your deployment grows you can add additional separate dedicated process servers to handle increasing volumes of replication traffic.</span></span>
 <span data-ttu-id="b7a04-126">**마스터 대상 서버**</span><span class="sxs-lookup"><span data-stu-id="b7a04-126">**Master target server**</span></span> | <span data-ttu-id="b7a04-127">기본적으로 온-프레미스 구성 서버에 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-127">Installed by default on the on-premises configuration server.</span></span> | <span data-ttu-id="b7a04-128">Azure에서 장애 복구 중에 복제 데이터를 처리합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-128">Handles replication data during failback from Azure.</span></span><br/><br/> <span data-ttu-id="b7a04-129">장애 복구 트래픽 볼륨이 높은 경우 장애 복구를 위해 별도 마스터 대상 서버를 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-129">If volumes of failback traffic are high, you can deploy a separate master target server for failback.</span></span>
<span data-ttu-id="b7a04-130">**VMware 서버**</span><span class="sxs-lookup"><span data-stu-id="b7a04-130">**VMware servers**</span></span> | <span data-ttu-id="b7a04-131">VMware VM은 vSphere ESXi 서버에서 호스트되며 호스트를 관리하는 vCenter 서버를 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-131">VMware VMs are hosted on vSphere ESXi servers, and we recommend a vCenter server to manage the hosts.</span></span> | <span data-ttu-id="b7a04-132">VMware 서버를 사용자의 Recovery Services 자격 증명 모음에 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-132">You add VMware servers to your Recovery Services vault.</span></span>
<span data-ttu-id="b7a04-133">**복제된 컴퓨터**</span><span class="sxs-lookup"><span data-stu-id="b7a04-133">**Replicated machines**</span></span> | <span data-ttu-id="b7a04-134">복제하는 각 VMware VM에 모바일 서비스가 설치됩니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-134">The Mobility service will be installed on each VMware VM you replicate.</span></span> <span data-ttu-id="b7a04-135">각 컴퓨터에 수동으로 설치되거나 프로세스 서버에서 강제 설치로 설치될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-135">It can be installed manually on each machine, or with a push installation from the process server.</span></span>

<span data-ttu-id="b7a04-136">**그림 1: VMware에서 Azure 구성 요소로**</span><span class="sxs-lookup"><span data-stu-id="b7a04-136">**Figure 1: VMware to Azure components**</span></span>

![구성 요소](./media/vmware-walkthrough-architecture/arch-enhanced.png)

## <a name="replication-process"></a><span data-ttu-id="b7a04-138">복제 프로세스</span><span class="sxs-lookup"><span data-stu-id="b7a04-138">Replication process</span></span>

1. <span data-ttu-id="b7a04-139">온-프레미스 및 Azure 구성 요소를 포함하여 배포를 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-139">You set up the deployment, including on-premises and Azure components.</span></span> <span data-ttu-id="b7a04-140">Recovery Services 자격 증명 모음에서 복제 원본 및 대상을 지정하고 구성 서버를 설정하며 복제 정책을 만들고 모바일 서비스를 배포하며 복제를 사용하도록 설정하고 테스트 장애 조치를 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-140">In the Recovery Services vault, you specify the replication source and target, set up the configuration server, create a replication policy, deploy the Mobility service, enable replication, and run a test failover.</span></span>
2. <span data-ttu-id="b7a04-141">컴퓨터는 복제 정책에 따라 복제를 시작하고 데이터의 초기 복사본은 Azure Storage로 복제됩니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-141">Machines replicate in accordance with the replication policy, and an initial copy of the data is replicated to Azure storage.</span></span>
3. <span data-ttu-id="b7a04-142">초기 복제가 완료되면 Azure에 대한 델타 변경 내용의 복제가 시작됩니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-142">After initial replication finishes, replication of delta changes to Azure begins.</span></span> <span data-ttu-id="b7a04-143">.hrl 파일에는 컴퓨터에 대한 추적된 변경 내용이 유지됩니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-143">Tracked changes for a machine are held in a .hrl file.</span></span>
    - <span data-ttu-id="b7a04-144">컴퓨터를 복제하는 작업은 복제 관리를 위해 HTTPS 443 인바운드 포트에 대한 구성 서버와 통신합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-144">Replicating machines communicate with the configuration server on port HTTPS 443 inbound, for replication management.</span></span>
    - <span data-ttu-id="b7a04-145">컴퓨터를 복제하는 작업은 복제 데이터를 HTTPS 9443 인바운드 포트(수정될 수 있음)에 대한 프로세스 서버로 전달합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-145">Replicating machines send replication data to the process server on port HTTPS 9443 inbound (can be modified).</span></span>
    - <span data-ttu-id="b7a04-146">구성 서버는 HTTPS 443 아웃바운드 포트를 통해 Azure를 사용하는 복제 관리를 오케스트레이션합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-146">The configuration server orchestrates replication management with Azure over port HTTPS 443 outbound.</span></span>
    - <span data-ttu-id="b7a04-147">프로세스 서버가 원본 컴퓨터에서 데이터를 수신하고 이를 최적화 및 암호화하며 443 아웃바운드 포트를 통해 Azure Storage로 전송합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-147">The process server receives data from source machines, optimizes and encrypts it, and sends it to Azure storage over port 443 outbound.</span></span>
    - <span data-ttu-id="b7a04-148">다중 VM 일관성을 사용하도록 설정하면 복제 그룹의 컴퓨터는 20004 포트를 통해 서로 통신하게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-148">If you enable multi-VM consistency, then machines in the replication group communicate with each other over port 20004.</span></span> <span data-ttu-id="b7a04-149">다중 VM은 장애 조치 시(failover) 크래시 일관성 및 앱 일관성 복구 지점을 공유하는 복제 그룹에 여러 컴퓨터를 그룹화하는 경우 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-149">Multi-VM is used if you group multiple machines into replication groups that share crash-consistent and app-consistent recovery points when they fail over.</span></span> <span data-ttu-id="b7a04-150">이 기능은 컴퓨터가 동일한 워크로드를 실행하고 일관성을 유지해야 할 경우에 유용합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-150">This is useful if machines are running the same workload and need to be consistent.</span></span>
4. <span data-ttu-id="b7a04-151">트래픽은 인터넷을 통해 Azure Storage 공용 끝점에 복제됩니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-151">Traffic is replicated to Azure storage public endpoints, over the internet.</span></span> <span data-ttu-id="b7a04-152">Azure ExpressRoute [공용 피어링](../expressroute/expressroute-circuit-peerings.md#public-peering)을 사용할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-152">Alternately, you can use Azure ExpressRoute [public peering](../expressroute/expressroute-circuit-peerings.md#public-peering).</span></span> <span data-ttu-id="b7a04-153">온-프레미스 사이트에서 Azure로의 사이트 간 VPN을 통한 트래픽 복제는 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-153">Replicating traffic over a site-to-site VPN from an on-premises site to Azure isn't supported.</span></span>


<span data-ttu-id="b7a04-154">**그림 2: VMware에서 Azure 복제로**</span><span class="sxs-lookup"><span data-stu-id="b7a04-154">**Figure 2: VMware to Azure replication**</span></span>

![향상된](./media/vmware-walkthrough-architecture/v2a-architecture-henry.png)

## <a name="failover-and-failback-process"></a><span data-ttu-id="b7a04-156">장애 조치 및 장애 복구 프로세스</span><span class="sxs-lookup"><span data-stu-id="b7a04-156">Failover and failback process</span></span>

1. <span data-ttu-id="b7a04-157">예상대로 작동하는 테스트 장애 조치(failover)를 확인한 후에 필요에 따라 Azure에 계획되지 않은 장애 조치(failover)를 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-157">After you verify that test failover is working as expected, you can run unplanned failovers to Azure as required.</span></span> <span data-ttu-id="b7a04-158">계획된 장애 조치는 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-158">Planned failover isn't supported.</span></span>
2. <span data-ttu-id="b7a04-159">단일 컴퓨터에 장애 조치를 수행하거나 [복구 계획](site-recovery-create-recovery-plans.md)을 만들어서 여러 VM의 장애 조치를 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-159">You can fail over a single machine, or create [recovery plans](site-recovery-create-recovery-plans.md), to fail over multiple VMs.</span></span>
3. <span data-ttu-id="b7a04-160">장애 조치를 실행하면 Azure에 복제본 VM이 만들어집니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-160">When you run a failover, replica VMs are created in Azure.</span></span> <span data-ttu-id="b7a04-161">복제본 Azure VM에서 워크로드에 액세스하려면 장애 조치를 커밋합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-161">You commit a failover to start accessing the workload from the replica Azure VM.</span></span>
4. <span data-ttu-id="b7a04-162">기본 온-프레미스 사이트를 다시 사용할 수 있는 경우 장애 복구를 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-162">When your primary on-premises site is available again, you can fail back.</span></span> <span data-ttu-id="b7a04-163">장애 복구 인프라를 설정하고 보조 사이트에서 기본 사이트에 컴퓨터를 복제하기 시작하며 보조 사이트에서 계획되지 않은 장애 조치를 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-163">You set up a failback infrastructure, start replicating the machine from the secondary site to the primary, and run an unplanned failover from the secondary site.</span></span> <span data-ttu-id="b7a04-164">이 장애 조치를 커밋한 후에 데이터가 다시 온-프레미스로 돌아오면 Azure에 다시 복제를 사용하도록 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-164">After you commit this failover, data will be back on-premises, and you need to enable replication to Azure again.</span></span> [<span data-ttu-id="b7a04-165">자세히 알아보기</span><span class="sxs-lookup"><span data-stu-id="b7a04-165">Learn more</span></span>](site-recovery-failback-azure-to-vmware.md)

<span data-ttu-id="b7a04-166">몇 가지 장애 복구 요구 사항이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-166">There are a few failback requirements:</span></span>


- <span data-ttu-id="b7a04-167">**Azure에서 임시 프로세스 서버**: 장애 조치 후 Azure에서 장애 복구하려면 Azure에서 복제를 처리하기 위해 프로세스 서버로 구성된 Azure VM을 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-167">**Temporary process server in Azure**: If you want to fail back from Azure after failover you'll need to set up an Azure VM configured as a process server, to handle replication from Azure.</span></span> <span data-ttu-id="b7a04-168">장애 복구를 완료한 후 이 VM을 삭제할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-168">You can delete this VM after failback finishes.</span></span>
- <span data-ttu-id="b7a04-169">**VPN 연결**: 장애 복구를 수행하려면 Azure 네트워크에서 온-프레미스 사이트로 VPN 연결(또는 Azure Express 경로) 설정이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-169">**VPN connection**: For failback you'll need a VPN connection (or Azure ExpressRoute) set up from the Azure network to the on-premises site.</span></span>
- <span data-ttu-id="b7a04-170">**별도의 온-프레미스 마스터 대상 서버**: 온-프레미스 마스터 대상 서버는 장애 복구를 처리합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-170">**Separate on-premises master target server**: The on-premises master target server handles failback.</span></span> <span data-ttu-id="b7a04-171">마스터 대상 서버는 기본적으로 관리 서버에 설치되지만 대량의 트래픽 볼륨을 장애 복구하는 경우 이 목적으로 별도의 온-프레미스 마스터 대상 서버를 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-171">The master target server is installed by default on the management server, but if you're failing back larger volumes of traffic you should set up a separate on-premises master target server for this purpose.</span></span>
- <span data-ttu-id="b7a04-172">**장애 복구 정책**: 온-프레미스 사이트에 다시 복제하려면 장애 복구 정책이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-172">**Failback policy**: To replicate back to your on-premises site, you need a failback policy.</span></span> <span data-ttu-id="b7a04-173">이 정책은 복제 정책을 만들 때 자동으로 생성됩니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-173">This is automatically created when you created your replication policy.</span></span>
- <span data-ttu-id="b7a04-174">**VMware 인프라**: 온-프레미스 VMware VM으로 장애 복구(failback)해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-174">**VMware infrastructure**: You must fail back to an on-premises VMware VM.</span></span> <span data-ttu-id="b7a04-175">즉, 온-프레미스 물리적 서버를 Azure로 복제하는 경우에도 온-프레미스 VMware 인프라가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-175">This means you need an on-premises VMware infrastructure, even if you're replicating on-premises physical servers to Azure.</span></span>

<span data-ttu-id="b7a04-176">**그림 3: VMware/물리적 장애 복구**</span><span class="sxs-lookup"><span data-stu-id="b7a04-176">**Figure 3: VMware/physical failback**</span></span>

![장애 복구](./media/vmware-walkthrough-architecture/enhanced-failback.png)


## <a name="next-steps"></a><span data-ttu-id="b7a04-178">다음 단계</span><span class="sxs-lookup"><span data-stu-id="b7a04-178">Next steps</span></span>

<span data-ttu-id="b7a04-179">[2단계: 필수 조건 및 제한 사항 확인](vmware-walkthrough-prerequisites.md)으로 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="b7a04-179">Go to [Step 2: Verify prerequisites and limitations](vmware-walkthrough-prerequisites.md)</span></span>
