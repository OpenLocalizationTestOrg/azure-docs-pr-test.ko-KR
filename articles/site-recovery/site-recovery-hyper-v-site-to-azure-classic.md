---
title: "클래식 포털에서 Azure에 Hyper-V VM 복제 | Microsoft Docs"
description: "이 문서에서는 컴퓨터가 VMM 클라우드에서 관리되지 않는 경우 Azure에 Hyper-V 가상 컴퓨터를 복제하는 방법을 설명합니다."
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: jwhit
editor: 
ms.assetid: 3f4c4483-e3dd-495a-bd02-c16e9e28c88d
ms.service: site-recovery
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage-backup-recovery
ms.date: 02/21/2017
ms.author: raynew
ms.openlocfilehash: 438f32ee3605e2dd0c46de7993a359cc269262fe
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/29/2017
---
# <a name="replicate-between-on-premises-hyper-v-virtual-machines-and-azure-without-vmm-with-azure-site-recovery"></a><span data-ttu-id="c35da-103">Azure Site Recovery로 온-프레미스 Hyper-V 가상 컴퓨터와 Azure(VMM 없음) 간 복제</span><span class="sxs-lookup"><span data-stu-id="c35da-103">Replicate between on-premises Hyper-V virtual machines and Azure (without VMM) with Azure Site Recovery</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="c35da-104">Azure 포털</span><span class="sxs-lookup"><span data-stu-id="c35da-104">Azure Portal</span></span>](site-recovery-hyper-v-site-to-azure.md)
> * [<span data-ttu-id="c35da-105">PowerShell - Resource Manager</span><span class="sxs-lookup"><span data-stu-id="c35da-105">PowerShell - Resource Manager</span></span>](site-recovery-deploy-with-powershell-resource-manager.md)
> * [<span data-ttu-id="c35da-106">클래식 포털</span><span class="sxs-lookup"><span data-stu-id="c35da-106">Classic Portal</span></span>](site-recovery-hyper-v-site-to-azure-classic.md)
>
>

<span data-ttu-id="c35da-107">이 문서에서는 Azure Portal에서 [Azure Site Recovery](site-recovery-overview.md) 서비스를 사용하여 온-프레미스 Hyper-V 가상 컴퓨터를 Azure에 복제하는 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-107">This article describes how to replicate on-premises Hyper-V virtual machines to Azure, using the [Azure Site Recovery](site-recovery-overview.md) service, in the Azure portal.</span></span> <span data-ttu-id="c35da-108">이 시나리오에서는 VMM 클라우드에서 Hyper-V 서버가 관리되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-108">In this scenario, Hyper-V servers are not managed in VMM clouds.</span></span>

<span data-ttu-id="c35da-109">이 문서를 읽은 후에는 하단에서 의견을 게시하거나 [Azure Recovery Services 포럼](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr)에서 기술적인 질문을 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-109">After reading this article, post any comments at the bottom, or ask technical questions on the [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>


## <a name="site-recovery-in-the-azure-portal"></a><span data-ttu-id="c35da-110">Azure 포털에서 Site Recovery</span><span class="sxs-lookup"><span data-stu-id="c35da-110">Site Recovery in the Azure portal</span></span>

<span data-ttu-id="c35da-111">Azure에는 리소스를 만들고 작업하는 Azure Resource Manager와 클래식이라는 두 가지 [배포 모델](../resource-manager-deployment-model.md)이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-111">Azure has two different [deployment models](../resource-manager-deployment-model.md) for creating and working with resources – Azure Resource Manager and classic.</span></span> <span data-ttu-id="c35da-112">Azure에는 두 가지, 즉 Azure 클래식 포털 및 Azure 포털이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-112">Azure also has two portals – the Azure classic portal, and the Azure portal.</span></span>

<span data-ttu-id="c35da-113">이 문서에서는 클래식 포털에 배포하는 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-113">This article describes how to deploy in the classic portal.</span></span> <span data-ttu-id="c35da-114">기존 자격 증명 모음을 유지하기 위해 클래식 포털을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-114">The classic portal can be used to maintain existing vaults.</span></span> <span data-ttu-id="c35da-115">클래식 포털을 사용하여 새 자격 증명 모음을 만들 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-115">You can't create new vaults using the classic portal.</span></span>

## <a name="site-recovery-in-your-business"></a><span data-ttu-id="c35da-116">사용자 비즈니스에서 Site Recovery</span><span class="sxs-lookup"><span data-stu-id="c35da-116">Site Recovery in your business</span></span>

<span data-ttu-id="c35da-117">조직에서는 계획된 중단 또는 불의의 중지 시간에 앱 및 데이터를 실행 중이고 가용 상태로 유지하고 가능한 신속히 정상적인 작업 상태로 복귀하기 위한 BCDR 전략이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-117">Organizations need a BCDR strategy that determines how apps and data stay running and available during planned and unplanned downtime, and recover to normal working conditions as soon as possible.</span></span> <span data-ttu-id="c35da-118">수행할 수 있는 Site Recovery는 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-118">Here's what Site Recovery can do:</span></span>

* <span data-ttu-id="c35da-119">Hyper-V VM에서 실행되는 비즈니스 앱에 대한 오프사이트 보호.</span><span class="sxs-lookup"><span data-stu-id="c35da-119">Offsite protection for business apps running on Hyper-V VMs.</span></span>
* <span data-ttu-id="c35da-120">복제, 장애 조치(Failover), 복구를 설정, 관리 및 모니터링하는 단일 위치.</span><span class="sxs-lookup"><span data-stu-id="c35da-120">A single location to set up, manage, and monitor replication, failover, and recovery.</span></span>
* <span data-ttu-id="c35da-121">Azure로 간단한 장애 조치 및 Azure에서 온-프레미스 사이트의 Hyper-V 호스트 서버로 장애 복구(Failback)(복원).</span><span class="sxs-lookup"><span data-stu-id="c35da-121">Simple failover to Azure, and failback (restore) from Azure to Hyper-V host servers in your on-premises site.</span></span>
* <span data-ttu-id="c35da-122">계층화된 응용 프로그램 워크로드가 함께 장애 조치(Failover)되도록 여러 VM을 포함하는 복구 계획.</span><span class="sxs-lookup"><span data-stu-id="c35da-122">Recovery plans that include multiple VMs, so that tiered application workloads fail over together.</span></span>

## <a name="azure-prerequisites"></a><span data-ttu-id="c35da-123">Azure 필수 조건</span><span class="sxs-lookup"><span data-stu-id="c35da-123">Azure prerequisites</span></span>
* <span data-ttu-id="c35da-124">[Microsoft Azure](https://azure.microsoft.com/) 계정이 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-124">You need a [Microsoft Azure](https://azure.microsoft.com/) account.</span></span> <span data-ttu-id="c35da-125">[무료 평가판](https://azure.microsoft.com/pricing/free-trial/)으로 시작할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-125">You can start with a [free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="c35da-126">복제된 데이터를 저장하려면 Azure 저장소 계정이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-126">You need an Azure storage account to store replicated data.</span></span> <span data-ttu-id="c35da-127">계정의 지역에서 복제 기능을 사용하도록 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-127">The account needs geo-replication enabled.</span></span> <span data-ttu-id="c35da-128">계정은 Azure Site Recovery 자격 증명 모음과 동일한 지역에 있고 동일한 구독과 연결되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-128">It should be in the same region as the Azure Site Recovery vault and be associated with the same subscription.</span></span> <span data-ttu-id="c35da-129">[Azure 저장소에 대해 자세히 알아보세요](../storage/common/storage-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="c35da-129">[Learn more about Azure storage](../storage/common/storage-introduction.md).</span></span> <span data-ttu-id="c35da-130">여러 리소스 그룹에 [새 Azure 포털](../storage/common/storage-create-storage-account.md) 을 사용하여 만든 저장소 계정의 이동을 지원하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-130">Note that we don't support moving storage accounts created using the [new Azure portal](../storage/common/storage-create-storage-account.md) across resource groups.</span></span>
* <span data-ttu-id="c35da-131">기본 사이트에서 장애 조치(failover) 시 Azure 가상 컴퓨터가 네트워크에 연결되도록 하기 위해서는 Azure 가상 네트워크가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-131">You'll need an Azure virtual network so that Azure virtual machines will be connected to a network when you fail over from your primary site.</span></span>

## <a name="hyper-v-prerequisites"></a><span data-ttu-id="c35da-132">Hyper-V 필수 조건</span><span class="sxs-lookup"><span data-stu-id="c35da-132">Hyper-V prerequisites</span></span>
* <span data-ttu-id="c35da-133">원본 온-프레미스 사이트에서 Hyper-V 역할이 설치된 **Windows Server 2012 R2** 또는 **Microsoft Hyper-V Server 2012 R2**를 실행하는 하나 이상의 서버가 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-133">In the source on-premises site you'll need one or more servers running **Windows Server 2012 R2** with the Hyper-V role installed or **Microsoft Hyper-V Server 2012 R2**.</span></span> <span data-ttu-id="c35da-134">이 서버는 다음 조건을 충족해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-134">This server should:</span></span>
* <span data-ttu-id="c35da-135">하나 이상의 가상 컴퓨터를 포함해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-135">Contain one or more virtual machines.</span></span>
* <span data-ttu-id="c35da-136">직접 또는 프록시를 통해 인터넷에 연결되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-136">Be connected to the Internet, either directly or via a proxy.</span></span>
* <span data-ttu-id="c35da-137">기술 자료 [2961977](https://support.microsoft.com/en-us/kb/2961977 "KB2961977")에서 의견이나 질문을 게시합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-137">Be running the fixes described in KB [2961977](https://support.microsoft.com/en-us/kb/2961977 "KB2961977").</span></span>

## <a name="virtual-machine-prerequisites"></a><span data-ttu-id="c35da-138">가상 컴퓨터 필수 조건</span><span class="sxs-lookup"><span data-stu-id="c35da-138">Virtual machine prerequisites</span></span>
<span data-ttu-id="c35da-139">보호할 가상 컴퓨터는 [Azure 가상 컴퓨터 요구 사항](site-recovery-support-matrix-to-azure.md#failed-over-azure-vm-requirements)에 맞아야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-139">Virtual machines you want to protect should conform with [Azure virtual machine requirements](site-recovery-support-matrix-to-azure.md#failed-over-azure-vm-requirements).</span></span>

## <a name="provider-and-agent-prerequisites"></a><span data-ttu-id="c35da-140">공급자 및 에이전트 필수 조건</span><span class="sxs-lookup"><span data-stu-id="c35da-140">Provider and agent prerequisites</span></span>
<span data-ttu-id="c35da-141">Azure Site Recovery 배포의 일환으로 Hyper-V 서버마다 Azure Site Recovery 공급자 및 Azure 복구 서비스 에이전트를 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-141">As part of Azure Site Recovery deployment you’ll install the Azure Site Recovery Provider and the Azure Recovery Services Agent on each Hyper-V server.</span></span> <span data-ttu-id="c35da-142">다음 사항에 유의하세요.</span><span class="sxs-lookup"><span data-stu-id="c35da-142">Note that:</span></span>

* <span data-ttu-id="c35da-143">항상 최신 버전의 공급자 및 에이전트를 실행하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-143">We recommend you always run the latest versions of the Provider and agent.</span></span> <span data-ttu-id="c35da-144">이에 대한 내용은 사이트 복구 포털에서 제공됩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-144">These are available in the Site Recovery portal.</span></span>
* <span data-ttu-id="c35da-145">자격 증명 모음의 모든 Hyper-V 서버는 동일한 버전의 공급자 및 에이전트를 포함해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-145">All Hyper-V servers in a vault should have the same versions of the Provider and agent.</span></span>
* <span data-ttu-id="c35da-146">서버에서 실행되는 공급자는 인터넷을 통해 사이트 복구에 연결됩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-146">The Provider running on the server connects to Site Recovery over the internet.</span></span> <span data-ttu-id="c35da-147">현재 Hyper-V 서버에 구성된 프록시 설정 또는 공급자 설치 중에 구성하는 사용자 지정 프록시 설정을 사용하여 프록시 없이 이를 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-147">You can do this without a proxy, with the proxy settings currently configured on the Hyper-V server, or with custom proxy settings that you configure during Provider installation.</span></span> <span data-ttu-id="c35da-148">사용하려는 프록시 서버가 Azure 연결을 위해 이러한 URL에 액세스할 수 있는지 확인해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-148">You'll need to make sure that the proxy server you want to use can access these the URLs for connecting to Azure:</span></span>

  * <span data-ttu-id="c35da-149">*.accesscontrol.windows.net</span><span class="sxs-lookup"><span data-stu-id="c35da-149">*.accesscontrol.windows.net</span></span>
  * <span data-ttu-id="c35da-150">*.backup.windowsazure.com</span><span class="sxs-lookup"><span data-stu-id="c35da-150">*.backup.windowsazure.com</span></span>
  * <span data-ttu-id="c35da-151">*.hypervrecoverymanager.windowsazure.com</span><span class="sxs-lookup"><span data-stu-id="c35da-151">*.hypervrecoverymanager.windowsazure.com</span></span>
  * <span data-ttu-id="c35da-152">*.store.core.windows.net</span><span class="sxs-lookup"><span data-stu-id="c35da-152">*.store.core.windows.net</span></span>      
  * <span data-ttu-id="c35da-153">*.blob.core.windows.net</span><span class="sxs-lookup"><span data-stu-id="c35da-153">*.blob.core.windows.net</span></span>
  - <span data-ttu-id="c35da-154">https://www.msftncsi.com/ncsi.txt</span><span class="sxs-lookup"><span data-stu-id="c35da-154">https://www.msftncsi.com/ncsi.txt</span></span>
  - <span data-ttu-id="c35da-155">time.windows.com</span><span class="sxs-lookup"><span data-stu-id="c35da-155">time.windows.com</span></span>
  - <span data-ttu-id="c35da-156">time.nist.gov</span><span class="sxs-lookup"><span data-stu-id="c35da-156">time.nist.gov</span></span>
* <span data-ttu-id="c35da-157">또한 [Azure 데이터센터 IP 범위](https://www.microsoft.com/download/details.aspx?id=41653) 및 HTTPS(443) 프로토콜에 설명된 IP 주소를 허용합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-157">In addition allow the IP addresses described in [Azure Datacenter IP Ranges](https://www.microsoft.com/download/details.aspx?id=41653) and HTTPS (443) protocol.</span></span> <span data-ttu-id="c35da-158">사용하려는 Azure 지역 및 미국 서부의 IP 범위를 허용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-158">You have to allow the IP ranges of the Azure region that you plan to use and that of West US.</span></span>

<span data-ttu-id="c35da-159">이 그림에서는 조정 및 복제를 위해 사이트 복구에서 사용되는 다양한 통신 채널 및 포트를 보여줍니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-159">This graphic shows the different communication channels and ports used by Site Recovery for orchestration and replication</span></span>

![B2A 토폴로지](./media/site-recovery-hyper-v-site-to-azure-classic/b2a-topology.png)

## <a name="step-1-create-a-vault"></a><span data-ttu-id="c35da-161">1단계: 자격 증명 모음 만들기</span><span class="sxs-lookup"><span data-stu-id="c35da-161">Step 1: Create a vault</span></span>
1. <span data-ttu-id="c35da-162">[관리 포털](https://portal.azure.com)에 로그인합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-162">Sign in to the [Management Portal](https://portal.azure.com).</span></span>
2. <span data-ttu-id="c35da-163">**Data Services** > **Recovery Services**를 확장하고 **Site Recovery 자격 증명 모음**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-163">Expand **Data Services** > **Recovery Services** and click **Site Recovery Vault**.</span></span>
3. <span data-ttu-id="c35da-164">**새로 만들기** > **빠른 생성**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-164">Click **Create New** > **Quick Create**.</span></span>
4. <span data-ttu-id="c35da-165">**이름**에 자격 증명 모음을 식별하기 위한 이름을 입력합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-165">In **Name**, enter a friendly name to identify the vault.</span></span>
5. <span data-ttu-id="c35da-166">**지역**에서 자격 증명 모음에 대한 지리적 지역을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-166">In **Region**, select the geographic region for the vault.</span></span> <span data-ttu-id="c35da-167">지원되는 하위 지역을 확인하려면 [Azure Site Recovery 가격 정보](https://azure.microsoft.com/pricing/details/site-recovery/)에서 지리적 가용성을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="c35da-167">To check supported regions see Geographic Availability in [Azure Site Recovery Pricing Details](https://azure.microsoft.com/pricing/details/site-recovery/).</span></span>
6. <span data-ttu-id="c35da-168">**자격 증명 모음 만들기**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-168">Click **Create vault**.</span></span>

    ![새 자격 증명 모음](./media/site-recovery-hyper-v-site-to-azure-classic/vault.png)

<span data-ttu-id="c35da-170">상태 표시줄을 점검하여 자격 증명 모음이 성공적으로 만들어졌는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-170">Check the status bar to confirm that the vault was successfully created.</span></span> <span data-ttu-id="c35da-171">자격 증명 모음은 기본 복구 서비스 페이지에서 **활성** 으로 나열됩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-171">The vault will be listed as **Active** on the main Recovery Services page.</span></span>

## <a name="step-2-create-a-hyper-v-site"></a><span data-ttu-id="c35da-172">2단계: Hyper-V 사이트 만들기</span><span class="sxs-lookup"><span data-stu-id="c35da-172">Step 2: Create a Hyper-V site</span></span>
1. <span data-ttu-id="c35da-173">복구 서비스 페이지에서 자격 증명 모음을 클릭하여 빠른 시작 페이지를 엽니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-173">In the Recovery Services page, click the vault to open the Quick Start page.</span></span> <span data-ttu-id="c35da-174">빠른 시작은 언제든지 아이콘을 사용하여 열 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-174">Quick Start can also be opened at any time using the icon.</span></span>

    ![빠른 시작](./media/site-recovery-hyper-v-site-to-azure-classic/quick-start-icon.png)
2. <span data-ttu-id="c35da-176">드롭다운 목록에서 **온-프레미스 Hyper-V 사이트와 Azure 간**을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-176">In the dropdown list, select **Between an on-premises Hyper-V site and Azure**.</span></span>

    ![Hyper-V 사이트 시나리오](./media/site-recovery-hyper-v-site-to-azure-classic/select-scenario.png)
3. <span data-ttu-id="c35da-178">**Hyper-V 사이트 만들기**에서 **Hyper-V 사이트 만들기**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-178">In **Create a Hyper-V Site** click **Create Hyper-V site**.</span></span> <span data-ttu-id="c35da-179">사이트 이름을 지정하고 저장합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-179">Specify a site name and save.</span></span>

    ![Hyper-V 사이트](./media/site-recovery-hyper-v-site-to-azure-classic/create-site.png)

## <a name="step-3-install-the-provider-and-agent"></a><span data-ttu-id="c35da-181">3단계: 공급자 및 에이전트 설치</span><span class="sxs-lookup"><span data-stu-id="c35da-181">Step 3: Install the Provider and agent</span></span>
<span data-ttu-id="c35da-182">보호할 VM이 있는 Hyper-V 서버마다 공급자 및 에이전트를 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-182">Install the Provider and agent on each Hyper-V server that has VMs you want to protect.</span></span>

<span data-ttu-id="c35da-183">Hyper-V 클러스터를 설치하는 경우 장애 조치 클러스터의 각 노드에서 5~11단계를 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-183">If you're installing on a Hyper-V cluster, performs steps 5-11 on each node in the failover cluster.</span></span> <span data-ttu-id="c35da-184">모든 노드를 등록하고 보호 기능을 설정한 후 가상 컴퓨터는 클러스터 내의 노드 간에 마이그레이션할 경우에도 보호됩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-184">After all nodes are registered and protection is enabled, virtual machines will be protected even if they migrate across nodes in the cluster.</span></span>

1. <span data-ttu-id="c35da-185">**Hyper-V 서버 준비**에서 **등록 키 다운로드** 파일을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-185">In **Prepare Hyper-V servers**, click **Download a registration key** file.</span></span>
2. <span data-ttu-id="c35da-186">**등록 키 다운로드** 페이지에서 사이트 옆의 **다운로드**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-186">On the **Download Registration Key** page, click **Download** next to the site.</span></span> <span data-ttu-id="c35da-187">Hyper-V 서버에서 쉽게 액세스할 수 있는 안전한 위치로 키를 다운로드합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-187">Download the key to a safe location that can be easily accessed by the Hyper-V server.</span></span> <span data-ttu-id="c35da-188">이 키는 생성된 날로부터 5일간 유효합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-188">The key is valid for 5 days after it's generated.</span></span>

    ![등록 키](./media/site-recovery-hyper-v-site-to-azure-classic/download-key.png)
3. <span data-ttu-id="c35da-190">**공급자 다운로드** 를 클릭하여 최신 버전을 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-190">Click **Download the Provider** to obtain the latest version.</span></span>
4. <span data-ttu-id="c35da-191">자격 증명 모음에 등록하려는 각 Hyper-V 서버에서 파일을 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-191">Run the file on each Hyper-V server you want to register in the vault.</span></span> <span data-ttu-id="c35da-192">이 파일은 다음 두 구성 요소를 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-192">The file installs two components:</span></span>
   * <span data-ttu-id="c35da-193">**Azure Site Recovery 공급자**- Hyper-V 서버와 Azure Site Recovery 포털 간의 통신 및 오케스트레이션을 처리합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-193">**Azure Site Recovery Provider**—Handles communication and orchestration between the Hyper-V server and the Azure Site Recovery portal.</span></span>
   * <span data-ttu-id="c35da-194">**Azure 복구 서비스 에이전트**- 원본 Hyper-V 서버에 실행 중인 가상 컴퓨터와 Azure 저장소 간의 데이터 전송을 처리합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-194">**Azure Recovery Services Agent**—Handles data transport between virtual machines running on the source Hyper-V server and Azure storage.</span></span>
5. <span data-ttu-id="c35da-195">**Microsoft 업데이트** 에서 업데이트를 선택할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-195">In **Microsoft Update** you can opt in for updates.</span></span> <span data-ttu-id="c35da-196">이 설정을 사용하도록 설정하면 공급자와 에이전트 업데이트가 Microsoft 업데이트 정책에 따라 설치됩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-196">With this setting enabled, Provider and Agent updates will be installed according to your Microsoft Update policy.</span></span>

    ![Microsoft 업데이트](./media/site-recovery-hyper-v-site-to-azure-classic/provider1.png)
6. <span data-ttu-id="c35da-198">**설치** 에 Hyper-V 서버에서 공급자 및 에이전트를 설치할 위치를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-198">In **Installation** specify where you want to install the Provider and Agent on the Hyper-V server.</span></span>

    ![설치 위치](./media/site-recovery-hyper-v-site-to-azure-classic/provider2.png)
7. <span data-ttu-id="c35da-200">설치가 완료되면 설정을 계속 진행하여 자격 증명 모음에 서버를 등록합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-200">After installation is complete continue setup to register the server in the vault.</span></span>
8. <span data-ttu-id="c35da-201">**자격 증명 모음 설정** 페이지에서 **찾아보기**를 클릭하고 키 파일을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-201">On the **Vault Settings** page, click **Browse** to select the key file.</span></span> <span data-ttu-id="c35da-202">Azure Site Recovery 구독, 자격 증명 모음 이름 및 Hyper-V 서버가 속한 Hyper-V 사이트를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-202">Specify the Azure Site Recovery subscription, the vault name, and the Hyper-V site to which the Hyper-V server belongs.</span></span>

    ![서버 등록](./media/site-recovery-hyper-v-site-to-azure-classic/provider8.PNG)
9. <span data-ttu-id="c35da-204">**인터넷 연결** 페이지에서 공급자가 Azure Site Recovery에 연결하는 방법을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-204">On the **Internet Connection** page you specify how the Provider connects to Azure Site Recovery.</span></span> <span data-ttu-id="c35da-205">서버에 구성되어 있는 기본 인터넷 연결 설정을 사용하려면 **기본 시스템 프록시 설정 사용** 을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-205">Select **Use default system proxy settings** to use the default Internet connection settings configured on the server.</span></span> <span data-ttu-id="c35da-206">값을 지정 하지 않으면 기본 설정이 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-206">If you don't specify a value the default settings will be used.</span></span>

   ![인터넷 설정](./media/site-recovery-hyper-v-site-to-azure-classic/provider7.PNG)
10. <span data-ttu-id="c35da-208">서버를 자격 증명 모음에 등록하는 등록이 시작됩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-208">Registration starts to register the server in the vault.</span></span>

    ![서버 등록](./media/site-recovery-hyper-v-site-to-azure-classic/provider15.PNG)
11. <span data-ttu-id="c35da-210">등록이 완료되면 Azure Site Recovery에서 Hyper-V 서버의 메타데이터를 가져오고 서버가 자격 증명 모음의 **서버** 페이지에 있는 **Hyper-V 사이트** 탭에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-210">After registration finishes metadata from the Hyper-V server is retrieved by Azure Site Recovery and the server is displayed on the **Hyper-V Sites** tab on the **Servers** page in the vault.</span></span>

### <a name="install-the-provider-from-the-command-line"></a><span data-ttu-id="c35da-211">명령줄에서 공급자 설치</span><span class="sxs-lookup"><span data-stu-id="c35da-211">Install the Provider from the command line</span></span>
<span data-ttu-id="c35da-212">또한 명령줄에서 Azure Site Recovery 공급자를 설치할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-212">As an alternative you can install the Azure Site Recovery Provider from the command line.</span></span> <span data-ttu-id="c35da-213">Windows Server Core 2012 R2를 실행하는 컴퓨터에 공급자를 설치하려면 이 방법을 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-213">You should use this method if you want to install the Provider on a computer running Windows Server Core 2012 R2.</span></span> <span data-ttu-id="c35da-214">다음과 같이 명령줄에서 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-214">Run from the command line as follows:</span></span>

1. <span data-ttu-id="c35da-215">공급자 설치 파일 및 등록 키를 폴더로 다운로드합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-215">Download the Provider installation file and registration key to a folder.</span></span> <span data-ttu-id="c35da-216">예: C:\ASR.</span><span class="sxs-lookup"><span data-stu-id="c35da-216">For example C:\ASR.</span></span>
2. <span data-ttu-id="c35da-217">관리자로 명령 프롬프트 창을 실행하고 다음을 입력합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-217">Run a command prompt as an Administrator and type:</span></span>

        C:\Windows\System32> CD C:\ASR
        C:\ASR> AzureSiteRecoveryProvider.exe /x:. /q
3. <span data-ttu-id="c35da-218">다음을 실행하여 공급자를 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-218">Then install the Provider by running:</span></span>

        C:\ASR> setupdr.exe /i
4. <span data-ttu-id="c35da-219">등록을 완료하려면 다음을 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-219">Run the following to complete registration:</span></span>

        CD C:\Program Files\Microsoft Azure Site Recovery Provider
        C:\Program Files\Microsoft Azure Site Recovery Provider\> DRConfigurator.exe /r  /Friendlyname <friendly name of the server> /Credentials <path of the credentials file> /EncryptionEnabled <full file name to save the encryption certificate>         

<span data-ttu-id="c35da-220">여기서 매개 변수는 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-220">Where parameters include:</span></span>

* <span data-ttu-id="c35da-221">**/Credentials**: 다운로드한 등록 키의 위치를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-221">**/Credentials**: Specify the location of the registration key you downloaded.</span></span>
* <span data-ttu-id="c35da-222">**/FriendlyName**: Hyper-V 호스트 서버를 식별하는 이름을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-222">**/FriendlyName**: Specify a name to identify the Hyper-V host server.</span></span> <span data-ttu-id="c35da-223">이 이름이 포털에 나타납니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-223">This name will appear in the portal</span></span>
* <span data-ttu-id="c35da-224">**/EncryptionEnabled**: 선택 사항입니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-224">**/EncryptionEnabled**: Optional.</span></span> <span data-ttu-id="c35da-225">Azure(암호화 미사용)에서 복제본 가상 컴퓨터를 암호화할 것인지 여부를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-225">Specify whether you want to encrypt replica virtual machines in Azure (at rest encryption).</span></span>
* <span data-ttu-id="c35da-226">**/proxyAddress**; **/proxyport**; **/proxyUsername**; **/proxyPassword**: 선택 사항입니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-226">**/proxyAddress**; **/proxyport**; **/proxyUsername**; **/proxyPassword**: Optional.</span></span> <span data-ttu-id="c35da-227">사용자 지정 프록시를 사용하거나 기존 프록시에 인증이 필요한 경우 프록시 매개 변수를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-227">Specify proxy parameters if you want to use a custom proxy, or your existing proxy requires authentication.</span></span>

## <a name="step-4-create-an-azure-storage-account"></a><span data-ttu-id="c35da-228">4단계: Azure 저장소 계정 만들기</span><span class="sxs-lookup"><span data-stu-id="c35da-228">Step 4: Create an Azure storage account</span></span>
* <span data-ttu-id="c35da-229">Azure Storage 계정이 없는 경우 **리소스 준비**에서 **저장소 계정 만들기**를 선택하여 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-229">In **Prepare resources** select **Create Storage Account**  to create an Azure storage account if you don't have one.</span></span> <span data-ttu-id="c35da-230">계정의 지역에서 복제 기능을 사용하도록 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-230">The account should have geo-replication enabled.</span></span> <span data-ttu-id="c35da-231">계정은 Azure Site Recovery 자격 증명 모음과 동일한 지역에 있고 동일한 구독과 연결되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-231">It should be in the same region as the Azure Site Recovery vault, and be associated with the same subscription.</span></span>

    ![저장소 계정 만들기](./media/site-recovery-hyper-v-site-to-azure-classic/create-resources.png)

> [!NOTE]
> 1. <span data-ttu-id="c35da-233">여러 리소스 그룹에 [새 Azure 포털](../storage/common/storage-create-storage-account.md) 을 사용하여 만든 저장소 계정의 이동을 지원하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-233">We do not support the move of Storage accounts created using the [new Azure portal](../storage/common/storage-create-storage-account.md) across resource groups.</span></span>
> 2. <span data-ttu-id="c35da-234">[저장소 계정 마이그레이션](../azure-resource-manager/resource-group-move-resources.md) 작업은 Site Recovery를 배포하는 데 사용되는 저장소 계정에서 같은 구독 내에 있거나 여러 구독에 있는 리소스 그룹에 대해 수행할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-234">[Migration of storage accounts](../azure-resource-manager/resource-group-move-resources.md) across resource groups within the same subscription or across subscriptions is not supported for storage accounts used for deploying Site Recovery.</span></span>
>

## <a name="step-5-create-and-configure-protection-groups"></a><span data-ttu-id="c35da-235">5단계: 보호 그룹 만들기 및 구성</span><span class="sxs-lookup"><span data-stu-id="c35da-235">Step 5: Create and configure protection groups</span></span>
<span data-ttu-id="c35da-236">보호 그룹은 동일한 보호 설정을 사용하여 보호하려는 가상 컴퓨터의 논리적 그룹화입니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-236">Protection groups are logical groupings of virtual machines that you want to protect using the same protection settings.</span></span> <span data-ttu-id="c35da-237">보호 설정을 보호 그룹에 적용하면 이러한 설정은 그룹에 추가한 가상 컴퓨터 모두에 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-237">You apply protection settings to a protection group, and those settings are applied to all virtual machines that you add to the group.</span></span>

1. <span data-ttu-id="c35da-238">**보호 그룹 만들기 및 구성**에서 **보호 그룹 만들기**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-238">In **Create and configure protection groups** click **Create a protection group**.</span></span> <span data-ttu-id="c35da-239">필수 조건이 갖추어지지 않은 경우 메시지가 표시되며 **세부 정보 보기** 를 클릭하여 자세한 내용을 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-239">If any prerequisites aren't in place a message is issued and you can click **View details** for more information.</span></span>
2. <span data-ttu-id="c35da-240">**보호 그룹** 탭에서 보호 그룹을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-240">In the **Protection Groups** tab, add a protection group.</span></span> <span data-ttu-id="c35da-241">이름, 소스 Hyper-V 사이트, 대상 **Azure**, Azure Site Recovery 구독 이름 및 Azure 저장소 계정을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-241">Specify a name, the source Hyper-V site, the target **Azure**, your Azure Site Recovery subscription name, and the Azure storage account.</span></span>

    ![보호 그룹](./media/site-recovery-hyper-v-site-to-azure-classic/protection-group.png)
3. <span data-ttu-id="c35da-243">**복제 설정**에서 **복사 빈도**를 설정하여 원본과 대상 간에 데이터 델타가 동기화되는 빈도를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-243">In **Replication settings** set the **Copy frequency** to specify how often the data delta should be synchronized between the source and target.</span></span> <span data-ttu-id="c35da-244">30초, 5분 또는 15분으로 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-244">You can set to 30 seconds, 5 minutes, or 15 minutes.</span></span>
4. <span data-ttu-id="c35da-245">**복구 지점 보존 기간** 에서 복구 기록을 보관하는 시간을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-245">In **Retain recovery points** specify how many hours of recovery history should be stored.</span></span>
5. <span data-ttu-id="c35da-246">**응용프로그램에 일관된 스냅숏의 빈도** 에서 VSS(볼륨 섀도 복사본 서비스)를 사용하여 스냅숏을 만들 때 응용프로그램이 일관된 상태가 되도록 할지 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-246">In **Frequency of application-consistent snapshots** you can specify whether to take snapshots that use Volume Shadow Copy Service (VSS) to ensure that applications are in a consistent state when the snapshot is taken.</span></span> <span data-ttu-id="c35da-247">기본적으로 수행되지는 않습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-247">By default these aren't taken.</span></span> <span data-ttu-id="c35da-248">값을 설정할 경우 구성할 추가 복구 지점 수보다 적은지 확인하세요.</span><span class="sxs-lookup"><span data-stu-id="c35da-248">Make sure this value is set to less than the number of additional recovery points you configure.</span></span> <span data-ttu-id="c35da-249">이는 가상 컴퓨터가 Windows 운영 체제를 실행하는 경우에만 지원됩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-249">This is only supported if the virtual machine is running a Windows operating system.</span></span>
6. <span data-ttu-id="c35da-250">**초기 복제 시작 시간** 에서 보호 그룹에 가상 컴퓨터의 초기 복제를 Azure로 보내도록 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-250">In **Initial replication start time** specify when initial replication of virtual machines in the protection group should be sent to Azure.</span></span>

    ![보호 그룹](./media/site-recovery-hyper-v-site-to-azure-classic/protection-group2.png)

## <a name="step-6-enable-virtual-machine-protection"></a><span data-ttu-id="c35da-252">6단계: 가상 컴퓨터 보호 사용</span><span class="sxs-lookup"><span data-stu-id="c35da-252">Step 6: Enable virtual machine protection</span></span>
<span data-ttu-id="c35da-253">가상 컴퓨터를 보호 그룹에 추가하여 보호를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-253">Add virtual machines to a protection group to enable protection for them.</span></span>

> [!NOTE]
> <span data-ttu-id="c35da-254">고정 IP 주소를 사용하여 Linux를 실행하는 VM 보호는 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-254">Protecting VMs running Linux with a static IP address isn't supported.</span></span>
>
>

1. <span data-ttu-id="c35da-255">보호 그룹의 **컴퓨터** 탭에서 **가상 컴퓨터를 보호 그룹에 추가하여 보호합니다.**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-255">On the **Machines** tab for the protection group, click** Add virtual machines to protection groups to enable protection**.</span></span>
2. <span data-ttu-id="c35da-256">**가상 컴퓨터 보호 사용** 페이지에서 보호할 가상 컴퓨터를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-256">On the **Enable Virtual Machine Protection** page select the virtual machines you want to protect.</span></span>

    ![가상 컴퓨터 보호 사용](./media/site-recovery-hyper-v-site-to-azure-classic/add-vm.png)

    <span data-ttu-id="c35da-258">보호 사용 작업이 시작됩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-258">The Enable Protection jobs begins.</span></span> <span data-ttu-id="c35da-259">**작업** 탭에서 진행률을 추적할 수 있습니다. 보호 완료 작업이 실행된 후에는 가상 컴퓨터가 장애 조치(Failover)를 수행할 준비가 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-259">You can track progress on the **Jobs** tab. After the Finalize Protection job runs the virtual machine is ready for failover.</span></span>
3. <span data-ttu-id="c35da-260">보호가 설정된 후 다음을 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-260">After protection is set up you can:</span></span>

   * <span data-ttu-id="c35da-261">**보호된 항목** > **보호 그룹** > *protectiongroup_name* > **가상 컴퓨터**에서 보호된 가상 컴퓨터를 볼 수 있습니다. **속성** 탭에서 컴퓨터 세부 정보를 자세히 다룰 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-261">View virtual machines in **Protected Items** > **Protection Groups** > *protectiongroup_name* > **Virtual Machines** You can drill down to machine details in the **Properties** tab..</span></span>
   * <span data-ttu-id="c35da-262">**보호된 항목** > **보호 그룹** > *protectiongroup_name* > **가상 컴퓨터** *virtual_machine_name* > **구성**에서 가상 컴퓨터의 장애 조치 속성을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-262">Configure the failover properties for a virtual machines in **Protected Items** > **Protection Groups** > *protectiongroup_name* > **Virtual Machines** *virtual_machine_name* > **Configure**.</span></span> <span data-ttu-id="c35da-263">다음을 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-263">You can configure:</span></span>

     * <span data-ttu-id="c35da-264">**이름**: Azure의 가상 컴퓨터 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-264">**Name**: The name of the virtual machine in Azure.</span></span>
     * <span data-ttu-id="c35da-265">**크기**: 장애 조치된 가상 컴퓨터의 대상 크기입니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-265">**Size**: The target size of the virtual machine that fails over.</span></span>

       ![가상 컴퓨터 속성 구성](./media/site-recovery-hyper-v-site-to-azure-classic/vm-properties.png)
   * <span data-ttu-id="c35da-267">다음을 포함하여 *보호된 항목** > **보호 그룹** > *protectiongroup_name* > **Virtual Machines** *virtual_machine_name* > **구성**에서 추가적인 가상 컴퓨터의 설정을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-267">Configure additional virtual machine settings in *Protected Items** > **Protection Groups** > *protectiongroup_name* > **Virtual Machines** *virtual_machine_name* > **Configure**, including:</span></span>

     * <span data-ttu-id="c35da-268">**네트워크 어댑터**: 네트워크 어댑터 수가 대상 가상 컴퓨터에 대해 지정하는 크기에 따라 결정됩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-268">**Network adapters**: The number of network adapters is dictated by the size you specify for the target virtual machine.</span></span> <span data-ttu-id="c35da-269">[가상 컴퓨터 크기 사양](../virtual-machines/linux/sizes.md) 에서 가상 컴퓨터 크기에 의해 지원되는 NIC의 수를 확인하세요.</span><span class="sxs-lookup"><span data-stu-id="c35da-269">Check [virtual machine size specs](../virtual-machines/linux/sizes.md) for the number of nics supported by the virtual machine size.</span></span>

       <span data-ttu-id="c35da-270">가상 컴퓨터의 크기를 수정하고 설정을 저장하면 다음에 **구성** 페이지를 열 때 네트워크 어댑터의 수가 변경됩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-270">When you modify the size for a virtual machine and save the settings, the number of network adapter will change when you open **Configure** page the next time.</span></span> <span data-ttu-id="c35da-271">대상 가상 컴퓨터의 네트워크 어댑터 수는 원본 가상 컴퓨터의 네트워크 어댑터 수 이상이어야 하며 선택한 가상 머신 크기에서 지원하는 네트워크 어댑터 수 이하여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-271">The number of network adapters of target virtual machines is minimum of the number of network adapters on source virtual machine and maximum number of network adapters supported by the size of the virtual machine chosen.</span></span> <span data-ttu-id="c35da-272">아래 설명을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="c35da-272">It is explained below:</span></span>

       * <span data-ttu-id="c35da-273">원본 컴퓨터의 네트워크 어댑터 수가 대상 컴퓨터 크기에 허용되는 어댑터 수보다 작거나 같은 경우, 대상의 어댑터 수는 소스와 동일해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-273">If the number of network adapters on the source machine is less than or equal to the number of adapters allowed for the target machine size, then the target will have the same number of adapters as the source.</span></span>
       * <span data-ttu-id="c35da-274">원본 가상 컴퓨터의 어댑터의 수가 대상 크기에 허용된 수를 초과하면 대상 크기 최대치가 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-274">If the number of adapters for the source virtual machine exceeds the number allowed for the target size then the target size maximum will be used.</span></span>
       * <span data-ttu-id="c35da-275">예를 들어 원본 컴퓨터에 두 네트워크 어댑터가 있고 대상 컴퓨터 크기가 4를 지원하는 경우, 대상 컴퓨터에는 2개의 어댑터가 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-275">For example if a source machine has two network adapters and the target machine size supports four, the target machine will have two adapters.</span></span> <span data-ttu-id="c35da-276">원본 컴퓨터에 두 어댑터가 있지만 지원되는 대상 크기가 하나만 지원하는 경우 대상 컴퓨터에는 1개의 어댑터만 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-276">If the source machine has two adapters but the supported target size only supports one then the target machine will have only one adapter.</span></span>

     * <span data-ttu-id="c35da-277">**Azure 네트워크**: 가상 컴퓨터가 장애 조치되는 네트워크를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-277">**Azure network**: Specify the network to which the virtual machine should fail over.</span></span> <span data-ttu-id="c35da-278">가상 컴퓨터에 여러 네트워크가 있는 경우 모든 어댑터는 동일한 Azure 네트워크에 연결되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-278">If the virtual machine has multiple network adapters all adapters should connected to the same Azure network.</span></span>
     * <span data-ttu-id="c35da-279">**서브넷** 가상 컴퓨터에서 각 네트워크 어댑터에 대해 장애 조치 후 컴퓨터가 연결되는 Azure 네트워크의 서브넷을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-279">**Subnet** For each network adapter on the virtual machine, select the subnet in the Azure network to which the machine should connect after failover.</span></span>
     * <span data-ttu-id="c35da-280">**대상 IP 주소**: 원본 가상 컴퓨터의 네트워크 어댑터를 고정 IP 주소를 사용하도록 구성하는 경우, 대상 가상 컴퓨터의 IP 주소를 지정하여 장애 조치 후 컴퓨터가 동일한 IP 주소를 갖도록 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-280">**Target IP address**: If the network adapter of source virtual machine is configured to use static a IP address then you can specify the IP address for the target virtual machine to ensure that the machine has the same IP address after failover.</span></span>  <span data-ttu-id="c35da-281">IP 주소를 지정하지 않으면 사용 가능한 임의의 주소가 장애 조치 시 할당됩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-281">If you don't specify an IP address then any available address will be assigned at the time of failover.</span></span> <span data-ttu-id="c35da-282">사용 중인 주소를 지정하는 경우 장애 조치가 실패합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-282">If you specify an address that's in use then failover will fail.</span></span>

     > [!NOTE]
     > <span data-ttu-id="c35da-283">같은 구독 내에 있거나 여러 구독에 있는 리소스 그룹에 대한 [네트워크의 마이그레이션](../azure-resource-manager/resource-group-move-resources.md)은 Site Recovery를 배포하는 데 사용되는 네트워크에 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-283">[Migration of networks](../azure-resource-manager/resource-group-move-resources.md) across resource groups within the same subscription or across subscriptions is not supported for networks used for deploying Site Recovery.</span></span>
     >

     ![가상 컴퓨터 속성 구성](./media/site-recovery-hyper-v-site-to-azure-classic/multiple-nic.png)




## <a name="step-7-create-a-recovery-plan"></a><span data-ttu-id="c35da-285">7단계: 복구 계획 만들기</span><span class="sxs-lookup"><span data-stu-id="c35da-285">Step 7: Create a recovery plan</span></span>
<span data-ttu-id="c35da-286">배포를 테스트하기 위해 단일 가상 컴퓨터에 대한 테스트 장애 조치(failover)를 실행하거나 하나 이상의 가상 컴퓨터를 포함한 복구 계획을 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-286">In order to test the deployment you can run a test failover for a single virtual machine or a recovery plan that contains one or more virtual machines.</span></span> <span data-ttu-id="c35da-287">[자세히 알아보세요](site-recovery-create-recovery-plans.md) .</span><span class="sxs-lookup"><span data-stu-id="c35da-287">[Learn more](site-recovery-create-recovery-plans.md) about creating a recovery plan.</span></span>

## <a name="step-8-test-the-deployment"></a><span data-ttu-id="c35da-288">8단계: 배포 테스트</span><span class="sxs-lookup"><span data-stu-id="c35da-288">Step 8: Test the deployment</span></span>
<span data-ttu-id="c35da-289">Azure로의 테스트 장애 조치(Failover)를 실행하는 두 가지 방법이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-289">There are two ways to run a test failover to Azure.</span></span>

* <span data-ttu-id="c35da-290">**Azure 네트워크를 사용하지 않는 테스트 장애 조치(Failover)**- 이 유형의 테스트 장애 조치는 Azure에서 가상 컴퓨터가 제대로 작동하는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-290">**Test failover without an Azure network**—This type of test failover checks that the virtual machine comes up correctly in Azure.</span></span> <span data-ttu-id="c35da-291">장애 조치(Failover) 후에 가상 컴퓨터가 Azure 네트워크에 연결되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-291">The virtual machine won’t be connected to any Azure network after failover.</span></span>
* <span data-ttu-id="c35da-292">**Azure 네트워크를 사용하는 테스트 장애 조치(Failover)**- 이 유형의 테스트 장애 조치는 전체 복제 환경이 예상대로 작동하고 장애 조치된 가상 컴퓨터가 지정한 대상 Azure 네트워크에 연결되는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-292">**Test failover with an Azure network**—This type of failover checks that the entire replication environment comes up as expected and that failed over the virtual machines connects to the specified target Azure network.</span></span> <span data-ttu-id="c35da-293">테스트 장애 조치(Failover)의 경우 테스트 가상 컴퓨터의 서브넷이 복제본 가상 컴퓨터의 서브넷에 따라 확인됩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-293">Note that for test failover the subnet of the test virtual machine will be figured out based on the subnet of the replica virtual machine.</span></span> <span data-ttu-id="c35da-294">이는 복제본 가상 컴퓨터의 서브넷이 원본 가상 컴퓨터의 서브넷을 기반으로 하는 일반 복제의 경우와 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-294">This is different to regular replication when the subnet of a replica virtual machine is based on the subnet of the source virtual machine.</span></span>

<span data-ttu-id="c35da-295">Azure 네트워크를 지정하지 않고 테스트 장애 조치(Failover)를 실행하려는 경우 아무 것도 준비할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-295">If you want to run a test failover without specifying an Azure network you don’t need to prepare anything.</span></span>

<span data-ttu-id="c35da-296">Azure 대상 네트워크를 사용하여 테스트 장애 조치(Failover)를 실행하려면 Azure 프로덕션 네트워크에서 격리된 새 Azure 네트워크를 만듭니다.(Azure에서 새 네트워크를 만들 때의 기본 동작)</span><span class="sxs-lookup"><span data-stu-id="c35da-296">To run a test failover with a target Azure network you’ll need to create a new Azure network that’s isolated from your Azure production network (default behavior when you create a new network in Azure).</span></span> <span data-ttu-id="c35da-297">자세한 내용은 [테스트 장애 조치(Failover) 실행](site-recovery-failover.md)을 살펴보세요.</span><span class="sxs-lookup"><span data-stu-id="c35da-297">Read [run a test failover](site-recovery-failover.md) for more details.</span></span>

<span data-ttu-id="c35da-298">복제 및 네트워크 배포를 완벽하게 테스트하려면 복제된 가상 컴퓨터가 예상대로 작동하도록 인프라를 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-298">To fully test your replication and network deployment you'll need to set up the infrastructure so that the replicated virtual machine to work as expected.</span></span> <span data-ttu-id="c35da-299">이렇게 하는 한 가지 방법은 DNS를 사용하여 가상 컴퓨터를 도메인 컨트롤러로 설정하고 사이트 복구를 사용하여 이를 Azure에 복제하고 테스트 장애 조치(Failover)를 실행하여 테스트 네트워크에 만드는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-299">One way of doing this to to set up a virtual machine as a domain controller with DNS and replicate it to Azure using Site Recovery to create it in the test network by running a test failover.</span></span>  <span data-ttu-id="c35da-300">[여기](site-recovery-active-directory.md#test-failover-considerations) 를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="c35da-300">[Read more](site-recovery-active-directory.md#test-failover-considerations) about test failover considerations for Active Directory.</span></span>

<span data-ttu-id="c35da-301">다음과 같이 테스트 장애 조치(Failover)를 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-301">Run the test failover as follows:</span></span>

> [!NOTE]
> <span data-ttu-id="c35da-302">Azure에 장애 조치를 수행할 때 최상의 성능을 얻으려면 보호된 컴퓨터에 Azure 에이전트를 설치하도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-302">To get the best performance when you do a failover to Azure, ensure that you have installed the Azure Agent in the protected machine.</span></span> <span data-ttu-id="c35da-303">더 빨리 부팅하고 문제가 발생한 경우 진단에도 도움이 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-303">This helps in booting faster and also helps in diagnosis in case of issues.</span></span> <span data-ttu-id="c35da-304">Linux 에이전트는 [여기](https://github.com/Azure/WALinuxAgent)에서 찾을 수 있습니다. Windows 에이전트는 [여기](http://go.microsoft.com/fwlink/?LinkID=394789)에서 찾을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-304">Linux agent can be found [here](https://github.com/Azure/WALinuxAgent) - and Windows agent can be found [here](http://go.microsoft.com/fwlink/?LinkID=394789)</span></span>
>
>

1. <span data-ttu-id="c35da-305">**복구 계획** 탭에서 계획을 선택하고 **테스트 장애 조치**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-305">On the **Recovery Plans** tab, select the plan and click **Test Failover**.</span></span>
2. <span data-ttu-id="c35da-306">**테스트 장애 조치 확인** 페이지에서 **없음** 또는 특정 Azure 네트워크를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-306">On the **Confirm Test Failover** page select **None** or a specific Azure network.</span></span>  <span data-ttu-id="c35da-307">**없음** 을 선택하면 테스트 장애 조치에서 가상 컴퓨터가 Azure로 올바르게 복제되었는지 확인하지만 복제 네트워크 구성은 확인하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-307">Note that if you select **None** the test failover will check that the virtual machine replicated correctly to Azure but doesn't check your replication network configuration.</span></span>

    ![테스트 장애 조치](./media/site-recovery-hyper-v-site-to-azure-classic/test-nonetwork.png)
3. <span data-ttu-id="c35da-309">**작업** 탭에서 장애 조치 진행률을 추적할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-309">On the **Jobs** tab you can track failover progress.</span></span> <span data-ttu-id="c35da-310">또한 Azure 포털에서 가상 컴퓨터 테스트 복제본을 확인할 수 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-310">You should also be able to see the virtual machine test replica in the Azure portal.</span></span> <span data-ttu-id="c35da-311">온-프레미스 네트워크에서 가상 컴퓨터에 액세스할 수 있도록 설정한 경우 가상 컴퓨터에 대한 원격 데스크톱 연결을 시작할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-311">If you’re set up to access virtual machines from your on-premises network you can initiate a Remote Desktop connection to the virtual machine.</span></span>
4. <span data-ttu-id="c35da-312">장애 조치가 **테스트 완료** 단계에 도달하면 **테스트 완료**를 클릭하여 테스트 장애 조치를 완료합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-312">When the failover reaches the **Complete testing** phase , click **Complete Test** to finish up the test failover.</span></span> <span data-ttu-id="c35da-313">**작업** 탭으로 드릴다운하여 장애 조치 진행률 및 상태를 추적하고 필요한 작업을 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-313">You can drill down to the **Job** tab to track failover progress and status, and to perform any actions that are needed.</span></span>
5. <span data-ttu-id="c35da-314">장애 조치(Failover) 후에는 Azure Portal에서 가상 컴퓨터 테스트 복제본을 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-314">After  failover you'll be able to see the virtual machine test replica in the Azure portal.</span></span> <span data-ttu-id="c35da-315">온-프레미스 네트워크에서 가상 컴퓨터에 액세스할 수 있도록 설정한 경우 가상 컴퓨터에 대한 원격 데스크톱 연결을 시작할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-315">If you’re set up to access virtual machines from your on-premises network you can initiate a Remote Desktop connection to the virtual machine.</span></span>

   1. <span data-ttu-id="c35da-316">가상 컴퓨터가 성공적으로 시작되는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-316">Verify that the virtual machines start successfully.</span></span>
   2. <span data-ttu-id="c35da-317">장애 조치(Failover) 후에 원격 데스크탑을 사용하여 Azure의 가상 컴퓨터에 연결하려면 가상 컴퓨터에서 원격 데스크탑 연결을 사용하도록 설정하고 나서 테스트 장애 조치(Failover)를 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-317">If you want to connect to the virtual machine in Azure using Remote Desktop after the failover, enable Remote Desktop Connection on the virtual machine before you run the test failover.</span></span> <span data-ttu-id="c35da-318">가상 컴퓨터에서 RDP 끝점을 추가해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-318">You will also need to add an RDP endpoint on the virtual machine.</span></span> <span data-ttu-id="c35da-319">이를 위해서 [Azure Automation Runbook](site-recovery-runbook-automation.md) 을 활용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-319">You can leverage an [Azure automation runbook](site-recovery-runbook-automation.md) to do that.</span></span>
   3. <span data-ttu-id="c35da-320">장애 조치(Failover)는 원격 데스크톱을 사용하여 Azure에서 가상 컴퓨터에 연결하기 위해 공용 IP 주소를 사용하는 경우, 공용 주소를 사용하여 가상 컴퓨터에 연결하지 않는 도메인 정책이 없어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-320">After failover if you use a public IP address to connect to the virtual machine in Azure using Remote Desktop, ensure you don't have any domain policies that prevent you from connecting to a virtual machine using a public address.</span></span>
6. <span data-ttu-id="c35da-321">테스트가 완료되면 다음을 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-321">After the testing is complete do the following:</span></span>

   * <span data-ttu-id="c35da-322">**테스트 장애 조치(Failover)가 완료되었습니다**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-322">Click **The test failover is complete**.</span></span> <span data-ttu-id="c35da-323">테스트 환경을 정리하여 자동으로 테스트 가상 컴퓨터의 전원을 끄고 컴퓨터를 삭제합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-323">Clean up the test environment to automatically power off and delete the test virtual machines.</span></span>
   * <span data-ttu-id="c35da-324">**참고** 를 클릭하여 테스트 장애 조치(Failover)와 연관된 항목을 기록한 후 저장합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-324">Click **Notes** to record and save any observations associated with the test failover.</span></span>
7. <span data-ttu-id="c35da-325">장애 조치(Failover)가 **테스트 완료** 단계에 도달하면 다음과 같이 검증을 마칩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-325">When the failover reaches the **Complete testing** phase finish the verification as follows:</span></span>
   1. <span data-ttu-id="c35da-326">Azure 포털에서 복제본 가상 컴퓨터를 봅니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-326">View the replica virtual machine in the Azure portal.</span></span> <span data-ttu-id="c35da-327">가상 컴퓨터가 성공적으로 시작되는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-327">Verify that the virtual machine starts successfully.</span></span>
   2. <span data-ttu-id="c35da-328">온-프레미스 네트워크에서 가상 컴퓨터에 액세스할 수 있도록 설정한 경우 가상 컴퓨터에 대한 원격 데스크톱 연결을 시작할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-328">If you’re set up to access virtual machines from your on-premises network you can initiate a Remote Desktop connection to the virtual machine.</span></span>
   3. <span data-ttu-id="c35da-329">**테스트 완료** 를 클릭하여 테스트를 마칩니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-329">Click **Complete the test** to finish it.</span></span>
   4. <span data-ttu-id="c35da-330">**참고** 를 클릭하여 테스트 장애 조치(Failover)와 연관된 항목을 기록한 후 저장합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-330">Click **Notes** to record and save any observations associated with the test failover.</span></span>
   5. <span data-ttu-id="c35da-331">**테스트 장애 조치(Failover)가 완료되었습니다**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-331">Click **The test failover is complete**.</span></span> <span data-ttu-id="c35da-332">테스트 환경을 정리하여 자동으로 테스트 가상 컴퓨터의 전원을 끄고 컴퓨터를 삭제합니다.</span><span class="sxs-lookup"><span data-stu-id="c35da-332">Clean up the test environment to automatically power off and delete the test virtual machine.</span></span>

## <a name="next-steps"></a><span data-ttu-id="c35da-333">다음 단계</span><span class="sxs-lookup"><span data-stu-id="c35da-333">Next steps</span></span>
<span data-ttu-id="c35da-334">배포가 설정되고 실행된 후 장애 조치에 대해 [알아봅니다](site-recovery-failover.md) .</span><span class="sxs-lookup"><span data-stu-id="c35da-334">After your deployment is set up and running, [learn more](site-recovery-failover.md) about failover.</span></span>
