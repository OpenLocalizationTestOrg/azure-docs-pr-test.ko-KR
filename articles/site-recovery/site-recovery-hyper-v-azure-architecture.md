---
title: "Site Recovery에서 Azure에 대한 Hyper-V 복제가 작동하는 방식 | Microsoft Docs"
description: "이 문서에서는 Azure Site Recovery에서 Hyper-V 복제가 어떻게 작동하는지에 대한 개요를 제공합니다."
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: jwhit
editor: 
ms.assetid: c413efcd-d750-4b22-b34b-15bcaa03934a
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 06/14/2017
ms.author: raynew
ROBOTS: NOINDEX, NOFOLLOW
redirect_url: site-recovery-architecture-hyper-v-to-azure
ms.openlocfilehash: 6fa952af93033f82effdef418903fc93d94dd05c
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/11/2017
---
# <a name="how-does-hyper-v-replication-to-azure-work"></a><span data-ttu-id="2407d-104">Azure에 대한 Hyper-V 복제가 작동하는 방식</span><span class="sxs-lookup"><span data-stu-id="2407d-104">How does Hyper-V replication to Azure work?</span></span>

<span data-ttu-id="2407d-105">이 문서를 통해 [Azure Site Recovery](site-recovery-overview.md) 서비스를 사용하여 Azure로 Hyper-V 복제의 아키텍처 및 워크플로에 대해 알아보세요.</span><span class="sxs-lookup"><span data-stu-id="2407d-105">Read this article to understand the architecture and workflows for Hyper-V replication to Azure using the [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="2407d-106">이 문서의 하단 또는 [Azure Recovery Services 포럼](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr)에서 의견을 게시합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-106">Post any comments at the bottom of this article, or in the [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>

<span data-ttu-id="2407d-107">다음 사항을 Azure로 복제할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-107">You can replicate the following to Azure:</span></span>
- <span data-ttu-id="2407d-108">**Hyper-V(VMM 포함)**: System Center VMM(Virtual Machine Manager) 클라우드에서 관리되는 온-프레미스 Hyper-V 호스트에 있는 VM.</span><span class="sxs-lookup"><span data-stu-id="2407d-108">**Hyper-V with VMM**: VMs located on on-premises Hyper-V hosts managed in  System Center Virtual MAchine Manager (VMM) clouds.</span></span> <span data-ttu-id="2407d-109">[지원 되는 운영 체제](site-recovery-support-matrix-to-azure.md#support-for-datacenter-management-servers)에서 실행할 수 있는 호스트.</span><span class="sxs-lookup"><span data-stu-id="2407d-109">Hosts can be running any [supported operating system](site-recovery-support-matrix-to-azure.md#support-for-datacenter-management-servers).</span></span> <span data-ttu-id="2407d-110">[Hyper-V 및 Azure에서 지원하는](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows) 게스트 운영 체제를 실행하는 Hyper-V VM을 복제할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-110">You can replicate Hyper-V VMs running any guest operating system [supported by Hyper-V and Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span></span>
- <span data-ttu-id="2407d-111">**Hyper-V(VMM 없음)**: VMM 클라우드에서 관리되지 않는 Hyper-V 호스트에 있는 온-프레미스 VM.</span><span class="sxs-lookup"><span data-stu-id="2407d-111">**Hyper-V without VMM**: On-premises VMs located on Hyper-V hosts that aren't managed in VMM clouds.</span></span> <span data-ttu-id="2407d-112">[지원되는 운영 체제](site-recovery-support-matrix-to-azure.md#support-for-replicated-machine-os-versions)에서 실행할 수 있는 호스트.</span><span class="sxs-lookup"><span data-stu-id="2407d-112">Hosts can run any of the [supported operating systems](site-recovery-support-matrix-to-azure.md#support-for-replicated-machine-os-versions).</span></span> <span data-ttu-id="2407d-113">[Hyper-V 및 Azure에서 지원하는](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows) 게스트 운영 체제를 실행하는 Hyper-V VM을 복제할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-113">You can replicate Hyper-V VMs running any guest operating system [supported by Hyper-V and Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="2407d-114">아키텍처 구성 요소</span><span class="sxs-lookup"><span data-stu-id="2407d-114">Architectural components</span></span>

<span data-ttu-id="2407d-115">**영역**</span><span class="sxs-lookup"><span data-stu-id="2407d-115">**Area**</span></span> | <span data-ttu-id="2407d-116">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="2407d-116">**Component**</span></span> | <span data-ttu-id="2407d-117">**세부 정보**</span><span class="sxs-lookup"><span data-stu-id="2407d-117">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="2407d-118">**Azure**</span><span class="sxs-lookup"><span data-stu-id="2407d-118">**Azure**</span></span> | <span data-ttu-id="2407d-119">Azure에서는 Microsoft Azure 계정, Azure Storage 계정 및 Azure 네트워크가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-119">In Azure you need a Microsoft Azure account, an Azure storage account, and a Azure network.</span></span> | <span data-ttu-id="2407d-120">저장소 및 네트워크는 Resource Manager 기반 계정 또는 기존 계정일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-120">Storage and network can be Resource Manager-based, or classic accounts.</span></span><br/><br/> <span data-ttu-id="2407d-121">복제된 데이터를 저장소 계정에 저장하고 온-프레미스 사이트에서 장애 조치가 발생한 경우 복제된 데이터를 사용하여 Azure VM을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-121">Replicated data is stored in the storage account, and Azure VMs are created with the replicated data when failover from your on-premises site occurs.</span></span><br/><br/> <span data-ttu-id="2407d-122">Azure VM을 만들 때 Azure 가상 네트워크에 연결합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-122">The Azure VMs connect to the Azure virtual network when they're created.</span></span>
<span data-ttu-id="2407d-123">**VMM 서버**</span><span class="sxs-lookup"><span data-stu-id="2407d-123">**VMM server**</span></span> | <span data-ttu-id="2407d-124">VMM 클라우드에 있는 Hyper-V 호스트</span><span class="sxs-lookup"><span data-stu-id="2407d-124">Hyper-V hosts located in VMM clouds</span></span> | <span data-ttu-id="2407d-125">VMM 클라우드에서 Hyper-V 호스트를 관리하는 경우 Recovery Services 자격 증명 모음에 VMM 서버를 등록합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-125">If Hyper-V hosts are managed in VMM clouds, you register the VMM server in the Recovery Services vault.</span></span><br/><br/> <span data-ttu-id="2407d-126">VMM 서버에서 Site Recovery Provider를 설치하여 Azure로 복제를 오케스트레이션합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-126">On the VMM server you install the Site Recovery Provider to orchestrate replication with Azure.</span></span><br/><br/> <span data-ttu-id="2407d-127">논리 및 VM 네트워크를 설정하여 네트워크 매핑을 구성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-127">You need logical and VM networks set up to configure network mapping.</span></span> <span data-ttu-id="2407d-128">VM 네트워크는 클라우드와 연결된 논리 네트워크에 연결되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-128">A VM network should be linked to a logical network that's associated with the cloud.</span></span>
<span data-ttu-id="2407d-129">**Hyper-V 호스트**</span><span class="sxs-lookup"><span data-stu-id="2407d-129">**Hyper-V host**</span></span> | <span data-ttu-id="2407d-130">Hyper-V 서버는 VMM 서버를 사용하거나 사용하지 않고 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-130">Hyper-V servers can be deployed with or without VMM server.</span></span> | <span data-ttu-id="2407d-131">VMM 서버가 없는 경우 Site Recovery 복제를 오케스트레이션하기 위해 Site Recovery Provider가 인터넷을 통해 호스트에 설치됩니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-131">If there's no VMM server, the Site Recovery Provider is installed on the host to orchestrate replication with Site Recovery over the internet.</span></span> <span data-ttu-id="2407d-132">VMM 서버가 있는 경우, 공급자는 호스트가 아니라 서버에 설치됩니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-132">If there's a VMM server, the Provider is installed on it, and not on the host.</span></span><br/><br/> <span data-ttu-id="2407d-133">Recovery Services 에이전트는 호스트에 설치되어 데이터 복제를 처리합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-133">The Recovery Services agent is installed on the host to handle data replication.</span></span><br/><br/> <span data-ttu-id="2407d-134">공급자 및 에이전트로부터의 통신은 모두 보호 및 암호화됩니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-134">Communications from both the Provider and the agent are secure and encrypted.</span></span> <span data-ttu-id="2407d-135">Azure 저장소에 복제된 데이터도 암호화됩니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-135">Replicated data in Azure storage is also encrypted.</span></span>
<span data-ttu-id="2407d-136">**Hyper-V VM**</span><span class="sxs-lookup"><span data-stu-id="2407d-136">**Hyper-V VMs**</span></span> | <span data-ttu-id="2407d-137">Hyper-V 호스트 서버에 하나 이상의 VM이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-137">You need one or more VMs on the Hyper-V host server.</span></span> | <span data-ttu-id="2407d-138">명시적으로 VM에 설치해야 하는 것은 없음</span><span class="sxs-lookup"><span data-stu-id="2407d-138">Nothing needs to explicitly installed on VMs</span></span>

## <a name="deployment-steps"></a><span data-ttu-id="2407d-139">배포 단계</span><span class="sxs-lookup"><span data-stu-id="2407d-139">Deployment steps</span></span>

1. <span data-ttu-id="2407d-140">**Azure**: Azure 구성 요소를 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-140">**Azure**: You set up the Azure components.</span></span> <span data-ttu-id="2407d-141">Site Recovery 배포를 시작하기 전에 저장소 및 네트워크 계정을 설정하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-141">We recommend you set up storage and network accounts before you begin Site Recovery deployment.</span></span>
2. <span data-ttu-id="2407d-142">**자격 증명 모음**: Site Recovery에 대한 Recovery Services 자격 증명 모음을 만들고 원본 및 대상 설정 구성, 복제 정책 설정 및 복제 활성화를 포함하는 자격 증명 모음 설정을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-142">**Vault**: You create a Recovery Services vault for Site Recovery, and configure vault settings, including configuring source and target settings, setting up a replication policy, and enabling replication.</span></span>
3. <span data-ttu-id="2407d-143">**원본 및 대상**:</span><span class="sxs-lookup"><span data-stu-id="2407d-143">**Source and target**:</span></span>
    - <span data-ttu-id="2407d-144">**VMM 클라우드의 Hyper-V 호스트**: 원본 설정 지정의 일부로 VMM 서버에 Azure Site Recovery Provider, 각 Hyper-V 호스트에 Azure Recovery Services 에이전트를 다운로드하여 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-144">**Hyper-V hosts in VMM clouds**: As part of specifying source settings, you download and install the Azure Site Recovery Provider on the VMM server, and the Azure Recovery Services agent on each Hyper-V host.</span></span> <span data-ttu-id="2407d-145">원본은 VMM 서버가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-145">The source will be the VMM server.</span></span> <span data-ttu-id="2407d-146">대상은 Azure입니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-146">The target is Azure.</span></span>
    - <span data-ttu-id="2407d-147">Hyper-V 호스트(VMM 없음): 원본 설정을 지정할 때 각 Hyper-V 호스트에 공급자 및 에이전트를 다운로드하여 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-147">Hyper-V hosts without VMM: When you specify source settings, you download and install the Provider and agent on each Hyper-V host.</span></span> <span data-ttu-id="2407d-148">배포하는 동안 호스트를 Hyper-V 사이트로 수집하고 이 사이트를 원본으로 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-148">During deployment you gather the hosts into a Hyper-V site, and specify this site as the source.</span></span> <span data-ttu-id="2407d-149">대상은 Azure입니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-149">The target is Azure.</span></span>

    <span data-ttu-id="2407d-150">![Azure 하이퍼-V/v m M 복제](./media/site-recovery-components/arch-onprem-onprem-azure-vmm.png) ![azure 하이퍼-V 사이트 간 복제](./media/site-recovery-components/arch-onprem-azure-hypervsite.png)</span><span class="sxs-lookup"><span data-stu-id="2407d-150">![Hyper-V/VMM replication to Azure](./media/site-recovery-components/arch-onprem-onprem-azure-vmm.png) ![Hyper-V site replication to Azure](./media/site-recovery-components/arch-onprem-azure-hypervsite.png)</span></span>


4. <span data-ttu-id="2407d-151">**복제 정책**: Hyper-V 사이트 또는 VMM 클라우드에 대한 복제 정책을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-151">**Replication policy**: You create a replication policy for the Hyper-V site or VMM cloud.</span></span> <span data-ttu-id="2407d-152">정책은 사이트 또는 클라우드의 호스트에 있는 모든 VM에 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-152">The policy is applied to all VMs located on hosts in the site or cloud.</span></span>
5. <span data-ttu-id="2407d-153">**복제 활성화**: Hyper-V VM에 대한 복제를 활성화합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-153">**Enable replication**: You enable replication for Hyper-V VMs.</span></span> <span data-ttu-id="2407d-154">초기 복제는 복제 정책 설정에 따라 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-154">Initial replication occurs in accordance with the replication policy settings.</span></span> <span data-ttu-id="2407d-155">데이터 변경을 추적하고 Azure에 대한 델타 변경 내용의 복제를 초기 복제가 완료된 후에 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-155">Data changes are tracked, and replication of delta changes to Azure begins after the initial replication finishes.</span></span> <span data-ttu-id="2407d-156">.hrl 파일에는 항목에 대한 추적된 변경 내용이 유지됩니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-156">Tracked changes for an item are held in a .hrl file.</span></span>
6. <span data-ttu-id="2407d-157">**테스트 장애 조치(failover)**: 모든 것이 예상대로 작동하는지 확인할 수 있도록 테스트 장애 조치(failover)를 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-157">**Test failover**:  You run a test failover to make sure everything's working as expected.</span></span>

<span data-ttu-id="2407d-158">배포에 대해 자세히 알아보세요.</span><span class="sxs-lookup"><span data-stu-id="2407d-158">Learn more about deployment:</span></span>
- [<span data-ttu-id="2407d-159">Azure로 Hyper-V VM 복제 시작(VMM 있음)</span><span class="sxs-lookup"><span data-stu-id="2407d-159">Get started with Hyper-V VM replication to Azure - with VMM</span></span>](site-recovery-vmm-to-azure.md)
- [<span data-ttu-id="2407d-160">Azure로 Hyper-V VM 복제 시작(VMM 없음)</span><span class="sxs-lookup"><span data-stu-id="2407d-160">Get started with Hyper-V VM replication to Azure - without VMM</span></span>](site-recovery-hyper-v-site-to-azure.md)

## <a name="hyper-v-replication-workflow"></a><span data-ttu-id="2407d-161">Hyper-V 복제 워크플로</span><span class="sxs-lookup"><span data-stu-id="2407d-161">Hyper-V replication workflow</span></span>

### <a name="enable-protection"></a><span data-ttu-id="2407d-162">보호 사용</span><span class="sxs-lookup"><span data-stu-id="2407d-162">Enable protection</span></span>

1. <span data-ttu-id="2407d-163">Azure Portal 또는 온-프레미스에서 Hyper-V VM에 대한 보호를 사용하도록 설정하면 **보호 활성화**가 시작됩니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-163">After you enable protection for a Hyper-V VM, in the Azure portal or on-premises, the **Enable protection** starts.</span></span>
2. <span data-ttu-id="2407d-164">이 작업은 사용자가 구성한 설정으로 Azure에 대한 복제를 설정하기 위해 [CreateReplicationRelationship](https://msdn.microsoft.com/library/hh850036.aspx) 메서드를 호출하기 전에 해당 컴퓨터가 전제 조건에 부합하는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-164">The job checks that the machine complies with prerequisites, before invoking the [CreateReplicationRelationship](https://msdn.microsoft.com/library/hh850036.aspx), to set up replication with the settings you've configured.</span></span>
3. <span data-ttu-id="2407d-165">작업은 [StartReplication](https://msdn.microsoft.com/library/hh850303.aspx) 메서드를 호출하여 초기 복제를 시작하여 전체 VM 복제를 초기화하고 Azure로 VM의 가상 디스크를 전송합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-165">The job starts initial replication by invoking the [StartReplication](https://msdn.microsoft.com/library/hh850303.aspx) method, to initialize a full VM replication, and send the VM's virtual disks to Azure.</span></span>
4. <span data-ttu-id="2407d-166">**작업** 탭에서 작업을 모니터링할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-166">You can monitor the job in the **Jobs** tab.</span></span>
        <span data-ttu-id="2407d-167">![작업 목록](media/site-recovery-hyper-v-azure-architecture/image1.png)![보호 드릴 다운 사용](media/site-recovery-hyper-v-azure-architecture/image2.png)</span><span class="sxs-lookup"><span data-stu-id="2407d-167">![Jobs list](media/site-recovery-hyper-v-azure-architecture/image1.png) ![Enable protection drill down](media/site-recovery-hyper-v-azure-architecture/image2.png)</span></span>

### <a name="initial-replication"></a><span data-ttu-id="2407d-168">초기 복제</span><span class="sxs-lookup"><span data-stu-id="2407d-168">Initial replication</span></span>

1. <span data-ttu-id="2407d-169">초기 복제가 트리거될 때 [Hyper-V VM 스냅숏](https://technet.microsoft.com/library/dd560637.aspx)이 만들어집니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-169">A [Hyper-V VM snapshot](https://technet.microsoft.com/library/dd560637.aspx) snapshot is taken when initial replication is triggered.</span></span>
2. <span data-ttu-id="2407d-170">가상 하드 디스크는 모두 Azure에 복사될 때까지 하나씩 복제됩니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-170">Virtual hard disks are replicated one by one until they're all copied to Azure.</span></span> <span data-ttu-id="2407d-171">VM 크기 및 네트워크 대역폭에 따라 시간이 오래 걸릴 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-171">It could take a while, depending on the VM size, and network bandwidth.</span></span> <span data-ttu-id="2407d-172">네트워크 사용을 최적화하려면 [Azure 보호 네트워크 대역폭 사용에 대한 온-프레미스 관리 방법](https://support.microsoft.com/kb/3056159)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2407d-172">To optimize your network usage, see [How to manage on-premises to Azure protection network bandwidth usage](https://support.microsoft.com/kb/3056159).</span></span>
3. <span data-ttu-id="2407d-173">초기 복제 진행 중에 디스크가 변경될 경우, Hyper-V 복제 로그(.hrl)로 Hyper-V 복제본 복제 추적자가 이러한 변경 내용을 추적합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-173">If disk changes occur while initial replication is in progress, the Hyper-V Replica Replication Tracker tracks those changes as Hyper-V Replication Logs (.hrl).</span></span> <span data-ttu-id="2407d-174">이러한 파일은 디스크와 동일한 폴더에 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-174">These files are located in the same folder as the disks.</span></span> <span data-ttu-id="2407d-175">각 디스크에는 보조 저장소로 전송되는 .hrl 파일이 연결되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-175">Each disk has an associated .hrl file that will be sent to secondary storage.</span></span>
4. <span data-ttu-id="2407d-176">초기 복제 진행 중에는 스냅숏과 로그 파일이 디스크 리소스를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-176">The snapshot and log files consume disk resources while initial replication is in progress.</span></span>
5. <span data-ttu-id="2407d-177">초기 복제가 완료되면 VM 스냅숏은 삭제됩니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-177">When the initial replication finishes, the VM snapshot is deleted.</span></span> <span data-ttu-id="2407d-178">로그의 델타 디스크 변경 내용이 동기화되고 부모 디스크로 병합합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-178">Delta disk changes in the log are synchronized and merged to the parent disk.</span></span>


### <a name="finalize-protection"></a><span data-ttu-id="2407d-179">보호 완료</span><span class="sxs-lookup"><span data-stu-id="2407d-179">Finalize protection</span></span>

1. <span data-ttu-id="2407d-180">초기 복제를 완료한 후에 **가상 컴퓨터에서 보호 완료** 작업에서 가상 컴퓨터를 보호하도록 네트워크 및 기타 복제 후 설정을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-180">After the initial replication finishes, the **Finalize protection on the virtual machine** job configures network and other post-replication settings, so that the virtual machine is protected.</span></span>
    <span data-ttu-id="2407d-181">![보호 작업 완료](media/site-recovery-hyper-v-azure-architecture/image3.png)</span><span class="sxs-lookup"><span data-stu-id="2407d-181">![Finalize protection job](media/site-recovery-hyper-v-azure-architecture/image3.png)</span></span>
2. <span data-ttu-id="2407d-182">Azure에 복제할 경우 장애 조치를 위해 가상 컴퓨터에 대한 설정을 조정해야 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-182">If you're replicating to Azure, you might need to tweak the settings for the virtual machine so that it's ready for failover.</span></span> <span data-ttu-id="2407d-183">이 시점에서 테스트 장애 조치(Failover)를 실행하여 모든 것이 예상대로 작동하는지 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-183">At this point you can run a test failover to check everything is working as expected.</span></span>

### <a name="delta-replication"></a><span data-ttu-id="2407d-184">델타 복제</span><span class="sxs-lookup"><span data-stu-id="2407d-184">Delta replication</span></span>

1. <span data-ttu-id="2407d-185">초기 복제 후에는 복제 설정에 따라 델타 동기화가 시작됩니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-185">After the initial replication, delta synchronization begins, in accordance with replication settings.</span></span>
2. <span data-ttu-id="2407d-186">Hyper-V 복제본 복제 추적자가 .hrl 파일로 가상 하드 디스크에 변경 내용을 추적합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-186">The Hyper-V Replica Replication Tracker tracks the changes to a virtual hard disk as .hrl files.</span></span> <span data-ttu-id="2407d-187">복제를 위해 구성된 각 디스크에는 연결된 .hrl 파일이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-187">Each disk that's configured for replication has an associated .hrl file.</span></span> <span data-ttu-id="2407d-188">이 로그는 초기 복제가 완료된 후 고객의 저장소 계정으로 전송됩니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-188">This log is sent to the customer's storage account after initial replication is complete.</span></span> <span data-ttu-id="2407d-189">로그가 Azure로 전송 중인 경우 주 디스크의 변경 내용은 같은 디렉터리의 다른 로그 파일에 추적됩니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-189">When a log is in transit to Azure, the changes in the primary disk are tracked in another log file, in the same directory.</span></span>
3. <span data-ttu-id="2407d-190">초기 및 델타 복제가 진행되는 동안 VM 보기에서 VM을 모니터링할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-190">During initial and delta replication, you can monitor the VM in the VM view.</span></span> <span data-ttu-id="2407d-191">[자세히 알아보기](site-recovery-monitoring-and-troubleshooting.md#monitor-replication-health-for-virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="2407d-191">[Learn more](site-recovery-monitoring-and-troubleshooting.md#monitor-replication-health-for-virtual-machines).</span></span>  

### <a name="replication-synchronization"></a><span data-ttu-id="2407d-192">복제 동기화</span><span class="sxs-lookup"><span data-stu-id="2407d-192">Replication synchronization</span></span>

1. <span data-ttu-id="2407d-193">델타 복제에 실패했고 전체 복제에는 대역폭이나 시간이 많이 소모될 경우 VM에서 다시 동기화가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-193">If delta replication fails, and a full replication would be costly in terms of bandwidth or time, then a VM is marked for resynchronization.</span></span> <span data-ttu-id="2407d-194">예를 들어 .hrl 파일이 디스크 크기에 50%에 달한다면 VM이 다시 동기화되도록 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-194">For example, if the .hrl files reach 50% of the disk size, then the VM will be marked for resynchronization.</span></span>
2.  <span data-ttu-id="2407d-195">다시 동기화는 원본 및 대상 가상 컴퓨터의 체크섬을 계산하고 델타 데이터만 전송하므로 보내는 데이터 크기가 최소화됩니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-195">Resynchronization minimizes the amount of data sent by computing checksums of the source and target virtual machines, and sending only the delta data.</span></span> <span data-ttu-id="2407d-196">다시 동기화는 고정 블록 청크 알고리즘을 사용하며 이 경우 원본 및 대상 파일이 고정 청크로 나누어집니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-196">Resynchronization uses a fixed-block chunking algorithm where source and target files are divided into fixed chunks.</span></span> <span data-ttu-id="2407d-197">각 청크에 대한 체크섬을 생성한 후 이를 비교하여 원본의 어떤 블록을 대상에 적용해야 하는지 결정합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-197">Checksums for each chunk are generated and then compared to determine which blocks from the source need to be applied to the target.</span></span>
3. <span data-ttu-id="2407d-198">다시 동기화를 마치면 일반 델타 복제가 다시 시작됩니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-198">After resynchronization finishes, normal delta replication should resume.</span></span> <span data-ttu-id="2407d-199">기본적으로 다시 동기화는 업무 시간 이외에 실행되도록 예약되나 수동으로 가상 컴퓨터를 다시 동기화할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-199">By default resynchronization is scheduled to run automatically outside office hours, but you can resynchronize a virtual machine manually.</span></span> <span data-ttu-id="2407d-200">예를 들어 네트워크 중단 또는 다른 중단이 발생하면 다시 동기화를 다시 시작할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-200">For example, you can resume resynchronization if a network outage or another outage occurs.</span></span> <span data-ttu-id="2407d-201">이렇게 하려면 포털 > **다시 동기화**에서 VM을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-201">To do this, select the VM in the portal > **Resynchronize**.</span></span>

    ![수동 다시 동기화](media/site-recovery-hyper-v-azure-architecture/image4.png)


### <a name="retries"></a><span data-ttu-id="2407d-203">다시 시도</span><span class="sxs-lookup"><span data-stu-id="2407d-203">Retries</span></span>

<span data-ttu-id="2407d-204">복제 오류가 발생한 경우 기본 제공 재시도가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-204">If a replication error occurs, there's a built-in retry.</span></span> <span data-ttu-id="2407d-205">이 논리는 두 가지 범주로 분류할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-205">This logic can be classified into two categories:</span></span>

<span data-ttu-id="2407d-206">**범주**</span><span class="sxs-lookup"><span data-stu-id="2407d-206">**Category**</span></span> | <span data-ttu-id="2407d-207">**세부 정보**</span><span class="sxs-lookup"><span data-stu-id="2407d-207">**Details**</span></span>
--- | ---
<span data-ttu-id="2407d-208">**복구할 수 없는 오류**</span><span class="sxs-lookup"><span data-stu-id="2407d-208">**Non-recoverable errors**</span></span> | <span data-ttu-id="2407d-209">재시도가 수행되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-209">No retry is attempted.</span></span> <span data-ttu-id="2407d-210">VM 상태가 **위험**으로 표시되고 관리자 개입이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-210">VM status will be **Critical**, and administrator intervention is required.</span></span> <span data-ttu-id="2407d-211">이러한 오류의 예로는 VHD 체인 손상, VM 복제본에 대한 잘못된 상태, 네트워크 인증 오류, 권한 부여 오류, VM 찾을 수 없음 오류(독립 실행형 Hyper-V 서버의 경우)가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-211">Examples of these errors include: broken VHD chain; Invalid state for the replica VM; Network authentication errors: authorization errors; VM not found errors (for standalone Hyper-V servers)</span></span>
<span data-ttu-id="2407d-212">**복구할 수 있는 오류**</span><span class="sxs-lookup"><span data-stu-id="2407d-212">**Recoverable errors**</span></span> | <span data-ttu-id="2407d-213">첫 번째 시도부터 재시도 간격을 늘리는 기하급수적인 백오프(1, 2, 4, 8, 10분)를 사용하여 복제 간격마다 재시도가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-213">Retries occur every replication interval, using an exponential back-off that increases the retry interval from the start of the first attempt by 1, 2, 4, 8, and 10 minutes.</span></span> <span data-ttu-id="2407d-214">오류가 계속되면 30분마다 다시 시도하십시오.</span><span class="sxs-lookup"><span data-stu-id="2407d-214">If an error persists, retry every 30 minutes.</span></span> <span data-ttu-id="2407d-215">이러한 예로는 네트워크 오류, 디스크 공간 부족, 메모리 부족 상태가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2407d-215">Examples include: network errors; low disk  errors; low memory conditions</span></span> |

## <a name="protection-and-recovery-lifecycle"></a><span data-ttu-id="2407d-216">보호 및 복구 수명 주기</span><span class="sxs-lookup"><span data-stu-id="2407d-216">Protection and recovery lifecycle</span></span>

![워크플로](./media/site-recovery-components/arch-hyperv-azure-workflow.png)

## <a name="next-steps"></a><span data-ttu-id="2407d-218">다음 단계</span><span class="sxs-lookup"><span data-stu-id="2407d-218">Next steps</span></span>

- [<span data-ttu-id="2407d-219">배포 필수 조건 확인</span><span class="sxs-lookup"><span data-stu-id="2407d-219">Check deployment prerequisites</span></span>](site-recovery-prereq.md)
- <span data-ttu-id="2407d-220">문제 해결:</span><span class="sxs-lookup"><span data-stu-id="2407d-220">Troubleshoot with:</span></span>
    - [<span data-ttu-id="2407d-221">보호 모니터링 및 문제 해결</span><span class="sxs-lookup"><span data-stu-id="2407d-221">Monitor and troubleshoot protection</span></span>](site-recovery-monitoring-and-troubleshooting.md)
    - [<span data-ttu-id="2407d-222">Microsoft 지원의 도움</span><span class="sxs-lookup"><span data-stu-id="2407d-222">Help from Microsoft support</span></span>](site-recovery-monitoring-and-troubleshooting.md#reach-out-for-microsoft-support)
    - [<span data-ttu-id="2407d-223">일반적인 문제 및 해결 방법</span><span class="sxs-lookup"><span data-stu-id="2407d-223">Common errors and resolutions</span></span>](site-recovery-monitoring-and-troubleshooting.md#common-azure-site-recovery-errors-and-their-resolutions)
