---
title: "파워 쿼리로 Hadoop에 Excel 연결 - Azure HDInsight | Microsoft Docs"
description: "비즈니스 인텔리전스 구성 요소를 사용하는 방법과 Excel용 파워 쿼리를 사용하여 HDInsight의 Hadoop에 저장된 데이터에 액세스하는 방법에 대해 알아봅니다."
services: hdinsight
documentationcenter: 
tags: azure-portal
author: mumian
manager: jhubbard
editor: cgronlun
ms.assetid: 01ad2f90-7520-44d9-8c16-4d936faaff9b
ms.service: hdinsight
ms.custom: hdinsightactive
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: jgao
ms.openlocfilehash: 6a15efb091b4faaa7305bb8faa362c62fac595cb
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/03/2017
---
# <a name="connect-excel-to-hadoop-by-using-power-query"></a><span data-ttu-id="cf149-103">파워 쿼리를 사용하여 Hadoop에 Excel 연결</span><span class="sxs-lookup"><span data-stu-id="cf149-103">Connect Excel to Hadoop by using Power Query</span></span>
<span data-ttu-id="cf149-104">Microsoft의 빅데이터 솔루션이 가진 주요 기능 중 하나는 Microsoft BI(비즈니스 인텔리전스) 구성 요소를 Azure HDInsight의 Hadoop 클러스터와 통합하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-104">One key feature of the Microsoft big-data solution is the integration of Microsoft business intelligence (BI) components with Hadoop clusters in Azure HDInsight.</span></span> <span data-ttu-id="cf149-105">주요 예제로 Microsoft Excel용 파워 쿼리 추가 기능을 사용하여 Hadoop 클러스터와 연결된 데이터가 포함된 Azure 저장소 계정에 Excel을 연결하는 기능이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-105">A primary example is the ability to connect Excel to the Azure Storage account that contains the data associated with your Hadoop cluster by using the Microsoft Power Query for Excel add-in.</span></span> <span data-ttu-id="cf149-106">이 자습서에서는 파워 쿼리를 설정하고 사용하여 HDInsight로 관리하는 Hadoop 클러스터와 연결된 데이터를 쿼리하는 방법을 단계별로 안내합니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-106">This article walks you through how to set up and use Power Query to query data associated with a Hadoop cluster managed with HDInsight.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="cf149-107">필수 조건</span><span class="sxs-lookup"><span data-stu-id="cf149-107">Prerequisites</span></span>
<span data-ttu-id="cf149-108">이 문서를 시작하기 전에 다음 항목이 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-108">Before you begin this article, you must have the following items:</span></span>

* <span data-ttu-id="cf149-109">**HDInsight 클러스터**.</span><span class="sxs-lookup"><span data-stu-id="cf149-109">**An HDInsight cluster**.</span></span> <span data-ttu-id="cf149-110">구성하려면 [Azure HDInsight 시작][hdinsight-get-started]을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="cf149-110">To configure one, see [Get started with Azure HDInsight][hdinsight-get-started].</span></span>
* <span data-ttu-id="cf149-111">**워크스테이션** .</span><span class="sxs-lookup"><span data-stu-id="cf149-111">**A workstation** that is running Windows 7, Windows Server 2008 R2, or a later operating system.</span></span>
* <span data-ttu-id="cf149-112">**Office 2016, Office 2013 Professional Plus, Office 365 ProPlus, Excel 2013 Standalone 또는 Office 2010 Professional Plus**.</span><span class="sxs-lookup"><span data-stu-id="cf149-112">**Office 2016, Office 2013 Professional Plus, Office 365 ProPlus, Excel 2013 Standalone, or Office 2010 Professional Plus**.</span></span>

## <a name="install-power-query"></a><span data-ttu-id="cf149-113">파워 쿼리 설치</span><span class="sxs-lookup"><span data-stu-id="cf149-113">Install Power Query</span></span>
<span data-ttu-id="cf149-114">파워 쿼리는 출력되었거나 HDInsight 클러스터에 대해 실행되는 Hadoop 작업에서 생성된 데이터를 가져올 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-114">Power Query can import data that has been output or that has been generated by a Hadoop job running on an HDInsight cluster.</span></span>

<span data-ttu-id="cf149-115">Excel 2016에서는 파워 쿼리가 데이터 리본의 가져오기 및 변환 섹션 아래에 통합되었습니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-115">In Excel 2016, Power Query has been integrated into the Data ribbon under the Get & Transform section.</span></span> <span data-ttu-id="cf149-116">이전 Excel 버전의 경우 [Microsoft 다운로드 센터][powerquery-download]에서 Microsoft Excel용 파워 쿼리를 다운로드하여 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-116">For older Excel versions, download Microsoft Power Query for Excel from the [Microsoft Download Center][powerquery-download] and install it.</span></span>

## <a name="import-hdinsight-data-into-excel"></a><span data-ttu-id="cf149-117">Excel로 HDInsight 데이터 가져오기</span><span class="sxs-lookup"><span data-stu-id="cf149-117">Import HDInsight data into Excel</span></span>
<span data-ttu-id="cf149-118">Excel용 파워 쿼리 추가 기능을 사용하면 HDInsight 클러스터에서 Excel로 쉽게 데이터를 가져올 수 있으며, 여기서 PowerPivot 및 파워 맵 같은 BI 도구를 사용하여 데이터를 검사하고 분석하며 표시할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-118">The Power Query add-in for Excel makes it easy to import data from your HDInsight cluster into Excel, where BI tools such as PowerPivot and Power Map can be used to inspect, analyze, and present the data.</span></span>

<span data-ttu-id="cf149-119">**HDInsight 클러스터에서 데이터 가져오기**</span><span class="sxs-lookup"><span data-stu-id="cf149-119">**To import data from an HDInsight cluster**</span></span>

1. <span data-ttu-id="cf149-120">Excel을 엽니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-120">Open Excel.</span></span>
2. <span data-ttu-id="cf149-121">비어 있는 새 통합 문서를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-121">Create a new blank workbook.</span></span>
3. <span data-ttu-id="cf149-122">Excel 버전에 따라 다음 단계를 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-122">Perform the following steps based on the Excel version:</span></span>

    - <span data-ttu-id="cf149-123">Excel 2016</span><span class="sxs-lookup"><span data-stu-id="cf149-123">Excel 2016</span></span>

        - <span data-ttu-id="cf149-124">**데이터** 메뉴를 클릭하고 **데이터 가져오기 및 변환** 리본에서 **데이터 가져오기**를 클릭한 후 **Azure에서**를 클릭하고 **Azure HDInsight(HDFS)에서**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-124">Click the **Data** menu, click **Get Data** from the **Get & Transform Data** ribbon, click **From Azure**, and then click **From Azure HDInsight(HDFS)**.</span></span>

        ![HDI.PowerQuery.SelectHdiSource](./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.excel2016.png)

    - <span data-ttu-id="cf149-126">Excel 2013/2010</span><span class="sxs-lookup"><span data-stu-id="cf149-126">Excel 2013/2010</span></span>

        - <span data-ttu-id="cf149-127">**파워 쿼리** 메뉴를 클릭하고 **Azure에서**를 클릭한 후 **Microsoft Azure HDInsight에서**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-127">Click the **Power Query** menu, click **From Azure**, and then click **From Microsoft Azure HDInsight**.</span></span>
   
        ![HDI.PowerQuery.SelectHdiSource][image-hdi-powerquery-hdi-source]
       
        <span data-ttu-id="cf149-129">**참고**: **파워 쿼리** 메뉴가 표시되지 않는 경우 **파일** > **옵션** > **추가 기능**으로 이동하여 페이지 아래쪽에 있는 드롭다운 **관리** 상자에서 **COM 추가 기능**을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-129">**Note:** If you don't see the **Power Query** menu, go to **File** > **Options** > **Add-Ins**, and select **COM Add-ins** from the drop-down **Manage** box at the bottom of the page.</span></span> <span data-ttu-id="cf149-130">**이동...** 단추를 선택하고 Excel용 파워 쿼리 추가 기능에 해당하는 상자가 선택되어 있는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-130">Select the **Go...** button and verify that the box for the Power Query for Excel add-in has been checked.</span></span>
       
        <span data-ttu-id="cf149-131">**참고**: 또한 파워 쿼리를 사용하면 **기타 원본에서**를 클릭하여 HDFS에서 데이터를 가져올 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-131">**Note:** Power Query also allows you to import data from HDFS by clicking **From Other Sources**.</span></span>
4. <span data-ttu-id="cf149-132">**계정 이름**으로 클러스터와 연결된 Azure Blob 저장소 계정을 입력한 다음 **확인**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-132">For **Account Name**, enter the name of the Azure Blob storage account associated with your cluster, and then click **OK**.</span></span> <span data-ttu-id="cf149-133">이 계정은 [기본 저장소 계정](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) 또는 연결된 저장소 계정이 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-133">This account can be the [default storage account](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) or a linked storage account.</span></span>  <span data-ttu-id="cf149-134">형식은 *https://&lt;StorageAccountName>.blob.core.windows.net/*입니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-134">The format is *https://&lt;StorageAccountName>.blob.core.windows.net/*.</span></span>
5. <span data-ttu-id="cf149-135">**계정 키**에 Blob 저장소 계정의 키를 입력한 다음 **저장**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-135">For **Account Key**, enter the key for the Blob storage account, and then click **Save**.</span></span> <span data-ttu-id="cf149-136">(이 저장소에 처음 액세스할 때만 계정 정보를 입력하면 됩니다.)</span><span class="sxs-lookup"><span data-stu-id="cf149-136">(You need to enter the account information only the first time you access this store.)</span></span>
6. <span data-ttu-id="cf149-137">쿼리 편집기 왼쪽에 있는 **탐색기** 창에서 Blob 저장소 컨테이너 이름을 두 번 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-137">In the **Navigator** pane on the left of the Query Editor, double-click the Blob storage container name.</span></span> <span data-ttu-id="cf149-138">기본적으로 컨테이너 이름은 클러스터 이름과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-138">By default, the container name is the same name as the cluster name.</span></span>
7. <span data-ttu-id="cf149-139">**Name** 열에서 **HiveSampleData.txt**(폴더 경로 **../hive/warehouse/hivesampletable/**)를 찾은 후 HiveSampleData.txt 왼쪽에 있는 **Binary**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-139">Locate **HiveSampleData.txt** in the **Name** column (the folder path is **../hive/warehouse/hivesampletable/**), and then click **Binary** on the left of HiveSampleData.txt.</span></span> <span data-ttu-id="cf149-140">HiveSampleData.txt는 모든 클러스터와 함께 제공됩니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-140">HiveSampleData.txt comes with all the cluster.</span></span> <span data-ttu-id="cf149-141">필요에 따라 사용자의 파일을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-141">Optionally, you can use your own file.</span></span>
   
    ![HDI.PowerQuery.ImportData][image-hdi-powerquery-importdata]
8. <span data-ttu-id="cf149-143">원하는 경우 열 이름을 바꿀 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-143">If you want, you can rename the column names.</span></span> <span data-ttu-id="cf149-144">준비가 되면 **닫은 후 로드**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-144">When you are ready, click **Close & Load**.</span></span>  <span data-ttu-id="cf149-145">통합 문서에 데이터가 로드됩니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-145">The data has been loaded to your workbook:</span></span>
   
    ![HDI.PowerQuery.ImportedTable][image-hdi-powerquery-imported-table]

## <a name="next-steps"></a><span data-ttu-id="cf149-147">다음 단계</span><span class="sxs-lookup"><span data-stu-id="cf149-147">Next steps</span></span>
<span data-ttu-id="cf149-148">이 문서에서는 파워 쿼리를 사용하여 HDInsight에서 Excel로 데이터를 가져오는 방법을 알아보았습니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-148">In this article, you learned how to use Power Query to retrieve data from HDInsight into Excel.</span></span> <span data-ttu-id="cf149-149">마찬가지로 HDInsight에서 Azure SQL 데이터베이스로 데이터를 가져올 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-149">Similarly, you can retrieve data from HDInsight into Azure SQL Database.</span></span> <span data-ttu-id="cf149-150">데이터를 HDInsight에 업로드할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="cf149-150">It is also possible to upload data into HDInsight.</span></span> <span data-ttu-id="cf149-151">자세한 내용은 다음 문서를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="cf149-151">To learn more, see the following articles:</span></span>

* <span data-ttu-id="cf149-152">[Microsoft Hive ODBC 드라이버로 HDInsight에 Excel 연결][hdinsight-ODBC]</span><span class="sxs-lookup"><span data-stu-id="cf149-152">[Connect Excel to HDInsight with the Microsoft Hive ODBC Driver][hdinsight-ODBC]</span></span>
* <span data-ttu-id="cf149-153">[HDInsight에 데이터 업로드][hdinsight-upload-data]</span><span class="sxs-lookup"><span data-stu-id="cf149-153">[Upload Data to HDInsight][hdinsight-upload-data]</span></span>

[hdinsight-ODBC]: hdinsight-connect-excel-hive-odbc-driver.md
[hdinsight-get-started]: hdinsight-hadoop-linux-tutorial-get-started.md
[hdinsight-upload-data]: hdinsight-upload-data.md

[image-hdi-powerquery-hdi-source]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.png
[image-hdi-powerquery-importdata]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importdata.png
[image-hdi-powerquery-imported-table]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importedtable.PNG

[powerquery-download]: http://go.microsoft.com/fwlink/?LinkID=286689
