---
title: "Azure App Service Environment에 대한 네트워킹 고려 사항"
description: "ASE 네트워크 트래픽 및 ASE를 사용하여 NSG 및 UDR을 설정하는 방법을 설명합니다."
services: app-service
documentationcenter: na
author: ccompy
manager: stefsch
ms.assetid: 955a4d84-94ca-418d-aa79-b57a5eb8cb85
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/08/2017
ms.author: ccompy
ms.openlocfilehash: 3be0d7a202ff53f5532fd7169a50a04cfaf88832
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/29/2017
---
# <a name="networking-considerations-for-an-app-service-environment"></a><span data-ttu-id="85a93-103">App Service Environment에 대한 네트워킹 고려 사항</span><span class="sxs-lookup"><span data-stu-id="85a93-103">Networking considerations for an App Service environment</span></span> #

## <a name="overview"></a><span data-ttu-id="85a93-104">개요</span><span class="sxs-lookup"><span data-stu-id="85a93-104">Overview</span></span> ##

 <span data-ttu-id="85a93-105">Azure [App Service Environment][Intro]는 Azure App Service를 Azure VNet(Virtual Network) 내 서브넷에 배포한 것입니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-105">Azure [App Service Environment][Intro] is a deployment of Azure App Service into a subnet in your Azure virtual network (VNet).</span></span> <span data-ttu-id="85a93-106">ASE(App Service Environment)에는 두 가지 배포 유형이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-106">There are two deployment types for an App Service environment (ASE):</span></span>

- <span data-ttu-id="85a93-107">**외부 ASE** - ASE에서 호스트되는 앱을 인터넷 액세스가 가능한 IP 주소에 표시합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-107">**External ASE**: Exposes the ASE-hosted apps on an internet-accessible IP address.</span></span> <span data-ttu-id="85a93-108">자세한 내용은 [외부 ASE 만들기][MakeExternalASE]를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="85a93-108">For more information, see [Create an External ASE][MakeExternalASE].</span></span>
- <span data-ttu-id="85a93-109">**ILB ASE** - ASE에서 호스트되는 앱을 VNet 내부의 IP 주소에 표시합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-109">**ILB ASE**: Exposes the ASE-hosted apps on an IP address inside your VNet.</span></span> <span data-ttu-id="85a93-110">내부 끝점은 ILB(내부 부하 분산 장치)이므로 ILB ASE라고 합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-110">The internal endpoint is an internal load balancer (ILB), which is why it's called an ILB ASE.</span></span> <span data-ttu-id="85a93-111">자세한 내용은 [ILB ASE 만들기 및 사용][MakeILBASE]을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="85a93-111">For more information, see [Create and use an ILB ASE][MakeILBASE].</span></span>

<span data-ttu-id="85a93-112">현재 App Service Environment에는 두 가지 버전(ASEv1 및 ASEv2)이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-112">There are now two versions of App Service Environment: ASEv1 and ASEv2.</span></span> <span data-ttu-id="85a93-113">ASEv1에 대한 자세한 내용은 [App Service Environment v1 소개][ASEv1Intro]를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="85a93-113">For information on ASEv1, see [Introduction to App Service Environment v1][ASEv1Intro].</span></span> <span data-ttu-id="85a93-114">ASEv1은 클래식 또는 Resource Manager VNet에서 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-114">ASEv1 can be deployed in a classic or Resource Manager VNet.</span></span> <span data-ttu-id="85a93-115">ASEv2는 Resource Manager VNet에만 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-115">ASEv2 can only be deployed into a Resource Manager VNet.</span></span>

<span data-ttu-id="85a93-116">인터넷으로 이동하는 ASE의 모든 호출은 VNet을 출발하여 ASE에 할당된 VIP로 갑니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-116">All calls from an ASE that go to the internet leave the VNet through a VIP assigned for the ASE.</span></span> <span data-ttu-id="85a93-117">이 VIP의 공용 IP는 인터넷으로 이동하는 ASE의 모든 호출에 대한 원본 IP입니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-117">The public IP of this VIP is then the source IP for all calls from the ASE that go to the internet.</span></span> <span data-ttu-id="85a93-118">사용자의 ASE에 있는 앱이 VNet 또는 VPN의 리소스를 호출하는 경우 원본 IP는 ASE에서 사용되는 서브넷의 IP 중 하나가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-118">If the apps in your ASE make calls to resources in your VNet or across a VPN, the source IP is one of the IPs in the subnet used by your ASE.</span></span> <span data-ttu-id="85a93-119">ASE가 VNet 내에 있으므로 추가 구성 없이 VNet 내 리소스에 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-119">Because the ASE is within the VNet, it can also access resources within the VNet without any additional configuration.</span></span> <span data-ttu-id="85a93-120">VNet이 온-프레미스 네트워크에 연결되어 있으면 ASE의 앱도 해당 네트워크의 리소스에 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-120">If the VNet is connected to your on-premises network, apps in your ASE also have access to resources there.</span></span> <span data-ttu-id="85a93-121">즉, ASE나 앱을 추가로 구성할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-121">You don't need to configure the ASE or your app any further.</span></span>

![외부 ASE][1] 

<span data-ttu-id="85a93-123">외부 ASE가 있는 경우에는 공용 VIP가 다음 항목용으로 ASE 앱을 확인하는 끝점으로도 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-123">If you have an External ASE, the public VIP is also the endpoint that your ASE apps resolve to for:</span></span>

* <span data-ttu-id="85a93-124">HTTP/S</span><span class="sxs-lookup"><span data-stu-id="85a93-124">HTTP/S.</span></span> 
* <span data-ttu-id="85a93-125">FTP/S</span><span class="sxs-lookup"><span data-stu-id="85a93-125">FTP/S.</span></span> 
* <span data-ttu-id="85a93-126">웹 배포</span><span class="sxs-lookup"><span data-stu-id="85a93-126">Web deployment.</span></span>
* <span data-ttu-id="85a93-127">원격 디버깅</span><span class="sxs-lookup"><span data-stu-id="85a93-127">Remote debugging.</span></span>

![ILB ASE][2]

<span data-ttu-id="85a93-129">ILB ASE가 있는 경우에는 ILB의 IP 주소가 HTTP/S, FTP/S, 웹 배포 및 원격 디버깅용 끝점입니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-129">If you have an ILB ASE, the IP address of the ILB is the endpoint for HTTP/S, FTP/S, web deployment, and remote debugging.</span></span>

<span data-ttu-id="85a93-130">기본 앱 액세스 포트는 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-130">The normal app access ports are:</span></span>

| <span data-ttu-id="85a93-131">사용</span><span class="sxs-lookup"><span data-stu-id="85a93-131">Use</span></span> | <span data-ttu-id="85a93-132">원본</span><span class="sxs-lookup"><span data-stu-id="85a93-132">From</span></span> | <span data-ttu-id="85a93-133">받는 사람</span><span class="sxs-lookup"><span data-stu-id="85a93-133">To</span></span> |
|----------|---------|-------------|
|  <span data-ttu-id="85a93-134">HTTP/HTTPS</span><span class="sxs-lookup"><span data-stu-id="85a93-134">HTTP/HTTPS</span></span>  | <span data-ttu-id="85a93-135">사용자 구성 가능</span><span class="sxs-lookup"><span data-stu-id="85a93-135">User configurable</span></span> |  <span data-ttu-id="85a93-136">80, 443</span><span class="sxs-lookup"><span data-stu-id="85a93-136">80, 443</span></span> |
|  <span data-ttu-id="85a93-137">FTP/FTPS</span><span class="sxs-lookup"><span data-stu-id="85a93-137">FTP/FTPS</span></span>    | <span data-ttu-id="85a93-138">사용자 구성 가능</span><span class="sxs-lookup"><span data-stu-id="85a93-138">User configurable</span></span> |  <span data-ttu-id="85a93-139">21, 990, 10001-10020</span><span class="sxs-lookup"><span data-stu-id="85a93-139">21, 990, 10001-10020</span></span> |
|  <span data-ttu-id="85a93-140">Visual Studio 원격 디버깅</span><span class="sxs-lookup"><span data-stu-id="85a93-140">Visual Studio remote debugging</span></span>  |  <span data-ttu-id="85a93-141">사용자 구성 가능</span><span class="sxs-lookup"><span data-stu-id="85a93-141">User configurable</span></span> |  <span data-ttu-id="85a93-142">4016, 4018, 4020, 4022</span><span class="sxs-lookup"><span data-stu-id="85a93-142">4016, 4018, 4020, 4022</span></span> |

<span data-ttu-id="85a93-143">외부 ASE를 사용하든, ILB ASE를 사용하든 위 표에 나와 있는 포트가 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-143">This is true if you're on an External ASE or on an ILB ASE.</span></span> <span data-ttu-id="85a93-144">외부 ASE를 사용하는 경우 공용 VIP에서 해당 포트에 액세스합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-144">If you're on an External ASE, you hit those ports on the public VIP.</span></span> <span data-ttu-id="85a93-145">ILB ASE를 사용하는 경우에는 ILB에서 해당 포트에 액세스합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-145">If you're on an ILB ASE, you hit those ports on the ILB.</span></span> <span data-ttu-id="85a93-146">포트 443을 잠그면 포털에 표시되는 일부 기능이 영향을 받을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-146">If you lock down port 443, there can be an effect on some features exposed in the portal.</span></span> <span data-ttu-id="85a93-147">자세한 내용은 [포털 종속성](#portaldep)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="85a93-147">For more information, see [Portal dependencies](#portaldep).</span></span>

## <a name="ase-dependencies"></a><span data-ttu-id="85a93-148">ASE 종속성</span><span class="sxs-lookup"><span data-stu-id="85a93-148">ASE dependencies</span></span> ##

<span data-ttu-id="85a93-149">ASE 인바운드 액세스 종속성은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-149">An ASE inbound access dependency is:</span></span>

| <span data-ttu-id="85a93-150">사용</span><span class="sxs-lookup"><span data-stu-id="85a93-150">Use</span></span> | <span data-ttu-id="85a93-151">원본</span><span class="sxs-lookup"><span data-stu-id="85a93-151">From</span></span> | <span data-ttu-id="85a93-152">받는 사람</span><span class="sxs-lookup"><span data-stu-id="85a93-152">To</span></span> |
|-----|------|----|
| <span data-ttu-id="85a93-153">관리</span><span class="sxs-lookup"><span data-stu-id="85a93-153">Management</span></span> | <span data-ttu-id="85a93-154">App Service 관리 주소</span><span class="sxs-lookup"><span data-stu-id="85a93-154">App Service management addresses</span></span> | <span data-ttu-id="85a93-155">ASE 서브넷: 454, 455</span><span class="sxs-lookup"><span data-stu-id="85a93-155">ASE subnet: 454, 455</span></span> |
|  <span data-ttu-id="85a93-156">ASE 내부 통신</span><span class="sxs-lookup"><span data-stu-id="85a93-156">ASE internal communication</span></span> | <span data-ttu-id="85a93-157">ASE 서브넷: 모든 포트</span><span class="sxs-lookup"><span data-stu-id="85a93-157">ASE subnet: All ports</span></span> | <span data-ttu-id="85a93-158">ASE 서브넷: 모든 포트</span><span class="sxs-lookup"><span data-stu-id="85a93-158">ASE subnet: All ports</span></span>
|  <span data-ttu-id="85a93-159">Azure Load Balancer 인바운드 허용</span><span class="sxs-lookup"><span data-stu-id="85a93-159">Allow Azure load balancer inbound</span></span> | <span data-ttu-id="85a93-160">Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="85a93-160">Azure load balancer</span></span> | <span data-ttu-id="85a93-161">ASE 서브넷: 모든 포트</span><span class="sxs-lookup"><span data-stu-id="85a93-161">ASE subnet: All ports</span></span>
|  <span data-ttu-id="85a93-162">IP 주소가 할당된 앱</span><span class="sxs-lookup"><span data-stu-id="85a93-162">App assigned IP addresses</span></span> | <span data-ttu-id="85a93-163">주소가 할당된 앱</span><span class="sxs-lookup"><span data-stu-id="85a93-163">App assigned addresses</span></span> | <span data-ttu-id="85a93-164">ASE 서브넷: 모든 포트</span><span class="sxs-lookup"><span data-stu-id="85a93-164">ASE subnet: All ports</span></span>

<span data-ttu-id="85a93-165">인바운드 트래픽은 시스템 모니터링 외에도 ASE의 명령 및 제어를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-165">The inbound traffic provides command and control of the ASE in addition to system monitoring.</span></span> <span data-ttu-id="85a93-166">이 트래픽이 [ASE 관리 주소][ASEManagement] 문서에 나열되는 원본 IP.</span><span class="sxs-lookup"><span data-stu-id="85a93-166">The source IPs for this traffic are listed in the [ASE Management addresses][ASEManagement] document.</span></span> <span data-ttu-id="85a93-167">즉, 네트워크 보안 구성이 포트 454 및 455에서 모든 IP로부터의 액세스를 허용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-167">The network security configuration needs to allow access from all IPs on ports 454 and 455.</span></span>

<span data-ttu-id="85a93-168">ASE 서브넷 내에는 내부 구성 요소 통신에 사용된 많은 포트가 있으며 변경할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-168">Within the ASE subnet there are many ports used for internal component communication and they can change.</span></span>  <span data-ttu-id="85a93-169">이를 위해서는 ASE 서브넷에 있는 모든 포트를 ASE 서브넷에서 액세스할 수 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-169">This requires all of the ports in the ASE subnet to be accessible from the ASE subnet.</span></span> 

<span data-ttu-id="85a93-170">Azure Load Balancer 및 ASE 서브넷 간의 통신을 위해서는 최소 포트 454, 455 및 16001이 열려 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-170">For the communication between the Azure load balancer and the ASE subnet the minimum ports that need to be open are 454, 455 and 16001.</span></span> <span data-ttu-id="85a93-171">16001 포트는 부하 분산 장치 및 ASE 사이에 활성 트래픽을 유지하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-171">The 16001 port is used for keep alive traffic between the load balancer and the ASE.</span></span> <span data-ttu-id="85a93-172">ILB ASE를 사용하는 경우 454, 455, 16001 포트로만 트래픽을 잠글 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-172">If you are using an ILB ASE then you can lock traffic down to just the 454, 455, 16001 ports.</span></span>  <span data-ttu-id="85a93-173">외부 ASE를 사용하는 경우 정상적인 앱 액세스 포트를 고려해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-173">If you are using an External ASE then you need to take into account the normal app access ports.</span></span>  <span data-ttu-id="85a93-174">주소가 할당된 앱을 사용하는 경우 모든 포트에 대해 열려 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-174">If you are using app assigned addresses you need to open it to all ports.</span></span>  <span data-ttu-id="85a93-175">특정 앱에 주소를 할당하면 부하 분산 장치는 HTTP 및 HTTPS 트래픽을 ASE로 보내기 전에 알려지지 않은 포트를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-175">When an address is assigned to a specific app, then the load balancer will use ports that are not known of in advance to send HTTP and HTTPS traffic to the ASE.</span></span>

<span data-ttu-id="85a93-176">IP 주소가 할당된 앱을 사용하는 경우 앱에 할당된 IP에서 ASE 서브넷으로 트래픽을 허용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-176">If you are using app assigned IP addresses you need to allow traffic from the IPs assigned to your apps to the ASE subnet.</span></span>

<span data-ttu-id="85a93-177">아웃 바운드 액세스의 경우 ASE는 여러 외부 시스템에 종속됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-177">For outbound access, an ASE depends on multiple external systems.</span></span> <span data-ttu-id="85a93-178">그러한 시스템 종속성은 DNS 이름으로 정의되며 고정된 IP 주소 집합에 매핑되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-178">Those system dependencies are defined with DNS names and don't map to a fixed set of IP addresses.</span></span> <span data-ttu-id="85a93-179">따라서 ASE는 여러 포트를 통해 ASE 서브넷에서 모든 외부 IP에 아웃바운드로 액세스할 수 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-179">Thus, the ASE requires outbound access from the ASE subnet to all external IPs across a variety of ports.</span></span> <span data-ttu-id="85a93-180">ASE는 다음과 같은 아웃바운드 종속성을 가집니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-180">An ASE has the following outbound dependencies:</span></span>

| <span data-ttu-id="85a93-181">사용</span><span class="sxs-lookup"><span data-stu-id="85a93-181">Use</span></span> | <span data-ttu-id="85a93-182">원본</span><span class="sxs-lookup"><span data-stu-id="85a93-182">From</span></span> | <span data-ttu-id="85a93-183">받는 사람</span><span class="sxs-lookup"><span data-stu-id="85a93-183">To</span></span> |
|-----|------|----|
| <span data-ttu-id="85a93-184">Azure 저장소</span><span class="sxs-lookup"><span data-stu-id="85a93-184">Azure Storage</span></span> | <span data-ttu-id="85a93-185">ASE 서브넷</span><span class="sxs-lookup"><span data-stu-id="85a93-185">ASE subnet</span></span> | <span data-ttu-id="85a93-186">table.core.windows.net, blob.core.windows.net, queue.core.windows.net, file.core.windows.net: 80, 443, 445(445는 ASEv1의 경우에만 필요함)</span><span class="sxs-lookup"><span data-stu-id="85a93-186">table.core.windows.net, blob.core.windows.net, queue.core.windows.net, file.core.windows.net: 80, 443, 445 (445 is only needed for ASEv1.)</span></span> |
| <span data-ttu-id="85a93-187">Azure SQL 데이터베이스</span><span class="sxs-lookup"><span data-stu-id="85a93-187">Azure SQL Database</span></span> | <span data-ttu-id="85a93-188">ASE 서브넷</span><span class="sxs-lookup"><span data-stu-id="85a93-188">ASE subnet</span></span> | <span data-ttu-id="85a93-189">database.windows.net: 1433, 11000-11999, 14000-14999(자세한 내용은 [SQL Database V12 포트 사용](../../sql-database/sql-database-develop-direct-route-ports-adonet-v12.md) 참조)</span><span class="sxs-lookup"><span data-stu-id="85a93-189">database.windows.net: 1433, 11000-11999, 14000-14999 (For more information, see [SQL Database V12 port usage](../../sql-database/sql-database-develop-direct-route-ports-adonet-v12.md).)</span></span>|
| <span data-ttu-id="85a93-190">Azure 관리</span><span class="sxs-lookup"><span data-stu-id="85a93-190">Azure management</span></span> | <span data-ttu-id="85a93-191">ASE 서브넷</span><span class="sxs-lookup"><span data-stu-id="85a93-191">ASE subnet</span></span> | <span data-ttu-id="85a93-192">management.core.windows.net, management.azure.com: 443</span><span class="sxs-lookup"><span data-stu-id="85a93-192">management.core.windows.net, management.azure.com: 443</span></span> 
| <span data-ttu-id="85a93-193">SSL 인증서 확인</span><span class="sxs-lookup"><span data-stu-id="85a93-193">SSL certificate verification</span></span> |  <span data-ttu-id="85a93-194">ASE 서브넷</span><span class="sxs-lookup"><span data-stu-id="85a93-194">ASE subnet</span></span>            |  <span data-ttu-id="85a93-195">ocsp.msocsp.com, mscrl.microsoft.com, crl.microsoft.com: 443</span><span class="sxs-lookup"><span data-stu-id="85a93-195">ocsp.msocsp.com, mscrl.microsoft.com, crl.microsoft.com: 443</span></span>
| <span data-ttu-id="85a93-196">Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="85a93-196">Azure Active Directory</span></span>        | <span data-ttu-id="85a93-197">ASE 서브넷</span><span class="sxs-lookup"><span data-stu-id="85a93-197">ASE subnet</span></span>            |  <span data-ttu-id="85a93-198">인터넷: 443</span><span class="sxs-lookup"><span data-stu-id="85a93-198">Internet: 443</span></span>
| <span data-ttu-id="85a93-199">App Service 관리</span><span class="sxs-lookup"><span data-stu-id="85a93-199">App Service management</span></span>        | <span data-ttu-id="85a93-200">ASE 서브넷</span><span class="sxs-lookup"><span data-stu-id="85a93-200">ASE subnet</span></span>            |  <span data-ttu-id="85a93-201">인터넷: 443</span><span class="sxs-lookup"><span data-stu-id="85a93-201">Internet: 443</span></span>
| <span data-ttu-id="85a93-202">Azure DNS</span><span class="sxs-lookup"><span data-stu-id="85a93-202">Azure DNS</span></span>                     | <span data-ttu-id="85a93-203">ASE 서브넷</span><span class="sxs-lookup"><span data-stu-id="85a93-203">ASE subnet</span></span>            |  <span data-ttu-id="85a93-204">인터넷: 53</span><span class="sxs-lookup"><span data-stu-id="85a93-204">Internet: 53</span></span>
| <span data-ttu-id="85a93-205">ASE 내부 통신</span><span class="sxs-lookup"><span data-stu-id="85a93-205">ASE internal communication</span></span>    | <span data-ttu-id="85a93-206">ASE 서브넷: 모든 포트</span><span class="sxs-lookup"><span data-stu-id="85a93-206">ASE subnet: All ports</span></span> |  <span data-ttu-id="85a93-207">ASE 서브넷: 모든 포트</span><span class="sxs-lookup"><span data-stu-id="85a93-207">ASE subnet: All ports</span></span>

<span data-ttu-id="85a93-208">ASE가 이러한 종속성에 액세스하지 못하는 경우 작동이 중지됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-208">If the ASE loses access to these dependencies, it stops working.</span></span> <span data-ttu-id="85a93-209">이러한 작동 중지 상태가 오랜 기간 지속되면 ASE가 일시 중단됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-209">When that happens long enough, the ASE is suspended.</span></span>

### <a name="customer-dns"></a><span data-ttu-id="85a93-210">고객 DNS</span><span class="sxs-lookup"><span data-stu-id="85a93-210">Customer DNS</span></span> ###

<span data-ttu-id="85a93-211">VNet이 고객 정의 DNS 서버로 구성된 경우 테넌트 워크로드가 해당 서버를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-211">If the VNet is configured with a customer-defined DNS server, the tenant workloads use it.</span></span> <span data-ttu-id="85a93-212">ASE는 여전히 관리 목적을 위해 Azure DNS와 통신해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-212">The ASE still needs to communicate with Azure DNS for management purposes.</span></span> 

<span data-ttu-id="85a93-213">VNet이 VPN 반대쪽의 고객 DNS로 구성된 경우 ASE가 포함된 서브넷에서 DNS 서버에 연결할 수 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-213">If the VNet is configured with a customer DNS on the other side of a VPN, the DNS server must be reachable from the subnet that contains the ASE.</span></span>

<a name="portaldep"></a>

## <a name="portal-dependencies"></a><span data-ttu-id="85a93-214">포털 종속성</span><span class="sxs-lookup"><span data-stu-id="85a93-214">Portal dependencies</span></span> ##

<span data-ttu-id="85a93-215">ASE의 기능적 종속성 외에 포털 환경과 관련된 몇 가지 추가 항목이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-215">In addition to the ASE functional dependencies, there are a few extra items related to the portal experience.</span></span> <span data-ttu-id="85a93-216">Azure Portal의 기능 중 일부는 _SCM 사이트_에 대한 직접 액세스에 의존합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-216">Some of the capabilities in the Azure portal depend on direct access to _SCM site_.</span></span> <span data-ttu-id="85a93-217">Azure App Service의 모든 앱에는 URL이 두 개 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-217">For every app in Azure App Service, there are two URLs.</span></span> <span data-ttu-id="85a93-218">첫 번째 URL은 앱에 액세스하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-218">The first URL is to access your app.</span></span> <span data-ttu-id="85a93-219">두 번째 URL은 _Kudu 콘솔_이라고도 하는 SCM 사이트에 액세스하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-219">The second URL is to access the SCM site, which is also called the _Kudu console_.</span></span> <span data-ttu-id="85a93-220">SCM 사이트를 사용하는 기능은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-220">Features that use the SCM site include:</span></span>

-   <span data-ttu-id="85a93-221">웹 작업</span><span class="sxs-lookup"><span data-stu-id="85a93-221">Web jobs</span></span>
-   <span data-ttu-id="85a93-222">함수</span><span class="sxs-lookup"><span data-stu-id="85a93-222">Functions</span></span>
-   <span data-ttu-id="85a93-223">스트리밍 로그</span><span class="sxs-lookup"><span data-stu-id="85a93-223">Log streaming</span></span>
-   <span data-ttu-id="85a93-224">Kudu</span><span class="sxs-lookup"><span data-stu-id="85a93-224">Kudu</span></span>
-   <span data-ttu-id="85a93-225">확장</span><span class="sxs-lookup"><span data-stu-id="85a93-225">Extensions</span></span>
-   <span data-ttu-id="85a93-226">Process Explorer</span><span class="sxs-lookup"><span data-stu-id="85a93-226">Process Explorer</span></span>
-   <span data-ttu-id="85a93-227">콘솔</span><span class="sxs-lookup"><span data-stu-id="85a93-227">Console</span></span>

<span data-ttu-id="85a93-228">ILB ASE를 사용할 때는 VNet 외부에서 인터넷을 통해 SCM 사이트에 액세스할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-228">When you use an ILB ASE, the SCM site isn't internet accessible from outside the VNet.</span></span> <span data-ttu-id="85a93-229">ILB ASE에서 앱이 호스트되는 경우 포털에서 일부 기능이 작동하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-229">When your app is hosted on an ILB ASE, some capabilities will not work from the portal.</span></span>  

<span data-ttu-id="85a93-230">SCM 사이트에 종속된 이러한 기능 중 많은 부분은 Kudu 콘솔에서 직접 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-230">Many of those capabilities that depend upon the SCM site are also available directly in the Kudu console.</span></span> <span data-ttu-id="85a93-231">Portal을 사용하는 대신 콘솔에 직접 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-231">You can connect to it directly rather than by using the portal.</span></span> <span data-ttu-id="85a93-232">앱이 ILB ASE에서 호스트되는 경우에는 게시 자격 증명을 사용하여 로그인합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-232">If your app is hosted in an ILB ASE, use your publishing credentials to sign in.</span></span> <span data-ttu-id="85a93-233">ILB ASE에 호스팅된 앱의 SCM 사이트에 액세스하는 URL은 다음 형식으로 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-233">The URL to access the SCM site of an app hosted in an ILB ASE has the following format:</span></span> 

```
<appname>.scm.<domain name the ILB ASE was created with> 
```

<span data-ttu-id="85a93-234">ILB ASE 도메인 이름이 *contoso.net*이고 앱 이름이 *testapp*이면 *testapp.contoso.net*에서 앱에 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-234">If your ILB ASE is the domain name *contoso.net* and your app name is *testapp*, the app is reached at *testapp.contoso.net*.</span></span> <span data-ttu-id="85a93-235">그리고 앱과 함께 제공되는 SCM 사이트는 *testapp.scm.contoso.net*에서 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-235">The SCM site that goes with it is reached at *testapp.scm.contoso.net*.</span></span>

### <a name="functions-and-web-jobs"></a><span data-ttu-id="85a93-236">함수 및 웹 작업</span><span class="sxs-lookup"><span data-stu-id="85a93-236">Functions and Web jobs</span></span> ###

<span data-ttu-id="85a93-237">함수 및 웹 작업은 SCM 사이트에 따라 다르지만, 브라우저가 SCM 사이트에 연결될 수 있는 한, 앱이 ILB ASE에 있더라도 포털에서 사용할 수 있도록 지원됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-237">Both Functions and Web jobs depend on the SCM site but are supported for use in the portal, even if your apps are in an ILB ASE, so long as your browser can reach the SCM site.</span></span>  <span data-ttu-id="85a93-238">ILB ASE에 자체 서명된 인증서를 사용하는 경우 브라우저에서 해당 인증서를 신뢰하도록 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-238">If you are using a self-signed certificate with your ILB ASE, you will need to enable your browser to trust that certificate.</span></span>  <span data-ttu-id="85a93-239">IE와 Edge의 경우 인증서가 컴퓨터의 신뢰 저장소에 있어야 함을 의미합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-239">For IE and Edge that means the certificate has to be in the computer trust store.</span></span>  <span data-ttu-id="85a93-240">크롬을 사용하는 경우 브라우저에서 scm 사이트를 이미 직접 방문하여 이전에 인증서를 수락했음을 의미합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-240">If you are using Chrome then that means you accepted the certificate in the browser earlier by presumably hitting the scm site directly.</span></span>  <span data-ttu-id="85a93-241">가장 좋은 방법은 브라우저의 신뢰 체인에 있는 상용 인증서를 사용하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-241">The best solution is to use a commercial certificate that is in the browser chain of trust.</span></span>  

## <a name="ase-ip-addresses"></a><span data-ttu-id="85a93-242">ASE IP 주소</span><span class="sxs-lookup"><span data-stu-id="85a93-242">ASE IP addresses</span></span> ##

<span data-ttu-id="85a93-243">ASE에는 알고 있어야 할 몇 가지 IP 주소가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-243">An ASE has a few IP addresses to be aware of.</span></span> <span data-ttu-id="85a93-244">아래에 이 계정과 키의 예제가 나와 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-244">They are:</span></span>

- <span data-ttu-id="85a93-245">**공용 인바운드 IP 주소**: 외부 ASE의 앱 트래픽 및 외부 ASE와 ILB ASE 둘 다의 관리 트래픽에 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-245">**Public inbound IP address**: Used for app traffic in an External ASE, and management traffic in both an External ASE and an ILB ASE.</span></span>
- <span data-ttu-id="85a93-246">**아웃바운드 공용 IP**: VNet에서 시작되는 ASE로부터의 아웃바운드 연결(VPN으로 라우팅되지 않음)의 "시작" IP로 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-246">**Outbound public IP**: Used as the "from" IP for outbound connections from the ASE that leave the VNet, which aren't routed down a VPN.</span></span>
- <span data-ttu-id="85a93-247">**ILB IP 주소**: ILB ASE를 사용하는 경우 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-247">**ILB IP address**: If you use an ILB ASE.</span></span>
- <span data-ttu-id="85a93-248">**앱에 할당된 IP 기반 SSL 주소**: 외부 ASE를 사용하며 IP 기반 SSL이 구성되어 있을 때만 사용 가능합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-248">**App-assigned IP-based SSL addresses**: Only possible with an External ASE and when IP-based SSL is configured.</span></span>

<span data-ttu-id="85a93-249">이러한 모든 IP 주소는 ASE UI에서 Azure Portal의 ASEv2에 쉽게 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-249">All these IP addresses are easily visible in an ASEv2 in the Azure portal from the ASE UI.</span></span> <span data-ttu-id="85a93-250">ILB ASE를 사용하는 경우 ILB용 IP가 나열됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-250">If you have an ILB ASE, the IP for the ILB is listed.</span></span>

![IP 주소][3]

### <a name="app-assigned-ip-addresses"></a><span data-ttu-id="85a93-252">앱에 할당된 IP 주소</span><span class="sxs-lookup"><span data-stu-id="85a93-252">App-assigned IP addresses</span></span> ###

<span data-ttu-id="85a93-253">외부 ASE를 사용하면 IP 주소를 개별 앱에 할당할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-253">With an External ASE, you can assign IP addresses to individual apps.</span></span> <span data-ttu-id="85a93-254">ILB ASE에서는 IP 주소를 할당할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-254">You can't do that with an ILB ASE.</span></span> <span data-ttu-id="85a93-255">앱용으로 고유한 IP 주소를 구성하는 방법에 대한 자세한 내용은 [Azure Web Apps에 기존 사용자 지정 SSL 인증서 바인딩](../../app-service-web/app-service-web-tutorial-custom-ssl.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="85a93-255">For more information on how to configure your app to have its own IP address, see [Bind an existing custom SSL certificate to Azure web apps](../../app-service-web/app-service-web-tutorial-custom-ssl.md).</span></span>

<span data-ttu-id="85a93-256">앱에 고유한 IP 기반 SSL 주소가 있는 경우 ASE는 해당 IP 주소에 매핑하도록 두 개의 포트를 예약합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-256">When an app has its own IP-based SSL address, the ASE reserves two ports to map to that IP address.</span></span> <span data-ttu-id="85a93-257">한 포트는 HTTP 트래픽용이고, 다른 포트는 HTTPS용입니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-257">One port is for HTTP traffic, and the other port is for HTTPS.</span></span> <span data-ttu-id="85a93-258">이러한 포트는 IP 주소 섹션의 ASE UI에 나열됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-258">Those ports are listed in the ASE UI in the IP addresses section.</span></span> <span data-ttu-id="85a93-259">트래픽은 VIP에서 해당 포트에 연결할 수 있어야 합니다. 그렇지 않으면 앱에 액세스할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-259">Traffic must be able to reach those ports from the VIP or the apps are inaccessible.</span></span> <span data-ttu-id="85a93-260">NSG(네트워크 보안 그룹)를 구성할 때는 이 요구 사항을 고려해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-260">This requirement is important to remember when you configure Network Security Groups (NSGs).</span></span>

## <a name="network-security-groups"></a><span data-ttu-id="85a93-261">네트워크 보안 그룹</span><span class="sxs-lookup"><span data-stu-id="85a93-261">Network Security Groups</span></span> ##

<span data-ttu-id="85a93-262">[네트워크 보안 그룹][NSGs]은 VNet 내에서 네트워크 액세스를 제어하는 기능을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-262">[Network Security Groups][NSGs] provide the ability to control network access within a VNet.</span></span> <span data-ttu-id="85a93-263">포털을 사용할 때는 모든 항목을 거부하는 최저 우선 순위의 암시적 거부 규칙이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-263">When you use the portal, there's an implicit deny rule at the lowest priority to deny everything.</span></span> <span data-ttu-id="85a93-264">허용 규칙은 사용자가 직접 작성합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-264">What you build are your allow rules.</span></span>

<span data-ttu-id="85a93-265">ASE에서 사용자는 ASE 자체를 호스팅하는 데 사용된 VM에 대한 액세스 권한이 없습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-265">In an ASE, you don't have access to the VMs used to host the ASE itself.</span></span> <span data-ttu-id="85a93-266">Microsoft에서 관리하는 구독을 통해 이러한 VM에 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-266">They're in a Microsoft-managed subscription.</span></span> <span data-ttu-id="85a93-267">ASE에서 앱에 대한 액세스를 제한하려는 경우 ASE 서브넷에 대해 NSG를 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-267">If you want to restrict access to the apps on the ASE, set NSGs on the ASE subnet.</span></span> <span data-ttu-id="85a93-268">이 과정에서 ASE 종속성에 유의하세요.</span><span class="sxs-lookup"><span data-stu-id="85a93-268">In doing so, pay careful attention to the ASE dependencies.</span></span> <span data-ttu-id="85a93-269">종속성을 차단하면 ASE 작동이 중지됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-269">If you block any dependencies, the ASE stops working.</span></span>

<span data-ttu-id="85a93-270">NSG는 Azure Portal 또는 PowerShell을 통해 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-270">NSGs can be configured through the Azure portal or via PowerShell.</span></span> <span data-ttu-id="85a93-271">이 문서에서는 Azure Portal의 정보를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-271">The information here shows the Azure portal.</span></span> <span data-ttu-id="85a93-272">**네트워킹** 아래에서 최상위 리소스로 포털에서 NSG를 만들고 관리합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-272">You create and manage NSGs in the portal as a top-level resource under **Networking**.</span></span>

<span data-ttu-id="85a93-273">인바운드 및 아웃바운드 요구 사항을 고려할 때, NSG는 이 예제에 나와 있는 NSG와 비슷하게 표시되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-273">When the inbound and outbound requirements are taken into account, the NSGs should look similar to the NSGs shown in this example.</span></span> <span data-ttu-id="85a93-274">VNet 주소 범위는 _192.168.250.0/16_이고 ASE가 있는 서브넷은 _192.168.251.128/25_입니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-274">The VNet address range is _192.168.250.0/16_, and the subnet that the ASE is in is _192.168.251.128/25_.</span></span>

<span data-ttu-id="85a93-275">ASE가 작동하기 위한 가장 우선적인 인바운드 요구 사항 두 가지가 이 예제의 목록 맨 위에 나와 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-275">The first two inbound requirements for the ASE to function are shown at the top of the list in this example.</span></span> <span data-ttu-id="85a93-276">이는 ASE 관리를 가능케 하고 ASE가 자체적으로 통신할 수 있도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-276">They enable ASE management and allow the ASE to communicate with itself.</span></span> <span data-ttu-id="85a93-277">다른 항목은 모두 테넌트에서 구성할 수 있으며, ASE에서 호스트되는 응용 프로그램에 대한 네트워크 액세스를 관리하는 데 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-277">The other entries are all tenant configurable and can govern network access to the ASE-hosted applications.</span></span> 

![인바운드 보안 규칙][4]

<span data-ttu-id="85a93-279">기본 규칙을 사용하면 VNet의 IP가 ASE 서브넷과 통신할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-279">A default rule enables the IPs in the VNet to talk to the ASE subnet.</span></span> <span data-ttu-id="85a93-280">공용 VIP라고도 하는 부하 분산 장치가 ASE와 통신할 수 있도록 하는 또 다른 기본 규칙도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-280">Another default rule enables the load balancer, also known as the public VIP, to communicate with the ASE.</span></span> <span data-ttu-id="85a93-281">기본 규칙을 확인하려면 **추가** 아이콘 옆에 있는 **기본 규칙**을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-281">To see the default rules, select **Default rules** next to the **Add** icon.</span></span> <span data-ttu-id="85a93-282">표시된 NSG 규칙 다음에 기타 모든 항목을 거부하는 규칙을 배치하면 VIP와 ASE 간의 트래픽이 차단됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-282">If you put a deny everything else rule after the NSG rules shown, you prevent traffic between the VIP and the ASE.</span></span> <span data-ttu-id="85a93-283">VNet 내에서 들어오는 트래픽을 차단하려면 인바운드를 허용하는 규칙을 직접 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-283">To prevent traffic coming from inside the VNet, add your own rule to allow inbound.</span></span> <span data-ttu-id="85a93-284">이때 대상이 **Any**이고 포트 범위가 **\***인 AzureLoadBalancer와 같은 원본을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-284">Use a source equal to AzureLoadBalancer with a destination of **Any** and a port range of **\***.</span></span> <span data-ttu-id="85a93-285">NSG 규칙은 ASE 서브넷에 적용되므로 대상을 구체적으로 지정할 필요는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-285">Because the NSG rule is applied to the ASE subnet, you don't need to be specific in the destination.</span></span>

<span data-ttu-id="85a93-286">앱에 IP 주소를 할당한 경우 포트를 열어 두어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-286">If you assigned an IP address to your app, make sure you keep the ports open.</span></span> <span data-ttu-id="85a93-287">포트를 확인하려면 **App Service Environment** > **IP 주소**를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-287">To see the ports, select **App Service Environment** > **IP addresses**.</span></span>  

<span data-ttu-id="85a93-288">다음 아웃바운드 규칙에 표시된 모든 항목이 필요합니다(마지막 항목은 제외).</span><span class="sxs-lookup"><span data-stu-id="85a93-288">All the items shown in the following outbound rules are needed, except for the last item.</span></span> <span data-ttu-id="85a93-289">이러한 항목을 통해 네트워크에서 이 문서 앞부분에서 언급했던 ASE 종속성에 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-289">They enable network access to the ASE dependencies that were noted earlier in this article.</span></span> <span data-ttu-id="85a93-290">이러한 항목 중 하나라도 차단하면 ASE의 작동이 중지됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-290">If you block any of them, your ASE stops working.</span></span> <span data-ttu-id="85a93-291">목록의 마지막 항목은 사용자의 ASE가 VNet의 다른 리소스와 통신할 수 있도록 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-291">The last item in the list enables your ASE to communicate with other resources in your VNet.</span></span>

![아웃바운드 보안 규칙][5]

<span data-ttu-id="85a93-293">NSG를 정의한 후 ASE가 있는 서브넷에 할당합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-293">After your NSGs are defined, assign them to the subnet that your ASE is on.</span></span> <span data-ttu-id="85a93-294">ASE VNet 또는 서브넷을 기억하지 못하는 경우 ASE 관리 포털에서 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-294">If you don’t remember the ASE VNet or subnet, you can see it from the ASE management portal.</span></span> <span data-ttu-id="85a93-295">서브넷에 NSG를 할당하려면 서브넷 UI로 이동한 다음 NSG를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-295">To assign the NSG to your subnet, go to the subnet UI and select the NSG.</span></span>

## <a name="routes"></a><span data-ttu-id="85a93-296">경로</span><span class="sxs-lookup"><span data-stu-id="85a93-296">Routes</span></span> ##

<span data-ttu-id="85a93-297">경로 문제는 Azure ExpressRoute를 사용하여 VNet을 구성할 때 가장 흔히 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-297">Routes become problematic most commonly when you configure your VNet with Azure ExpressRoute.</span></span> <span data-ttu-id="85a93-298">VNet에는 세 가지 유형의 경로가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-298">There are three types of routes in a VNet:</span></span>

-   <span data-ttu-id="85a93-299">시스템 경로</span><span class="sxs-lookup"><span data-stu-id="85a93-299">System routes</span></span>
-   <span data-ttu-id="85a93-300">BGP 경로</span><span class="sxs-lookup"><span data-stu-id="85a93-300">BGP routes</span></span>
-   <span data-ttu-id="85a93-301">UDR(사용자 정의 경로)</span><span class="sxs-lookup"><span data-stu-id="85a93-301">User-defined routes (UDRs)</span></span>

<span data-ttu-id="85a93-302">BGP 경로는 시스템 경로를 재정의합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-302">BGP routes override system routes.</span></span> <span data-ttu-id="85a93-303">UDR은 BGP 경로를 재정의합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-303">UDRs override BGP routes.</span></span> <span data-ttu-id="85a93-304">Azure Virtual Networks의 경로에 대한 자세한 내용은 [사용자 정의 경로 개요][UDRs]를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="85a93-304">For more information about routes in Azure virtual networks, see [User-defined routes overview][UDRs].</span></span>

<span data-ttu-id="85a93-305">ASE가 시스템을 관리하는 데 사용하는 Azure SQL Database에는 방화벽이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-305">The Azure SQL database that the ASE uses to manage the system has a firewall.</span></span> <span data-ttu-id="85a93-306">이 방화벽은 통신이 ASE 공용 VIP에서 시작되어야 하도록 요구합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-306">It requires communication to originate from the ASE public VIP.</span></span> <span data-ttu-id="85a93-307">ASE에서 SQL Database로의 연결은 ExpressRoute 연결을 통해 다른 IP 주소로 전송되는 경우 거부됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-307">Connections to the SQL database from the ASE will be denied if they are sent down the ExpressRoute connection and out another IP address.</span></span>

<span data-ttu-id="85a93-308">들어오는 관리 요청에 대한 회신이 ExpressRoute로 전송되는 경우에는 회신 주소가 원래 대상과 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-308">If replies to incoming management requests are sent down the ExpressRoute, the reply address is different than the original destination.</span></span> <span data-ttu-id="85a93-309">이러한 주소 불일치로 인해 TCP 통신이 중단됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-309">This mismatch breaks the TCP communication.</span></span>

<span data-ttu-id="85a93-310">VNet이 ExpressRoute로 구성된 상태로 ASE가 작동하도록 하기 위해 수행할 수 있는 가장 쉬운 방법은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-310">For your ASE to work while your VNet is configured with an ExpressRoute, the easiest thing to do is:</span></span>

-   <span data-ttu-id="85a93-311">_0.0.0.0/0_을 보급하도록 ExpressRoute를 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-311">Configure ExpressRoute to advertise _0.0.0.0/0_.</span></span> <span data-ttu-id="85a93-312">기본적으로 ExpressRoute는 온-프레미스의 모든 아웃바운드 트래픽을 강제로 터널링합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-312">By default, it force tunnels all outbound traffic on-premises.</span></span>
-   <span data-ttu-id="85a93-313">UDR를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-313">Create a UDR.</span></span> <span data-ttu-id="85a93-314">그리고 주소 접두사가 _0.0.0.0/0_이며 다음 홉 형식이 _인터넷_인 ASE가 포함된 서브넷에 UDR을 적용합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-314">Apply it to the subnet that contains the ASE with an address prefix of _0.0.0.0/0_ and a next hop type of _Internet_.</span></span>

<span data-ttu-id="85a93-315">이러한 두 가지 사항을 변경하면 ASE 서브넷에서 발생하는 인터넷용 트래픽이 ExpressRoute로 강제 전송되지 않으며 ASE가 정상적으로 작동합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-315">If you make these two changes, internet-destined traffic that originates from the ASE subnet isn't forced down the ExpressRoute and the ASE works.</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="85a93-316">UDR에 정의된 경로는 ExpressRoute 구성을 통해 보급된 경로보다 우선하도록 충분히 구체적이어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-316">The routes defined in a UDR must be specific enough to take precedence over any routes advertised by the ExpressRoute configuration.</span></span> <span data-ttu-id="85a93-317">이전 예제에서는 광범위한 0.0.0.0/0 주소 범위를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-317">The preceding example uses the broad 0.0.0.0/0 address range.</span></span> <span data-ttu-id="85a93-318">따라서 더 구체적인 주소 범위를 사용하는 경로 보급 알림으로 인해 주소 범위가 잘못 재정의될 가능성이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-318">It can potentially be accidentally overridden by route advertisements that use more specific address ranges.</span></span>
>
> <span data-ttu-id="85a93-319">공용 피어링 경로에서 개인 피어링 경로로 경로의 교차 보급을 수행하는 ExpressRoute 구성에서는 ASE가 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-319">ASEs aren't supported with ExpressRoute configurations that cross-advertise routes from the public-peering path to the private-peering path.</span></span> <span data-ttu-id="85a93-320">공용 피어링이 구성된 ExpressRoute 구성은 Microsoft에서 경로 보급 알림을 받습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-320">ExpressRoute configurations with public peering configured receive route advertisements from Microsoft.</span></span> <span data-ttu-id="85a93-321">보급 알림에는 대규모 Microsoft Azure IP 주소 범위 집합이 포함되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-321">The advertisements contain a large set of Microsoft Azure IP address ranges.</span></span> <span data-ttu-id="85a93-322">개인 피어링 경로에서 주소 범위를 교차 보급하는 경우 ASE 서브넷의 모든 아웃바운드 네트워크 패킷이 고객의 온-프레미스 네트워크 인프라로 강제 터널링됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-322">If the address ranges are cross-advertised on the private-peering path, all outbound network packets from the ASE's subnet are force tunneled to a customer's on-premises network infrastructure.</span></span> <span data-ttu-id="85a93-323">이 네트워크 흐름은 현재 ASE에서 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-323">This network flow is currently not supported with ASEs.</span></span> <span data-ttu-id="85a93-324">이 문제를 해결하려면 공용 피어링 경로에서 개인 피어링 경로로의 교차 보급 경로를 중지합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-324">One solution to this problem is to stop cross-advertising routes from the public-peering path to the private-peering path.</span></span>

<span data-ttu-id="85a93-325">UDR를 만들려면 다음 단계를 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-325">To create a UDR, follow these steps:</span></span>

1. <span data-ttu-id="85a93-326">Azure Portal로 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-326">Go to the Azure portal.</span></span> <span data-ttu-id="85a93-327">**네트워킹** > **경로 테이블**을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-327">Select **Networking** > **Route Tables**.</span></span>

2. <span data-ttu-id="85a93-328">VNet과 동일한 지역에 새 경로 테이블을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-328">Create a new route table in the same region as your VNet.</span></span>

3. <span data-ttu-id="85a93-329">경로 테이블 UI 내에서 **경로** > **추가**를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-329">From within your route table UI, select **Routes** > **Add**.</span></span>

4. <span data-ttu-id="85a93-330">**다음 홉 형식**을 **인터넷**으로, **주소 접두사**를 **0.0.0.0/0**으로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-330">Set the **Next hop type** to **Internet** and the **Address prefix** to **0.0.0.0/0**.</span></span> <span data-ttu-id="85a93-331">**저장**을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-331">Select **Save**.</span></span>

    <span data-ttu-id="85a93-332">다음과 유사한 출력이 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-332">You then see something like the following:</span></span>

    ![기능 경로][6]

5. <span data-ttu-id="85a93-334">새 경로 테이블을 만든 후 ASE가 포함된 서브넷으로 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-334">After you create the new route table, go to the subnet that contains your ASE.</span></span> <span data-ttu-id="85a93-335">Portal의 목록에서 경로 테이블을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-335">Select your route table from the list in the portal.</span></span> <span data-ttu-id="85a93-336">변경 내용을 저장하면 서브넷이 표시된 경로와 NSG를 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-336">After you save the change, you should then see the NSGs and routes noted with your subnet.</span></span>

    ![NSG 및 경로][7]

### <a name="deploy-into-existing-azure-virtual-networks-that-are-integrated-with-expressroute"></a><span data-ttu-id="85a93-338">ExpressRoute와 통합된 기존 Azure Virtual Networks에 배포</span><span class="sxs-lookup"><span data-stu-id="85a93-338">Deploy into existing Azure virtual networks that are integrated with ExpressRoute</span></span> ###

<span data-ttu-id="85a93-339">ExpressRoute와 통합된 VNet에 ASE를 배포하려면 ASE를 배포할 서브넷을 미리 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-339">To deploy your ASE into a VNet that's integrated with ExpressRoute, preconfigure the subnet where you want the ASE deployed.</span></span> <span data-ttu-id="85a93-340">그런 다음 Resource Manager 템플릿을 사용하여 ASE를 배포합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-340">Then use a Resource Manager template to deploy it.</span></span> <span data-ttu-id="85a93-341">ASE를 이미 구성된 ExpressRoute가 있는 VNet에 만들려면 다음을 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-341">To create an ASE in a VNet that already has ExpressRoute configured:</span></span>

- <span data-ttu-id="85a93-342">ASE를 호스팅하는 서브넷을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-342">Create a subnet to host the ASE.</span></span>

    > [!NOTE]
    > <span data-ttu-id="85a93-343">ASE 이외의 항목을 서브넷에 포함해서는 안 됩니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-343">Nothing else can be in the subnet but the ASE.</span></span> <span data-ttu-id="85a93-344">향후 확장이 가능한 주소 공간을 선택해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-344">Be sure to choose an address space that allows for future growth.</span></span> <span data-ttu-id="85a93-345">이 설정은 나중에 변경할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-345">You can't change this setting later.</span></span> <span data-ttu-id="85a93-346">주소 128개를 포함할 수 있는 `/25` 크기를 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-346">We recommend a size of `/25` with 128 addresses.</span></span>

- <span data-ttu-id="85a93-347">앞에서 설명한 대로 UDR(예: 경로 테이블)을 만들고 서브넷에서 UDR을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-347">Create UDRs (for example, route tables) as described earlier, and set that on the subnet.</span></span>
- <span data-ttu-id="85a93-348">[Resource Manager 템플릿을 사용하여 ASE 만들기][MakeASEfromTemplate]에서 설명한 대로 Resource Manager 템플릿을 사용하여 ASE를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="85a93-348">Create the ASE by using a Resource Manager template as described in [Create an ASE by using a Resource Manager template][MakeASEfromTemplate].</span></span>

<!--Image references-->
[1]: ./media/network_considerations_with_an_app_service_environment/networkase-overflow.png
[2]: ./media/network_considerations_with_an_app_service_environment/networkase-overflow2.png
[3]: ./media/network_considerations_with_an_app_service_environment/networkase-ipaddresses.png
[4]: ./media/network_considerations_with_an_app_service_environment/networkase-inboundnsg.png
[5]: ./media/network_considerations_with_an_app_service_environment/networkase-outboundnsg.png
[6]: ./media/network_considerations_with_an_app_service_environment/networkase-udr.png
[7]: ./media/network_considerations_with_an_app_service_environment/networkase-subnet.png

<!--Links-->
[Intro]: ./intro.md
[MakeExternalASE]: ./create-external-ase.md
[MakeASEfromTemplate]: ./create-from-template.md
[MakeILBASE]: ./create-ilb-ase.md
[ASENetwork]: ./network-info.md
[ASEReadme]: ./readme.md
[UsingASE]: ./using-an-ase.md
[UDRs]: ../../virtual-network/virtual-networks-udr-overview.md
[NSGs]: ../../virtual-network/virtual-networks-nsg.md
[ConfigureASEv1]: ../../app-service-web/app-service-web-configure-an-app-service-environment.md
[ASEv1Intro]: ../../app-service-web/app-service-app-service-environment-intro.md
[webapps]: ../../app-service-web/app-service-web-overview.md
[mobileapps]: ../../app-service-mobile/app-service-mobile-value-prop.md
[APIapps]: ../../app-service-api/app-service-api-apps-why-best-platform.md
[Functions]: ../../azure-functions/index.yml
[Pricing]: http://azure.microsoft.com/pricing/details/app-service/
[ARMOverview]: ../../azure-resource-manager/resource-group-overview.md
[ConfigureSSL]: ../../app-service-web/web-sites-purchase-ssl-web-site.md
[Kudu]: http://azure.microsoft.com/resources/videos/super-secret-kudu-debug-console-for-azure-web-sites/
[AppDeploy]: ../../app-service-web/web-sites-deploy.md
[ASEWAF]: ../../app-service-web/app-service-app-service-environment-web-application-firewall.md
[AppGW]: ../../application-gateway/application-gateway-web-application-firewall-overview.md
[ASEManagement]: ./management-addresses.md
