---
title: "SQL Server에 대한 고가용성 및 재해 복구 | Microsoft Docs"
description: "Azure 가상 컴퓨터에서 실행되는 SQL Server에 대한 다양한 형식의 HADR 전략을 설명합니다."
services: virtual-machines-windows
documentationcenter: na
author: MikeRayMSFT
manager: jhubbard
editor: 
tags: azure-service-management
ms.assetid: 53981f7e-8370-4979-b26a-93a5988d905f
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 06/27/2017
ms.author: mikeray
ms.openlocfilehash: 27d05c1681f7d7b3090fc7abd4a6b15d1c030e2c
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/11/2017
---
# <a name="high-availability-and-disaster-recovery-for-sql-server-in-azure-virtual-machines"></a><span data-ttu-id="ac361-103">Azure 가상 컴퓨터의 SQL Server에 대한 고가용성 및 재해 복구</span><span class="sxs-lookup"><span data-stu-id="ac361-103">High availability and disaster recovery for SQL Server in Azure Virtual Machines</span></span>

<span data-ttu-id="ac361-104">Microsoft Azure 가상 컴퓨터(VM)에 SQL Server를 설치하여 사용하면 고가용성 및 재해 복구(HADR) 데이터베이스 솔루션의 비용을 절감하는 데 도움이 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-104">Microsoft Azure virtual machines (VMs) with SQL Server can help lower the cost of a high availability and disaster recovery (HADR) database solution.</span></span> <span data-ttu-id="ac361-105">대부분의 SQL Server HADR 솔루션은 Azure 가상 컴퓨터에서 지원됩니다. Azure 전용으로도, 하이브리드 솔루션으로도 사용 가능합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-105">Most SQL Server HADR solutions are supported in Azure virtual machines, both as Azure-only and as hybrid solutions.</span></span> <span data-ttu-id="ac361-106">Azure 전용 솔루션에서는 HADR 시스템 전체가 Azure에서 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-106">In an Azure-only solution, the entire HADR system runs in Azure.</span></span> <span data-ttu-id="ac361-107">하이브리드 구성에서는 솔루션의 일부가 Azure에서 실행되고 나머지 부분은 조직의 온-프레미스에서 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-107">In a hybrid configuration, part of the solution runs in Azure and the other part runs on-premises in your organization.</span></span> <span data-ttu-id="ac361-108">Azure 환경은 유연하게 제공되므로 사용 중인 SQL Server 데이터베이스 시스템의 예산과 HADR 요구 사항에 맞게 Azure로 부분적으로만 이동하거나 완전히 이동할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-108">The flexibility of the Azure environment enables you to move partially or completely to Azure to satisfy the budget and HADR requirements of your SQL Server database systems.</span></span>

[!INCLUDE [learn-about-deployment-models](../../../../includes/learn-about-deployment-models-both-include.md)]

## <a name="understanding-the-need-for-an-hadr-solution"></a><span data-ttu-id="ac361-109">HADR 솔루션의 필요성 이해</span><span class="sxs-lookup"><span data-stu-id="ac361-109">Understanding the need for an HADR solution</span></span>
<span data-ttu-id="ac361-110">데이터베이스 시스템에 서비스 수준 계약(SLA)이 필요한 HADR 기능을 도입하는 것은 여러분의 선택입니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-110">It is up to you to ensure that your database system possesses the HADR capabilities that the service-level agreement (SLA) requires.</span></span> <span data-ttu-id="ac361-111">Azure는 클라우드 서비스를 위한 서비스 복구 및 Virtual Machines에 대한 오류 복구 감지와 같은 고가용성 메커니즘을 제공하기는 하지만, 이를 통해 원하는 SLA를 충족할 수 있다는 보장은 없습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-111">The fact that Azure provides high availability mechanisms, such as service healing for cloud services and failure recovery detection for Virtual Machines, does not itself guarantee you can meet the desired SLA.</span></span> <span data-ttu-id="ac361-112">이러한 메커니즘은 VVM의 고가용성을 보호하기는 하지만 VM에서 실행되는 SQL Server의 고가용성을 보호하지는 않습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-112">These mechanisms protect the high availability of the VMs but not the high availability of SQL Server running inside the VMs.</span></span> <span data-ttu-id="ac361-113">VM이 온라인 상태이고 정상인 경우에도 SQL Server에 문제가 생길 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-113">It is possible for the SQL Server instance to fail while the VM is online and healthy.</span></span> <span data-ttu-id="ac361-114">또한 Azure가 제공하는 고가용성 메커니즘을 사용해도 소프트웨어를 사용한 복구나 하드웨어 고장, 운영 체제 업그레이드와 같은 경우에는 VM이 가동 중지될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-114">Moreover, even the high availability mechanisms provided by Azure allow for downtime of the VMs due to events such as recovery from software or hardware failures and operating system upgrades.</span></span>

<span data-ttu-id="ac361-115">지역 복제라는 기능으로 구현되는 Azure의 GRS(지역 중복 저장)도 데이터베이스의 적절한 재해 복구 솔루션이 되지 못할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-115">In addition, Geo Redundant Storage (GRS) in Azure, which is implemented with a feature called geo-replication, may not be an adequate disaster recovery solution for your databases.</span></span> <span data-ttu-id="ac361-116">지역 복제는 데이터를 비동기 방식으로 전송하기 때문에, 재해 발생 시 최근 업데이트 내용이 손실될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-116">Because geo-replication sends data asynchronously, recent updates can be lost in the event of disaster.</span></span> <span data-ttu-id="ac361-117">지역에서 복제의 제한 사항에 대한 자세한 내용은 [지역에서 복제는 별도의 디스크에 저장된 데이터 및 로그 파일에 대해 지원되지 않음](#geo-replication-support) 섹션에 설명되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-117">More information regarding geo-replication limitations are covered in the [Geo-replication not supported for data and log files on separate disks](#geo-replication-support) section.</span></span>

## <a name="hadr-deployment-architectures"></a><span data-ttu-id="ac361-118">HADR 배포 아키텍처</span><span class="sxs-lookup"><span data-stu-id="ac361-118">HADR deployment architectures</span></span>
<span data-ttu-id="ac361-119">Azure에서 지원하는 SQL Server HADR 기술은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-119">SQL Server HADR technologies that are supported in Azure include:</span></span>

* [<span data-ttu-id="ac361-120">Always On 가용성 그룹</span><span class="sxs-lookup"><span data-stu-id="ac361-120">Always On Availability Groups</span></span>](https://technet.microsoft.com/library/hh510230.aspx)
* [<span data-ttu-id="ac361-121">Always On 장애 조치 클러스터 인스턴스</span><span class="sxs-lookup"><span data-stu-id="ac361-121">Always On Failover Cluster Instances</span></span>](https://technet.microsoft.com/library/ms189134.aspx)
* [<span data-ttu-id="ac361-122">로그 전달</span><span class="sxs-lookup"><span data-stu-id="ac361-122">Log Shipping</span></span>](https://technet.microsoft.com/library/ms187103.aspx)
* [<span data-ttu-id="ac361-123">Azure Blob Storage 서비스로 SQL Server 백업 및 복원</span><span class="sxs-lookup"><span data-stu-id="ac361-123">SQL Server Backup and Restore with Azure Blob Storage Service</span></span>](https://msdn.microsoft.com/library/jj919148.aspx)
* <span data-ttu-id="ac361-124">[데이터베이스 미러링](https://technet.microsoft.com/library/ms189852.aspx) - SQL Server 2016에서에서 사용되지 않음</span><span class="sxs-lookup"><span data-stu-id="ac361-124">[Database Mirroring](https://technet.microsoft.com/library/ms189852.aspx) - Deprecated in SQL Server 2016</span></span>

<span data-ttu-id="ac361-125">이러한 기술을 조합하여 고가용성과 재해 복구 기능을 갖춘 SQL Server 솔루션을 구현하는 것도 가능합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-125">It is possible to combine the technologies together to implement a SQL Server solution that has both high availability and disaster recovery capabilities.</span></span> <span data-ttu-id="ac361-126">사용하는 기술에 따라, 하이브리드 배포에는 Azure 가상 네트워크와 함께 VPN 터널이 필요할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-126">Depending on the technology you use, a hybrid deployment may require a VPN tunnel with the Azure virtual network.</span></span> <span data-ttu-id="ac361-127">다음 섹션에서 몇 가지 배포 아키텍처의 예를 소개합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-127">The sections below show you some of the example deployment architectures.</span></span>

## <a name="azure-only-high-availability-solutions"></a><span data-ttu-id="ac361-128">Azure 전용: 고가용성 솔루션</span><span class="sxs-lookup"><span data-stu-id="ac361-128">Azure-only: High availability solutions</span></span>

<span data-ttu-id="ac361-129">가용성 그룹이라고 하는 Always On 가용성 그룹을 사용하여 데이터베이스 수준에서 SQL Server에 대한 고가용성 솔루션을 유지할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-129">You can have a high availability solution for SQL Server at a database level with Always On Availability Groups - called availability groups.</span></span> <span data-ttu-id="ac361-130">장애 조치 클러스터 인스턴스라고 하는 Always On 장애 조치 클러스터 인스턴스를 사용하여 인스턴스 수준에서 고가용성 솔루션을 만들 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-130">You can also create a high availability solution at an instance level with Always On Failover Cluster Instances - failover cluster instances.</span></span> <span data-ttu-id="ac361-131">추가적인 중복의 경우 장애 조치 클러스터 인스턴스에서 가용성 그룹을 만들어 두 수준 모두에서 중복을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-131">For additional redundancy, you can create redundancy at both levels by creating availability groups on failover cluster instances.</span></span> 

| <span data-ttu-id="ac361-132">기술</span><span class="sxs-lookup"><span data-stu-id="ac361-132">Technology</span></span> | <span data-ttu-id="ac361-133">아키텍처의 예</span><span class="sxs-lookup"><span data-stu-id="ac361-133">Example Architectures</span></span> |
| --- | --- |
| <span data-ttu-id="ac361-134">**가용성 그룹**</span><span class="sxs-lookup"><span data-stu-id="ac361-134">**Availability groups**</span></span> |<span data-ttu-id="ac361-135">동일한 지역에 있는 Azure VM에서 실행되는 모든 가용성 복제본은 고가용성을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-135">Availability replicas running in Azure VMs in the same region provide high availability.</span></span> <span data-ttu-id="ac361-136">Windows 장애 조치 클러스터링에 Active Directory 도메인이 필요하기 때문에 도메인 컨트롤러 VM을 구성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-136">You need to configure a domain controller VM, because Windows failover clustering requires an Active Directory domain.</span></span><br/> <span data-ttu-id="ac361-137">![가용성 그룹](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_ha_always_on.gif)</span><span class="sxs-lookup"><span data-stu-id="ac361-137">![Availability Groups](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_ha_always_on.gif)</span></span><br/><span data-ttu-id="ac361-138">자세한 내용은 [Azure에서 가용성 그룹 구성(GUI)](virtual-machines-windows-portal-sql-alwayson-availability-groups.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ac361-138">For more information, see [Configure Availability Groups in Azure (GUI)](virtual-machines-windows-portal-sql-alwayson-availability-groups.md).</span></span> |
| <span data-ttu-id="ac361-139">**장애 조치 클러스터 인스턴스**</span><span class="sxs-lookup"><span data-stu-id="ac361-139">**Failover cluster instances**</span></span> |<span data-ttu-id="ac361-140">공유 저장소가 필요한 FCI(장애 조치 클러스터 인스턴스)는 3가지 방법으로 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-140">Failover Cluster Instances (FCI), which require shared storage, can be created in 3 different ways.</span></span><br/><br/><span data-ttu-id="ac361-141">1. [Windows Server 2016 저장소 공간 다이렉트 \(S2D\)](virtual-machines-windows-portal-sql-create-failover-cluster.md)를 사용하는 연결된 저장소로 Azure VM에서 실행되는 2노드 장애 조치 클러스터는 소프트웨어 기반 가상 SAN을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-141">1. A two-node failover cluster running in Azure VMs with attached storage using [Windows Server 2016 Storage Spaces Direct \(S2D\)](virtual-machines-windows-portal-sql-create-failover-cluster.md) to provide a software-based virtual SAN.</span></span><br/><br/><span data-ttu-id="ac361-142">2. 타사 클러스터링 솔루션에서 지원하는 저장소를 사용하여 Azure VM에서 실행되는 2노드 장애 조치 클러스터입니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-142">2. A two-node failover cluster running in Azure VMs with storage supported by a third-party clustering solution.</span></span> <span data-ttu-id="ac361-143">SIOS DataKeeper를 사용하는 특정 예제는 [장애 조치 클러스터링 및 타사 소프트웨어 SIOS DataKeeper를 사용하는 파일 공유에 대한 고가용성](https://azure.microsoft.com/blog/high-availability-for-a-file-share-using-wsfc-ilb-and-3rd-party-software-sios-datakeeper/)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ac361-143">For a specific example that uses SIOS DataKeeper, see [High availability for a file share using failover clustering and 3rd party software SIOS DataKeeper](https://azure.microsoft.com/blog/high-availability-for-a-file-share-using-wsfc-ilb-and-3rd-party-software-sios-datakeeper/).</span></span><br/><br/><span data-ttu-id="ac361-144">3. ExpressRoute를 통한 원격 iSCSI 대상 공유 블록 저장소를 사용하여 Azure VM에서 실행되는 2노드 장애 조치 클러스터입니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-144">3. A two-node failover cluster running in Azure VMs with remote iSCSI Target shared block storage via ExpressRoute.</span></span> <span data-ttu-id="ac361-145">예를 들어 NPS(NetApp 개인 저장소)는 Equinix와 함께 Express 경로를 사용하여 iSCSI 대상을 Azure VM에 공개합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-145">For example, NetApp Private Storage (NPS) exposes an iSCSI target via ExpressRoute with Equinix to Azure VMs.</span></span><br/><br/><span data-ttu-id="ac361-146">타사 공유 저장소 및 데이터 복제 솔루션의 경우 장애 조치 시 데이터 액세스와 관련된 문제는 공급 업체에 문의해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-146">For third-party shared storage and data replication solutions, you should contact the vendor for any issues related to accessing data on failover.</span></span><br/><br/><span data-ttu-id="ac361-147">이 솔루션은 프리미엄 저장소를 사용하지 않기 때문에 [Azure 파일 저장소](https://azure.microsoft.com/services/storage/files/) 맨 위에서 FCI를 사용하는 것은 아직 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-147">Note that using FCI on top of [Azure File storage](https://azure.microsoft.com/services/storage/files/) is not supported yet, because this solution does not utilize Premium Storage.</span></span> <span data-ttu-id="ac361-148">빠른 시일 내에 지원하기 위해 노력하고 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-148">We are working to support this soon.</span></span> |

## <a name="azure-only-disaster-recovery-solutions"></a><span data-ttu-id="ac361-149">Azure 전용: 재해 복구 솔루션</span><span class="sxs-lookup"><span data-stu-id="ac361-149">Azure-only: Disaster recovery solutions</span></span>
<span data-ttu-id="ac361-150">가용성 그룹, 데이터베이스 미러링을 사용하여 Azure 내의 SQL Server 데이터베이스에 대한 재해 복구 솔루션을 구축하거나 저장소 blob을 사용하여 백업 및 복원할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-150">You can have a disaster recovery solution for your SQL Server databases in Azure using availability groups, database mirroring, or backup and restore with storage blobs.</span></span>

| <span data-ttu-id="ac361-151">기술</span><span class="sxs-lookup"><span data-stu-id="ac361-151">Technology</span></span> | <span data-ttu-id="ac361-152">아키텍처의 예</span><span class="sxs-lookup"><span data-stu-id="ac361-152">Example Architectures</span></span> |
| --- | --- |
| <span data-ttu-id="ac361-153">**가용성 그룹**</span><span class="sxs-lookup"><span data-stu-id="ac361-153">**Availability Groups**</span></span> |<span data-ttu-id="ac361-154">재해 복구를 위해 가용성 복제본을 Azure VM의 여러 데이터 센터에서 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-154">Availability replicas running across multiple datacenters in Azure VMs for disaster recovery.</span></span> <span data-ttu-id="ac361-155">이렇게 여러 영역에 나누어 실행되는 솔루션은 완전한 사이트 중단이 발생해도 데이터를 보호할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-155">This cross-region solution protects against complete site outage.</span></span> <br/> <span data-ttu-id="ac361-156">![가용성 그룹](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_alwayson.png)</span><span class="sxs-lookup"><span data-stu-id="ac361-156">![Availability Groups](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_alwayson.png)</span></span><br/><span data-ttu-id="ac361-157">한 영역 내의 모든 복제본은 동일한 클라우드 서비스 및 동일한 VNet 내에 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-157">Within a region, all replicas should be within the same cloud service and the same VNet.</span></span> <span data-ttu-id="ac361-158">각 영역에 별도의 VNet이 있으므로, 이러한 솔루션은 VNet 사이의 연결이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-158">Because each region will have a separate VNet, these solutions require VNet to VNet connectivity.</span></span> <span data-ttu-id="ac361-159">자세한 내용은 [Azure Portal에서 VNet-VNet 연결 구성](../../../vpn-gateway/vpn-gateway-howto-vnet-vnet-resource-manager-portal.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ac361-159">For more information, see [Configure a VNet-to-VNet connection using the Azure portal](../../../vpn-gateway/vpn-gateway-howto-vnet-vnet-resource-manager-portal.md).</span></span> <span data-ttu-id="ac361-160">자세한 지침은 [다른 지역의 Azure Virtual Machines에서 SQL Server 가용성 그룹 구성](virtual-machines-windows-portal-sql-availability-group-dr.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ac361-160">For detailed instructions, see [Configure a SQL Server Availability Group on Azure Virtual Machines in Different Regions](virtual-machines-windows-portal-sql-availability-group-dr.md).</span></span>|
| <span data-ttu-id="ac361-161">**데이터베이스 미러링**</span><span class="sxs-lookup"><span data-stu-id="ac361-161">**Database Mirroring**</span></span> |<span data-ttu-id="ac361-162">재해 복구를 위해 주 서버와 미러 서버를 다른 데이터 센터에서 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-162">Principal and mirror and servers running in different datacenters for disaster recovery.</span></span> <span data-ttu-id="ac361-163">Active Directory 도메인을 여러 데이터 센터에 사용할 수 없으므로 서버 인증서를 사용하여 배포해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-163">You must deploy using server certificates because an active directory domain cannot span multiple datacenters.</span></span><br/>![데이터베이스 미러링](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_dbmirroring.gif) |
| <span data-ttu-id="ac361-165">**Azure Blob 저장소 서비스로 SQL Server 백업 및 복원**</span><span class="sxs-lookup"><span data-stu-id="ac361-165">**Backup and Restore with Azure Blob Storage Service**</span></span> |<span data-ttu-id="ac361-166">재해 복구를 위해 프로덕션 데이터베이스를 다른 데이터 센터의 Blob 저장소에 직접 백업합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-166">Production databases backed up directly to blob storage in a different datacenter for disaster recovery.</span></span><br/><span data-ttu-id="ac361-167">![백업 및 복원](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_backup_restore.gif)</span><span class="sxs-lookup"><span data-stu-id="ac361-167">![Backup and Restore](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_backup_restore.gif)</span></span><br/><span data-ttu-id="ac361-168">자세한 내용은 [Azure 가상 컴퓨터에서 SQL Server의 백업 및 복원](virtual-machines-windows-sql-backup-recovery.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ac361-168">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-backup-recovery.md).</span></span> |

## <a name="hybrid-it-disaster-recovery-solutions"></a><span data-ttu-id="ac361-169">하이브리드 IT: 재해 복구 솔루션</span><span class="sxs-lookup"><span data-stu-id="ac361-169">Hybrid IT: Disaster recovery solutions</span></span>
<span data-ttu-id="ac361-170">가용성 그룹, 데이터베이스 미러링, 로그 전달을 사용하여 하이브리드 IT 환경 내에 SQL Server 데이터베이스에 대한 재해 복구 솔루션을 구축하고 Azure Blob 저장소를 사용하여 백업 및 복원할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-170">You can have a disaster recovery solution for your SQL Server databases in a hybrid-IT environment using availability groups, database mirroring, log shipping, and backup and restore with Azure blog storage.</span></span>

| <span data-ttu-id="ac361-171">기술</span><span class="sxs-lookup"><span data-stu-id="ac361-171">Technology</span></span> | <span data-ttu-id="ac361-172">아키텍처의 예</span><span class="sxs-lookup"><span data-stu-id="ac361-172">Example Architectures</span></span> |
| --- | --- |
| <span data-ttu-id="ac361-173">**가용성 그룹**</span><span class="sxs-lookup"><span data-stu-id="ac361-173">**Availability Groups**</span></span> |<span data-ttu-id="ac361-174">사이트간 재해 복구를 위해 일부 가용성 복제본은 Azure VM에서 실행되고 다른 복제본은 온-프레미스에서 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-174">Some availability replicas running in Azure VMs and other replicas running on-premises for cross-site disaster recovery.</span></span> <span data-ttu-id="ac361-175">프로덕션 사이트는 온-프레미스와 Azure 데이터 센터 어디에도 있을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-175">The production site can be either on-premises or in an Azure datacenter.</span></span><br/>![가용성 그룹](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_alwayson.gif)<br/><span data-ttu-id="ac361-177">모든 가용성 복제본이 동일한 장애 조치 클러스터에 있어야 하므로, 장애 조치 클러스터는 두 네트워크(다중 서브넷 장애 조치 클러스터)에 걸쳐 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-177">Because all availability replicas must be in the same failover cluster, the cluster must span both networks (a multi-subnet failover cluster).</span></span> <span data-ttu-id="ac361-178">이 구성은 Azure와 온-프레미스 네트워크 간의 VPN 연결이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-178">This configuration requires a VPN connection between Azure and the on-premises network.</span></span><br/><br/><span data-ttu-id="ac361-179">데이터베이스의 성공적인 재해 복구를 위해서는 재해 복구 사이트에 복제 도메인 컨트롤러도 설치해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-179">For successful disaster recovery of your databases, you should also install a replica domain controller at the disaster recovery site.</span></span><br/><br/><span data-ttu-id="ac361-180">SSMS에서 복제본 추가 마법사를 사용하여 Azure 복제본을 기존 Always On 가용성 그룹에 추가할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-180">It is possible to use the Add Replica Wizard in SSMS to add an Azure replica to an existing Always On Availability Group.</span></span> <span data-ttu-id="ac361-181">자세한 내용은 자습서: Always On 가용성 그룹을 Azure로 확장을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ac361-181">For more information, see Tutorial: Extend your Always On Availability Group to Azure.</span></span> |
| <span data-ttu-id="ac361-182">**데이터베이스 미러링**</span><span class="sxs-lookup"><span data-stu-id="ac361-182">**Database Mirroring**</span></span> |<span data-ttu-id="ac361-183">서버 인증서를 사용한 사이트 간 재해 복구를 위해 한 파트너는 Azure VM에서 실행하고 다른 파트너는 온-프레미스에서 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-183">One partner running in an Azure VM and the other running on-premises for cross-site disaster recovery using server certificates.</span></span> <span data-ttu-id="ac361-184">파트너는 동일한 Active Directory 도메인에 속할 필요가 없으며 VPN 연결도 필요하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-184">Partners do not need to be in the same Active Directory domain, and no VPN connection is required.</span></span><br/><span data-ttu-id="ac361-185">![데이터베이스 미러링](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_dbmirroring.gif)</span><span class="sxs-lookup"><span data-stu-id="ac361-185">![Database Mirroring](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_dbmirroring.gif)</span></span><br/><span data-ttu-id="ac361-186">또 다른 데이터베이스 미러링 시나리오로는 사이트 간 재해 복구를 위해 한 파트너가 Azure VM에서 실행되고 다른 파트너가 동일한 Active Directory 도메인의 온-프레미스에서 실행되는 경우를 들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-186">Another database mirroring scenario involves one partner running in an Azure VM and the other running on-premises in the same Active Directory domain for cross-site disaster recovery.</span></span> <span data-ttu-id="ac361-187">[Azure 가상 네트워크와 온-프레미스 네트워크 간의 VPN 연결](../../../vpn-gateway/vpn-gateway-site-to-site-create.md)이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-187">A [VPN connection between the Azure virtual network and the on-premises network](../../../vpn-gateway/vpn-gateway-site-to-site-create.md) is required.</span></span><br/><br/><span data-ttu-id="ac361-188">데이터베이스의 성공적인 재해 복구를 위해서는 재해 복구 사이트에 복제 도메인 컨트롤러도 설치해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-188">For successful disaster recovery of your databases, you should also install a replica domain controller at the disaster recovery site.</span></span> |
| <span data-ttu-id="ac361-189">**로그 전달**</span><span class="sxs-lookup"><span data-stu-id="ac361-189">**Log Shipping**</span></span> |<span data-ttu-id="ac361-190">사이트 간 재해 복구를 위해 한 서버는 Azure VM에서 실행하고 다른 서버는 온-프레미스에서 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-190">One server running in an Azure VM and the other running on-premises for cross-site disaster recovery.</span></span> <span data-ttu-id="ac361-191">로그 전달은 Windows 파일 공유를 사용하므로 Azure 가상 네트워크와 온-프레미스 네트워크 간의 VPN 연결이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-191">Log shipping depends on Windows file sharing, so a VPN connection between the Azure virtual network and the on-premises network is required.</span></span><br/>![로그 전달](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_log_shipping.gif)<br/><span data-ttu-id="ac361-193">데이터베이스의 성공적인 재해 복구를 위해서는 재해 복구 사이트에 복제 도메인 컨트롤러도 설치해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-193">For successful disaster recovery of your databases, you should also install a replica domain controller at the disaster recovery site.</span></span> |
| <span data-ttu-id="ac361-194">**Azure Blob 저장소 서비스로 SQL Server 백업 및 복원**</span><span class="sxs-lookup"><span data-stu-id="ac361-194">**Backup and Restore with Azure Blob Storage Service**</span></span> |<span data-ttu-id="ac361-195">재해 복구를 위해 온-프레미스 프로덕션 데이터베이스는 다른 데이터 센터의 Blob 저장소에 직접 백업됩니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-195">On-premises production databases backed up directly to Azure blob storage for disaster recovery.</span></span><br/><span data-ttu-id="ac361-196">![백업 및 복원](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_backup_restore.gif)</span><span class="sxs-lookup"><span data-stu-id="ac361-196">![Backup and Restore](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_backup_restore.gif)</span></span><br/><span data-ttu-id="ac361-197">자세한 내용은 [Azure 가상 컴퓨터에서 SQL Server의 백업 및 복원](virtual-machines-windows-sql-backup-recovery.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ac361-197">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-backup-recovery.md).</span></span> |

## <a name="important-considerations-for-sql-server-hadr-in-azure"></a><span data-ttu-id="ac361-198">Azure에서 SQL Server HADR에 대한 중요 고려 사항</span><span class="sxs-lookup"><span data-stu-id="ac361-198">Important considerations for SQL Server HADR in Azure</span></span>
<span data-ttu-id="ac361-199">Azure VM, 저장소 및 네트워킹은 온-프레미스, 가상화되지 않은 IT 인프라에서는 작동 특성이 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-199">Azure VMs, storage, and networking have different operational characteristics than an on-premises, non-virtualized IT infrastructure.</span></span> <span data-ttu-id="ac361-200">Azure에서 SQL Server HADR 솔루션을 성공적으로 구현하기 위해서는 이러한 차이점을 이해하고 그에 맞게 솔루션을 설계해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-200">A successful implementation of a HADR SQL Server solution in Azure requires that you understand these differences and design your solution to accommodate them.</span></span>

### <a name="high-availability-nodes-in-an-availability-set"></a><span data-ttu-id="ac361-201">가용성 집합의 고가용성 노드</span><span class="sxs-lookup"><span data-stu-id="ac361-201">High availability nodes in an availability set</span></span>
<span data-ttu-id="ac361-202">Azure의 가용성 집합을 사용하면 고가용성 노드를 별도의 오류 도메인(FD)과 업데이트 도메인(UD)에 배치할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-202">Availability sets in Azure enable you to place the high availability nodes into separate Fault Domains (FDs) and Update Domains (UDs).</span></span> <span data-ttu-id="ac361-203">같은 가용성 집합에 배치할 Azure VM이라면 같은 클라우드 서비스에 배포해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-203">For Azure VMs to be placed in the same availability set, you must deploy them in the same cloud service.</span></span> <span data-ttu-id="ac361-204">같은 클라우드 서비스에 있는 노드만 같은 가용성 집합에 참여할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-204">Only nodes in the same cloud service can participate in the same availability set.</span></span> <span data-ttu-id="ac361-205">자세한 내용은 [가상 컴퓨터의 가용성 관리](../manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ac361-205">For more information, see [Manage the Availability of Virtual Machines](../manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

### <a name="failover-cluster-behavior-in-azure-networking"></a><span data-ttu-id="ac361-206">Azure 네트워킹에서 장애 조치 클러스터의 동작</span><span class="sxs-lookup"><span data-stu-id="ac361-206">Failover cluster behavior in Azure networking</span></span>
<span data-ttu-id="ac361-207">Azure에 RFC 호환이 아닌 DHCP 서비스를 사용하면 특정한 장애 조치 클러스터 구성에 오류가 발생할 수 있습니다. 클러스터 노드에 같은 IP 주소가 사용되는 것과 같이 클러스터 네트워크 이름에 중복된 IP 주소가 할당될 수 있기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-207">The non-RFC-compliant DHCP service in Azure can cause the creation of certain failover cluster configurations to fail, due to the cluster network name being assigned a duplicate IP address, such as the same IP address as one of the cluster nodes.</span></span> <span data-ttu-id="ac361-208">이는 Windows 장애 조치 클러스터 기능을 사용하는 가용성 그룹을 구현할 때 문제가 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-208">This is an issue when you implement Availability Groups, which depends on the Windows failover cluster feature.</span></span>

<span data-ttu-id="ac361-209">노드가 2개인 클러스터를 만들고 온라인 상태로 만드는 상황을 고려해 보십시오.</span><span class="sxs-lookup"><span data-stu-id="ac361-209">Consider the scenario when a two-node cluster is created and brought online:</span></span>

1. <span data-ttu-id="ac361-210">클러스터가 온라인 상태가 되면 다음 NODE1은 클러스터 네트워크 이름으로 동적 할당된 IP 주소를 요청합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-210">The cluster comes online, then NODE1 requests a dynamically assigned IP address for the cluster network name.</span></span>
2. <span data-ttu-id="ac361-211">DHCP에서 할당한 NODE1의 자체 IP 주소 외에는 다른 IP 주소가 없으므로, DHCP 서비스는 요청이 NODE1 자체에서 온 것으로 인식하게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-211">No IP address other than NODE1’s own IP address is given by the DHCP service, since the DHCP service recognizes that the request comes from NODE1 itself.</span></span>
3. <span data-ttu-id="ac361-212">Windows는 NODE1과 장애 조치 클러스터 네트워크 이름에 중복된 주소가 할당된 것으로 감지하므로 기본 클러스터 그룹이 온라인 상태가 되지 못합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-212">Windows detects that a duplicate address is assigned both to NODE1 and to the failover cluster network name, and the default cluster group fails to come online.</span></span>
4. <span data-ttu-id="ac361-213">기본 클러스터 그룹은 NODE2로 이동하게 되고, NODE1의 IP 주소를 클러스터 IP 주소로 취급하여 기본 클러스터 그룹이 온라인 상태가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-213">The default cluster group moves to NODE2, which treats NODE1’s IP address as the cluster IP address and brings the default cluster group online.</span></span>
5. <span data-ttu-id="ac361-214">NODE2가 NODE1에 연결을 시도하면 NODE1로 보내지는 패킷이 NODE1의 IP 주소 자체로 향하게 되므로 NODE2에서 출발 자체를 못합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-214">When NODE2 attempts to establish connectivity with NODE1, packets directed at NODE1 never leave NODE2 because it resolves NODE1’s IP address to itself.</span></span> <span data-ttu-id="ac361-215">따라서 NODE2는 NODE1에 연결할 수 없고 쿼럼을 잃고 클러스터를 닫게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-215">NODE2 cannot establish connectivity with NODE1, then loses quorum and shuts down the cluster.</span></span>
6. <span data-ttu-id="ac361-216">NODE1은 NODE2로 패킷을 보낼 수 있지만, NODE2는 응답할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-216">In the meantime, NODE1 can send packets to NODE2, but NODE2 cannot reply.</span></span> <span data-ttu-id="ac361-217">NODE1도 쿼럼을 잃고 클러스터를 닫습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-217">NODE1 loses quorum and shuts down the cluster.</span></span>

<span data-ttu-id="ac361-218">169.254.1.1과 같은 링크 로컬 IP 주소 등의 사용되지 않는 정적 IP 주소를 클러스터 네트워크 이름으로 할당하여 클러스터 네트워크 이름을 온라인 상태로 만들면 이러한 상황을 방지할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-218">This scenario can be avoided by assigning an unused static IP address, such as a link-local IP address like 169.254.1.1, to the cluster network name in order to bring the cluster network name online.</span></span> <span data-ttu-id="ac361-219">이 절차를 간단히 수행하려면 [Azure에서 가용성 그룹에 Windows 장애 조치 클러스터 구성](http://social.technet.microsoft.com/wiki/contents/articles/14776.configuring-windows-failover-cluster-in-windows-azure-for-alwayson-availability-groups.aspx)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ac361-219">To simplify this process, see [Configuring Windows failover cluster in Azure for availability groups](http://social.technet.microsoft.com/wiki/contents/articles/14776.configuring-windows-failover-cluster-in-windows-azure-for-alwayson-availability-groups.aspx).</span></span>

<span data-ttu-id="ac361-220">자세한 내용은 [Azure에서 가용성 그룹 구성(GUI)](virtual-machines-windows-portal-sql-alwayson-availability-groups.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ac361-220">For more information, see [Configure availability groups in Azure (GUI)](virtual-machines-windows-portal-sql-alwayson-availability-groups.md).</span></span>

### <a name="availability-group-listener-support"></a><span data-ttu-id="ac361-221">가용성 그룹 수신기 지원</span><span class="sxs-lookup"><span data-stu-id="ac361-221">Availability group listener support</span></span>
<span data-ttu-id="ac361-222">가용성 그룹 수신기는 Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2 및 Windows Server 2016에서 실행되는 Azure VM에서 지원됩니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-222">Availability group listeners are supported on Azure VMs running Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2, and Windows Server 2016.</span></span> <span data-ttu-id="ac361-223">가용성 그룹 노드인 Azure VM에서 부하 분산된 끝점을 사용하도록 설정하면 이러한 지원이 가능해집니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-223">This support is made possible by the use of load-balanced endpoints enabled on the Azure VMs that are availability group nodes.</span></span> <span data-ttu-id="ac361-224">수신기가 작동하도록 하려면 Azure에서 실행되는 클라이언트 응용 프로그램과 온-프레미스 실행되는 클라이언트 응용 프로그램 모두에 대해 특별한 구성 단계를 따라야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-224">You must follow special configuration steps for the listeners to work for both client applications that are running in Azure as well as those running on-premises.</span></span>

<span data-ttu-id="ac361-225">수신기를 설정하는 두 가지 주요 옵션(외부(공용) 및 내부)이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-225">There are two main options for setting up your listener: external (public) or internal.</span></span> <span data-ttu-id="ac361-226">외부(공용) 수신기는 인터넷 연결 부하 분산 장치를 사용하며 인터넷을 통해 액세스할 수 있는 공용 VIP(가상 IP)에 연결됩니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-226">The external (public) listener uses an internet facing load balancer and is associated with a public Virtual IP (VIP) that is accessible over the internet.</span></span> <span data-ttu-id="ac361-227">내부 수신기는 내부 부하 분산 장치를 사용하며 동일한 Virtual Network 내에 있는 클라이언트만 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-227">An internal listener uses an internal load balancer and only supports clients within the same Virtual Network.</span></span> <span data-ttu-id="ac361-228">각 부하 분산 장치 유형에 대해 Direct Server Return (DSR)을 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-228">For either load balancer type, you must enable Direct Server Return.</span></span> 

<span data-ttu-id="ac361-229">가용성 그룹이 여러 Azure 서브넷에 있는 경우(여러 Azure 지역에 배포한 경우와 같이) 클라이언트 연결 문자열에는 "**MultisubnetFailover = True**"가 포함되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-229">If the Availability Group spans multiple Azure subnets (such as a deployment that crosses Azure regions), the client connection string must include "**MultisubnetFailover=True**".</span></span> <span data-ttu-id="ac361-230">이렇게 하면 다른 서브넷에 있는 복제본에 대해 병렬 연결을 시도하게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-230">This results in parallel connection attempts to the replicas in the different subnets.</span></span> <span data-ttu-id="ac361-231">수신기 설정에 대한 지침은 다음을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ac361-231">For instructions on setting up a listener, see</span></span>

* <span data-ttu-id="ac361-232">[Azure에서 가용성 그룹에 대한 ILB 수신기 구성](virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md)</span><span class="sxs-lookup"><span data-stu-id="ac361-232">[Configure an ILB listener for availability groups in Azure](virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md).</span></span>
* <span data-ttu-id="ac361-233">[Azure에서 가용성 그룹에 대한 외부 수신기 구성](../classic/ps-sql-ext-listener.md)</span><span class="sxs-lookup"><span data-stu-id="ac361-233">[Configure an external listener for availability groups in Azure](../classic/ps-sql-ext-listener.md).</span></span>

<span data-ttu-id="ac361-234">서비스 인스턴스에 직접 연결하면 각 가용성 복제본에 개별적으로 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-234">You can still connect to each availability replica separately by connecting directly to the service instance.</span></span> <span data-ttu-id="ac361-235">또한 가용성 그룹은 데이터베이스 미러링 클라이언트와 역방향 호환이 가능하므로 복제본이 데이터베이스 미러링과 유사하게 구성된 이상 데이터베이스 미러링 파트너와 같이 가용성 복제본에 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-235">Also, since availability groups are backward compatible with database mirroring clients, you can connect to the availability replicas like database mirroring partners as long as the replicas are configured similar to database mirroring:</span></span>

* <span data-ttu-id="ac361-236">하나의 주 복제본과 하나의 보조 복제본</span><span class="sxs-lookup"><span data-stu-id="ac361-236">One primary replica and one secondary replica</span></span>
* <span data-ttu-id="ac361-237">보조 복제본은 읽을 수 없도록 구성(**읽을 수 있는 보조** 옵션을 **아니요**로 설정)</span><span class="sxs-lookup"><span data-stu-id="ac361-237">The secondary replica is configured as non-readable (**Readable Secondary** option set to **No**)</span></span>

<span data-ttu-id="ac361-238">ADO.NET 또는 SQL Server Native Client를 사용하여 데이터베이스 미러링과 유사한 이 구성에 연결하는 클라이언트 연결 문자열의 예는 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-238">An example client connection string that corresponds to this database mirroring-like configuration using ADO.NET or SQL Server Native Client is below:</span></span>

    Data Source=ReplicaServer1;Failover Partner=ReplicaServer2;Initial Catalog=AvailabilityDatabase;

<span data-ttu-id="ac361-239">클라이언트 연결에 대한 자세한 내용은 다음을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ac361-239">For more information on client connectivity, see:</span></span>

* [<span data-ttu-id="ac361-240">SQL Server Native Client와 연결 문자열 키워드 사용</span><span class="sxs-lookup"><span data-stu-id="ac361-240">Using Connection String Keywords with SQL Server Native Client</span></span>](https://msdn.microsoft.com/library/ms130822.aspx)
* [<span data-ttu-id="ac361-241">데이터베이스 미러링 세션(SQL Server)에 클라이언트 연결</span><span class="sxs-lookup"><span data-stu-id="ac361-241">Connect Clients to a Database Mirroring Session (SQL Server)</span></span>](https://technet.microsoft.com/library/ms175484.aspx)
* [<span data-ttu-id="ac361-242">하이브리드 IT 환경에서 가용성 그룹 수신기에 연결</span><span class="sxs-lookup"><span data-stu-id="ac361-242">Connecting to Availability Group Listener in Hybrid IT</span></span>](http://blogs.msdn.com/b/sqlalwayson/archive/2013/02/14/connecting-to-availability-group-listener-in-hybrid-it.aspx)
* [<span data-ttu-id="ac361-243">가용성 그룹 수신기, 클라이언트 연결 및 응용 프로그램 장애 조치(failover)(SQL Server)</span><span class="sxs-lookup"><span data-stu-id="ac361-243">Availability Group Listeners, Client Connectivity, and Application Failover (SQL Server)</span></span>](https://technet.microsoft.com/library/hh213417.aspx)
* [<span data-ttu-id="ac361-244">가용성 그룹과 데이터베이스 미러링 연결 문자열 사용</span><span class="sxs-lookup"><span data-stu-id="ac361-244">Using Database-Mirroring Connection Strings with Availability Groups</span></span>](https://technet.microsoft.com/library/hh213417.aspx)

### <a name="network-latency-in-hybrid-it"></a><span data-ttu-id="ac361-245">하이브리드 IT 환경의 네트워크 대기 시간</span><span class="sxs-lookup"><span data-stu-id="ac361-245">Network latency in hybrid IT</span></span>
<span data-ttu-id="ac361-246">HADR 솔루션을 배포할 때는 온-프레미스 네트워크와 Azure 간에 긴 네트워크 대기 시간이 있을 수 있다는 가정을 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-246">You should deploy your HADR solution with the assumption that there may be periods of time with high network latency between your on-premises network and Azure.</span></span> <span data-ttu-id="ac361-247">복제본을 Azure에 배포할 때, 동기화 모드로 동기 커밋 대신 비동기 커밋을 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-247">When deploying replicas to Azure, you should use asynchronous commit instead of synchronous commit for the synchronization mode.</span></span> <span data-ttu-id="ac361-248">온-프레미스와 Azure 모두에 데이터베이스 미러링 서버를 배포할 때는 보호 우선 모드 대신 성능 우선 모드를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-248">When deploying database mirroring servers both on-premises and in Azure, use the high-performance mode instead of the high-safety mode.</span></span>

### <a name="geo-replication-support"></a><span data-ttu-id="ac361-249">지역에서 복제 지원</span><span class="sxs-lookup"><span data-stu-id="ac361-249">Geo-replication support</span></span>
<span data-ttu-id="ac361-250">Azure 디스크의 지역 복제는 동일한 데이터베이스의 로그 파일과 데이터 파일을 별도의 디스크로 저장하는 것을 지원하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-250">Geo-replication in Azure disks does not support the data file and log file of the same database to be stored on separate disks.</span></span> <span data-ttu-id="ac361-251">GRS는 변경 내용을 독립적이고 비동기적으로 각 디스크에 복제합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-251">GRS replicates changes on each disk independently and asynchronously.</span></span> <span data-ttu-id="ac361-252">이 메커니즘은 지리적으로 복제된 복사본에서 쓰기 순서가 지켜지도록 보장하지만 여러 디스크에 지역 복제된 복사본에서는 보장하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-252">This mechanism guarantees the write order within a single disk on the geo-replicated copy, but not across geo-replicated copies of multiple disks.</span></span> <span data-ttu-id="ac361-253">데이터 파일과 로그 파일을 별도의 디스크에 저장하도록 데이터베이스를 구성하는 경우, 재해 후 복구된 디스크에는 로그 파일보다 더 최신인 데이터 파일의 복사본이 포함되어 있을 수 있어 SQL Server의 미리 기록 규칙과 트랜잭션의 ACID 특성을 어기게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-253">If you configure a database to store its data file and its log file on separate disks, the recovered disks after a disaster may contain a more up-to-date copy of the data file than the log file, which breaks the write-ahead log in SQL Server and the ACID properties of transactions.</span></span> <span data-ttu-id="ac361-254">저장소 계정에 지역 복제를 사용하지 않도록 설정할 수 있는 방법이 없을 경우 데이터베이스의 모든 데이터 및 로그 파일을 동일한 디스크에 저장해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-254">If you do not have the option to disable geo-replication on the storage account, you should keep all data and log files for a given database on the same disk.</span></span> <span data-ttu-id="ac361-255">데이터베이스의 크기 때문에 하나 이상의 디스크를 사용하는 경우 데이터의 중복성을 보장하려면 위에 나열된 재해 복구 솔루션 중 하나를 배포해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ac361-255">If you must use more than one disk due to the size of the database, you need to deploy one of the disaster recovery solutions listed above to ensure data redundancy.</span></span>

## <a name="next-steps"></a><span data-ttu-id="ac361-256">다음 단계</span><span class="sxs-lookup"><span data-stu-id="ac361-256">Next steps</span></span>
<span data-ttu-id="ac361-257">SQL Server가 포함된 Azure 가상 컴퓨터를 만들어야 한다면 [Azure에 SQL Server 가상 컴퓨터 프로비전](virtual-machines-windows-portal-sql-server-provision.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ac361-257">If you need to create an Azure virtual machine with SQL Server, see [Provisioning a SQL Server Virtual Machine on Azure](virtual-machines-windows-portal-sql-server-provision.md).</span></span>

<span data-ttu-id="ac361-258">Azure VM에서 실행되는 SQL Server에서 최상의 성능을 얻으려면 [Azure 가상 컴퓨터의 SQL Server에 대한 성능 모범 사례](virtual-machines-windows-sql-performance.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ac361-258">To get the best performance from SQL Server running on an Azure VM, see the guidance in [Performance Best Practices for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-performance.md).</span></span>

<span data-ttu-id="ac361-259">Azure VM에서의 SQL Server 실행에 관한 다른 항목은 [Azure 가상 컴퓨터의 SQL Server](virtual-machines-windows-sql-server-iaas-overview.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ac361-259">For other topics related to running SQL Server in Azure VMs, see [SQL Server on Azure Virtual Machines](virtual-machines-windows-sql-server-iaas-overview.md).</span></span>

### <a name="other-resources"></a><span data-ttu-id="ac361-260">기타 리소스</span><span class="sxs-lookup"><span data-stu-id="ac361-260">Other resources</span></span>
* [<span data-ttu-id="ac361-261">Azure에 새 Active Directory 포리스트 설치</span><span class="sxs-lookup"><span data-stu-id="ac361-261">Install a new Active Directory forest in Azure</span></span>](../../../active-directory/active-directory-new-forest-virtual-machine.md)
* [<span data-ttu-id="ac361-262">Azure VM에서 가용성 그룹을 위한 장애 조치 클러스터 만들기</span><span class="sxs-lookup"><span data-stu-id="ac361-262">Create Failover Cluster for availability groups in Azure VM</span></span>](http://gallery.technet.microsoft.com/scriptcenter/Create-WSFC-Cluster-for-7c207d3a)

