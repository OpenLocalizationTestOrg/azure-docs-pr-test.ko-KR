---
title: "Azure 가상 컴퓨터에 Windows Server Active Directory를 배포하기 위한 지침 | Microsoft Docs"
description: "온-프레미스에 AD 도메인 서비스 및 AD 페더레이션 서비스를 배포하는 방법을 아는 경우 Azure 가상 컴퓨터에서 작동하는 방법을 학습합니다."
services: active-directory
documentationcenter: 
author: femila
manager: femila
editor: 
ms.assetid: 04df4c46-e6b6-4754-960a-57b823d617fa
ms.service: active-directory
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 07/26/2017
ms.author: femila
ms.openlocfilehash: 342d9e2787add3d04f1b744152e135db98848179
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/03/2017
---
# <a name="guidelines-for-deploying-windows-server-active-directory-on-azure-virtual-machines"></a><span data-ttu-id="9cf17-103">Azure 가상 컴퓨터에 Windows Server Active Directory를 배포하기 위한 지침</span><span class="sxs-lookup"><span data-stu-id="9cf17-103">Guidelines for deploying Windows Server Active Directory on Azure virtual machines</span></span>
<span data-ttu-id="9cf17-104">이 문서에서는 Windows Server AD DS(Active Directory 도메인 서비스) 및 AD FS(Active Directory Federation Services) 온-프레미스 배포와 Microsoft Azure 가상 컴퓨터에 배포 간의 중요한 차이점을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-104">This article explains the important differences between deploying Windows Server Active Directory Domain Services (AD DS) and Active Directory Federation Services (AD FS) on-premises versus deploying them on Microsoft Azure virtual machines.</span></span>

## <a name="scope-and-audience"></a><span data-ttu-id="9cf17-105">범위 및 대상</span><span class="sxs-lookup"><span data-stu-id="9cf17-105">Scope and audience</span></span>
<span data-ttu-id="9cf17-106">이 문서는 Active Directory 온-프레미스 배포에 경험이 있는 사용자를 위한 것입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-106">The article is intended for those already experienced with deploying Active Directory on-premises.</span></span> <span data-ttu-id="9cf17-107">Microsoft Azure 가상 컴퓨터/Azure 가상 네트워크에 Active Directory 배포와 기존 온-프레미스 Active Directory 배포 간의 차이점을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-107">It covers the differences between deploying Active Directory on Microsoft Azure virtual machines/Azure virtual networks and traditional on-premises Active Directory deployments.</span></span> <span data-ttu-id="9cf17-108">Azure 가상 컴퓨터와 Azure 가상 네트워크는 클라우드에서 컴퓨팅 리소스를 활용하도록 조직에 제공하는 IaaS(Infrastructure-as-a-Service)의 일부입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-108">Azure virtual machines and Azure virtual networks are part of an Infrastructure-as-a-Service (IaaS) offering for organizations to leverage computing resources in the cloud.</span></span>

<span data-ttu-id="9cf17-109">AD 배포에 익숙하지 않은 사용자는 [AD DS 배포 가이드](https://technet.microsoft.com/library/cc753963) 또는 [AD FS 배포 계획](https://technet.microsoft.com/library/dn151324.aspx)을 적절하게 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-109">For those that are not familiar with AD deployment, see the [AD DS Deployment Guide](https://technet.microsoft.com/library/cc753963) or [Plan your AD FS deployment](https://technet.microsoft.com/library/dn151324.aspx) as appropriate.</span></span>

<span data-ttu-id="9cf17-110">이 문서에서는 독자가 다음 개념을 알고 있다고 가정합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-110">This article assumes that the reader is familiar with the following concepts:</span></span>

* <span data-ttu-id="9cf17-111">Windows Server AD DS 배포 및 관리</span><span class="sxs-lookup"><span data-stu-id="9cf17-111">Windows Server AD DS deployment and management</span></span>
* <span data-ttu-id="9cf17-112">Windows Server AD DS 인프라를 지원하도록 DNS 배포 및 구성</span><span class="sxs-lookup"><span data-stu-id="9cf17-112">Deployment and configuration of DNS to support a Windows Server AD DS infrastructure</span></span>
* <span data-ttu-id="9cf17-113">Windows Server AD FS 배포 및 관리</span><span class="sxs-lookup"><span data-stu-id="9cf17-113">Windows Server AD FS deployment and management</span></span>
* <span data-ttu-id="9cf17-114">Windows Server AD FS 토큰을 사용할 수 있는 신뢰 당사자 응용 프로그램(웹 사이트 및 웹 서비스) 배포, 구성 및 관리</span><span class="sxs-lookup"><span data-stu-id="9cf17-114">Deploying, configuring, and managing relying party applications (websites and web services) that can consume Windows Server AD FS tokens</span></span>
* <span data-ttu-id="9cf17-115">가상 컴퓨터, 가상 디스크 및 가상 네트워크를 구성하는 방법과 같은 일반적인 가상 컴퓨터 개념</span><span class="sxs-lookup"><span data-stu-id="9cf17-115">General virtual machine concepts, such as how to configure a virtual machine, virtual disks, and virtual networks</span></span>

<span data-ttu-id="9cf17-116">이 문서는 Windows Server AD DS 또는 AD FS가 온-프레미스로 부분적으로 배포되며 Azure 가상 컴퓨터에 부분적으로 배포되는 하이브리드 배포 시나리오에 대한 요구 사항을 강조 표시합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-116">This article highlights the requirements for a hybrid deployment scenario in which Windows Server AD DS or AD FS are partly deployed on-premises and partly deployed on Azure virtual machines.</span></span> <span data-ttu-id="9cf17-117">문서는 먼저 Azure 가상 컴퓨터와 온-프레미스에서 Windows Server AD DS 및 AD FS 실행 간의 중요한 차이점과 디자인 및 배포에 영향을 주는 중요한 결정 사항을 다룹니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-117">The document first covers the critical differences between running Windows Server AD DS and AD FS on Azure virtual machines versus on-premises, and important decision points that affect design and deployment.</span></span> <span data-ttu-id="9cf17-118">문서의 나머지 부분에서는 각각의 의사 결정 지점에 대한 구체적 지침 및 다양한 배포 시나리오에 지침을 적용하는 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-118">The rest of the paper explains guidelines for each of the decision points in more detail, and how to apply the guidelines to various deployment scenarios.</span></span>

<span data-ttu-id="9cf17-119">이 문서는 클라우드 응용 프로그램에 대한 ID 관리 및 액세스 제어 기능을 제공하는 REST 기반 서비스인 [Azure Active Directory](http://azure.microsoft.com/services/active-directory/)의 구성을 설명하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-119">This article does not discuss the configuration of [Azure Active Directory](http://azure.microsoft.com/services/active-directory/), which is a REST-based service that provides identity management and access control capabilities for cloud applications.</span></span> <span data-ttu-id="9cf17-120">하지만 Azure AD(Azure Active Directory) 및 Windows Server AD DS는 오늘날의 하이브리드 IT 환경 및 최신 응용 프로그램에 대한 ID 및 액세스 관리 솔루션을 제공하기 위해 함께 작동하도록 설계되었습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-120">Azure Active Directory (Azure AD) and Windows Server AD DS are, however, designed to work together to provide an identity and access management solution for today’s hybrid IT environments and modern applications.</span></span> <span data-ttu-id="9cf17-121">Windows Server AD DS와 Azure AD 간의 차이점 및 관계를 이해하려면 다음을 고려하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-121">To help understand the differences and relationships between Windows Server AD DS and Azure AD, consider the following:</span></span>

1. <span data-ttu-id="9cf17-122">Azure를 사용하여 온-프레미스 데이터 센터를 클라우드로 확장하는 경우 Azure 가상 컴퓨터의 클라우드에서 Windows Server AD DS를 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-122">You might run Windows Server AD DS in the cloud on Azure virtual machines when you are using Azure to extend your on-premises datacenter into the cloud.</span></span>
2. <span data-ttu-id="9cf17-123">Azure AD를 사용하여 사용자가 SaaS(Software-as-a-Service) 응용 프로그램에서 Single Sign-On을 사용하도록 제공할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-123">You might use Azure AD to give your users single sign-on to Software-as-a-Service (SaaS) applications.</span></span> <span data-ttu-id="9cf17-124">이 기술은 Microsoft Office 365에서 사용되며, Azure 또는 기타 클라우드 플랫폼에서 실행하는 응용 프로그램에서도 이 기술을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-124">Microsoft Office 365 uses this technology, for example, and applications running on Azure or other cloud platforms can also use it.</span></span>
3. <span data-ttu-id="9cf17-125">Azure AD(해당 액세스 제어 서비스)를 사용하여 Facebook, Google, Microsoft 및 다른 ID 공급자에게서 받은 ID를 사용하여 사용자가 클라우드 또는 온-프레미스에 호스팅된 응용 프로그램에 로그인할 수 있게 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-125">You might use Azure AD (its Access Control Service) to let users sign in using identities from Facebook, Google, Microsoft, and other identity providers to applications that are hosted in the cloud or on-premises.</span></span>

<span data-ttu-id="9cf17-126">이러한 차이점에 대한 자세한 내용은 [Azure ID](fundamentals-identity.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-126">For more information about these differences, see [Azure Identity](fundamentals-identity.md).</span></span>

## <a name="related-resources"></a><span data-ttu-id="9cf17-127">관련 리소스</span><span class="sxs-lookup"><span data-stu-id="9cf17-127">Related resources</span></span>
<span data-ttu-id="9cf17-128">[Azure 가상 컴퓨터 준비 평가](https://www.microsoft.com/download/details.aspx?id=40898)를 다운로드하고 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-128">You may download and run the [Azure Virtual Machine Readiness Assessment](https://www.microsoft.com/download/details.aspx?id=40898).</span></span> <span data-ttu-id="9cf17-129">평가는 환경을 Azure로 마이그레이션할 수 있도록 이 항목의 지침에 따라 자동으로 온-프레미스 환경을 검사하고 사용자 지정된 보고서를 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-129">The assessment will automatically inspect your on-premises environment and generate a customized report based on the guidance found in this topic to help you migrate the environment to Azure.</span></span>

<span data-ttu-id="9cf17-130">먼저 다음 항목을 설명하는 자습서, 가이드 및 비디오를 검토하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-130">We recommend that you also first review the tutorials, guides, and videos that cover the following topics:</span></span>

* [<span data-ttu-id="9cf17-131">Azure 포털에서 클라우드 전용 가상 네트워크 구성</span><span class="sxs-lookup"><span data-stu-id="9cf17-131">Configure a Cloud-Only Virtual Network in the Azure Portal</span></span>](../virtual-network/virtual-networks-create-vnet-arm-pportal.md)
* [<span data-ttu-id="9cf17-132">Azure 포털에서 사이트 간 VPN 구성</span><span class="sxs-lookup"><span data-stu-id="9cf17-132">Configure a Site-to-Site VPN in the Azure Portal</span></span>](../vpn-gateway/vpn-gateway-site-to-site-create.md)
* [<span data-ttu-id="9cf17-133">Azure 가상 네트워크에 새 Active Directory 포리스트 설치</span><span class="sxs-lookup"><span data-stu-id="9cf17-133">Install a new Active Directory forest on an Azure virtual network</span></span>](active-directory-new-forest-virtual-machine.md)
* [<span data-ttu-id="9cf17-134">Azure에서 복제 Active Directory 도메인 컨트롤러 설치</span><span class="sxs-lookup"><span data-stu-id="9cf17-134">Install a replica Active Directory domain controller on Azure</span></span>](active-directory-install-replica-active-directory-domain-controller.md)
* [<span data-ttu-id="9cf17-135">Microsoft Azure IT Pro IaaS: (01) 가상 컴퓨터 기본 사항(영문)</span><span class="sxs-lookup"><span data-stu-id="9cf17-135">Microsoft Azure IT Pro IaaS: (01) Virtual Machine Fundamentals</span></span>](https://channel9.msdn.com/Series/Windows-Azure-IT-Pro-IaaS/01)
* [<span data-ttu-id="9cf17-136">Microsoft Azure IT Pro IaaS: (05) 가상 네트워크 및 프레미스 간 연결 만들기(영문)</span><span class="sxs-lookup"><span data-stu-id="9cf17-136">Microsoft Azure IT Pro IaaS: (05) Creating Virtual Networks and Cross-Premises Connectivity</span></span>](https://channel9.msdn.com/Series/Windows-Azure-IT-Pro-IaaS/05)

## <a name="introduction"></a><span data-ttu-id="9cf17-137">소개</span><span class="sxs-lookup"><span data-stu-id="9cf17-137">Introduction</span></span>
<span data-ttu-id="9cf17-138">Azure 가상 컴퓨터에서 Windows Server Active Directory를 배포하기 위한 기본 요구 사항은 온-프레미스 가상 컴퓨터(및 어느 정도까지는 물리적 컴퓨터)에서 배포하는 경우와 아주 조금 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-138">The fundamental requirements for deploying Windows Server Active Directory on Azure virtual machines differ very little from deploying it in on-premises virtual machines (and, to some extent, physical machines).</span></span> <span data-ttu-id="9cf17-139">예를 들어 Windows Server AD DS의 경우 Azure 가상 컴퓨터에 배포하는 DC(도메인 컨트롤러)는 기존 온-프레미스 회사 도메인/포리스트에서 복제본이며 Azure 배포는 다른 모든 추가 Windows Server Active Directory 사이트를 처리하는 것과 대부분 동일한 방식으로 처리될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-139">For example, in the case of Windows Server AD DS, if the domain controllers (DCs) that you deploy on Azure virtual machines are replicas in an existing on-premises corporate domain/forest, then the Azure deployment can largely be treated in the same way as you might treat any other additional Windows Server Active Directory site.</span></span> <span data-ttu-id="9cf17-140">즉, 서브넷은 만들어진 사이트, 해당 사이트에 연결된 서브넷, Windows Server AD DS에서 정의되어야 하며 적절한 사이트 링크를 사용하여 다른 사이트에 연결되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-140">That is, subnets must be defined in Windows Server AD DS, a site created, the subnets linked to that site, and connected to other sites using appropriate site-links.</span></span> <span data-ttu-id="9cf17-141">그러나 모든 Azure 배포에 공통적인 몇 가지 차이점과 특정 배포 시나리오에 따라 다른 일부가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-141">There are, however, some differences that are common to all Azure deployments and some that vary according to the specific deployment scenario.</span></span> <span data-ttu-id="9cf17-142">두 가지 근본적인 차이점은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-142">Two fundamental differences are outlined below:</span></span>

### <a name="azure-virtual-machines-may-need-connectivity-to-the-on-premises-corporate-network"></a><span data-ttu-id="9cf17-143">Azure 가상 컴퓨터를 온-프레미스 회사 네트워크에 연결해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-143">Azure virtual machines may need connectivity to the on-premises corporate network.</span></span>
<span data-ttu-id="9cf17-144">Azure 가상 컴퓨터를 온-프레미스 회사 네트워크에 다시 연결하려면 Azure 가상 컴퓨터 및 온-프레미스 컴퓨터를 원활하게 연결할 수 있는 사이트 간 또는 사이트와 지점 간 VPN(가상 사설망) 구성 요소를 포함하는 Azure 가상 네트워크가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-144">Connecting Azure virtual machines back to an on-premises corporate network requires Azure virtual network, which includes a site-to-site or site-to-point virtual private network (VPN) component able to seamlessly connect Azure virtual machines and on-premises machines.</span></span> <span data-ttu-id="9cf17-145">이 VPN 구성 요소를 통해 온-프레미스 도메인 구성원 컴퓨터는 해당 도메인 컨트롤러가 Azure 가상 컴퓨터에 독점적으로 호스팅되는 Windows Server Active Directory 도메인에 액세스할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-145">This VPN component could also enable on-premises domain member computers to access a Windows Server Active Directory domain whose domain controllers are hosted exclusively on Azure virtual machines.</span></span> <span data-ttu-id="9cf17-146">한편 VPN에 실패하면 Windows Server Active Directory에 의존하는 인증 및 다른 작업도 또한 실패하는 것을 고려해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-146">It is important to note, though, that if the VPN fails, authentication and other operations that depend on Windows Server Active Directory will also fail.</span></span> <span data-ttu-id="9cf17-147">사용자는 기존 캐시된 자격 증명을 사용하여 로그인할 수 있는 반면 티켓이 발생되어야 하거나 유효하지 않게 된 모든 피어-투-피어 또는 클라이언트-서버 간 인증 시도는 실패합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-147">While users may be able to sign in using existing cached credentials, all peer-to-peer or client-to-server authentication attempts for which tickets have yet to be issued or have become stale will fail.</span></span>

<span data-ttu-id="9cf17-148">[Azure Portal에서 사이트 간 VPN 구성](../vpn-gateway/vpn-gateway-site-to-site-create.md)을 포함하는 단계별 자습서의 데모 비디오 및 목록은 [가상 네트워크](http://azure.microsoft.com/documentation/services/virtual-network/)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-148">See [Virtual Network](http://azure.microsoft.com/documentation/services/virtual-network/) for a demonstration video and a list of step-by-step tutorials, including [Configure a Site-to-Site VPN in the Azure portal](../vpn-gateway/vpn-gateway-site-to-site-create.md).</span></span>

> [!NOTE]
> <span data-ttu-id="9cf17-149">또한 온-프레미스 네트워크와 연결되지 않은 Azure 가상 네트워크에 Windows Server Active Directory를 배포할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-149">You can also deploy Windows Server Active Directory on an Azure virtual network that does not have connectivity with an on-premises network.</span></span> <span data-ttu-id="9cf17-150">그러나 이 항목의 지침은 Azure 가상 네트워크가 Windows Server에 필수적인 IP 주소 지정 기능을 제공하기 때문에 사용된다고 가정합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-150">The guidelines in this topic, however, assume that an Azure virtual network is used because it provides IP addressing capabilities that are essential to Windows Server.</span></span>
> 
> 

### <a name="static-ip-addresses-must-be-configured-with-azure-powershell"></a><span data-ttu-id="9cf17-151">고정 IP 주소는 Azure PowerShell을 통해 구성되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-151">Static IP addresses must be configured with Azure PowerShell.</span></span>
<span data-ttu-id="9cf17-152">동적 주소는 기본적으로 할당되지만 Set-AzureStaticVNetIP cmdlet을 사용하여 고정 IP 주소를 대신 할당합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-152">Dynamic addresses are allocated by default, but use the Set-AzureStaticVNetIP cmdlet to assign a static IP address instead.</span></span> <span data-ttu-id="9cf17-153">서비스 복구 및 VM 종료/다시 시작을 통해 유지되는 고정 IP 주소를 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-153">That sets a static IP address that will persist through service healing and VM shutdown/restart.</span></span> <span data-ttu-id="9cf17-154">자세한 내용은 [가상 컴퓨터에 대한 고정 내부 IP 주소](http://azure.microsoft.com/blog/static-internal-ip-address-for-virtual-machines/)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-154">For more information, see [Static internal IP address for virtual machines](http://azure.microsoft.com/blog/static-internal-ip-address-for-virtual-machines/).</span></span>

## <span data-ttu-id="9cf17-155"><a name="BKMK_Glossary"></a>용어 및 정의</span><span class="sxs-lookup"><span data-stu-id="9cf17-155"><a name="BKMK_Glossary"></a>Terms and definitions</span></span>
<span data-ttu-id="9cf17-156">다음은 이 문서에서 참조되는 다양한 Azure 기술에 대한 용어의 전체 목록이 아닙니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-156">The following is a non-exhaustive list of terms for various Azure technologies which will be referenced in this article.</span></span>

* <span data-ttu-id="9cf17-157">**Azure 가상 컴퓨터**: 고객이 거의 모든 기존 온-프레미스 서버 작업을 실행하는 VM을 배포할 수 있도록 허용하는 Azure에서 제공되는 IaaS.</span><span class="sxs-lookup"><span data-stu-id="9cf17-157">**Azure virtual machines**: The IaaS offering in Azure that allows customers to deploy VMs running nearly any traditionally on-premises server workload.</span></span>
* <span data-ttu-id="9cf17-158">**Azure 가상 네트워크**: 고객이 VPN(가상 사설망)을 사용하여 Azure에서 가상 네트워크를 만들고 관리하고 온-프레미스 네트워킹 인프라에 안전하게 연결할 수 있도록 하는 Azure의 네트워킹 서비스.</span><span class="sxs-lookup"><span data-stu-id="9cf17-158">**Azure virtual network**: The networking service in Azure that lets customers create and manage virtual networks in Azure and securely link them to their own on-premises networking infrastructure by using a virtual private network (VPN).</span></span>
* <span data-ttu-id="9cf17-159">**가상 IP 주소**: 특정 컴퓨터 또는 네트워크 인터페이스 카드에 바인딩되지 않은 인터넷 연결 IP 주소.</span><span class="sxs-lookup"><span data-stu-id="9cf17-159">**Virtual IP address**: An internet-facing IP address that is not bound to a specific computer or network interface card.</span></span> <span data-ttu-id="9cf17-160">클라우드 서비스는 Azure VM으로 리디렉션되는 네트워크 트래픽을 받기 위한 가상 IP 주소를 할당합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-160">Cloud services are assigned a virtual IP address for receiving network traffic which is redirected to an Azure VM.</span></span> <span data-ttu-id="9cf17-161">가상 IP 주소는 하나 이상의 Azure 가상 컴퓨터를 포함할 수 있는 클라우드 서비스의 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-161">A virtual IP address is a property of a cloud-service which can contain one or more Azure virtual machines.</span></span> <span data-ttu-id="9cf17-162">또한 Azure 가상 네트워크는 하나 이상의 클라우드 서비스를 포함할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-162">Also note that an Azure virtual network can contain one or more cloud-services.</span></span> <span data-ttu-id="9cf17-163">가상 IP 주소는 기본 부하 분산 기능을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-163">Virtual IP addresses provide native load-balancing capabilities.</span></span>
* <span data-ttu-id="9cf17-164">**동적 IP 주소**: 내부용으로만 사용되는 IP 주소입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-164">**Dynamic IP address**: This is the IP address that is internal only.</span></span> <span data-ttu-id="9cf17-165">DC/DNS 서버 역할을 호스팅하는 VM에 대한 고정 IP 주소(Set-AzureStaticVNetIP cmdlet을 사용하여)로 구성되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-165">It should be configured as a static IP address (by using the Set-AzureStaticVNetIP cmdlet) for VMs that host the DC/DNS server roles.</span></span>
* <span data-ttu-id="9cf17-166">**서비스 복구**: Azure에서 서비스가 실패했음을 감지한 후 서비스를 실행 상태로 자동으로 반환하는 프로세스.</span><span class="sxs-lookup"><span data-stu-id="9cf17-166">**Service healing**: The process in which Azure automatically returns a service to a running state again after it detects that the service has failed.</span></span> <span data-ttu-id="9cf17-167">서비스 복구는 가용성과 복원력을 지원하는 Azure의 측면 중 하나입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-167">Service healing is one of the aspects of Azure that supports availability and resiliency.</span></span> <span data-ttu-id="9cf17-168">가능성이 드물긴 하지만 VM에서 실행되는 DC에 대한 서비스 복구 인시던트에 따른 결과는 계획되지 않은 재부팅과 유사하지만 몇 가지 파생 효과가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-168">While unlikely, the result following a service healing incident for a DC running on a VM is similar to an unplanned reboot, but has a few side-effects:</span></span>
  
  * <span data-ttu-id="9cf17-169">VM의 가상 네트워크 어댑터가 변경됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-169">The virtual network adapter in the VM will change</span></span>
  * <span data-ttu-id="9cf17-170">가상 네트워크 어댑터의 MAC 주소가 변경됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-170">The MAC address of the virtual network adapter will change</span></span>
  * <span data-ttu-id="9cf17-171">VM의 프로세서/CPU ID가 변경됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-171">The Processor/CPU ID of the VM will change</span></span>
  * <span data-ttu-id="9cf17-172">가상 네트워크 어댑터의 IP 구성은 VM이 가상 네트워크에 연결되어 있고 VM의 IP 주소가 정적인 한 변경되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-172">The IP configuration of the virtual network adapter will not change as long as the VM is attached to a virtual network and the VM’s IP address is static.</span></span>
  
  <span data-ttu-id="9cf17-173">MAC 주소 또는 프로세서/CPU ID에 종속성이 없으므로 이러한 동작은 Windows Server Active Directory에 영향을 주지 않으며 Azure에서 모든 Windows Server Active Directory 배포는 위에서 설명한 대로 Azure 가상 네트워크에서 실행되는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-173">None of these behaviors affect Windows Server Active Directory because it has no dependency on the MAC address or Processor/CPU ID, and all Windows Server Active Directory deployments on Azure are recommended to be run on an Azure virtual network as outlined above.</span></span>

## <a name="is-it-safe-to-virtualize-windows-server-active-directory-domain-controllers"></a><span data-ttu-id="9cf17-174">Windows Server Active Directory 도메인 컨트롤러 가상화에 안전합니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-174">Is it safe to virtualize Windows Server Active Directory domain controllers?</span></span>
<span data-ttu-id="9cf17-175">Azure 가상 컴퓨터에 Windows Server Active Directory DC 배포는 가상 컴퓨터에서 온-프레미스로 DC를 실행하는 경우와 동일한 지침이 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-175">Deploying Windows Server Active Directory DCs on Azure virtual machines is subject to the same guidelines as running DCs on-premises in a virtual machine.</span></span> <span data-ttu-id="9cf17-176">DC 백업 및 복원을 위한 지침을 따르는 한 가상화된 DC 실행은 안전한 사례입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-176">Running virtualized DCs is a safe practice as long as guidelines for backing up and restoring DCs are followed.</span></span> <span data-ttu-id="9cf17-177">가상화된 DC를 실행하기 위한 제약 조건 및 지침에 대한 자세한 내용은 [Hyper-V에서 도메인 컨트롤러 실행](https://technet.microsoft.com/library/dd363553)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-177">For more information about constraints and guidelines for running virtualized DCs, see [Running Domain Controllers in Hyper-V](https://technet.microsoft.com/library/dd363553).</span></span>

<span data-ttu-id="9cf17-178">하이퍼바이저는 Windows Server Active Directory를 비롯한 대부분의 분산된 시스템에 문제가 발생할 수 있는 기술을 제공 또는 하찮아 보이게 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-178">Hypervisors provide or trivialize technologies that can cause problems for many distributed systems, including Windows Server Active Directory.</span></span> <span data-ttu-id="9cf17-179">예를 들어 물리적 서버에서 디스크를 복제하거나 지원되는 메서드를 사용하여 SAN 등의 사용을 비롯한 서버의 상태를 롤백할 수 있지만 물리적 서버에서 이렇게 하는 것은 하이퍼바이저에서 가상 컴퓨터 스냅숏을 복사하는 것보다 훨씬 어렵습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-179">For example, on a physical server, you can clone a disk or use unsupported methods to roll back the state of a server, including using SANs and so on, but doing that on a physical server is much harder than restoring a virtual machine snapshot in a hypervisor.</span></span> <span data-ttu-id="9cf17-180">Azure는 동일한 바람직하지 않은 조건을 가져올 수 있는 기능을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-180">Azure offers functionality that can result in the same undesirable condition.</span></span> <span data-ttu-id="9cf17-181">예를 들어 복원하면 스냅숏 복원 기능을 사용하는 경우 비슷한 상황이 발생할 수 있으므로 정기적인 백업을 수행하는 대신 DC의 VHD 파일을 복사하지 않아야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-181">For example, you should not copy VHD files of DCs instead of performing regular backups because restoring them can result in a similar situation to using snapshot restore features.</span></span>

<span data-ttu-id="9cf17-182">이러한 롤백은 DC 간에 영구적으로 달라지는 상태를 일으킬 수 있는 USN 거품을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-182">Such rollbacks introduce USN bubbles that can lead to permanently divergent states between DCs.</span></span> <span data-ttu-id="9cf17-183">다음과 같은 문제가 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-183">That can cause issues such as:</span></span>

* <span data-ttu-id="9cf17-184">느린 개체</span><span class="sxs-lookup"><span data-stu-id="9cf17-184">Lingering objects</span></span>
* <span data-ttu-id="9cf17-185">암호 불일치</span><span class="sxs-lookup"><span data-stu-id="9cf17-185">Inconsistent passwords</span></span>
* <span data-ttu-id="9cf17-186">특성 값 불일치</span><span class="sxs-lookup"><span data-stu-id="9cf17-186">Inconsistent attribute values</span></span>
* <span data-ttu-id="9cf17-187">스키마 마스터가 롤백되는 경우 스키마 불일치</span><span class="sxs-lookup"><span data-stu-id="9cf17-187">Schema mismatches if the schema master is rolled back</span></span>

<span data-ttu-id="9cf17-188">DC에 영향을 주는 방법에 대한 자세한 내용은 [USN 및 USN 롤백](https://technet.microsoft.com/library/virtual_active_directory_domain_controller_virtualization_hyperv.aspx#usn_and_usn_rollback)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-188">For more information about how DCs are impacted, see [USN and USN Rollback](https://technet.microsoft.com/library/virtual_active_directory_domain_controller_virtualization_hyperv.aspx#usn_and_usn_rollback).</span></span>

<span data-ttu-id="9cf17-189">Windows Server 2012부터는 [추가 세이프가드가 AD DS에 기본 제공됩니다](https://technet.microsoft.com/library/hh831734.aspx).</span><span class="sxs-lookup"><span data-stu-id="9cf17-189">Beginning with Windows Server 2012, [additional safeguards are built in to AD DS](https://technet.microsoft.com/library/hh831734.aspx).</span></span> <span data-ttu-id="9cf17-190">이러한 세이프가드 도움은 기본 하이퍼바이저 플랫폼이 VM-GenerationID를 지원하는 한 앞서 언급한 문제에 대해서 가상화된 도메인 컨트롤러를 보호합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-190">These safeguards help protect virtualized domain controllers against the aforementioned problems, as long as the underlying hypervisor platform supports VM-GenerationID.</span></span> <span data-ttu-id="9cf17-191">Azure는 Azure 가상 컴퓨터에서 Windows Server 2012 이상을 실행하는 도메인 컨트롤러에 추가 세이프가드가 있음을 의미하는 VM-GenerationID를 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-191">Azure supports VM-GenerationID, which means that domain controllers that run Windows Server 2012 or later on Azure virtual machines have the additional safeguards.</span></span>

> [!NOTE]
> <span data-ttu-id="9cf17-192">Azure Portal에서 **종료** 옵션을 사용하는 대신 게스트 운영 체제 내의 Azure에서 도메인 컨트롤러 역할을 실행하는 VM을 종료하고 다시 시작해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-192">You should shut down and restart a VM that runs the domain controller role in Azure within the guest operating system instead of using the **Shut Down** option in the Azure porta.</span></span> <span data-ttu-id="9cf17-193">오늘날 포털을 사용하여 VM을 종료하면 VM 할당이 취소됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-193">Today, using the portal to shut down a VM causes the VM to be deallocated.</span></span> <span data-ttu-id="9cf17-194">할당 취소된 VM은 비용이 발생하지 않는다는 장점이 있지만 DC에 바람직하지 않은 VM-GenerationID를 다시 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-194">A deallocated VM has the advantage of not incurring charges, but it also resets the VM-GenerationID, which is undesirable for a DC.</span></span> <span data-ttu-id="9cf17-195">VM-GenerationID를 다시 설정할 때 AD DS 데이터베이스의 invocationID 또한 다시 설정되며 RID 풀이 삭제되고 SYSVOL이 권한이 없는 것으로 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-195">When the VM-GenerationID is reset, the invocationID of the AD DS database is also reset, the RID pool is discarded, and SYSVOL is marked as non-authoritative.</span></span> <span data-ttu-id="9cf17-196">자세한 내용은 [AD DS(Active Directory 도메인 서비스) 가상화 소개](https://technet.microsoft.com/library/hh831734.aspx) 및 [안전하게 DFSR 가상화](http://blogs.technet.com/b/filecab/archive/2013/04/05/safely-virtualizing-dfsr.aspx)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-196">For more information, see [Introduction to Active Directory Domain Services (AD DS) Virtualization](https://technet.microsoft.com/library/hh831734.aspx) and [Safely Virtualizing DFSR](http://blogs.technet.com/b/filecab/archive/2013/04/05/safely-virtualizing-dfsr.aspx).</span></span>
> 
> 

## <a name="why-deploy-windows-server-ad-ds-on-azure-virtual-machines"></a><span data-ttu-id="9cf17-197">Azure 가상 컴퓨터에 Windows Server AD DS를 배포하는 이유는 무엇입니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-197">Why deploy Windows Server AD DS on Azure Virtual Machines?</span></span>
<span data-ttu-id="9cf17-198">많은 Windows Server AD DS 배포 시나리오는 Azure에서 VM으로 배포하기에 적합합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-198">Many Windows Server AD DS deployment scenarios are well-suited for deployment as VMs on Azure.</span></span> <span data-ttu-id="9cf17-199">예를 들어 아시아의 원격 위치에서 사용자를 인증해야 하는 회사가 유럽에 있다고 가정합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-199">For example, suppose you have a company in Europe that needs to authenticate users in a remote location in Asia.</span></span> <span data-ttu-id="9cf17-200">회사는 배포하는 비용 및 배포 후에 서버를 관리하는 데 제한된 전문 지식으로 인해 아시아에 Windows Server Active Directory DC를 이전에 배포하지 않았습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-200">The company has not previously deployed Windows Server Active Directory DCs in Asia due to the cost to deploy them and limited expertise to manage the servers post-deployment.</span></span> <span data-ttu-id="9cf17-201">결과적으로, 아시아의 인증 요청은 최적이 아닌 결과로 유럽의 DC에서 지원됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-201">As a result, authentication requests from Asia are serviced by DCs in Europe with suboptimal results.</span></span> <span data-ttu-id="9cf17-202">이 경우 아시아의 Azure 데이터 센터 내에서 실행되어야 한다고 지정한 VM에 DC를 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-202">In this case, you can deploy a DC on a VM that you have specified must be run within the Azure datacenter in Asia.</span></span> <span data-ttu-id="9cf17-203">해당 DC를 원격 위치에 직접 연결된 Azure 가상 네트워크에 연결하면 인증 성능이 향상됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-203">Attaching that DC to an Azure virtual network that is connected directly to the remote location will improve authentication performance.</span></span>

<span data-ttu-id="9cf17-204">Azure는 비용이 드는 재해 복구(DR) 사이트에 대한 대체로 적합합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-204">Azure is also well-suited as a substitute to otherwise costly disaster recovery (DR) sites.</span></span> <span data-ttu-id="9cf17-205">Azure에서 적은 수의 도메인 컨트롤러 및 단일 가상 네트워크 호스팅의 상대적으로 낮은 비용은 매력적인 대안을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-205">The relatively low-cost of hosting a small number of domain controllers and a single virtual network on Azure represents an attractive alternative.</span></span>

<span data-ttu-id="9cf17-206">마지막으로 Azure에서 SharePoint와 같은 Windows Server Active Directory가 필요하지만 온-프레미스 네트워크 또는 회사 Windows Server Active Directory에 의존하지 않는 네트워크 응용 프로그램을 배포할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-206">Finally, you may want to deploy a network application on Azure, such as SharePoint, that requires Windows Server Active Directory but has no dependency on the on-premises network or the corporate Windows Server Active Directory.</span></span> <span data-ttu-id="9cf17-207">이 경우 SharePoint 서버의 요구 사항을 충족하기 위해 Azure에서 분리된 포리스트를 배포하는 것이 최적입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-207">In this case, deploying an isolated forest on Azure to meet the SharePoint server’s requirements is optimal.</span></span> <span data-ttu-id="9cf17-208">다시 온-프레미스 네트워크와 회사 Active Directory에 대한 연결이 필요한 네트워크 응용 프로그램 배포도 지원됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-208">Again, deploying network applications that do require connectivity to the on-premises network and the corporate Active Directory is also supported.</span></span>

> [!NOTE]
> <span data-ttu-id="9cf17-209">계층-3 연결을 제공하므로 Azure 가상 네트워크와 온-프레미스 네트워크 간의 연결을 제공하는 VPN 구성 요소는 온-프레미스를 실행하는 구성원 서버가 Azure 가상 네트워크에서 Azure 가상 컴퓨터로 실행하는 DC를 활용할 수 있도록 할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-209">Since it provides a layer-3 connection, the VPN component that provides connectivity between an Azure virtual network and an on-premises network can also enable member servers that run on-premises to leverage DCs that run as Azure virtual machines on Azure virtual network.</span></span> <span data-ttu-id="9cf17-210">그러나 VPN을 사용할 수 없는 경우 온-프레미스 컴퓨터와 Azure 기반 도메인 컨트롤러 간의 통신은 작동하지 않으며 인증 및 다양한 다른 오류가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-210">But if the VPN is unavailable, communication between on-premises computers and Azure-based domain controllers will not function, resulting in authentication and various other errors.</span></span>  
> 
> 

## <a name="contrasts-between-deploying-windows-server-active-directory-domain-controllers-on-azure-virtual-machines-versus-on-premises"></a><span data-ttu-id="9cf17-211">Azure 가상 컴퓨터와 온-프레미스에 Windows Server Active Directory 도메인 컨트롤러 배포 간의 비교</span><span class="sxs-lookup"><span data-stu-id="9cf17-211">Contrasts between deploying Windows Server Active Directory domain controllers on Azure Virtual Machines versus on-premises</span></span>
* <span data-ttu-id="9cf17-212">단일 VM을 두 개 이상 포함하는 모든 Windows Server Active Directory 배포 시나리오의 경우 IP 주소 일관성을 위해 Azure 가상 네트워크를 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-212">For any Windows Server Active Directory deployment scenario that includes more than a single VM, it is necessary to use an Azure virtual network for IP address consistency.</span></span> <span data-ttu-id="9cf17-213">이 가이드에서는 DC가 Azure 가상 네트워크에서 실행 중임을 가정합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-213">Note that this guide assumes that DCs are running on an Azure virtual network.</span></span>
* <span data-ttu-id="9cf17-214">온-프레미스 DC와 마찬가지로 고정 IP 주소를 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-214">As with on-premises DCs, static IP addresses are recommended.</span></span> <span data-ttu-id="9cf17-215">고정 IP 주소는 Azure PowerShell을 사용하여 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-215">A static IP address can only be configured by using Azure PowerShell.</span></span> <span data-ttu-id="9cf17-216">자세한 내용은 [VM에 대한 고정 내부 IP 주소](http://azure.microsoft.com/blog/static-internal-ip-address-for-virtual-machines/) 를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-216">See [Static internal IP address for VMs](http://azure.microsoft.com/blog/static-internal-ip-address-for-virtual-machines/) for more details.</span></span> <span data-ttu-id="9cf17-217">모니터링 시스템 또는 게스트 운영 체제 내에서 고정 IP 주소 구성을 확인하는 다른 솔루션이 있는 경우 VM의 네트워크 어댑터 속성에 동일한 고정 IP 주소를 할당할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-217">If you have monitoring systems or other solutions that check for static IP address configuration within the guest operating system, you can assign the same static IP address to the network adapter properties of the VM.</span></span> <span data-ttu-id="9cf17-218">하지만 VM이 서비스 복구를 받거나 포털에서 종료되고 해당 주소가 할당 취소되는 경우 네트워크 어댑터가 삭제됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-218">But be aware that the network adapter will be discarded if the VM undergoes service healing or is shut down in the portal and has its address deallocated.</span></span> <span data-ttu-id="9cf17-219">이 경우 게스트 내의 고정 IP 주소를 다시 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-219">In that case, the static IP address within the guest will need to be reset.</span></span>
* <span data-ttu-id="9cf17-220">가상 네트워크에 VM 배포는 온-프레미스 네트워크에 다시 연결하는 것을 의미(요구)하지 않습니다. 가상 네트워크는 단순히 해당 가능성을 활성화합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-220">Deploying VMs on a virtual network does not imply (or require) connectivity back to an on-premises network; the virtual network merely enables that possibility.</span></span> <span data-ttu-id="9cf17-221">Azure와 온-프레미스 네트워크 간의 개인 통신에 대한 가상 네트워크를 만들어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-221">You must create a virtual network for private communication between Azure and your on-premises network.</span></span> <span data-ttu-id="9cf17-222">온-프레미스 네트워크에 VPN 끝점을 배포해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-222">You need to deploy a VPN endpoint on the on-premises network.</span></span> <span data-ttu-id="9cf17-223">VPN은 Azure에서 온-프레미스 네트워크로 열립니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-223">The VPN is opened from Azure to the on-premises network.</span></span> <span data-ttu-id="9cf17-224">자세한 내용은 [가상 네트워크 개요](../virtual-network/virtual-networks-overview.md) 및 [Azure Portal에서 사이트 간 VPN 구성](../vpn-gateway/vpn-gateway-site-to-site-create.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-224">For more information, see [Virtual Network Overview](../virtual-network/virtual-networks-overview.md) and [Configure a Site-to-Site VPN in the Azure Portal](../vpn-gateway/vpn-gateway-site-to-site-create.md).</span></span>

> [!NOTE]
> <span data-ttu-id="9cf17-225">[지점 및 사이트 간 VPN 만들기](../vpn-gateway/vpn-gateway-point-to-site-create.md) 에 대한 옵션은 개별 Windows 기반 컴퓨터를 Azure 가상 네트워크에 직접 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-225">An option to [create a point-to-site VPN](../vpn-gateway/vpn-gateway-point-to-site-create.md) is available to connect individual Windows-based computers directly to an Azure virtual network.</span></span>
> 
> 

* <span data-ttu-id="9cf17-226">가상 네트워크를 만드는지 여부에 관계 없이 Azure는 송신 트래픽에 대한 요금을 청구하지만 하지만 수신 트래픽에 대한 요금을 청구하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-226">Regardless of whether you create a virtual network or not, Azure charges for egress traffic but not ingress.</span></span> <span data-ttu-id="9cf17-227">다양한 Windows Server Active Directory 디자인 선택은 배포에서 생성되는 송신 트래픽의 양에 영향을 줄 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-227">Various Windows Server Active Directory design choices can affect how much egress traffic is generated by a deployment.</span></span> <span data-ttu-id="9cf17-228">예를 들어 읽기 전용 도메인 컨트롤러(RODC) 배포는 아웃바운드를 복제하지 않으므로 송신 트래픽을 제한합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-228">For example, deploying a read-only domain controller (RODC) limits egress traffic because it does not replicate outbound.</span></span> <span data-ttu-id="9cf17-229">그러나 RODC를 배포하는 결정은 DC 및 사이트의 응용 프로그램 및 서비스가 RODC와 함께 가진 [호환성](https://technet.microsoft.com/library/cc755190) 에 대해 쓰기 작업을 수행할 필요성에 대한 고려가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-229">But the decision to deploy an RODC needs to be weighed against the need to perform write operations against the DC and the [compatibility](https://technet.microsoft.com/library/cc755190) that applications and services in the site have with RODCs.</span></span> <span data-ttu-id="9cf17-230">트래픽 요금에 대한 자세한 내용은 [Azure 가격 개요](http://azure.microsoft.com/pricing/)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-230">For more information about traffic charges, see [Azure pricing at-a-glance](http://azure.microsoft.com/pricing/).</span></span>
* <span data-ttu-id="9cf17-231">Azure에서 RAM, 디스크 크기 등과 같은 VM 온-프레미스에 사용할 서버 리소스를 완전히 제어할 수 있지만 미리 구성된 서버 크기의 목록에서 선택해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-231">While you have complete control over what server resources to use for VMs on-premises, such as RAM, disk size, and so on, on Azure you must select from a list of preconfigured server sizes.</span></span> <span data-ttu-id="9cf17-232">DC의 경우 Windows Server Active Directory 데이터베이스를 저장하기 위해 운영 체제 디스크 외에도 데이터 디스크가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-232">For a DC, a data disk is needed in addition to the operating system disk in order to store the Windows Server Active Directory database.</span></span>

## <a name="can-you-deploy-windows-server-ad-fs-on-azure-virtual-machines"></a><span data-ttu-id="9cf17-233">Azure 가상 컴퓨터에 Windows Server AD FS를 배포할 수 있습니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-233">Can you deploy Windows Server AD FS on Azure virtual machines?</span></span>
<span data-ttu-id="9cf17-234">예, Azure 가상 컴퓨터에 Windows Server AD FS를 배포할 수 있으며 온-프레미스에서 [AD FS 배포에 대한 모범 사례](https://technet.microsoft.com/library/dn151324.aspx) 는 Azure에서 AD FS 배포에 동일하게 적용합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-234">Yes, you can deploy Windows Server AD FS on Azure virtual machines, and the [best practices for AD FS deployment](https://technet.microsoft.com/library/dn151324.aspx) on-premises apply equally to AD FS deployment on Azure.</span></span> <span data-ttu-id="9cf17-235">하지만 부하 분산 및 고가용성 기능과 같은 몇 가지 모범 사례는 AD FS가 제공하는 이상의 기술이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-235">But some of the best practices such as load balancing and high availability require technologies beyond what AD FS offers itself.</span></span> <span data-ttu-id="9cf17-236">기본 인프라에서 제공되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-236">They must be provided by the underlying infrastructure.</span></span> <span data-ttu-id="9cf17-237">몇 가지 모범 사례를 검토하고 Azure VM 및 Azure 가상 네트워크를 사용하여 실현할 수 있는 방법을 살펴 보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-237">Let’s review some of those best practices and see how they can be achieved by using Azure VMs and an Azure virtual network.</span></span>

1. <span data-ttu-id="9cf17-238">**STS(보안 토큰 서비스) 서버를 인터넷에 직접 노출하지 마세요.**</span><span class="sxs-lookup"><span data-stu-id="9cf17-238">**Never expose security token service (STS) servers directly to the Internet.**</span></span>
   
    <span data-ttu-id="9cf17-239">STS는 보안 토큰을 발급하기 때문에 이것은 중요합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-239">This is important because the STS issues security tokens.</span></span> <span data-ttu-id="9cf17-240">결과적으로 AD FS 서버와 같은 STS 서버는 도메인 컨트롤러로 동일한 수준의 보호로 처리되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-240">As a result, STS servers such as AD FS servers should be treated with the same level of protection as a domain controller.</span></span> <span data-ttu-id="9cf17-241">STS가 손상되면 악의적인 사용자가 신뢰 당사자 응용 프로그램과 신뢰 조직의 다른 STS 서버를 선택할 권리를 잠재적으로 포함하는 액세스 토큰을 발급할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-241">If an STS is compromised, malicious users have the ability to issue access tokens potentially containing claims of their choosing to relying party applications and other STS servers in trusting organizations.</span></span>
2. <span data-ttu-id="9cf17-242">**AD FS 서버와 동일한 네트워크의 모든 사용자 도메인에 대한 Active Directory 도메인 컨트롤러를 배포합니다.**</span><span class="sxs-lookup"><span data-stu-id="9cf17-242">**Deploy Active Directory domain controllers for all user domains in the same network as the AD FS servers.**</span></span>
   
    <span data-ttu-id="9cf17-243">AD FS 서버는 Active Directory 도메인 서비스를 사용하여 사용자를 인증합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-243">AD FS servers use Active Directory Domain Services to authenticate users.</span></span> <span data-ttu-id="9cf17-244">AD FS 서버와 동일한 네트워크에서 도메인 컨트롤러를 배포하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-244">It is recommended to deploy domain controllers on the same network as the AD FS servers.</span></span> <span data-ttu-id="9cf17-245">Azure 네트워크와 온-프레미스 네트워크 간의 링크가 중단된 경우 비즈니스 연속성을 제공하고 로그인에 대한 낮은 대기 시간 및 향상된 성능을 가능하게 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-245">This provides business continuity in case the link between the Azure network and your on-premises network is broken, and enables lower latency and increased performance for logins.</span></span>
3. <span data-ttu-id="9cf17-246">**고가용성 및 부하 분산에 대한 여러 AD FS 노드를 배포합니다.**</span><span class="sxs-lookup"><span data-stu-id="9cf17-246">**Deploy multiple AD FS nodes for high availability and balancing the load.**</span></span>
   
    <span data-ttu-id="9cf17-247">대부분의 경우에서 보안 토큰이 필요한 응용 프로그램이 종종 중요 업무용이기 때문에 AD FS가 활성화하는 응용 프로그램의 오류는 허용할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-247">In most cases, the failure of an application that AD FS enables is unacceptable because the applications that require security tokens are often mission critical.</span></span> <span data-ttu-id="9cf17-248">결과적으로 AD FS는 이제 중요 업무용 응용 프로그램에 액세스하는 요주의 경로에 있기 때문에 AD FS 서비스는 여러 AD FS 프록시 및 AD FS 서버를 통해 항상 사용 가능해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-248">As a result, and because AD FS now resides in the critical path to accessing mission critical applications, the AD FS service must be highly available through multiple AD FS proxies and AD FS servers.</span></span> <span data-ttu-id="9cf17-249">요청의 배포를 위해 부하 분산 장치는 일반적으로 AD FS 프록시 및 AD FS 서버 앞에 배포됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-249">To achieve distribution of requests, load balancers are typically deployed in front of both the AD FS Proxies and the AD FS servers.</span></span>
4. <span data-ttu-id="9cf17-250">**인터넷 액세스에 대한 하나 이상의 웹 응용 프로그램 프록시 노드를 배포합니다.**</span><span class="sxs-lookup"><span data-stu-id="9cf17-250">**Deploy one or more Web Application Proxy nodes for internet access.**</span></span>
   
    <span data-ttu-id="9cf17-251">사용자가 AD FS 서비스에 의해 보호되는 응용 프로그램에 액세스해야 하는 경우 AD FS 서비스는 인터넷을 통해 사용할 수 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-251">When users need to access applications protected by the AD FS service, the AD FS service needs to be available from the internet.</span></span> <span data-ttu-id="9cf17-252">이는 웹 응용 프로그램 프록시 서비스를 배포하여 수행됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-252">This is achieved by deploying the Web Application Proxy service.</span></span> <span data-ttu-id="9cf17-253">고가용성 및 부하 분산을 위해 둘 이상의 노드를 배포하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-253">It is strongly recommended to deploy more than one node for the purposes of high availability and load balancing.</span></span>
5. <span data-ttu-id="9cf17-254">**웹 응용 프로그램 프록시 노드에서 내부 네트워크 리소스에 액세스를 제한합니다.**</span><span class="sxs-lookup"><span data-stu-id="9cf17-254">**Restrict access from the Web Application Proxy nodes to internal network resources.**</span></span>
   
    <span data-ttu-id="9cf17-255">외부 사용자가 인터넷에서 AD FS에 액세스할 수 있도록 허용하려면 웹 응용 프로그램 프록시 노드(또는 Windows Server의 이전 버전에서 AD FS 프록시)를 배포해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-255">To allow external users to access AD FS from the internet, you need to deploy Web Application Proxy nodes (or AD FS Proxy in earlier versions of Windows Server).</span></span> <span data-ttu-id="9cf17-256">웹 응용 프로그램 프록시 노드는 인터넷에 직접 노출됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-256">The Web Application proxy nodes are directly exposed to the Internet.</span></span> <span data-ttu-id="9cf17-257">도메인에 가입할 필요가 없으며 TCP 포트 443 및 80을 통해 AD FS 서버에 대한 액세스 권한만 있으면 됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-257">They are not required to be domain-joined and they only need access to the AD FS servers over TCP ports 443 and 80.</span></span> <span data-ttu-id="9cf17-258">다른 모든 컴퓨터(특히 도메인 컨트롤러)에 대한 해당 통신은 차단되는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-258">It is strongly recommended that communication to all other computers (especially domain controllers) is blocked.</span></span>
   
    <span data-ttu-id="9cf17-259">이는 일반적으로 DMZ를 통해 온-프레미스에서 수행됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-259">This is typically achieved on-premises by means of a DMZ.</span></span> <span data-ttu-id="9cf17-260">방화벽은 작업의 허용 목록 모드를 사용하여 온-프레미스 네트워크에 대한 DMZ의 트래픽을 제한합니다.(즉, 지정된 IP 주소 및 지정된 포트를 통한 트래픽은 허용되고 다른 모든 트래픽은 차단됩니다.)</span><span class="sxs-lookup"><span data-stu-id="9cf17-260">Firewalls use a whitelist mode of operation to restrict traffic from the DMZ to the on-premises network (that is, only traffic from the specified IP addresses and over specified ports is allowed, and all other traffic is blocked).</span></span>

<span data-ttu-id="9cf17-261">다음 다이어그램은 기존의 온-프레미스 AD FS 배포를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-261">The following diagram shows a traditional on-premises AD FS deployment.</span></span>

![기존의 온-프레미스 Active Directory Federation Services 배포 다이어그램](media/active-directory-deploying-ws-ad-guidelines/ADFS_onprem.png)

<span data-ttu-id="9cf17-263">그러나 Azure는 기본으로 완전한 기능의 방화벽 기능을 제공하지 않으므로 트래픽을 제한하는 데 다른 옵션을 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-263">However, because Azure does not provide native, full-featured firewall capability, other options need to be used to restrict traffic.</span></span> <span data-ttu-id="9cf17-264">다음 표는 각 옵션 및 해당 장점 및 단점을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-264">The following table shows each option and its advantages and disadvantages.</span></span>

| <span data-ttu-id="9cf17-265">옵션</span><span class="sxs-lookup"><span data-stu-id="9cf17-265">Option</span></span> | <span data-ttu-id="9cf17-266">장점</span><span class="sxs-lookup"><span data-stu-id="9cf17-266">Advantage</span></span> | <span data-ttu-id="9cf17-267">단점</span><span class="sxs-lookup"><span data-stu-id="9cf17-267">Disadvantage</span></span> |
| --- | --- | --- |
| [<span data-ttu-id="9cf17-268">Azure 네트워크 ACL</span><span class="sxs-lookup"><span data-stu-id="9cf17-268">Azure network ACLs</span></span>](../virtual-network/virtual-networks-acl.md) |<span data-ttu-id="9cf17-269">보다 저렴하고 간단한 초기 구성</span><span class="sxs-lookup"><span data-stu-id="9cf17-269">Less costly and simpler initial configuration</span></span> |<span data-ttu-id="9cf17-270">새 VM이 배포에 추가된 경우 필요한 추가 네트워크 ACL 구성</span><span class="sxs-lookup"><span data-stu-id="9cf17-270">Additional network ACL configuration required if any new VMs are added to the deployment</span></span> |
| [<span data-ttu-id="9cf17-271">Barracuda NG 방화벽</span><span class="sxs-lookup"><span data-stu-id="9cf17-271">Barracuda NG firewall</span></span>](https://www.barracuda.com/products/ngfirewall) |<span data-ttu-id="9cf17-272">작업의 허용 목록 모드 및 네트워크 ACL 구성이 필요하지 않음</span><span class="sxs-lookup"><span data-stu-id="9cf17-272">Whitelist mode of operation and it requires no network ACL configuration</span></span> |<span data-ttu-id="9cf17-273">초기 설치에 대한 증가된 비용 및 복잡성</span><span class="sxs-lookup"><span data-stu-id="9cf17-273">Increased cost and complexity for initial setup</span></span> |

<span data-ttu-id="9cf17-274">이 경우 AD FS를 배포하는 대략적인 단계는 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-274">The high-level steps to deploy AD FS in this case are as follows:</span></span>

1. <span data-ttu-id="9cf17-275">VPN 또는 [ExpressRoute](http://azure.microsoft.com/services/expressroute/)를 사용하여 크로스-프레미스 연결로 가상 네트워크를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-275">Create a virtual network with cross-premises connectivity, using either a VPN or [ExpressRoute](http://azure.microsoft.com/services/expressroute/).</span></span>
2. <span data-ttu-id="9cf17-276">가상 네트워크에 도메인 컨트롤러를 배포합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-276">Deploy domain controllers on the virtual network.</span></span> <span data-ttu-id="9cf17-277">이 단계는 선택 사항이지만 권장됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-277">This step is optional but recommended.</span></span>
3. <span data-ttu-id="9cf17-278">가상 네트워크에 도메인에 가입된 AD FS 서버를 배포합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-278">Deploy domain-joined AD FS servers on the virtual network.</span></span>
4. <span data-ttu-id="9cf17-279">AD FS 서버를 포함하고 가상 네트워크(동적 IP 주소) 내에서 새로운 개인 IP 주소를 사용하는 [내부 부하 분산 집합](http://azure.microsoft.com/blog/internal-load-balancing/) 을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-279">Create an [internal load balanced set](http://azure.microsoft.com/blog/internal-load-balancing/) that includes the AD FS servers and uses a new private IP address within the virtual network (a dynamic IP address).</span></span>
   
   1. <span data-ttu-id="9cf17-280">DNS를 업데이트하여 내부 부하 분산 집합의 개인(동적) IP 주소를 가리키는 FQDN을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-280">Update DNS to create the FQDN to point to the private (dynamic) IP address of the internal load balanced set.</span></span>
5. <span data-ttu-id="9cf17-281">웹 응용 프로그램 프록시 노드에 대한 클라우드 서비스(또는 별도 가상 네트워크)를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-281">Create a cloud service (or a separate virtual network) for the Web Application Proxy nodes.</span></span>
6. <span data-ttu-id="9cf17-282">클라우드 서비스 또는 가상 네트워크에 웹 응용 프로그램 프록시 노드를 배포합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-282">Deploy the Web Application Proxy nodes in the cloud service or virtual network</span></span>
   
   1. <span data-ttu-id="9cf17-283">웹 응용 프로그램 프록시 노드를 포함하는 외부 부하 분산 집합을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-283">Create an external load balanced set that includes the Web Application Proxy nodes.</span></span>
   2. <span data-ttu-id="9cf17-284">외부 DNS 이름(FQDN)을 업데이트하여 클라우드 서비스 공용 IP 주소(가상 IP 주소)를 가리킵니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-284">Update the external DNS name (FQDN) to point to the cloud service public IP address (the virtual IP address).</span></span>
   3. <span data-ttu-id="9cf17-285">AD FS 프록시를 구성하여 AD FS 서버에 대한 내부 부하 분산 집합에 해당하는 FQDN을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-285">Configure AD FS proxies to use the FQDN that corresponds to the internal load balanced set for the AD FS servers.</span></span>
   4. <span data-ttu-id="9cf17-286">클레임 기반 웹 사이트를 업데이트하여 클레임 공급자에 대한 외부 FQDN을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-286">Update claims-based web sites to use the external FQDN for their claims provider.</span></span>
7. <span data-ttu-id="9cf17-287">AD FS 가상 네트워크의 모든 컴퓨터에 웹 응용 프로그램 프록시 간의 액세스를 제한합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-287">Restrict access between Web Application Proxy to any machine in the AD FS virtual network.</span></span>

<span data-ttu-id="9cf17-288">트래픽을 제한하려면 Azure 내부 부하 분산 장치에 대한 부하 분산 집합은 TCP 포트 80 및 443에 대한 트래픽만을 위해 구성되어야 하고 부하 분산 집합의 내부 동적 IP 주소에 대한 다른 모든 트래픽은 삭제됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-288">To restrict traffic, the load-balanced set for the Azure internal load balancer needs to be configured for only traffic to TCP ports 80 and 443, and all other traffic to the internal dynamic IP address of the load balanced set is dropped.</span></span>

![TCP 443 + 80 허용으로 ADFS 네트워크 ACL의 다이어그램.](media/active-directory-deploying-ws-ad-guidelines/ADFS_ACLs.png)

<span data-ttu-id="9cf17-290">AD FS 서버에 대한 트래픽은 다음 원본을 통해서만 허용됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-290">Traffic to the AD FS servers would be permitted only by the following sources:</span></span>

* <span data-ttu-id="9cf17-291">Azure 내부 부하 분산 장치.</span><span class="sxs-lookup"><span data-stu-id="9cf17-291">The Azure internal load balancer.</span></span>
* <span data-ttu-id="9cf17-292">온-프레미스 네트워크에서 관리자의 IP 주소.</span><span class="sxs-lookup"><span data-stu-id="9cf17-292">The IP address of an administrator on the on-premises network.</span></span>

> [!WARNING]
> <span data-ttu-id="9cf17-293">디자인은 웹 응용 프로그램 프록시 노드가 Azure 가상 네트워크 또는 온-프레미스 네트워크의 모든 위치에 있는 다른 모든 VM에 연결되지 못하도록 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-293">The design must prevent Web Application Proxy nodes from reaching any other VMs in the Azure virtual network or any locations on the on-premises network.</span></span> <span data-ttu-id="9cf17-294">Express 경로 연결용 온-프레미스 어플라이언스 또는 사이트 간 VPN 연결에 대한 VPN 장치에서 방화벽 규칙을 구성하여 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-294">That can be done by configuring firewall rules in the on-premises appliance for Express Route connections or the VPN device for site-to-site VPN connections.</span></span>
> 
> 

<span data-ttu-id="9cf17-295">이 옵션의 단점은 내부 부하 분산 장치, AD FS 서버 및 가상 네트워크에 추가하는 기타 서버를 포함하여 여러 장치에 대해 네트워크 ACL을 구성해야 한다는 점입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-295">A disadvantage to this option is the need to configure the network ACLs for multiple devices, including internal load balancer, the AD FS servers, and any other servers that get added to the virtual network.</span></span> <span data-ttu-id="9cf17-296">트래픽을 제한하도록 네트워크 ACL을 구성하지 않고 장치가 배포에 추가된 경우 전체 배포는 위험에 노출될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-296">If any device is added to the deployment without configuring network ACLs to restrict traffic to it, the entire deployment can be at risk.</span></span> <span data-ttu-id="9cf17-297">웹 응용 프로그램 프록시 노드의 IP 주소를 변경하는 경우 네트워크 ACL을 다시 설정해야 합니다(즉, 프록시는 [정적 동적 IP 주소](http://azure.microsoft.com/blog/static-internal-ip-address-for-virtual-machines/)를 사용하도록 구성되어야 함).</span><span class="sxs-lookup"><span data-stu-id="9cf17-297">If the IP addresses of the Web Application Proxy nodes ever change, the network ACLs must be reset (which means the proxies should be configured to use [static dynamic IP addresses](http://azure.microsoft.com/blog/static-internal-ip-address-for-virtual-machines/)).</span></span>

![네트워크 ACLS를 사용한 Azure의 ADFS.](media/active-directory-deploying-ws-ad-guidelines/ADFS_Azure.png)

<span data-ttu-id="9cf17-299">다른 옵션은 AD FS 프록시 서버와 AD FS 서버 간의 트래픽을 제어하는 [Barracuda NG Firewall](https://www.barracuda.com/products/ngfirewall) 어플라이언스를 사용하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-299">Another option is to use the [Barracuda NG Firewall](https://www.barracuda.com/products/ngfirewall) appliance to control traffic between AD FS proxy servers and the AD FS servers.</span></span> <span data-ttu-id="9cf17-300">이 옵션은 보안 및 고가용성을 위해 모범 사례를 준수하며 Barracuda NG Firewall 어플라이언스는 방화벽 관리의 허용 목록 모드를 제공하고 Azure 가상 네트워크에 직접 설치할 수 있으므로 초기 설치 후 적은 관리가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-300">This option complies with best practices for security and high availability, and requires less administration after the initial setup because the Barracuda NG Firewall appliance provides a whitelist mode of firewall administration and it can be installed directly on an Azure virtual network.</span></span> <span data-ttu-id="9cf17-301">새 서버가 배포에 추가될 때마다 네트워크 ACL을 구성하지 않아도 됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-301">That eliminates the need to configure network ACLs any time a new server is added to the deployment.</span></span> <span data-ttu-id="9cf17-302">하지만 이 옵션은 초기 배포의 복잡성과 비용이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-302">But this option adds initial deployment complexity and cost.</span></span>

<span data-ttu-id="9cf17-303">이 경우 두 개의 가상 네트워크가 하나 대신 배포됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-303">In this case, two virtual networks are deployed instead of one.</span></span> <span data-ttu-id="9cf17-304">이를 VNet1 및 VNet2라고 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-304">We'll call them VNet1 and VNet2.</span></span> <span data-ttu-id="9cf17-305">VNet1은 프록시를 포함하고 VNet2는 STS와 회사 네트워크로의 네트워크 연결을 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-305">VNet1 contains the proxies and VNet2 contains the STSs and the network connection back to the corporate network.</span></span> <span data-ttu-id="9cf17-306">따라서 VNet1은 차례로 VNet2와 회사 네트워크에서 물리적으로(비록 가상일지라도) 분리됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-306">VNet1 is therefore physically (albeit virtually) isolated from VNet2 and, in turn, from the corporate network.</span></span> <span data-ttu-id="9cf17-307">VNet1은 TINA(전송 독립 네트워크 아키텍처)라는 특수 터널링 기술을 사용하여 VNet2에 연결됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-307">VNet1 is then connected to VNet2 using a special tunneling technology known as Transport Independent Network Architecture (TINA).</span></span> <span data-ttu-id="9cf17-308">TINA 터널은 가상 네트워크 각각에서 하나의 Barracuda로 Barracuda NG 방화벽을 사용하여 가상 네트워크 각각에 연결됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-308">The TINA tunnel is attached to each of the virtual networks using a Barracuda NG firewall—one Barracuda on each of the virtual networks.</span></span>  <span data-ttu-id="9cf17-309">고가용성을 위해 각 가상 네트워크에 하나는 활성으로 하나는 수동으로 두 개의 Barracudas를 배포하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-309">For high-availability, it is recommended that you deploy two Barracudas on each virtual network; one active, the other passive.</span></span> <span data-ttu-id="9cf17-310">Azure에서 기존 온-프레미스 DMZ의 작업을 모방할 수 있는 매우 효율적인 방화벽 기능을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-310">They offer extremely rich firewalling capabilities which allow us to mimic the operation of a traditional on-premises DMZ in Azure.</span></span>

![방화벽을 사용한 Azure의 ADFS.](media/active-directory-deploying-ws-ad-guidelines/ADFS_Azure_firewall.png)

<span data-ttu-id="9cf17-312">자세한 내용은 [AD FS: 인터넷으로 클레임 인식 온-프레미스 프런트 엔드 응용 프로그램 확장](#BKMK_CloudOnlyFed)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-312">For more information, see [AD FS: Extend a claims-aware on-premises front-end application to the Internet](#BKMK_CloudOnlyFed).</span></span>

### <a name="an-alternative-to-ad-fs-deployment-if-the-goal-is-office-365-sso-alone"></a><span data-ttu-id="9cf17-313">목표가 Office 365 SSO만인 경우 AD FS 배포에 대한 대안</span><span class="sxs-lookup"><span data-stu-id="9cf17-313">An alternative to AD FS deployment if the goal is Office 365 SSO alone</span></span>
<span data-ttu-id="9cf17-314">목표가 오직 Office 365에 대한 로그인을 활성화하는 것인 경우 AD FS를 함께 배포하는 다른 대안이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-314">There is another alternative to deploying AD FS altogether if your goal is only to enable sign-in for Office 365.</span></span> <span data-ttu-id="9cf17-315">해당 경우 이 방법은 AD FS 또는 Azure가 필요하지 않으므로 단순히 암호 동기화 온-프레미스를 사용하여 DirSync를 배포하고 최소 배포 복잡성으로 동일한 최종 결과를 얻을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-315">In that case, you can simply deploy DirSync with password sync on-premises and achieve the same end-result with minimal deployment complexity because this approach does not require AD FS or Azure.</span></span>

<span data-ttu-id="9cf17-316">다음 표는 AD FS 배포로 및 AD FS 배포 없이 로그인 프로세스 작동 방법을 비교합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-316">The following table compares how the sign-in processes work with and without deploying AD FS.</span></span>

| <span data-ttu-id="9cf17-317">AD FS 및 DirSync를 사용하여 Office 365 Single Sign-On</span><span class="sxs-lookup"><span data-stu-id="9cf17-317">Office 365 single sign-on using AD FS and DirSync</span></span> | <span data-ttu-id="9cf17-318">DirSync + 암호 동기화를 사용하여 Office 365 동일한 로그온</span><span class="sxs-lookup"><span data-stu-id="9cf17-318">Office 365 same sign-on using DirSync + Password Sync</span></span> |
| --- | --- |
| <span data-ttu-id="9cf17-319">1. 사용자는 회사 네트워크에 로그온하고 Windows Server Active Directory에 인증됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-319">1. The user logs on to a corporate network, and is authenticated to Windows Server Active Directory.</span></span> |<span data-ttu-id="9cf17-320">1. 사용자는 회사 네트워크에 로그온하고 Windows Server Active Directory에 인증됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-320">1. The user logs on to a corporate network, and is authenticated to Windows Server Active Directory.</span></span> |
| <span data-ttu-id="9cf17-321">2. 사용자(@contoso.com)는 Office 365에 액세스하려고 시도합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-321">2. The user tries to access Office 365 (I am @contoso.com).</span></span> |<span data-ttu-id="9cf17-322">2. 사용자(@contoso.com)는 Office 365에 액세스하려고 시도합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-322">2. The user tries to access Office 365 (I am @contoso.com).</span></span> |
| <span data-ttu-id="9cf17-323">3. Office 365는 Azure AD에 사용자를 리디렉션합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-323">3. Office 365 redirects the user to Azure AD.</span></span> |<span data-ttu-id="9cf17-324">3. Office 365는 Azure AD에 사용자를 리디렉션합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-324">3. Office 365 redirects the user to Azure AD.</span></span> |
| <span data-ttu-id="9cf17-325">4. Azure AD는 사용자를 인증할 수 없으므로 AD FS 온-프레미스와 트러스트가 있음을 이해하고 사용자를 AD FS로 리디렉션합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-325">4. Since Azure AD can’t authenticate the user and understands there is a trust with AD FS on-premises, it redirects the user to AD FS.</span></span> |<span data-ttu-id="9cf17-326">4. Azure AD는 Kerberos 티켓을 직접 수락할 수 없고 트러스트 관계가 없으므로 사용자가 자격 증명을 입력하도록 요청합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-326">4. Azure AD can’t accept Kerberos tickets directly and no trust relationship exists so it requests that the user enter credentials.</span></span> |
| <span data-ttu-id="9cf17-327">5. 사용자는 AD FS STS에 Kerberos 티켓을 보냅니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-327">5. The user sends a Kerberos ticket to the AD FS STS.</span></span> |<span data-ttu-id="9cf17-328">5. 사용자는 동일한 온-프레미스 암호를 입력하고 Azure AD는 DirSync에 의해 동기화된 사용자 이름 및 암호를 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-328">5. The user enters the same on-premises password, and Azure AD validates them against the user name and password that was synchronized by DirSync.</span></span> |
| <span data-ttu-id="9cf17-329">6. AD FS는 Kerberos 티켓을 필요한 토큰 형식/클레임으로 변환하고 사용자를 Azure AD로 리디렉션합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-329">6. AD FS transforms the Kerberos ticket to the required token format/claims and redirects the user to Azure AD.</span></span> |<span data-ttu-id="9cf17-330">6. Azure AD는 Office 365에 사용자를 리디렉션합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-330">6. Azure AD redirects the user to Office 365.</span></span> |
| <span data-ttu-id="9cf17-331">7. 사용자는 Azure AD에 인증됩니다(또 다른 변환이 발생).</span><span class="sxs-lookup"><span data-stu-id="9cf17-331">7. The user authenticates to Azure AD (another transformation occurs).</span></span> |<span data-ttu-id="9cf17-332">7. 사용자는 Azure AD 토큰을 사용하여 Office 365 및 OWA에 로그인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-332">7. The user can sign in to Office 365 and OWA using the Azure AD token.</span></span> |
| <span data-ttu-id="9cf17-333">8. Azure AD는 Office 365에 사용자를 리디렉션합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-333">8. Azure AD redirects the user to Office 365.</span></span> | |
| <span data-ttu-id="9cf17-334">9. 사용자는 Office 365에 자동으로 로그인됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-334">9. The user is silently signed on to Office 365.</span></span> | |

<span data-ttu-id="9cf17-335">암호 동기화 시나리오(AD FS 없음)로 DirSync를 사용하는 Office 365에서 Single Sign-On은 “동일한 로그온"으로 대체됩니다. 여기서 "동일한"은 사용자가 Office 365에 액세스할 때 동일한 온-프레미스 자격 증명을 다시 입력해야 함을 의미합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-335">In the Office 365 with DirSync with password sync scenario (no AD FS), single sign-on is replaced by “same sign-on” where “same” simply means that users must re-enter their same on-premises credentials when accessing Office 365.</span></span> <span data-ttu-id="9cf17-336">이 데이터는 후속 프롬프트를 줄일 수 있도록 사용자의 브라우저에서 기억될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-336">Note that this data can be remembered by the user’s browser to help reduce subsequent prompts.</span></span>

### <a name="additional-food-for-thought"></a><span data-ttu-id="9cf17-337">추가 고려 사항</span><span class="sxs-lookup"><span data-stu-id="9cf17-337">Additional food for thought</span></span>
* <span data-ttu-id="9cf17-338">Azure 가상 컴퓨터에서 AD FS 프록시를 배포하는 경우 AD FS 서버에 대한 연결이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-338">If you deploy an AD FS proxy on an Azure virtual machine, connectivity to the AD FS servers is needed.</span></span> <span data-ttu-id="9cf17-339">온-프레미스인 경우 AD FS 서버와 통신하는 웹 응용 프로그램 프록시 노드를 허용하도록 가상 네트워크에서 제공하는 사이트 간 VPN 연결을 활용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-339">If they are on-premises, it is recommended that you leverage the site-to-site VPN connectivity provided by the virtual network to allow the Web Application Proxy nodes to communicate with their AD FS servers.</span></span>
* <span data-ttu-id="9cf17-340">Azure 가상 컴퓨터에서 AD FS 서버를 배포하는 경우 Windows Server Active Directory 도메인 컨트롤러, 특성 저장소 및 구성 데이터베이스에 대한 연결이 필요하며 Azure 가상 네트워크와 온-프레미스 네트워크 간에 Express 경로 또는 사이트 간 VPN 연결도 필요할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-340">If you deploy an AD FS server on an Azure virtual machine, connectivity to Windows Server Active Directory domain controllers, Attribute Stores, and Configuration databases is necessary and may also require an ExpressRoute or a site-to-site VPN connection between the Azure virtual network and the on-premises network.</span></span>
* <span data-ttu-id="9cf17-341">Azure 가상 컴퓨터(송신 트래픽)에서 모든 트래픽에 요금이 부과됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-341">Charges are applied to all traffic from Azure virtual machines (egress traffic).</span></span> <span data-ttu-id="9cf17-342">비용이 주요 요인인 경우 Azure에 AD FS 서버 온-프레미스를 활용하는 웹 응용 프로그램 프록시 노드를 배포하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-342">If cost is the driving factor, it is advisable to deploy the Web Application Proxy nodes on Azure, leaving the AD FS servers on-premises.</span></span> <span data-ttu-id="9cf17-343">Azure 가상 컴퓨터에 AD FS 서버를 배포하는 경우 온-프레미스 사용자를 인증하는 데 추가 비용이 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-343">If the AD FS servers are deployed on Azure virtual machines as well, additional costs will be incurred to authenticate on-premises users.</span></span> <span data-ttu-id="9cf17-344">송신 트래픽은 Express 경로 또는 VPN 사이트 간 연결을 순회 중인지 여부에 관계 없이 비용을 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-344">Egress traffic incurs a cost regardless of whether or not it is traversing the ExpressRoute or the VPN site-to-site connection.</span></span>
* <span data-ttu-id="9cf17-345">AD FS 서버의 고가용성을 위해 Azure의 기본 서버 부하 분산 기능을 사용하려는 경우 부하 분산은 클라우드 서비스 내에서 가상 컴퓨터의 상태를 확인하는 데 사용되는 프로브를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-345">If you decide to use Azure’s native server load balancing capabilities for high availability of AD FS servers, note that load balancing provides probes that are used to determine the health of the virtual machines within the cloud service.</span></span> <span data-ttu-id="9cf17-346">Azure 가상 컴퓨터의 경우(웹 또는 작업자 역할이 아니라) 기본 프로브에 응답하는 에이전트는 Azure 가상 컴퓨터에 존재하지 않으므로 사용자 지정 프로브를 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-346">In the case of Azure virtual machines (as opposed to web or worker roles), a custom probe must be used since the agent that responds to the default probes is not present on Azure virtual machines.</span></span> <span data-ttu-id="9cf17-347">간단히 하기 위해 사용자 지정 TCP 프로브를 사용할 수 있습니다. 가상 컴퓨터 상태를 확인하도록 TCP 연결(TCP SYN ACK 세그먼트로 TCP SYN 세그먼트를 보내고 응답)이 성공적으로 설정되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-347">For simplicity, you might use a custom TCP probe — this requires only that a TCP connection (a TCP SYN segment sent and responded to with a TCP SYN ACK segment) be successfully established to determine virtual machine health.</span></span> <span data-ttu-id="9cf17-348">사용자 지정 프로브를 구성하여 가상 컴퓨터가 활성 상태로 수신 대기하는 TCP 포트를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-348">You can configure the custom probe to use any TCP port to which your virtual machines are actively listening.</span></span>

> [!NOTE]
> <span data-ttu-id="9cf17-349">동일한 포트 집합을 인터넷(예: 포트 80 및 443)에 직접 노출해야 하는 컴퓨터는 동일한 클라우드 서비스를 공유할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-349">Machines that need to expose the same set of ports directly to the Internet (such as port 80 and 443) cannot share the same cloud service.</span></span> <span data-ttu-id="9cf17-350">따라서 응용 프로그램 및 Windows Server AD FS에 대한 포트 요구 사항 간의 잠재적인 겹침을 방지하기 위해 Windows Server AD FS 서버에 대한 전용 클라우드 서비스를 만드는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-350">It is, therefore, recommended that you create a dedicated cloud service for your Windows Server AD FS servers in order to avoid potential overlaps between port requirements for an application and Windows Server AD FS.</span></span>
> 
> 

## <a name="deployment-scenarios"></a><span data-ttu-id="9cf17-351">배포 시나리오</span><span class="sxs-lookup"><span data-stu-id="9cf17-351">Deployment scenarios</span></span>
<span data-ttu-id="9cf17-352">다음 섹션에서는 반드시 고려해야 하는 중요한 고려 사항을 살펴보도록 일반적인 배포 시나리오를 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-352">The following section outlines commonplace deployment scenarios to draw attention to important considerations that must be taken into account.</span></span> <span data-ttu-id="9cf17-353">각 시나리오에는 고려할 결정 사항 및 요인에 대한 자세한 내용의 링크가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-353">Each scenario has links to more details about the decisions and factors to consider.</span></span>

1. [<span data-ttu-id="9cf17-354">AD DS: 회사 네트워크 연결에 대한 요구 사항 없이 AD DS 인식 응용 프로그램 배포</span><span class="sxs-lookup"><span data-stu-id="9cf17-354">AD DS: Deploy an AD DS-aware application with no requirement for corporate network connectivity</span></span>](#BKMK_CloudOnly)
   
    <span data-ttu-id="9cf17-355">예를 들어 인터넷 연결 SharePoint 서비스는 Azure 가상 컴퓨터에 배포됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-355">For example, an Internet-facing SharePoint service is deployed on an Azure virtual machine.</span></span> <span data-ttu-id="9cf17-356">응용 프로그램은 회사 네트워크 리소스에 의존하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-356">The application has no dependencies on corporate-network resources.</span></span> <span data-ttu-id="9cf17-357">응용 프로그램은 Windows Server AD DS가 필요하지만 회사 Windows Server AD DS는 필요하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-357">The application does require Windows Server AD DS but does NOT require the corporate Windows Server AD DS.</span></span>
2. [<span data-ttu-id="9cf17-358">AD FS: 인터넷으로 클레임 인식 온-프레미스 프런트 엔드 응용 프로그램 확장</span><span class="sxs-lookup"><span data-stu-id="9cf17-358">AD FS: Extend a claims-aware on-premises front-end application to the Internet</span></span>](#BKMK_CloudOnlyFed)
   
    <span data-ttu-id="9cf17-359">예를 들어 온-프레미스에 성공적으로 배포되고 회사 사용자가 사용하는 클레임 인식 응용 프로그램을 인터넷에서 액세스할 수 있게 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-359">For example, a claims-aware application that has been successfully deployed on-premises and used by corporate users needs to become accessible from the Internet.</span></span> <span data-ttu-id="9cf17-360">응용 프로그램은 자체 회사 ID를 사용하여 비즈니스 파트너와 기존 회사 사용자가 인터넷을 통해 직접 액세스할 수 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-360">The application needs to be accessed directly over the Internet both by business partners using their own corporate identities and by existing corporate users.</span></span>
3. [<span data-ttu-id="9cf17-361">AD DS: 회사 네트워크에 연결해야 하는 Windows Server AD DS 인식 응용 프로그램 배포</span><span class="sxs-lookup"><span data-stu-id="9cf17-361">AD DS: Deploy a Windows Server AD DS-aware application that requires connectivity to the corporate network</span></span>](#BKMK_HybridExt)
   
    <span data-ttu-id="9cf17-362">예를 들어 Windows 통합 인증을 지원하고 구성 및 사용자 프로필 데이터에 대한 리포지토리로 Windows Server AD DS를 사용하는 LDAP 인식 응용 프로그램은 Azure 가상 컴퓨터에 배포됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-362">For example, an LDAP-aware application that supports Windows-integrated authentication and uses Windows Server AD DS as a repository for configuration and user-profile data is deployed on an Azure virtual machine.</span></span> <span data-ttu-id="9cf17-363">응용 프로그램은 기존의 회사 Windows Server AD DS를 활용하고 Single Sign-On을 제공하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-363">It is desirable for the application to leverage the existing corporate Windows Server AD DS and provide single sign-on.</span></span> <span data-ttu-id="9cf17-364">응용 프로그램은 클레임 인식되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-364">The application is not claims-aware.</span></span>

### <span data-ttu-id="9cf17-365"><a name="BKMK_CloudOnly"></a>1. AD DS: 회사 네트워크 연결에 대한 요구 사항 없이 AD DS 인식 응용 프로그램 배포</span><span class="sxs-lookup"><span data-stu-id="9cf17-365"><a name="BKMK_CloudOnly"></a>1. AD DS: Deploy an AD DS-aware application with no requirement for corporate network connectivity</span></span>
<span data-ttu-id="9cf17-366">![클라우드 전용 AD DS 배포](media/active-directory-deploying-ws-ad-guidelines/ADDS_cloud.png)
**그림 1**</span><span class="sxs-lookup"><span data-stu-id="9cf17-366">![Cloud-only AD DS deployment](media/active-directory-deploying-ws-ad-guidelines/ADDS_cloud.png)
**Figure 1**</span></span>

#### <a name="description"></a><span data-ttu-id="9cf17-367">설명</span><span class="sxs-lookup"><span data-stu-id="9cf17-367">Description</span></span>
<span data-ttu-id="9cf17-368">SharePoint가 Azure 가상 컴퓨터에 배포되고 응용 프로그램은 회사 네트워크 리소스에 의존하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-368">SharePoint is deployed on an Azure virtual machine and the application has no dependencies on corporate-network resources.</span></span> <span data-ttu-id="9cf17-369">응용 프로그램은 Windows Server AD DS가 필요하지만 회사 Windows Server AD DS는 필요하지 *않습니다* .</span><span class="sxs-lookup"><span data-stu-id="9cf17-369">The application does require Windows Server AD DS but does *not* require the corporate Windows Server AD DS.</span></span> <span data-ttu-id="9cf17-370">사용자는 응용 프로그램을 통해 Azure 가상 컴퓨터의 클라우드에서 호스팅되는 Windows Server AD DS 도메인으로 자체 프로비전되기 때문에 Kerberos 또는 페더레이션된 트러스트는 필요하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-370">No Kerberos or federated trusts are required because users are self-provisioned through the application into the Windows Server AD DS domain that is also hosted in the cloud on Azure virtual machines.</span></span>

#### <a name="scenario-considerations-and-how-technology-areas-apply-to-the-scenario"></a><span data-ttu-id="9cf17-371">시나리오 고려 사항 및 시나리오에 대한 기술 영역 적용 방법</span><span class="sxs-lookup"><span data-stu-id="9cf17-371">Scenario considerations and how technology areas apply to the scenario</span></span>
* <span data-ttu-id="9cf17-372">[네트워크 토폴로지](#BKMK_NetworkTopology): 크로스-프레미스 연결(사이트 간 연결이라고도 함) 없이 Azure 가상 네트워크를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-372">[Network topology](#BKMK_NetworkTopology): Create an Azure virtual network without cross-premises connectivity (also known as site-to-site connectivity).</span></span>
* <span data-ttu-id="9cf17-373">[DC 배포 구성](#BKMK_DeploymentConfig): 새로운 단일 도메인 Windows Server Active Directory 포리스트에 새 도메인 컨트롤러를 배포합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-373">[DC deployment configuration](#BKMK_DeploymentConfig): Deploy a new domain controller into a new, single-domain, Windows Server Active Directory forest.</span></span> <span data-ttu-id="9cf17-374">Windows DNS 서버와 함께 배포되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-374">This should be deployed along with the Windows DNS server.</span></span>
* <span data-ttu-id="9cf17-375">[Windows Server Active Directory 사이트 토폴로지](#BKMK_ADSiteTopology): 기본 Windows Server Active Directory 사이트를 사용합니다(모든 컴퓨터는 Default-First-Site-Name에 있음).</span><span class="sxs-lookup"><span data-stu-id="9cf17-375">[Windows Server Active Directory site topology](#BKMK_ADSiteTopology): Use the default Windows Server Active Directory site (all computers will be in Default-First-Site-Name).</span></span>
* <span data-ttu-id="9cf17-376">[IP 주소 지정 및 DNS](#BKMK_IPAddressDNS):</span><span class="sxs-lookup"><span data-stu-id="9cf17-376">[IP addressing and DNS](#BKMK_IPAddressDNS):</span></span>
  
  * <span data-ttu-id="9cf17-377">Set-AzureStaticVNetIP Azure PowerShell cmdlet을 사용하여 DC에 대한 고정 IP 주소를 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-377">Set a static IP address for the DC by using the Set-AzureStaticVNetIP Azure PowerShell cmdlet.</span></span>
  * <span data-ttu-id="9cf17-378">Azure의 도메인 컨트롤러에 Windows Server DNS를 설치 및 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-378">Install and configure Windows Server DNS on the domain controller(s) on Azure.</span></span>
  * <span data-ttu-id="9cf17-379">DC 및 DNS 서버 역할을 호스팅하는 VM의 이름 및 IP 주소로 가상 네트워크 속성을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-379">Configure the virtual network properties with the name and IP address of the VM that hosts the DC and DNS server roles.</span></span>
* <span data-ttu-id="9cf17-380">[글로벌 카탈로그](#BKMK_GC): 포리스트의 첫 번째 DC는 글로벌 카탈로그 서버여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-380">[Global Catalog](#BKMK_GC): The first DC in the forest must be a global catalog server.</span></span> <span data-ttu-id="9cf17-381">단일 도메인 포리스트에서 글로벌 카탈로그는 DC에서 추가 작업이 필요하지 않으므로 추가 DC는 GC로 구성되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-381">Additional DCs should also be configured as GCs because in a single domain forest, the global catalog does not require any additional work from the DC.</span></span>
* <span data-ttu-id="9cf17-382">[Windows Server AD DS 데이터베이스 및 SYSVOL의 배치](#BKMK_PlaceDB): Windows Server Active Directory 데이터베이스, 로그 및 SYSVOL을 저장하기 위해 Azure VM으로 실행되는 DC에 데이터 디스크를 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-382">[Placement of the Windows Server AD DS database and SYSVOL](#BKMK_PlaceDB): Add a data disk to DCs running as Azure VMs in order to store the Windows Server Active Directory database, logs, and SYSVOL.</span></span>
* <span data-ttu-id="9cf17-383">[백업 및 복원](#BKMK_BUR): 시스템 상태 백업을 저장할 위치를 결정합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-383">[Backup and Restore](#BKMK_BUR): Determine where you want to store system state backups.</span></span> <span data-ttu-id="9cf17-384">필요한 경우 백업을 저장하도록 DC VM에 다른 데이터 디스크를 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-384">If necessary, add another data disk to the DC VM to store backups.</span></span>

### <span data-ttu-id="9cf17-385"><a name="BKMK_CloudOnlyFed"></a>2 AD FS: 인터넷으로 클레임 인식 온-프레미스 프런트 엔드 응용 프로그램 확장</span><span class="sxs-lookup"><span data-stu-id="9cf17-385"><a name="BKMK_CloudOnlyFed"></a>2 AD FS: Extend a claims-aware on-premises front-end application to the Internet</span></span>
<span data-ttu-id="9cf17-386">![크로스-프레미스 연결로 페더레이션](media/active-directory-deploying-ws-ad-guidelines/Federation_xprem.png)
**그림 2**</span><span class="sxs-lookup"><span data-stu-id="9cf17-386">![Federation with cross-premises connectivity](media/active-directory-deploying-ws-ad-guidelines/Federation_xprem.png)
**Figure 2**</span></span>

#### <a name="description"></a><span data-ttu-id="9cf17-387">설명</span><span class="sxs-lookup"><span data-stu-id="9cf17-387">Description</span></span>
<span data-ttu-id="9cf17-388">온-프레미스에 성공적으로 배포되고 회사 사용자가 사용하는 클레임 인식 응용 프로그램을 인터넷에서 직접 액세스할 수 있게 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-388">A claims-aware application that has been successfully deployed on-premises and used by corporate users needs to become accessible directly from the Internet.</span></span> <span data-ttu-id="9cf17-389">응용 프로그램은 데이터를 저장하는 SQL 데이터베이스에 웹 프런트 엔드 역할을 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-389">The application serves as a web frontend to a SQL database in which it stores data.</span></span> <span data-ttu-id="9cf17-390">응용 프로그램에서 사용하는 SQL Server도 회사 네트워크에 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-390">The SQL servers used by the application are also located on the corporate network.</span></span> <span data-ttu-id="9cf17-391">두 개의 Windows Server AD FS STS 및 부하 분산 장치는 회사 사용자에 게 액세스를 제공하도록 온-프레미스에 배포되었습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-391">Two Windows Server AD FS STSs and a load-balancer have been deployed on-premises to provide access to the corporate users.</span></span> <span data-ttu-id="9cf17-392">이제 응용 프로그램은 자체 회사 ID를 사용하여 비즈니스 파트너와 기존 회사 사용자가 인터넷을 통해 추가로 직접 액세스할 수 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-392">The application now needs to be additionally accessed directly over the Internet both by business partners using their own corporate identities and by existing corporate users.</span></span>

<span data-ttu-id="9cf17-393">이 새로운 요구 사항의 배포 및 구성 요구를 단순화하고 충족시키기 위해 두 개의 추가 웹 프런트 엔드 및 두 개의 Windows Server AD FS 프록시 서버가 Azure 가상 컴퓨터에 설치되도록 결정되었습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-393">In an effort to simplify and meet the deployment and configuration needs of this new requirement, it is decided that two additional web frontends and two Windows Server AD FS proxy servers be installed on Azure virtual machines.</span></span> <span data-ttu-id="9cf17-394">모든 4개의 VM은 인터넷에 직접 노출되고 Azure 가상 네트워크의 사이트 간 VPN 기능을 사용하여 온-프레미스 네트워크에 대한 연결이 제공됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-394">All four VMs will be exposed directly to the Internet and will be provided connectivity to the on-premises network using Azure Virtual Network’s site-to-site VPN capability.</span></span>

#### <a name="scenario-considerations-and-how-technology-areas-apply-to-the-scenario"></a><span data-ttu-id="9cf17-395">시나리오 고려 사항 및 시나리오에 대한 기술 영역 적용 방법</span><span class="sxs-lookup"><span data-stu-id="9cf17-395">Scenario considerations and how technology areas apply to the scenario</span></span>
* <span data-ttu-id="9cf17-396">[네트워크 토폴로지](#BKMK_NetworkTopology): Azure 가상 네트워크를 만들고 [크로스-프레미스 연결을 구성합니다](../vpn-gateway/vpn-gateway-site-to-site-create.md).</span><span class="sxs-lookup"><span data-stu-id="9cf17-396">[Network topology](#BKMK_NetworkTopology): Create an Azure virtual network and [configure cross-premises connectivity](../vpn-gateway/vpn-gateway-site-to-site-create.md).</span></span>
  
  > [!NOTE]
  > <span data-ttu-id="9cf17-397">각각의 Windows Server AD FS 인증서의 경우 Azure에서 실행되는 Windows Server AD FS 인스턴스에서 인증서 템플릿 및 생성된 인증서 내에 정의된 URL에 연결할 수 있는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-397">For each of the Windows Server AD FS certificates, ensure that the URL defined within the certificate template and the resulting certificates can be reached by the Windows Server AD FS instances running on Azure.</span></span> <span data-ttu-id="9cf17-398">PKI 인프라의 일부에 대한 크로스-프레미스 연결이 필요할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-398">This may require cross-premises connectivity to parts of your PKI infrastructure.</span></span> <span data-ttu-id="9cf17-399">예를 들어 CRL의 끝점이 LDAP 기반이고 단독으로 온-프레미스에서 호스팅되는 경우 크로스-프레미스 연결이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-399">For example if the CRL's endpoint is LDAP-based and hosted exclusively on-premises, then cross-premises connectivity will be required.</span></span> <span data-ttu-id="9cf17-400">필요 없는 경우 인터넷을 통해 해당 CRL을 액세스할 수 있는 CA에서 발급한 인증서를 사용해야 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-400">If this is not desirable, it may be necessary to use certificates issued by a CA whose CRL is accessible over the Internet.</span></span>
  > 
  > 
* <span data-ttu-id="9cf17-401">[클라우드 서비스 구성](#BKMK_CloudSvcConfig): 두 개의 부하 분산된 가상 IP 주소를 제공하기 위해 두 개의 클라우드 서비스가 있는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-401">[Cloud services configuration](#BKMK_CloudSvcConfig): Ensure you have two cloud services in order provide two load-balanced virtual IP addresses.</span></span> <span data-ttu-id="9cf17-402">첫 번째 클라우드 서비스의 가상 IP 주소는 포트 80 및 443에서 두 개의 Windows Server AD FS 프록시 VM으로 전달됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-402">The first cloud service’s virtual IP address will be directed to the two Windows Server AD FS proxy VMs on ports 80 and 443.</span></span> <span data-ttu-id="9cf17-403">Windows Server AD FS 프록시 VM은 Windows Server AD FS STS를 향하는 온-프레미스 부하 분산 장치의 IP 주소를 가리키도록 구성됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-403">The Windows Server AD FS proxy VMs will be configured to point to the IP address of the on-premises load-balancer that fronts the Windows Server AD FS STSs.</span></span> <span data-ttu-id="9cf17-404">두 번째 클라우드 서비스의 가상 IP 주소는 포트 80 및 443에서 웹 프런트 엔드를 다시 실행하는 두 VM으로 전달됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-404">The second cloud service’s virtual IP address will be directed to the two VMs running the web frontend again on ports 80 and 443.</span></span> <span data-ttu-id="9cf17-405">부하 분산 장치가 Windows Server AD FS 프록시와 웹 프런트 엔드 VM 작동에 대한 트래픽을 전송하도록 사용자 지정 프로브를 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-405">Configure a custom probe to ensure the load-balancer only directs traffic to functioning Windows Server AD FS proxy and web frontend VMs.</span></span>
* <span data-ttu-id="9cf17-406">[페더레이션 서버 구성](#BKMK_FedSrvConfig): Windows Server AD FS를 STS(페더레이션 서버)로 구성하여 클라우드에서 만들어진 Windows Server Active Directory 포리스트에 대한 보안 토큰을 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-406">[Federation server configuration](#BKMK_FedSrvConfig): Configure Windows Server AD FS as a federation server (STS) to generate security tokens for the Windows Server Active Directory forest created in the cloud.</span></span> <span data-ttu-id="9cf17-407">ID를 허용하려는 다른 파트너와 클레임 공급자 트러스트 관계를 설정하고 토큰을 생성하려는 다른 응용 프로그램과 신뢰 당사자 트러스트 관계를 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-407">Set federation claims provider trust relationships with the different partners you wish to accept identities from, and configure relying party trust relationships with the different applications you want to generate tokens to.</span></span>
  
    <span data-ttu-id="9cf17-408">대부분의 시나리오에서 Windows Server AD FS 프록시 서버는 보안용으로 인터넷 연결 용량에 배포되는 반면 해당 Windows Server AD FS 페더레이션 항목은 직접 인터넷 연결에서 격리됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-408">In most scenarios, Windows Server AD FS proxy servers are deployed in an Internet-facing capacity for security purposes while their Windows Server AD FS federation counterparts remain isolated from direct Internet connectivity.</span></span> <span data-ttu-id="9cf17-409">배포 시나리오에 관계 없이 공개적으로 노출된 IP 주소와 두 개의 Windows Server AD FS STS 인스턴스 또는 프록시 인스턴스 간에 부하를 분산할 수 있는 포트를 제공하는 가상 IP 주소로 클라우드 서비스를 구성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-409">Regardless of your deployment scenario, you must configure your cloud service with a virtual IP address that will provide a publicly exposed IP address and port that is able to load-balance across either your two Windows Server AD FS STS instances or proxy instances.</span></span>
* <span data-ttu-id="9cf17-410">[Windows Server AD FS 고가용성 구성](#BKMK_ADFSHighAvail): 장애 조치 및 부하 분산을 위해 최소 두 개 이상의 서버로 Windows Server AD FS 팜을 배포하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-410">[Windows Server AD FS high availability configuration](#BKMK_ADFSHighAvail): It is advisable to deploy a Windows Server AD FS farm with at least two servers for failover and load balancing.</span></span> <span data-ttu-id="9cf17-411">Windows Server AD FS 구성 데이터에 대해 WID(Windows 내부 데이터베이스) 사용을 고려할 수도 있으며 Azure의 내부 부하 분산 기능을 사용하여 들어오는 요청을 팜의 서버에 걸쳐 분산시킬 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-411">You might want to consider using the Windows Internal Database (WID) for Windows Server AD FS configuration data, and use the internal load balancing capability of Azure to distribute incoming requests across the servers in the farm.</span></span>

<span data-ttu-id="9cf17-412">자세한 내용은 [AD DS 배포 가이드](https://technet.microsoft.com/library/cc753963)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-412">For more information, see the [AD DS Deployment Guide](https://technet.microsoft.com/library/cc753963).</span></span>

### <span data-ttu-id="9cf17-413"><a name="BKMK_HybridExt"></a>3. AD DS: 회사 네트워크에 연결해야 하는 Windows Server AD DS 인식 응용 프로그램 배포</span><span class="sxs-lookup"><span data-stu-id="9cf17-413"><a name="BKMK_HybridExt"></a>3. AD DS: Deploy a Windows Server AD DS-aware application that requires connectivity to the corporate network</span></span>
<span data-ttu-id="9cf17-414">![크로스-프레미스 AD DS 배포](media/active-directory-deploying-ws-ad-guidelines/ADDS_xprem.png)
**그림 3**</span><span class="sxs-lookup"><span data-stu-id="9cf17-414">![Cross-premises AD DS deployment](media/active-directory-deploying-ws-ad-guidelines/ADDS_xprem.png)
**Figure 3**</span></span>

#### <a name="description"></a><span data-ttu-id="9cf17-415">설명</span><span class="sxs-lookup"><span data-stu-id="9cf17-415">Description</span></span>
<span data-ttu-id="9cf17-416">LDAP 인식 응용 프로그램이 Azure 가상 컴퓨터에 배포됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-416">An LDAP-aware application is deployed on an Azure virtual machine.</span></span> <span data-ttu-id="9cf17-417">Windows 통합 인증을 지원하고 구성 및 사용자 프로필 데이터에 대한 리포지토리로 Windows Server AD DS를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-417">It supports Windows-integrated authentication and uses Windows Server AD DS as a repository for configuration and user profile data.</span></span> <span data-ttu-id="9cf17-418">응용 프로그램에 대한 목표는 기존의 회사 Windows Server AD DS를 활용하고 Single Sign-On을 제공하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-418">The goal is for the application to leverage the existing corporate Windows Server AD DS and provide single sign-on.</span></span> <span data-ttu-id="9cf17-419">응용 프로그램은 클레임 인식되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-419">The application is not claims-aware.</span></span> <span data-ttu-id="9cf17-420">또한 사용자는 인터넷에서 직접 응용 프로그램에 액세스해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-420">Users also need to access the application directly from the Internet.</span></span> <span data-ttu-id="9cf17-421">성능 및 비용을 최적화하기 위해 Azure에서 응용 프로그램과 함께 회사 도메인의 일부인 두 개의 추가 도메인 컨트롤러를 배포하도록 결정했습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-421">To optimize for performance and cost, it is decided that two additional domain controllers that are part of the corporate domain be deployed alongside the application on Azure.</span></span>

#### <a name="scenario-considerations-and-how-technology-areas-apply-to-the-scenario"></a><span data-ttu-id="9cf17-422">시나리오 고려 사항 및 시나리오에 대한 기술 영역 적용 방법</span><span class="sxs-lookup"><span data-stu-id="9cf17-422">Scenario considerations and how technology areas apply to the scenario</span></span>
* <span data-ttu-id="9cf17-423">[네트워크 토폴로지](#BKMK_NetworkTopology): [크로스-프레미스 연결](../vpn-gateway/vpn-gateway-site-to-site-create.md)로 Azure 가상 네트워크를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-423">[Network topology](#BKMK_NetworkTopology): Create an Azure virtual network with [cross-premises connectivity](../vpn-gateway/vpn-gateway-site-to-site-create.md).</span></span>
* <span data-ttu-id="9cf17-424">[설치 방법](#BKMK_InstallMethod): 회사 Windows Server Active Directory 도메인의 복제본 DC를 배포합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-424">[Installation method](#BKMK_InstallMethod): Deploy replica DCs from the corporate Windows Server Active Directory domain.</span></span> <span data-ttu-id="9cf17-425">복제본 DC의 경우 VM에 Windows Server AD DS를 설치할 수 있으며 필요에 따라 IFM(미디어에서 설치) 기능을 사용하여 설치하는 동안 새로운 DC에 복제해야 하는 데이터의 양을 줄일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-425">For a replica DC, you can install Windows Server AD DS on the VM, and optionally use the Install From Media (IFM) feature to reduce the amount of data that needs to be replicated to the new DC during installation.</span></span> <span data-ttu-id="9cf17-426">자습서는 [Azure에서 복제 Active Directory 도메인 컨트롤러 설치](active-directory-install-replica-active-directory-domain-controller.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-426">For a tutorial, see [Install a replica Active Directory domain controller on Azure](active-directory-install-replica-active-directory-domain-controller.md).</span></span> <span data-ttu-id="9cf17-427">IFM을 사용하는 경우라도 설치하는 동안 Windows Server AD DS를 복제하는 대신 가상 DC 온-프레미스를 빌드하고 전체 VHD(가상 하드 디스크)를 클라우드로 이동하는 것이 더욱 효율적일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-427">Even if you use IFM, it may be more efficient to build the virtual DC on-premises and move the entire Virtual Hard Disk (VHD) to the cloud instead of replicating Windows Server AD DS during installation.</span></span> <span data-ttu-id="9cf17-428">보안을 위해 Azure로 복사된 후 온-프레미스 네트워크에서 VHD를 삭제하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-428">For safety, it is recommended that you delete the VHD from the on-premises network once it has been copied to Azure.</span></span>
* <span data-ttu-id="9cf17-429">[Windows Server Active Directory 사이트 토폴로지](#BKMK_ADSiteTopology): Active Directory 사이트 및 서비스에서 새로운 Azure 사이트를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-429">[Windows Server Active Directory site topology](#BKMK_ADSiteTopology): Create a new Azure site in Active Directory Sites and Services.</span></span> <span data-ttu-id="9cf17-430">Azure 가상 네트워크를 나타내는 Windows Server Active Directory 서브넷 개체를 만들고 사이트에 서브넷을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-430">Create a Windows Server Active Directory subnet object to represent the Azure virtual network and add the subnet to the site.</span></span> <span data-ttu-id="9cf17-431">Azure 간 Windows Server Active Directory 트래픽을 제어하고 최적화하기 위해 새 Azure 사이트와 Azure 가상 네트워크 VPN 끝점이 위치한 사이트를 포함하는 새 사이트 링크를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-431">Create a new site link that includes the new Azure site and the site in which the Azure virtual network VPN endpoint is located in order to control and optimize Windows Server Active Directory traffic to and from Azure.</span></span>
* <span data-ttu-id="9cf17-432">[IP 주소 지정 및 DNS](#BKMK_IPAddressDNS):</span><span class="sxs-lookup"><span data-stu-id="9cf17-432">[IP addressing and DNS](#BKMK_IPAddressDNS):</span></span>
  
  * <span data-ttu-id="9cf17-433">Set-AzureStaticVNetIP Azure PowerShell cmdlet을 사용하여 DC에 대한 고정 IP 주소를 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-433">Set a static IP address for the DC by using the Set-AzureStaticVNetIP Azure PowerShell cmdlet.</span></span>
  * <span data-ttu-id="9cf17-434">Azure의 도메인 컨트롤러에 Windows Server DNS를 설치 및 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-434">Install and configure Windows Server DNS on the domain controller(s) on Azure.</span></span>
  * <span data-ttu-id="9cf17-435">DC 및 DNS 서버 역할을 호스팅하는 VM의 이름 및 IP 주소로 가상 네트워크 속성을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-435">Configure the virtual network properties with the name and IP address of the VM that hosts the DC and DNS server roles.</span></span>
* <span data-ttu-id="9cf17-436">[지리적으로 분산된 DC](#BKMK_DistributedDCs): 필요에 따라 추가 가상 네트워크를 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-436">[Geo-distributed DCs](#BKMK_DistributedDCs): Configure additional virtual networks as needed.</span></span> <span data-ttu-id="9cf17-437">Active Directory 사이트 토폴로지에서 다른 Azure 지역에 해당하는 지역에 DC가 필요한 경우 Active Directory 사이트를 적절하게 만들려고 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-437">If your Active Directory site topology requires DCs in geographies that correspond to different Azure regions, than you want to create Active Directory sites accordingly.</span></span>
* <span data-ttu-id="9cf17-438">[읽기 전용 DC](#BKMK_RODC): DC에 대한 쓰기 작업 수행을 위한 요구 사항 및 RODC를 사용한 사이트의 응용 프로그램 및 서비스의 호환성에 따라 Azure 사이트에서 RODC를 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-438">[Read-only DCs](#BKMK_RODC): You might deploy an RODC in the Azure site, depending on your requirements for performing write operations against the DC and the compatibility of applications and services in the site with RODCs.</span></span> <span data-ttu-id="9cf17-439">응용 프로그램 호환성에 대한 자세한 내용은 [읽기 전용 도메인 컨트롤러 응용 프로그램 호환성 가이드](https://technet.microsoft.com/library/cc755190)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-439">For more information about application compatibility, see the [Read-Only domain controllers application compatibility guide](https://technet.microsoft.com/library/cc755190).</span></span>
* <span data-ttu-id="9cf17-440">[글로벌 카탈로그](#BKMK_GC): GC는 다중 도메인 포리스트에서 로그온 요청을 처리하는 데 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-440">[Global Catalog](#BKMK_GC): GCs are needed to service logon requests in multidomain forests.</span></span> <span data-ttu-id="9cf17-441">Azure 사이트에서 GC를 배포하지 않는 경우 인증 요청이 다른 사이트에서 쿼리 GC를 발생시키므로 송신 트래픽 비용이 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-441">If you do not deploy a GC in the Azure site, you will incur egress traffic costs as authentication requests cause queries GCs in other sites.</span></span> <span data-ttu-id="9cf17-442">해당 트래픽을 최소화하기 위해 Active Directory 사이트 및 서비스에서 Azure 사이트에 대한 유니버설 그룹 멤버 자격 캐싱을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-442">To minimize that traffic, you can enable universal group membership caching for the Azure site in Active Directory Sites and Services.</span></span>
  
    <span data-ttu-id="9cf17-443">GC를 배포하는 경우 Azure 사이트의 GC가 동일한 부분 도메인 파티션을 복제해야 하는 다른 GC에서 원본 DC로 선호되지 않도록 사이트 링크 및 사이트 링크 비용을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-443">If you deploy a GC, configure site links and site links costs so that the GC in the Azure site is not preferred as a source DC by other GCs that need to replicate the same partial domain partitions.</span></span>
* <span data-ttu-id="9cf17-444">[Windows Server AD DS 데이터베이스 및 SYSVOL의 배치](#BKMK_PlaceDB): Windows Server Active Directory 데이터베이스, 로그 및 SYSVOL을 저장하기 위해 Azure VM에서 실행되는 DC에 데이터 디스크를 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-444">[Placement of the Windows Server AD DS database and SYSVOL](#BKMK_PlaceDB): Add a data disk to DCs running on Azure VMs in order to store the Windows Server Active Directory database, logs, and SYSVOL.</span></span>
* <span data-ttu-id="9cf17-445">[백업 및 복원](#BKMK_BUR): 시스템 상태 백업을 저장할 위치를 결정합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-445">[Backup and Restore](#BKMK_BUR): Determine where you want to store system state backups.</span></span> <span data-ttu-id="9cf17-446">필요한 경우 백업을 저장하도록 DC VM에 다른 데이터 디스크를 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-446">If necessary, add another data disk to the DC VM to store backups.</span></span>

## <a name="deployment-decisions-and-factors"></a><span data-ttu-id="9cf17-447">배포 결정 및 요인</span><span class="sxs-lookup"><span data-stu-id="9cf17-447">Deployment decisions and factors</span></span>
<span data-ttu-id="9cf17-448">이 표에서 아래의 자세한 내용에 대한 링크와 함께 이전 시나리오 및 고려해야 할 해당 결정에 영향을 받는 Windows Server Active Directory 기술 영역을 요약합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-448">This table summarizes the Windows Server Active Directory technology areas that are impacted in the preceding scenarios and the corresponding decisions to consider, with links to more detail below.</span></span> <span data-ttu-id="9cf17-449">일부 기술 영역은 모든 배포 시나리오에 적용되지 않을 수 있으며 일부 기술 영역은 다른 기술 영역보다 배포 시나리오에 더 중요할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-449">Some technology areas might not be applicable to every deployment scenario, and some technology areas might be more critical to a deployment scenario than other technology areas.</span></span>

<span data-ttu-id="9cf17-450">예를 들어 가상 네트워크에서 복제본 DC를 배포하고 포리스트가 단일 도메인을 가진 경우 글로벌 카탈로그 서버를 배포하도록 선택하는 것은 추가 복제 요구 사항을 만들지 않으므로 해당 경우에서 배포 시나리오에 중요하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-450">For example, if you deploy a replica DC on a virtual network and your forest has only a single domain, then choosing to deploy a global catalog server in that case will not be critical to the deployment scenario because it will not create any additional replication requirements.</span></span> <span data-ttu-id="9cf17-451">반대로 포리스트에 여러 도메인이 있는 경우 가상 네트워크에 글로벌 카탈로그를 배포하는 결정은 사용 가능한 대역폭, 성능, 인증, 디렉터리 조회 등에 영향을 줄 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-451">On the other hand, if the forest has several domains, then the decision to deploy a global catalog on a virtual network could affect available bandwidth, performance, authentication, directory lookups, and so on.</span></span>

| <span data-ttu-id="9cf17-452">Windows Server Active Directory 기술 영역</span><span class="sxs-lookup"><span data-stu-id="9cf17-452">Windows Server Active Directory technology area</span></span> | <span data-ttu-id="9cf17-453">의사 결정</span><span class="sxs-lookup"><span data-stu-id="9cf17-453">Decisions</span></span> | <span data-ttu-id="9cf17-454">요소</span><span class="sxs-lookup"><span data-stu-id="9cf17-454">Factors</span></span> |
| --- | --- | --- |
| [<span data-ttu-id="9cf17-455">네트워크 토폴로지</span><span class="sxs-lookup"><span data-stu-id="9cf17-455">Network topology</span></span>](#BKMK_NetworkTopology) |<span data-ttu-id="9cf17-456">가상 네트워크를 만듭니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-456">Do you create a virtual network?</span></span> |<li><span data-ttu-id="9cf17-457">회사 리소스 액세스 요구 사항</span><span class="sxs-lookup"><span data-stu-id="9cf17-457">Requirements to access Corp resources</span></span></li> <li><span data-ttu-id="9cf17-458">인증</span><span class="sxs-lookup"><span data-stu-id="9cf17-458">Authentication</span></span></li> <li><span data-ttu-id="9cf17-459">계정 관리</span><span class="sxs-lookup"><span data-stu-id="9cf17-459">Account management</span></span></li> |
| [<span data-ttu-id="9cf17-460">DC 배포 구성</span><span class="sxs-lookup"><span data-stu-id="9cf17-460">DC deployment configuration</span></span>](#BKMK_DeploymentConfig) |<li><span data-ttu-id="9cf17-461">트러스트 없이 별도 포리스트를 배포합니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-461">Deploy a separate forest without any trusts?</span></span></li> <li><span data-ttu-id="9cf17-462">페더레이션이 포함된 새 포리스트를 배포합니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-462">Deploy a new forest with federation?</span></span></li> <li><span data-ttu-id="9cf17-463">Windows Server Active Directory 포리스트 트러스트 또는 Kerberos가 포함된 새 포리스트를 배포합니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-463">Deploy a new forest with Windows Server Active Directory forest trust or Kerberos?</span></span></li> <li><span data-ttu-id="9cf17-464">복제본 DC를 배포하여 회사 포리스트를 확장합니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-464">Extend Corp forest by deploying a replica DC?</span></span></li> <li><span data-ttu-id="9cf17-465">새 자식 도메인 또는 도메인 트리를 배포하여 회사 포리스트를 확장합니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-465">Extend Corp forest by deploying a new child domain or domain tree?</span></span></li> |<li><span data-ttu-id="9cf17-466">보안</span><span class="sxs-lookup"><span data-stu-id="9cf17-466">Security</span></span></li> <li><span data-ttu-id="9cf17-467">규정 준수</span><span class="sxs-lookup"><span data-stu-id="9cf17-467">Compliance</span></span></li> <li><span data-ttu-id="9cf17-468">비용</span><span class="sxs-lookup"><span data-stu-id="9cf17-468">Cost</span></span></li> <li><span data-ttu-id="9cf17-469">복원력 및 내결함성</span><span class="sxs-lookup"><span data-stu-id="9cf17-469">Resiliency and fault-tolerance</span></span></li> <li><span data-ttu-id="9cf17-470">응용 프로그램 호환성</span><span class="sxs-lookup"><span data-stu-id="9cf17-470">Application compatibility</span></span></li> |
| [<span data-ttu-id="9cf17-471">Windows Server Active Directory 사이트 토폴로지</span><span class="sxs-lookup"><span data-stu-id="9cf17-471">Windows Server Active Directory site topology</span></span>](#BKMK_ADSiteTopology) |<span data-ttu-id="9cf17-472">트래픽을 최적화하고 비용을 최소화하기 위해 Azure 가상 네트워크로 서브넷, 사이트 및 사이트 링크를 어떻게 구성합니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-472">How do you configure subnets, sites, and site links with Azure Virtual Network to optimize traffic and minimize cost?</span></span> |<li><span data-ttu-id="9cf17-473">서브넷 및 사이트 정의</span><span class="sxs-lookup"><span data-stu-id="9cf17-473">Subnet and site definitions</span></span></li> <li><span data-ttu-id="9cf17-474">사이트 링크 속성 및 변경 알림</span><span class="sxs-lookup"><span data-stu-id="9cf17-474">Site link properties and change notification</span></span></li> <li><span data-ttu-id="9cf17-475">복제 압축</span><span class="sxs-lookup"><span data-stu-id="9cf17-475">Replication compression</span></span></li> |
| [<span data-ttu-id="9cf17-476">IP 주소 지정 및 DNS</span><span class="sxs-lookup"><span data-stu-id="9cf17-476">IP addressing and DNS</span></span>](#BKMK_IPAddressDNS) |<span data-ttu-id="9cf17-477">IP 주소 및 이름 확인을 구성하는 방법은 무엇입니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-477">How to configure IP addresses and name resolution?</span></span> |<li><span data-ttu-id="9cf17-478">Set-AzureStaticVNetIP cmdlet 사용을 사용하여 고정 IP 주소 할당</span><span class="sxs-lookup"><span data-stu-id="9cf17-478">Use the Use the Set-AzureStaticVNetIP cmdlet to assign a static IP address</span></span></li> <li><span data-ttu-id="9cf17-479">Windows Server DNS 서버를 설치하고 DC 및 DNS 서버 역할을 호스팅하는 VM의 이름 및 IP 주소로 가상 네트워크 속성을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-479">Install Windows Server DNS server and configure the virtual network properties with the name and IP address of the VM that hosts the DC and DNS server roles</span></span></li> |
| [<span data-ttu-id="9cf17-480">지리적으로 분산된 DC</span><span class="sxs-lookup"><span data-stu-id="9cf17-480">Geo-distributed DCs</span></span>](#BKMK_DistributedDCs) |<span data-ttu-id="9cf17-481">별도 가상 네트워크의 DC에 복제하는 방법은 무엇입니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-481">How to replicate to DCs on separate virtual networks?</span></span> |<span data-ttu-id="9cf17-482">Active Directory 사이트 토폴로지에서 다른 Azure 지역에 해당하는 지역에 DC가 필요한 경우 Active Directory 사이트를 적절하게 만들려고 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-482">If your Active Directory site topology requires DCs in geographies that corresponds to different Azure regions, than you want to create Active Directory sites accordingly.</span></span> <span data-ttu-id="9cf17-483">[가상 네트워크 연결에 가상 네트워크를 구성](../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md) 하여 별도 가상 네트워크의 도메인 컨트롤러 간에 복제할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-483">[Configure virtual network to virtual network Connectivity](../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md) to replicate between domain controllers on separate virtual networks.</span></span> |
| [<span data-ttu-id="9cf17-484">읽기 전용 DC</span><span class="sxs-lookup"><span data-stu-id="9cf17-484">Read-only DCs</span></span>](#BKMK_RODC) |<span data-ttu-id="9cf17-485">읽기 전용 또는 쓰기 가능 DC를 사용합니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-485">Use read-only or writeable DCs?</span></span> |<li><span data-ttu-id="9cf17-486">HBI/PII 특성 필터링</span><span class="sxs-lookup"><span data-stu-id="9cf17-486">Filter HBI/PII attributes</span></span></li> <li><span data-ttu-id="9cf17-487">암호 필터링</span><span class="sxs-lookup"><span data-stu-id="9cf17-487">Filter secrets</span></span></li> <li><span data-ttu-id="9cf17-488">아웃바운드 트래픽 제한</span><span class="sxs-lookup"><span data-stu-id="9cf17-488">Limit outbound traffic</span></span></li> |
| [<span data-ttu-id="9cf17-489">글로벌 카탈로그</span><span class="sxs-lookup"><span data-stu-id="9cf17-489">Global catalog</span></span>](#BKMK_GC) |<span data-ttu-id="9cf17-490">글로벌 카탈로그를 설치합니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-490">Install global catalog?</span></span> |<li><span data-ttu-id="9cf17-491">단일 도메인 포리스트의 경우 모든 DC GC를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-491">For single-domain forest, make all DCs GCs</span></span></li> <li><span data-ttu-id="9cf17-492">다중 도메인 포리스트의 경우 인증에 GC가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-492">For multidomain forest, GCs are required for authentication</span></span></li> |
| [<span data-ttu-id="9cf17-493">설치 방법</span><span class="sxs-lookup"><span data-stu-id="9cf17-493">Installation method</span></span>](#BKMK_InstallMethod) |<span data-ttu-id="9cf17-494">Azure에서 DC를 설치하는 방법은 무엇입니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-494">How to install DC in Azure?</span></span> |<span data-ttu-id="9cf17-495">다음 중 한 방법으로 찾을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-495">Either:</span></span> <li><span data-ttu-id="9cf17-496">Windows PowerShell 또는 Dcpromo를 사용하여 AD DS 설치</span><span class="sxs-lookup"><span data-stu-id="9cf17-496">Install AD DS using Windows PowerShell or Dcpromo</span></span></li> <li><span data-ttu-id="9cf17-497">온-프레미스 가상 DC의 VHD 이동</span><span class="sxs-lookup"><span data-stu-id="9cf17-497">Move VHD of an on-premises virtual DC</span></span></li> |
| [<span data-ttu-id="9cf17-498">Windows Server AD DS 데이터베이스 및 SYSVOL의 배치</span><span class="sxs-lookup"><span data-stu-id="9cf17-498">Placement of the Windows Server AD DS database and SYSVOL</span></span>](#BKMK_PlaceDB) |<span data-ttu-id="9cf17-499">Windows Server AD DS 데이터베이스, 로그 및 SYSVOL을 저장하는 위치는 어디입니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-499">Where to store Windows Server AD DS database, logs, and SYSVOL?</span></span> |<span data-ttu-id="9cf17-500">Dcpromo.exe 기본값을 변경합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-500">Change Dcpromo.exe default values.</span></span> <span data-ttu-id="9cf17-501">이러한 중요한 Active Directory 파일은 쓰기 캐싱을 구현하는 운영 체제 디스크 대신 Azure Data Disks에 배치 *되어야* 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-501">These critical Active Directory files *must* be placed on Azure Data Disks instead of Operating System disks that implement write caching.</span></span> |
| [<span data-ttu-id="9cf17-502">백업 및 복원</span><span class="sxs-lookup"><span data-stu-id="9cf17-502">Backup and Restore</span></span>](#BKMK_BUR) |<span data-ttu-id="9cf17-503">데이터를 보호하고 복구하는 방법은 무엇입니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-503">How to safeguard and recover data?</span></span> |<span data-ttu-id="9cf17-504">시스템 상태 백업 만들기</span><span class="sxs-lookup"><span data-stu-id="9cf17-504">Create system state backups</span></span> |
| [<span data-ttu-id="9cf17-505">페더레이션 서버 구성</span><span class="sxs-lookup"><span data-stu-id="9cf17-505">Federation server configuration</span></span>](#BKMK_FedSrvConfig) |<li><span data-ttu-id="9cf17-506">클라우드에 페더레이션이 포함된 새 포리스트를 배포합니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-506">Deploy a new forest with federation in the cloud?</span></span></li> <li><span data-ttu-id="9cf17-507">AD FS 온-프레미스를 배포하고 클라우드에서 프록시를 노출합니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-507">Deploy AD FS on-premises and expose a proxy in the cloud?</span></span></li> |<li><span data-ttu-id="9cf17-508">보안</span><span class="sxs-lookup"><span data-stu-id="9cf17-508">Security</span></span></li> <li><span data-ttu-id="9cf17-509">규정 준수</span><span class="sxs-lookup"><span data-stu-id="9cf17-509">Compliance</span></span></li> <li><span data-ttu-id="9cf17-510">비용</span><span class="sxs-lookup"><span data-stu-id="9cf17-510">Cost</span></span></li> <li><span data-ttu-id="9cf17-511">비즈니스 파트너가 응용 프로그램에 액세스</span><span class="sxs-lookup"><span data-stu-id="9cf17-511">Access to applications by business partners</span></span></li> |
| [<span data-ttu-id="9cf17-512">클라우드 서비스 구성</span><span class="sxs-lookup"><span data-stu-id="9cf17-512">Cloud services configuration</span></span>](#BKMK_CloudSvcConfig) |<span data-ttu-id="9cf17-513">클라우드 서비스는 처음 가상 컴퓨터를 만들 때 암시적으로 배포됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-513">A cloud service is implicitly deployed the first time you create a virtual machine.</span></span> <span data-ttu-id="9cf17-514">추가 클라우드 서비스를 배포해야 하나요?</span><span class="sxs-lookup"><span data-stu-id="9cf17-514">Do you need to deploy additional cloud services?</span></span> |<li><span data-ttu-id="9cf17-515">VM에 인터넷에 대한 직접 노출이 필요합니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-515">Does a VM or VMs require direct exposure to the Internet?</span></span></li> <li> <span data-ttu-id="9cf17-516">서비스에 부하 분산이 필요합니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-516">Does the service require load-balancing?</span></span></li> |
| [<span data-ttu-id="9cf17-517">공용 및 개인 IP 주소 지정(동적 IP 및 가상 IP)에 대한 페더레이션 서버 요구 사항</span><span class="sxs-lookup"><span data-stu-id="9cf17-517">Federation server requirements for public and private IP addressing (dynamic IP vs. virtual IP)</span></span>](#BKMK_FedReqVIPDIP) |<li><span data-ttu-id="9cf17-518">Windows Server AD FS 인스턴스가 인터넷에서 직접 연결되어야 합니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-518">Does the Windows Server AD FS instance need to be reached directly from the Internet?</span></span></li> <li><span data-ttu-id="9cf17-519">고유한 인터넷 연결 IP 주소 및 포트가 클라우드에서 배포되는 응용 프로그램에 필요합니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-519">Does the application being deployed in the cloud require its own Internet-facing IP address and port?</span></span></li> |<span data-ttu-id="9cf17-520">배포에 필요한 각 가상 IP 주소에 대한 단일 클라우드 서비스 만들기</span><span class="sxs-lookup"><span data-stu-id="9cf17-520">Create one cloud-service for each virtual IP address that is required by your deployment</span></span> |
| [<span data-ttu-id="9cf17-521">Windows Server AD FS 고가용성 구성</span><span class="sxs-lookup"><span data-stu-id="9cf17-521">Windows Server AD FS high availability configuration</span></span>](#BKMK_ADFSHighAvail) |<li><span data-ttu-id="9cf17-522">Windows Server AD FS 서버 팜에 있는 노드는 몇 개입니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-522">How many nodes in my Windows Server AD FS server farm?</span></span></li> <li><span data-ttu-id="9cf17-523">Windows Server AD FS 프록시 팜에 배포할 노드는 몇 개입니까?</span><span class="sxs-lookup"><span data-stu-id="9cf17-523">How many nodes to deploy in my Windows Server AD FS proxy farm?</span></span></li> |<span data-ttu-id="9cf17-524">복원력 및 내결함성</span><span class="sxs-lookup"><span data-stu-id="9cf17-524">Resiliency and fault tolerance</span></span> |

### <span data-ttu-id="9cf17-525"><a name="BKMK_NetworkTopology"></a>네트워크 토폴로지</span><span class="sxs-lookup"><span data-stu-id="9cf17-525"><a name="BKMK_NetworkTopology"></a>Network topology</span></span>
<span data-ttu-id="9cf17-526">IP 주소 일관성과 Windows Server AD DS의 DNS 요구 사항을 충족하기 위해 먼저 [Azure 가상 네트워크](../virtual-network/virtual-networks-overview.md)를 만들고 가상 컴퓨터를 연결해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-526">In order to meet the IP address consistency and DNS requirements of Windows Server AD DS, it is necessary to first create an [Azure virtual network](../virtual-network/virtual-networks-overview.md) and attach your virtual machines to it.</span></span> <span data-ttu-id="9cf17-527">만드는 동안 필요에 따라 투명하게 Azure 가상 컴퓨터를 온-프레미스 컴퓨터에 연결하는 온-프레미스 회사 네트워크에 연결을 확장할지 여부를 결정해야 합니다. 이는 기존 VPN 기술을 사용하여 이루어지고 회사 네트워크의 가장자리에 VPN 끝점을 노출해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-527">During its creation, you must decide whether to optionally extend connectivity to your on-premises corporate network, which transparently connects Azure virtual machines to on-premises machines — this is achieved using traditional VPN technologies and requires that a VPN endpoint be exposed on the edge of the corporate network.</span></span> <span data-ttu-id="9cf17-528">즉, VPN은 Azure에서 회사 네트워크로 시작되며 반대의 경우는 아닙니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-528">That is, the VPN is initiated from Azure to the corporate network, not vice-versa.</span></span>

<span data-ttu-id="9cf17-529">각 VM에 적용되는 표준 요금 외 온-프레미스 네트워크에 가상 네트워크를 확장하는 경우 추가 요금이 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-529">Note that additional charges apply when extending a virtual network to your on-premises network beyond the standard charges that apply to each VM.</span></span> <span data-ttu-id="9cf17-530">특히 Azure 가상 네트워크 게이트웨이의 CPU 시간 및 VPN을 통해 온-프레미스 컴퓨터와 통신하는 각 VM에서 생성되는 송신 트래픽에 대한 요금이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-530">Specifically, there are charges for CPU time of the Azure Virtual Network gateway and for the egress traffic generated by each VM that communicates with on-premises machines across the VPN.</span></span> <span data-ttu-id="9cf17-531">네트워크 트래픽 요금에 대한 자세한 내용은 [한눈에 보는 Azure 가격 책정](http://azure.microsoft.com/pricing/)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-531">For more information about network traffic charges, see [Azure pricing at-a-glance](http://azure.microsoft.com/pricing/).</span></span>

### <span data-ttu-id="9cf17-532"><a name="BKMK_DeploymentConfig"></a>DC 배포 구성</span><span class="sxs-lookup"><span data-stu-id="9cf17-532"><a name="BKMK_DeploymentConfig"></a>DC deployment configuration</span></span>
<span data-ttu-id="9cf17-533">DC를 구성하는 방법은 Azure에서 실행하려는 서비스에 대한 요구 사항에 따라 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-533">The way you configure the DC depends on the requirements for the service you want to run on Azure.</span></span> <span data-ttu-id="9cf17-534">예를 들어 개념 증명 테스트용으로 고유한 회사 포리스트로부터 격리된 새 포리스트, 새 응용 프로그램 또는 내부 회사 리소스에 대한 특정 액세스가 아닌 디렉터리 서비스가 필요한 일부 다른 단기 프로젝트를 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-534">For example, you might deploy a new forest, isolated from your own corporate forest, for testing a proof-of-concept, a new application, or some other short term project that requires directory services but not specific access to internal corporate resources.</span></span>

<span data-ttu-id="9cf17-535">이점으로 분리된 포리스트 DC는 직접 비용을 절감하는 시스템 자체에서 생성된 적은 아웃바운드 네트워크 트래픽을 발생하여 온-프레미스 DC와 복제하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-535">As a benefit, an isolated forest DC does not replicate with on-premises DCs, resulting in less outbound network traffic generated by the system itself, directly reducing costs.</span></span> <span data-ttu-id="9cf17-536">네트워크 트래픽 요금에 대한 자세한 내용은 [한눈에 보는 Azure 가격 책정](http://azure.microsoft.com/pricing/)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-536">For more information about network traffic charges, see [Azure pricing at-a-glance](http://azure.microsoft.com/pricing/).</span></span>

<span data-ttu-id="9cf17-537">또 다른 예로 서비스에 대한 개인 정보 보호 요구 사항이 있지만 서비스가 내부 Windows Server Active Directory에 대한 액세스에 따라 달라진다고 가정합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-537">As another example, suppose you have privacy requirements for a service, but the service depends on access to your internal Windows Server Active Directory.</span></span> <span data-ttu-id="9cf17-538">클라우드의 서비스에 대한 데이터를 호스팅할 수 있으면 Azure에서 내부 포리스트에 대해 새 자식 도메인을 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-538">If you are allowed to host data for the service in the cloud, you might deploy a new child domain for your internal forest on Azure.</span></span> <span data-ttu-id="9cf17-539">이 경우 새 자식 도메인에 대한 DC를 배포할 수 있습니다(개인 정보 보호 문제를 해결하기 위해 글로벌 카탈로그 없이).</span><span class="sxs-lookup"><span data-stu-id="9cf17-539">In this case, you can deploy a DC for the new child domain (without the global catalog in order to help address privacy concerns).</span></span> <span data-ttu-id="9cf17-540">이 시나리오에서는 복제본 DC 배포와 함께 온-프레미스 DC와 연결하기 위한 가상 네트워크가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-540">This scenario, along with a replica DC deployment, requires a virtual network for connectivity with your on-premises DCs.</span></span>

<span data-ttu-id="9cf17-541">새 포리스트를 만드는 경우 [Active Directory 트러스트](https://technet.microsoft.com/library/cc771397) 또는 [페더레이션 트러스트](https://technet.microsoft.com/library/dd807036)의 사용 여부를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-541">If you create a new forest, choose whether to use [Active Directory trusts](https://technet.microsoft.com/library/cc771397) or [Federation trusts](https://technet.microsoft.com/library/dd807036).</span></span> <span data-ttu-id="9cf17-542">호환성, 보안, 규정 준수, 비용 및 복원 기능으로 지정된 요구 사항의 균형을 조정합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-542">Balance the requirements dictated by compatibility, security, compliance, cost, and resiliency.</span></span> <span data-ttu-id="9cf17-543">예를 들어 [선택적 인증](https://technet.microsoft.com/library/cc755844) 을 활용하기 위해 Azure의 새 포리스트를 배포하고 온-프레미스 포리스트 및 클라우드 포리스트 간에 Windows Server Active Directory 트러스트를 만들도록 선택할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-543">For example, to take advantage of [selective authentication](https://technet.microsoft.com/library/cc755844) you might choose to deploy a new forest on Azure and create a Windows Server Active Directory trust between the on-premises forest and the cloud forest.</span></span> <span data-ttu-id="9cf17-544">그러나 응용 프로그램이 클레임 인식인 경우 Active Directory 포리스트 트러스트 대신 페더레이션 트러스트를 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-544">If the application is claims-aware, however, you might deploy federation trusts instead of Active Directory forest trusts.</span></span> <span data-ttu-id="9cf17-545">또 다른 요소는 온-프레미스 Windows Server Active Directory를 클라우드로 확장하여 더 많은 데이터를 복제하거나 인증 및 쿼리 로드의 결과로 더 많은 아웃바운드 트래픽을 생성하는 비용입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-545">Another factor will be the cost to either replicate more data by extending your on-premises Windows Server Active Directory to the cloud or generate more outbound traffic as a result of authentication and query load.</span></span>

<span data-ttu-id="9cf17-546">가용성 및 내결함성에 대한 요구 사항은 선택에도 영향을 줍니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-546">Requirements for availability and fault tolerance also affect your choice.</span></span> <span data-ttu-id="9cf17-547">예를 들어 링크가 중단되는 경우 Kerberos 트러스트 또는 페더레이션 트러스트를 활용하는 응용 프로그램은 Azure에서 충분한 인프라를 배포하지 않은 한 모두 완전히 작동하지 않을 가능성이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-547">For example, if the link is interrupted, applications leveraging either a Kerberos trust or a federation trust are all likely entirely broken unless you have deployed sufficient infrastructure on Azure.</span></span> <span data-ttu-id="9cf17-548">복제본 DC와 같은 대체 배포 구성(쓰기 가능 또는 RODC)은 링크 중단을 허용할 수 있는 가능성을 높입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-548">Alternative deployment configurations such as replica DCs (writeable or RODCs) increase the likelihood of being able to tolerate link outages.</span></span>

### <span data-ttu-id="9cf17-549"><a name="BKMK_ADSiteTopology"></a>Windows Server Active Directory 사이트 토폴로지</span><span class="sxs-lookup"><span data-stu-id="9cf17-549"><a name="BKMK_ADSiteTopology"></a>Windows Server Active Directory site topology</span></span>
<span data-ttu-id="9cf17-550">트래픽을 최적화하고 비용을 최소화하기 위해 사이트 및 사이트 링크를 올바르게 정의해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-550">You need to correctly define sites and site links in order to optimize traffic and minimize cost.</span></span> <span data-ttu-id="9cf17-551">사이트, 사이트 링크 및 서브넷은 DC와 인증 트래픽 흐름 간의 복제 토폴로지에 영향을 줍니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-551">Sites, site-links, and subnets affect the replication topology between DCs and the flow of authentication traffic.</span></span> <span data-ttu-id="9cf17-552">다음 트래픽 요금을 고려한 다음 배포 시나리오의 요구 사항에 따라 DC를 배포 및 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-552">Consider the following traffic charges and then deploy and configure DCs according to the requirements of your deployment scenario:</span></span>

* <span data-ttu-id="9cf17-553">게이트웨이 자체에 대해 시간당 아주 적은 수수료가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-553">There is a nominal fee per hour for the gateway itself:</span></span>
  
  * <span data-ttu-id="9cf17-554">필요에 따라 시작 및 중지할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-554">It can be started and stopped as you see fit</span></span>
  * <span data-ttu-id="9cf17-555">중지된 경우 Azure VM은 회사 네트워크에서 격리됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-555">If stopped, Azure VMs are isolated from the corporate network</span></span>
* <span data-ttu-id="9cf17-556">인바운드 트래픽은 무료입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-556">Inbound traffic is free</span></span>
* <span data-ttu-id="9cf17-557">아웃바운드 트래픽은 [한눈에 보는 Azure 가격 책정](http://azure.microsoft.com/pricing/)에 따라 요금이 청구됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-557">Outbound traffic is charged, according to [Azure pricing at-a-glance](http://azure.microsoft.com/pricing/).</span></span> <span data-ttu-id="9cf17-558">다음과 같이 온-프레미스 사이트와 클라우드 사이트 간의 사이트 링크 속성을 최적화할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-558">You can optimize site link properties between on-premises sites and the cloud sites as follows:</span></span>
  
  * <span data-ttu-id="9cf17-559">여러 개의 가상 네트워크를 사용하는 경우 사이트 링크 및 해당 비용을 적절하게 구성하여 Windows Server AD DS가 동일한 수준의 서비스를 무료로 제공할 수 있는 것보다 Azure 사이트에 우선 순위를 두지 못하도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-559">If you are using multiple virtual networks, configure the site-links and their costs appropriately to prevent Windows Server AD DS from prioritizing the Azure site over one that can provide the same levels of service at no charge.</span></span> <span data-ttu-id="9cf17-560">BASL(브리지 모든 사이트 링크) 비활성화를 고려할 수도 있습니다(기본으로 활성화됨).</span><span class="sxs-lookup"><span data-stu-id="9cf17-560">You might also consider disabling the Bridge all site link (BASL) option (which is enabled by default).</span></span> <span data-ttu-id="9cf17-561">이렇게 하면 직접 연결된 사이트만 서로 복제합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-561">This ensures that only directly-connected sites replicate with one another.</span></span> <span data-ttu-id="9cf17-562">전이적으로 연결된 사이트의 DC는 더 이상 서로 직접 복제할 수는 없지만 공통 사이트 또는 사이트를 통해 복제해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-562">DCs in transitively connected sites are no longer able to replicate directly with each other, but must replicate through a common site or sites.</span></span> <span data-ttu-id="9cf17-563">중개 사이트가 어떤 이유로 사용 불가능해진 경우 전이적으로 연결된 사이트의 DC 간 복제는 사이트 간 연결을 사용할 수 있더라도 발생하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-563">If the intermediary sites become unavailable for some reason, replication between DCs in transitively connected sites will not occur even if connectivity between the sites is available.</span></span> <span data-ttu-id="9cf17-564">마지막으로 전이적 복제 동작의 섹션이 바람직하게 남아있는 곳에서 온-프레미스, 회사 네트워크 사이트와 같은 적절한 사이트 링크 및 사이트를 포함하는 사이트 링크 브리지를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-564">Finally, where sections of transitive replication behavior remain desirable, create site link bridges that contain the appropriate site-links and sites, such as on-premises, corporate network sites.</span></span>
  * <span data-ttu-id="9cf17-565">[사이트 링크 비용을 구성합니다](https://technet.microsoft.com/library/cc794882) .</span><span class="sxs-lookup"><span data-stu-id="9cf17-565">[Configure site link costs](https://technet.microsoft.com/library/cc794882) appropriately to avoid unintended traffic.</span></span> <span data-ttu-id="9cf17-566">예를 들어 **다음으로 가장 가까운 사이트 시도** 설정이 활성화된 경우 Azure 사이트를 회사 네트워크에 다시 연결하는 사이트 링크 개체와 관련된 비용을 증가시켜 가상 네트워크 사이트가 다음으로 가장 가까운 사이트가 아닌지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-566">For example, if **Try Next Closest Site** setting is enabled, make sure the virtual network sites are not the next closest by increasing the cost associated of the site-link object that connects the Azure site back to the corporate network.</span></span>
  * <span data-ttu-id="9cf17-567">일관성 요구 사항 및 개체 변경 비율에 따라 사이트 링크 [간격](https://technet.microsoft.com/library/cc794878) 및 [일정](https://technet.microsoft.com/library/cc816906)을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-567">Configure site link [intervals](https://technet.microsoft.com/library/cc794878) and [schedules](https://technet.microsoft.com/library/cc816906) according to consistency requirements and rate of object changes.</span></span> <span data-ttu-id="9cf17-568">복제 일정을 대기 시간 허용치에 맞춥니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-568">Align replication schedule with latency tolerance.</span></span> <span data-ttu-id="9cf17-569">DC는 값의 마지막 상태만을 복제하므로 충분한 개체 변경 비율이 있는 경우 복제 간격을 줄이면 비용을 절약할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-569">DCs replicate only the last state of a value, so decreasing the replication interval can save costs if there is a sufficient object change rate.</span></span>
* <span data-ttu-id="9cf17-570">비용 최소화가 매우 중요한 경우 복제가 예약되었고 변경 알림이 활성화되지 않았는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-570">If minimizing costs is a priority, ensure replication is scheduled and change notification is not enabled.</span></span> <span data-ttu-id="9cf17-571">사이트 간에 복제하는 경우 이것이 기본 구성입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-571">This is the default configuration when replicating between sites.</span></span> <span data-ttu-id="9cf17-572">RODC는 아웃바운드 변경 내용을 복제하지 않기 때문에 가상 네트워크에서 RODC를 배포하는 경우 중요하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-572">This is not important if you are deploying an RODC on a virtual network because the RODC will not replicate any changes outbound.</span></span> <span data-ttu-id="9cf17-573">하지만 쓰기 가능한 DC를 배포하는 경우 사이트 링크가 불필요한 빈도로 업데이트를 복제하도록 구성되지 않았는지 확인해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-573">But if you deploy a writable DC, you should make sure the site link is not configured to replicate updates with unnecessary frequency.</span></span> <span data-ttu-id="9cf17-574">GC(글로벌 카탈로그) 서버를 배포하는 경우 GC를 포함하는 다른 모든 사이트가 Azure 사이트에 있는 GC보다 비용이 낮은 사이트 링크와 연결된 사이트의 원본 DC에서 도메인 파티션을 복제하는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-574">If you deploy a global catalog server (GC), make sure that every other site that contains a GC replicates domain partitions from a source DC in a site that is connected with a site-link or site-links that have a lower cost than the GC in the Azure site.</span></span>
* <span data-ttu-id="9cf17-575">여전히 복제 압축 알고리즘을 변경하여 사이트 간 복제에 의해 생성된 네트워크 트래픽을 줄일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-575">It is possible to further still reduce network traffic generated by replication between sites by changing the replication compression algorithm.</span></span> <span data-ttu-id="9cf17-576">압축 알고리즘은 REG_DWORD 레지스트리 항목 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NTDS\Parameters\Replicator compression algorithm으로 제어됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-576">The compression algorithm is controlled by the REG_DWORD registry entry HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NTDS\Parameters\Replicator compression algorithm.</span></span> <span data-ttu-id="9cf17-577">기본값은 3이며 Xpress 압축 알고리즘과 관련이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-577">The default value is 3, which correlates to the Xpress Compress algorithm.</span></span> <span data-ttu-id="9cf17-578">값을 2로 변경할 수 있으며 알고리즘을 MSZip으로 변경합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-578">You can change the value to 2, which changes the algorithm to MSZip.</span></span> <span data-ttu-id="9cf17-579">대부분의 경우에서 이는 압축을 높이지만 CPU 사용률의 비용으로 그렇게 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-579">In most cases, this will increase the compression, but it does so at the expense of CPU utilization.</span></span> <span data-ttu-id="9cf17-580">자세한 내용은 [Active Directory 복제 토폴로지 작동 방법](https://technet.microsoft.com/library/cc755994)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-580">For more information, see [How Active Directory replication topology works](https://technet.microsoft.com/library/cc755994).</span></span>

### <span data-ttu-id="9cf17-581"><a name="BKMK_IPAddressDNS"></a>IP 주소 지정 및 DNS</span><span class="sxs-lookup"><span data-stu-id="9cf17-581"><a name="BKMK_IPAddressDNS"></a>IP addressing and DNS</span></span>
<span data-ttu-id="9cf17-582">Azure 가상 컴퓨터는 기본적으로 "DHCP 임대 주소"로 할당됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-582">Azure virtual machines are allocated “DHCP-leased addresses” by default.</span></span> <span data-ttu-id="9cf17-583">Azure 가상 네트워크 동적 주소는 가상 컴퓨터의 수명 동안 가상 컴퓨터와 지속되기 때문에 Windows Server AD DS의 요구 사항은 충족됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-583">Because Azure virtual network dynamic addresses persist with a virtual machine for the lifetime of the virtual machine, the requirements of Windows Server AD DS are met.</span></span>

<span data-ttu-id="9cf17-584">결과적으로 Azure에서 동적 주소를 사용하는 경우 임대 기간 동안 라우팅할 수 있으므로 사실상 고정 IP 주소를 사용하고 있으며 임대 기간은 클라우드 서비스의 수명과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-584">As a result, when you use a dynamic address on Azure, you are in effect using a static IP address because it is routable for the period of the lease, and the period of the lease is equal to the lifetime of the cloud service.</span></span>

<span data-ttu-id="9cf17-585">그러나 VM이 종료되는 경우 동적 주소가 할당됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-585">However, the dynamic address is deallocated if the VM is shutdown.</span></span> <span data-ttu-id="9cf17-586">IP 주소를 할당 취소되지 않도록 하려면 [Set-AzureStaticVNetIP를 사용하여 고정 IP 주소를 할당](http://social.technet.microsoft.com/wiki/contents/articles/23447.how-to-assign-a-private-static-ip-to-an-azure-vm.aspx)할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-586">To prevent the IP address from being deallocated, you can [use Set-AzureStaticVNetIP to assign a static IP address](http://social.technet.microsoft.com/wiki/contents/articles/23447.how-to-assign-a-private-static-ip-to-an-azure-vm.aspx).</span></span>

<span data-ttu-id="9cf17-587">이름 확인을 위해 사용자 고유의(또는 기존 것 활용) DNS 서버 인프라를 배포합니다. Azure 제공 DNS는 Windows Server AD DS의 고급 이름 확인 요구 사항을 충족하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-587">For name resolution, deploy your own (or leverage your existing) DNS server infrastructure; Azure-provided DNS does not meet the advanced name resolution needs of Windows Server AD DS.</span></span> <span data-ttu-id="9cf17-588">예를 들어 동적 SRV 레코드 등을 지원하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-588">For example, it does not support dynamic SRV records, and so on.</span></span> <span data-ttu-id="9cf17-589">이름 확인은 DC 및 도메인에 가입된 클라이언트에 대한 중요한 구성 항목입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-589">Name resolution is a critical configuration item for DCs and domain-joined clients.</span></span> <span data-ttu-id="9cf17-590">DC는 리소스 레코드를 등록하고 다른 DC의 리소스 레코드를 해결해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-590">DCs must be capable of registering resource records and resolving other DC’s resource records.</span></span>
<span data-ttu-id="9cf17-591">내결함성과 성능상의 이유로 Azure에서 실행되는 DC에 Windows Server DNS 서비스를 설치하는 데 적합합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-591">For fault tolerance and performance reasons, it is optimal to install the Windows Server DNS service on the DCs running on Azure.</span></span> <span data-ttu-id="9cf17-592">그런 다음 DNS 서버의 이름 및 IP 주소로 Azure 가상 네트워크 속성을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-592">Then configure the Azure virtual network properties with the name and IP address of the DNS server.</span></span> <span data-ttu-id="9cf17-593">가상 네트워크에 있는 다른 VM을 시작하는 경우 해당 DNS 클라이언트 확인자 설정은 동적 IP 주소 할당의 일부로 DNS 서버로 구성됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-593">When other VMs on the virtual network start, their DNS client resolver settings will be configured with DNS server as part of the dynamic IP address allocation.</span></span>

> [!NOTE]
> <span data-ttu-id="9cf17-594">인터넷을 통해 직접 Azure에서 호스팅되는 Windows Server AD DS Active Directory 도메인에 온-프레미스 컴퓨터를 가입할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-594">You cannot join on-premises computers to a Windows Server AD DS Active Directory domain that is hosted on Azure directly over the Internet.</span></span> <span data-ttu-id="9cf17-595">Active Directory 및 도메인 가입 작업에 대한 포트 요구 사항은 필요한 포트 및 사실상 전체 DC를 인터넷에 직접 노출하는 데 불가능한 것으로 렌더링합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-595">The port requirements for Active Directory and the domain-join operation render it impractical to directly expose the necessary ports and in effect, an entire DC to the Internet.</span></span>
> 
> 

<span data-ttu-id="9cf17-596">VM은 시작 시 또는 이름 변경 내용이 있을 때 자동으로 해당 DNS 이름을 등록합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-596">VMs register their DNS name automatically on startup or when there is a name change.</span></span>

<span data-ttu-id="9cf17-597">첫 번째 VM을 프로비전하고 AD DS를 설치하는 방법을 보여 주는 이 예제 및 다른 예제에 대한 자세한 내용은 [Microsoft Azure에서 새 Active Directory 포리스트 설치](active-directory-new-forest-virtual-machine.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-597">For more information about this example and another example that shows how to provision the first VM and install AD DS on it, see [Install a new Active Directory forest on Microsoft Azure](active-directory-new-forest-virtual-machine.md).</span></span> <span data-ttu-id="9cf17-598">Windows PowerShell 사용에 대한 자세한 내용은 [Azure PowerShell 설치](/powershell/azureps-cmdlets-docs) 및 [Azure 관리 Cmdlet](/powershell/module/azurerm.compute/#virtual_machines)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-598">For more information about using Windows PowerShell, see [Install Azure PowerShell](/powershell/azureps-cmdlets-docs) and [Azure Management Cmdlets](/powershell/module/azurerm.compute/#virtual_machines).</span></span>

### <span data-ttu-id="9cf17-599"><a name="BKMK_DistributedDCs"></a>지리적으로 분산된 DC</span><span class="sxs-lookup"><span data-stu-id="9cf17-599"><a name="BKMK_DistributedDCs"></a>Geo-distributed DCs</span></span>
<span data-ttu-id="9cf17-600">Azure는 서로 다른 가상 네트워크에 여러 DC를 호스팅하는 경우 이점을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-600">Azure offers advantages when hosting multiple DCs on different virtual networks:</span></span>

* <span data-ttu-id="9cf17-601">다중 사이트 내결함성</span><span class="sxs-lookup"><span data-stu-id="9cf17-601">Multi-site fault-tolerance</span></span>
* <span data-ttu-id="9cf17-602">지사(대기 시간 단축)에 대한 물리적 근접성</span><span class="sxs-lookup"><span data-stu-id="9cf17-602">Physical proximity to branch offices (lower latency)</span></span>

<span data-ttu-id="9cf17-603">가상 네트워크 간의 직접 통신을 구성하는 방법에 대한 정보는 [가상 네트워크 연결에 가상 네트워크 구성](../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-603">For information about configuring direct communication between virtual networks, see [Configure virtual network to virtual network connectivity](../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md).</span></span>

### <span data-ttu-id="9cf17-604"><a name="BKMK_RODC"></a>읽기 전용 DC</span><span class="sxs-lookup"><span data-stu-id="9cf17-604"><a name="BKMK_RODC"></a>Read-only DCs</span></span>
<span data-ttu-id="9cf17-605">읽기 전용 또는 쓰기 가능 DC를 배포할지 여부를 선택해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-605">You need to choose whether to deploy read-only or writeable DCs.</span></span> <span data-ttu-id="9cf17-606">물리적으로 제어할 수 없지만 RODC는 지사와 같은 해당 물리적 보안이 위험한 위치에 배포되도록 설계되었기 때문에 RODC를 배포할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-606">You might be inclined to deploy RODCs because you will not have physical control over them, but RODCs are designed to be deployed in locations where their physical security is at risk, such as branch offices.</span></span>

<span data-ttu-id="9cf17-607">Azure는 지사의 물리적 보안 위험을 제공하지 않지만 RODC가 제공하는 기능은 매우 다양한 이유로 이러한 환경에 적합하므로 RODC는 여전히 더욱 비용 효율적인 것으로 입증될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-607">Azure does not present the physical security risk of a branch office, but RODCs might still prove to be more cost effective because the features they provide are well-suited to these environments albeit for very different reasons.</span></span> <span data-ttu-id="9cf17-608">예를 들어 RODC는 아웃바운드 복제가 없으며 선택적으로 비밀(암호)을 채울 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-608">For example, RODCs have no outbound replication and are able to selectively populate secrets (passwords).</span></span> <span data-ttu-id="9cf17-609">단점으로 이러한 암호의 부족은 사용자 또는 컴퓨터 인증으로 유효성을 검사하는 주문형 아웃바운드 트래픽이 필요할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-609">On the downside, the lack of these secrets might require on-demand outbound traffic to validate them as a user or computer authenticates.</span></span> <span data-ttu-id="9cf17-610">그러나 암호는 선택적으로 미리 채워지고 캐시할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-610">But secrets can be selectively prepopulated and cached.</span></span>

<span data-ttu-id="9cf17-611">RODC는 RODC FAS(필터링된 특성 집합)에 대한 중요한 데이터를 포함하는 특성을 추가할 수 있으므로 HBI 및 PII 문제와 관련된 추가적인 이점을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-611">RODCs provide an additional advantage in and around HBI and PII concerns because you can add attributes that contain sensitive data to the RODC filtered attribute set (FAS).</span></span> <span data-ttu-id="9cf17-612">FAS는 RODC에 복제되지 않은 사용자 지정 가능한 특성 집합입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-612">The FAS is a customizable set of attributes that are not replicated to RODCs.</span></span> <span data-ttu-id="9cf17-613">허용되지 않거나 Azure에 PII 또는 HBI를 저장하지 않으려는 경우 FAS를 보호 장치로 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-613">You can use the FAS as a safeguard in case you are not permitted or do not want to store PII or HBI on Azure.</span></span> <span data-ttu-id="9cf17-614">자세한 내용은 RODC 필터링된 특성 집합[(https://technet.microsoft.com/library/cc753459)]을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-614">For more information, see [RODC filtered attribute set[(https://technet.microsoft.com/library/cc753459)].</span></span>

<span data-ttu-id="9cf17-615">응용 프로그램이 사용하려는 RODC와 호환되는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-615">Make sure that applications will be compatible with RODCs you plan to use.</span></span> <span data-ttu-id="9cf17-616">많은 Windows Server Active Directory 사용 응용 프로그램은 RODC와 잘 작동하지만 쓰기 가능한 DC에 대한 액세스가 없는 경우 일부 응용 프로그램은 비효율적으로 수행하거나 실패할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-616">Many Windows Server Active Directory-enabled applications work well with RODCs, but some applications can perform inefficiently or fail if they do not have access to a writable DC.</span></span> <span data-ttu-id="9cf17-617">자세한 내용은 [읽기 전용 DC 응용 프로그램 호환성 가이드](https://technet.microsoft.com/library/cc755190)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-617">For more information, see [Read-Only DCs application compatibility guide](https://technet.microsoft.com/library/cc755190).</span></span>

### <span data-ttu-id="9cf17-618"><a name="BKMK_GC"></a>글로벌 카탈로그</span><span class="sxs-lookup"><span data-stu-id="9cf17-618"><a name="BKMK_GC"></a>Global catalog</span></span>
<span data-ttu-id="9cf17-619">글로벌 카탈로그(GC) 설치 여부를 선택해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-619">You need to choose whether to install a global catalog (GC).</span></span> <span data-ttu-id="9cf17-620">단일 도메인 포리스트에서 모든 DC를 글로벌 카탈로그 서버로 구성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-620">In a single domain forest, you should configure all DCs as global catalog servers.</span></span> <span data-ttu-id="9cf17-621">추가 복제 트래픽이 없기 때문에 비용이 증가하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-621">It will not increase costs because there will be no additional replication traffic.</span></span>

<span data-ttu-id="9cf17-622">다중 도메인 포리스트에서 GC는 인증 프로세스 중에 유니버설 그룹 구성원 자격을 확장해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-622">In a multidomain forest, GCs are necessary to expand Universal Group memberships during the authentication process.</span></span> <span data-ttu-id="9cf17-623">GC를 배포하지 않는 경우 Azure에서 DC에 대해 인증하는 가상 네트워크의 작업은 각 인증 시도 중 온-프레미스에서 GC를 쿼리하도록 아웃바운드 인증 트래픽을 간접적으로 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-623">If you do not deploy a GC, workloads on the virtual network that authenticate against a DC on Azure will indirectly generate outbound authentication traffic to query GCs on-premises during each authentication attempt.</span></span>

<span data-ttu-id="9cf17-624">GC는 모든 도메인(부분에서)을 호스팅하기 때문에 GC와 관련된 비용은 예측하기가 어렵습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-624">The costs associated with GCs are less-predictable because they host every domain (in-part).</span></span> <span data-ttu-id="9cf17-625">작업이 인터넷 서비스를 호스팅하고 Windows Server AD DS에 대한 사용자를 인증하는 경우 비용은 완전히 예측할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-625">If the workload hosts an Internet-facing service and authenticates users against Windows Server AD DS, the costs could be completely unpredictable.</span></span> <span data-ttu-id="9cf17-626">인증하는 동안 클라우드 사이트 외부의 GC 쿼리를 줄이려면 [유니버설 그룹 구성원 자격 캐싱을 활성화](https://technet.microsoft.com/library/cc816928)할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-626">To help reduce GC queries outside of the cloud site during authentication, you can [enable Universal Group Membership Caching](https://technet.microsoft.com/library/cc816928).</span></span>

### <span data-ttu-id="9cf17-627"><a name="BKMK_InstallMethod"></a>설치 방법</span><span class="sxs-lookup"><span data-stu-id="9cf17-627"><a name="BKMK_InstallMethod"></a>Installation method</span></span>
<span data-ttu-id="9cf17-628">가상 네트워크에 DC를 설치하는 방법을 선택해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-628">You need to choose how to install the DCs on the virtual network:</span></span>

* <span data-ttu-id="9cf17-629">새 DC를 승격합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-629">Promote new DCs.</span></span> <span data-ttu-id="9cf17-630">자세한 내용은 [Azure 가상 네트워크에 새 Active Directory 포리스트 설치](active-directory-new-forest-virtual-machine.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-630">For more information, see [Install a new Active Directory forest on an Azure virtual network](active-directory-new-forest-virtual-machine.md).</span></span>
* <span data-ttu-id="9cf17-631">온-프레미스 가상 DC의 VHD를 클라우드로 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-631">Move the VHD of an on-premises virtual DC to the cloud.</span></span> <span data-ttu-id="9cf17-632">이 경우 온-프레미스 가상 DC가 "복사됨" 또는 "복제됨"이 아닌 "이동됨"인지 확인해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-632">In this case, you must ensure that the on-premises virtual DC is “moved,” not “copied” or “cloned.”</span></span>

<span data-ttu-id="9cf17-633">DC에 대한 Azure 가상 컴퓨터만 사용합니다(Azure "웹" 또는 "작업자" 역할 VM과 달리).</span><span class="sxs-lookup"><span data-stu-id="9cf17-633">Use only Azure virtual machines for DCs (as opposed to Azure “web” or “worker” role VMs).</span></span> <span data-ttu-id="9cf17-634">지속성이 있으며 DC에 대한 상태의 내구성이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-634">They are durable and durability of state for a DC is required.</span></span> <span data-ttu-id="9cf17-635">Azure 가상 컴퓨터는 DC와 같은 작업을 위해 설계되었습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-635">Azure virtual machines are designed for workloads such as DCs.</span></span>

<span data-ttu-id="9cf17-636">SYSPREP를 사용하여 DC를 배포하거나 복제하지 마십시오.</span><span class="sxs-lookup"><span data-stu-id="9cf17-636">Do not use SYSPREP to deploy or clone DCs.</span></span> <span data-ttu-id="9cf17-637">DC를 복제하는 기능은 Windows Server 2012부터 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-637">The ability to clone DCs is only available beginning in Windows Server 2012.</span></span> <span data-ttu-id="9cf17-638">복제 기능을 사용하려면 기본 하이퍼바이저에서 VMGenerationID에 대한 지원이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-638">The cloning feature requires support for VMGenerationID in the underlying hypervisor.</span></span> <span data-ttu-id="9cf17-639">Windows Server 2012 및 Azure 가상 네트워크의 Hyper-V는 모두 타사 가상화 소프트웨어 공급 업체와 마찬가지로 VMGenerationID를 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-639">Hyper-V in Windows Server 2012 and Azure virtual networks both support VMGenerationID, as do third-party virtualization software vendors.</span></span>

### <span data-ttu-id="9cf17-640"><a name="BKMK_PlaceDB"></a>Windows Server AD DS 데이터베이스 및 SYSVOL의 배치</span><span class="sxs-lookup"><span data-stu-id="9cf17-640"><a name="BKMK_PlaceDB"></a>Placement of the Windows Server AD DS database and SYSVOL</span></span>
<span data-ttu-id="9cf17-641">Windows Server AD DS 데이터베이스, 로그 및 SYSVOL을 배치할 위치를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-641">Select where to locate the Windows Server AD DS database, logs, and SYSVOL.</span></span> <span data-ttu-id="9cf17-642">Azure 데이터 디스크에 배포해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-642">They must be deployed on Azure Data disks.</span></span>

> [!NOTE]
> <span data-ttu-id="9cf17-643">Azure 데이터 디스크는 1TB로 제한됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-643">Azure Data disks are constrained to 1 TB.</span></span>
> 
> 

<span data-ttu-id="9cf17-644">데이터 디스크 드라이브는 기본적으로 쓰기를 캐시하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-644">Data disk drives do not cache writes by default.</span></span> <span data-ttu-id="9cf17-645">VM에 연결되어 있는 데이터 디스크 드라이브는 write-through 캐싱을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-645">Data disk drives that are attached to a VM use write-through caching.</span></span> <span data-ttu-id="9cf17-646">write-through 캐싱을 통해 VM의 운영 체제의 관점에서 트랜잭션이 완료되기 전에 쓰기가 지속형 Azure 저장소에 커밋되었는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-646">Write-through caching makes sure the write is committed to durable Azure storage before the transaction is complete from the perspective of the VM’s operating system.</span></span> <span data-ttu-id="9cf17-647">쓰기 속도가 약간 느려지는 대신 지속성을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-647">It provides durability, at the expense of slightly slower writes.</span></span>

<span data-ttu-id="9cf17-648">write-behind 캐싱은 DC에서 만든 가정을 무효화하므로 Windows Server AD DS의 경우 중요합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-648">This is important for Windows Server AD DS because write-behind disk-caching invalidates assumptions made by the DC.</span></span> <span data-ttu-id="9cf17-649">Windows Server AD DS에서 쓰기 캐싱을 비활성화하려고 하지만 이를 인식하는 디스크 IO 시스템에 따라 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-649">Windows Server AD DS attempts to disable write caching but it is up to the disk IO system to honor it.</span></span> <span data-ttu-id="9cf17-650">특정 상황에서 쓰기 캐싱 비활성화에 대한 실패는 느린 개체 및 다른 문제를 발생시키는 USN 롤백을 도입합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-650">Failure to disable write caching may, under certain circumstances, introduce USN rollback resulting in lingering objects and other problems.</span></span>

<span data-ttu-id="9cf17-651">가상 DC에 대한 모범 사례로 다음을 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-651">As a best practice for virtual DCs, do the following:</span></span>

* <span data-ttu-id="9cf17-652">Azure 데이터 디스크의 호스트 캐시 기본 설정을 없음으로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-652">Set the Host Cache Preference setting on the Azure data disk for NONE.</span></span> <span data-ttu-id="9cf17-653">이는 AD DS 작업에 대한 쓰기 캐싱을 사용하여 문제를 방지합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-653">This prevents issues with write caching for AD DS operations.</span></span>
* <span data-ttu-id="9cf17-654">동일한 데이터 디스크나 별도 데이터 디스크에 데이터베이스, 로그 및 SYSVOL을 저장합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-654">Store the database, logs, and SYSVOL on the either same data disk or separate data disks.</span></span> <span data-ttu-id="9cf17-655">일반적으로 운영 체제 자체에 사용되는 디스크와 별도 디스크입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-655">Typically, this is a separate disk from the disk used for the operating system itself.</span></span> <span data-ttu-id="9cf17-656">핵심 내용은 Windows Server AD DS 데이터베이스 및 SYSVOL이 Azure 운영 체제 디스크 유형에 저장되지 않아야 한다는 점입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-656">The key takeaway is that the Windows Server AD DS database and SYSVOL must not be stored on an Azure Operating System disk type.</span></span> <span data-ttu-id="9cf17-657">기본적으로 AD DS 설치 프로세스는 Azure에 권장되지 않는 %systemroot% 폴더에 이러한 구성 요소를 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-657">By default, the AD DS installation process installs these components in %systemroot% folder, which is NOT recommended for Azure.</span></span>

### <span data-ttu-id="9cf17-658"><a name="BKMK_BUR"></a>백업 및 복원</span><span class="sxs-lookup"><span data-stu-id="9cf17-658"><a name="BKMK_BUR"></a>Backup and restore</span></span>
<span data-ttu-id="9cf17-659">일반적으로 DC 및 보다 구체적으로 VM에서 실행되는 것의 백업 및 복원에 지원되는 것과 지원되지 않는 것을 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-659">Be aware of what is and is not supported for backup and restore of a DC in general, and more specifically, those running in a VM.</span></span> <span data-ttu-id="9cf17-660">[가상화된 DC에 대한 백업 및 복원 고려 사항](https://technet.microsoft.com/library/virtual_active_directory_domain_controller_virtualization_hyperv#backup_and_restore_considerations_for_virtualized_domain_controllers)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-660">See [Backup and Restore Considerations for Virtualized DCs](https://technet.microsoft.com/library/virtual_active_directory_domain_controller_virtualization_hyperv#backup_and_restore_considerations_for_virtualized_domain_controllers).</span></span>

<span data-ttu-id="9cf17-661">Windows Server 백업과 같은 Windows Server AD DS에 대한 백업 요구 사항을 특별히 인식하는 백업 소프트웨어만을 사용하여 시스템 상태 백업을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-661">Create system state backups by using only backup software that is specifically aware of backup requirements for Windows Server AD DS, such as Windows Server Backup.</span></span>

<span data-ttu-id="9cf17-662">정기 백업을 수행하는 대신 DC의 VHD 파일을 복사하거나 복제하지 마십시오.</span><span class="sxs-lookup"><span data-stu-id="9cf17-662">Do not copy or clone VHD files of DCs instead of performing regular backups.</span></span> <span data-ttu-id="9cf17-663">복원이 필요한 경우 Windows Server 2012 및 지원되는 하이퍼바이저 없이 복제되거나 복사된 VHD를 사용하여 수행하면 USN 거품이 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-663">Should a restore ever be required, doing so using cloned or copied VHDs without Windows Server 2012 and a supported hypervisor will introduce USN bubbles.</span></span>

### <span data-ttu-id="9cf17-664"><a name="BKMK_FedSrvConfig"></a>페더레이션 서버 구성</span><span class="sxs-lookup"><span data-stu-id="9cf17-664"><a name="BKMK_FedSrvConfig"></a>Federation server configuration</span></span>
<span data-ttu-id="9cf17-665">Windows Server AD FS 페더레이션 서버(STS)의 구성은 Azure에 배포하려는 응용 프로그램을 온-프레미스 네트워크의 리소스에 액세스해야 하는지 여부에 따라 부분적으로 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-665">The configuration of Windows Server AD FS federation servers (STSs) depends in part on whether the applications that you want to deploy on Azure need to access resources on your on-premises network.</span></span>

<span data-ttu-id="9cf17-666">응용 프로그램이 다음 조건을 충족하는 경우 온-프레미스 네트워크에서 격리된 상태에서 응용 프로그램을 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-666">If the applications meet the following criteria, you could deploy the applications in isolation from your on-premises network.</span></span>

* <span data-ttu-id="9cf17-667">SAML 보안 토큰에 동의합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-667">They accept SAML security tokens</span></span>
* <span data-ttu-id="9cf17-668">인터넷에 노출 가능합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-668">They are exposable to the Internet</span></span>
* <span data-ttu-id="9cf17-669">온-프레미스 리소스에 액세스하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-669">They do not access on-premises resources</span></span>

<span data-ttu-id="9cf17-670">이 경우 Windows Server AD FS STS를 다음과 같이 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-670">In this case, configure Windows Server AD FS STSs as follows:</span></span>

1. <span data-ttu-id="9cf17-671">Azure에서 분리된 단일 도메인 포리스트를 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-671">Configure an isolated single-domain forest on Azure.</span></span>
2. <span data-ttu-id="9cf17-672">Windows Server AD FS 페더레이션 서버 팜을 구성하여 포리스트에 대한 페더레이션된 액세스를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-672">Provide federated access to the forest by configuring a Windows Server AD FS federation server farm.</span></span>
3. <span data-ttu-id="9cf17-673">온-프레미스 포리스트에서 Windows Server AD FS(페더레이션 서버 팜 및 페더레이션 서버 프록시 팜)를 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-673">Configure Windows Server AD FS (federation server farm and federation server proxy farm) in the on-premises forest.</span></span>
4. <span data-ttu-id="9cf17-674">온-프레미스 및 Windows Server AD FS의 Azure 인스턴스 간에 페더레이션 트러스트 관계를 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-674">Establish a federation trust relationship between the on-premises and Azure instances of Windows Server AD FS.</span></span>

<span data-ttu-id="9cf17-675">반면에 응용 프로그램에 온-프레미스 리소스에 대한 액세스가 필요한 경우 다음과 같이 Azure의 응용 프로그램으로 Windows Server AD FS를 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-675">On the other hand, if the applications require access to on-premises resources, you could configure Windows Server AD FS with the application on Azure as follows:</span></span>

1. <span data-ttu-id="9cf17-676">온-프레미스 네트워크와 Azure 간의 연결을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-676">Configure connectivity between on-premises networks and Azure.</span></span>
2. <span data-ttu-id="9cf17-677">온-프레미스 포리스트에서 Windows Server AD FS 페더레이션 서버 팜을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-677">Configure a Windows Server AD FS federation server farm in the on-premises forest.</span></span>
3. <span data-ttu-id="9cf17-678">Azure에서 Windows Server AD FS 페더레이션 서버 프록시 팜을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-678">Configure a Windows Server AD FS federation server proxy farm on Azure.</span></span>

<span data-ttu-id="9cf17-679">이 구성에는 경계 네트워크의 응용 프로그램으로 Windows Server AD FS를 구성할 때와 마찬가지로 온-프레미스 리소스의 노출을 줄이는 이점이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-679">This configuration has the advantage of reducing the exposure of on-premises resources, similar to configuring Windows Server AD FS with applications in a perimeter network.</span></span>

<span data-ttu-id="9cf17-680">어느 시나리오에서든 B2B 공동 작업이 필요한 경우 더 많은 ID 공급자로 트러스트 관계를 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-680">Note that in either scenario, you can establish trusts relationships with more identity providers, if business-to-business collaboration is needed.</span></span>

### <span data-ttu-id="9cf17-681"><a name="BKMK_CloudSvcConfig"></a>클라우드 서비스 구성</span><span class="sxs-lookup"><span data-stu-id="9cf17-681"><a name="BKMK_CloudSvcConfig"></a>Cloud services configuration</span></span>
<span data-ttu-id="9cf17-682">VM을 인터넷에 직접 노출하거나 인터넷 연결 부하 분산된 응용 프로그램을 노출하려는 경우 클라우드 서비스가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-682">Cloud services are necessary if you want to expose a VM directly to the Internet or to expose an Internet-facing load-balanced application.</span></span> <span data-ttu-id="9cf17-683">각 클라우드 서비스는 단일 구성 가능한 가상 IP 주소를 제공하기 때문에 이것이 가능합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-683">This is possible because each cloud service offers a single configurable virtual IP address.</span></span>

### <span data-ttu-id="9cf17-684"><a name="BKMK_FedReqVIPDIP"></a>공용 및 개인 IP 주소 지정(동적 IP 및 가상 IP)에 대한 페더레이션 서버 요구 사항</span><span class="sxs-lookup"><span data-stu-id="9cf17-684"><a name="BKMK_FedReqVIPDIP"></a>Federation server requirements for public and private IP addressing (dynamic IP vs. virtual IP)</span></span>
<span data-ttu-id="9cf17-685">각 Azure 가상 컴퓨터는 동적 IP 주소를 받습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-685">Each Azure virtual machine receives a dynamic IP address.</span></span> <span data-ttu-id="9cf17-686">동적 IP 주소는 Azure 내에서만 액세스할 수 있는 개인 주소입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-686">A dynamic IP address is a private address accessible only within Azure.</span></span> <span data-ttu-id="9cf17-687">그러나 대부분의 경우에서 Windows Server AD FS 배포에 대한 가상 IP 주소를 구성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-687">In most cases, however, it will be necessary to configure a virtual IP address for your Windows Server AD FS deployments.</span></span> <span data-ttu-id="9cf17-688">가상 IP는 Windows Server AD FS 끝점을 인터넷에 노출하는 데 필요하며 인증 및 지속적인 관리를 위해 페더레이션된 파트너와 클라이언트에서 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-688">The virtual IP is necessary to expose Windows Server AD FS endpoints to the Internet, and will be used by federated partners and clients for authentication and ongoing management.</span></span> <span data-ttu-id="9cf17-689">가상 IP 주소는 하나 이상의 Azure 가상 컴퓨터를 포함하는 클라우드 서비스의 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-689">A virtual IP address is a property of a cloud service which contains one or more Azure virtual machines.</span></span> <span data-ttu-id="9cf17-690">Azure 및 Windows Server AD FS에 배포된 클레임 인식 응용 프로그램은 모두 인터넷에 연결되어 있고 공통 포트를 공유하며 각각은 자체의 가상 IP 주소가 필요하므로 응용 프로그램에 대한 하나의 클라우드 서비스 및 Windows Server AD FS에 대한 두 번째를 만드는 데 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-690">If the claims-aware application deployed on Azure and Windows Server AD FS are both Internet-facing and share common ports, each will require a virtual IP address of its own and it will therefore be necessary to create one cloud service for the application and a second for Windows Server AD FS.</span></span>

<span data-ttu-id="9cf17-691">가상 IP 주소 및 동적 IP 주소의 용어 정의는 [용어 및 정의](#BKMK_Glossary)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-691">For definitions of the terms virtual IP address and dynamic IP address, see [Terms and definitions](#BKMK_Glossary).</span></span>

### <span data-ttu-id="9cf17-692"><a name="BKMK_ADFSHighAvail"></a>Windows Server AD FS 고가용성 구성</span><span class="sxs-lookup"><span data-stu-id="9cf17-692"><a name="BKMK_ADFSHighAvail"></a>Windows Server AD FS high availability configuration</span></span>
<span data-ttu-id="9cf17-693">독립 실행형 Windows Server AD FS 페더레이션 서비스를 배포할 수 있지만 AD FS STS와 프로덕션 환경에 대한 프록시에 대한 두 개 이상의 노드가 포함된 팜을 배포하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-693">While it is possible to deploy standalone Windows Server AD FS federation services, it is recommended to deploy a farm with at least two nodes for both AD FS STS and proxies for production environments.</span></span>

<span data-ttu-id="9cf17-694">[AD FS 2.0 디자인 가이드](https://technet.microsoft.com/library/dd807036)의 [AD FS 2.0 배포 토폴로지 고려 사항](https://technet.microsoft.com/library/gg982489)을 참조하여 특정 필요에 가장 잘 맞는 배포 구성 옵션을 결정합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-694">See [AD FS 2.0 deployment topology considerations](https://technet.microsoft.com/library/gg982489) in the [AD FS 2.0 Design Guide](https://technet.microsoft.com/library/dd807036) to decide which deployment configuration options best suit your particular needs.</span></span>

> [!NOTE]
> <span data-ttu-id="9cf17-695">Azure에서 Windows Server AD FS 끝점에 대해 부하 분산하려면 동일한 클라우드 서비스에서 Windows Server AD FS 팜의 모든 구성원을 구성하고 HTTP(기본값 80) 및 HTTPS 포트(기본값 443)에 대한 Azure의 부하 분산 기능을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-695">In order to get load balancing for Windows Server AD FS endpoints on Azure, configure all members of the Windows Server AD FS farm in the same cloud service, and use the load balancing capability of Azure for HTTP (default 80) and HTTPS ports (default 443).</span></span> <span data-ttu-id="9cf17-696">자세한 내용은 [Azure 부하 분산 장치 프로브](https://msdn.microsoft.com/library/azure/jj151530)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9cf17-696">For more information, see [Azure load-balancer probe](https://msdn.microsoft.com/library/azure/jj151530).</span></span>
> <span data-ttu-id="9cf17-697">Windows Server NLB(네트워크 부하 분산)는 Azure에서 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9cf17-697">Windows Server Network Load Balancing (NLB) is not supported on Azure.</span></span>
> 
> 

