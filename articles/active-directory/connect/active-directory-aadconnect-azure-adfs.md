---
title: "Azure의 Active Directory Federation Services | Microsoft Docs"
description: "이 문서에서는 고가용성을 위해 Azure에서 AD FS를 배포하는 방법을 알아봅니다."
keywords: "Azure에 AD FS 배포, Azure ADFS 배포, Azure ADFS, Azure AD FS, ADFS 배포, AD FS 배포, Azure에서 ADFS, Azure에서 ADFS 배포, Azure에서 AD FS배포, ADFS Azure, AD FS 소개, Azure, Azure에서 AD FS, IaaS, ADFS, Azure에 ADFS 이동"
services: active-directory
documentationcenter: 
author: anandyadavmsft
manager: femila
editor: 
ms.assetid: 692a188c-badc-44aa-ba86-71c0e8074510
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 07/17/2017
ms.author: anandy; billmath
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: ddd29a1230286de8999175498ee793f3b3ea24e2
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/03/2017
---
# <a name="deploying-active-directory-federation-services-in-azure"></a><span data-ttu-id="925a0-104">Azure에서 Active Directory Federation Services 배포</span><span class="sxs-lookup"><span data-stu-id="925a0-104">Deploying Active Directory Federation Services in Azure</span></span>
<span data-ttu-id="925a0-105">AD FS는 간편하고 안전한 ID 페더레이션 및 웹 Single Sign-on(SSO) 기능을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-105">AD FS provides simplified, secured identity federation and Web single sign-on (SSO) capabilities.</span></span> <span data-ttu-id="925a0-106">사용자는 Azure AD 또는 O365와 함께 페더레이션을 통해 온-프레미스 자격 증명을 사용하여 인증하고 클라우드에서 모든 리소스에 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-106">Federation with Azure AD or O365 enables users to authenticate using on-premises credentials and access all resources in cloud.</span></span> <span data-ttu-id="925a0-107">결과적으로 온-프레미스 및 클라우드에서 리소스에 대한 액세스를 보장하는 항상 사용 가능한 AD FS 인프라가 있는 것이 중요합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-107">As a result, it becomes important to have a highly available AD FS infrastructure to ensure access to resources both on-premises and in the cloud.</span></span> <span data-ttu-id="925a0-108">Azure에서 AD FS를 배포하면 필요한 최소한의 노력으로 고가용성을 실현할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-108">Deploying AD FS in Azure can help achieve the high availability required with minimal efforts.</span></span>
<span data-ttu-id="925a0-109">Azure에서 AD FS를 배포하는 여러 가지 이점의 일부는 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-109">There are several advantages of deploying AD FS in Azure, a few of them are listed below:</span></span>

* <span data-ttu-id="925a0-110">**고가용성** - Azure 가용성 집합의 기능을 사용하여 인프라를 항상 사용 가능하도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-110">**High Availability** - With the power of Azure Availability Sets, you ensure a highly available infrastructure.</span></span>
* <span data-ttu-id="925a0-111">**규모 조정 용이** – 더 좋은 성능이 필요한가요?</span><span class="sxs-lookup"><span data-stu-id="925a0-111">**Easy to Scale** – Need more performance?</span></span> <span data-ttu-id="925a0-112">Azure에서 몇 번 클릭하면 더 강력한 컴퓨터로 쉽게 마이그레이션합니다</span><span class="sxs-lookup"><span data-stu-id="925a0-112">Easily migrate to more powerful machines by just a few clicks in Azure</span></span>
* <span data-ttu-id="925a0-113">**지역간 중복성** – Azure 지역 중복성을 사용하여 인프라를 전 세계에 걸쳐 항상 사용 가능하도록 보장할 수 있습니다</span><span class="sxs-lookup"><span data-stu-id="925a0-113">**Cross-Geo Redundancy** – With Azure Geo Redundancy you can be assured that your infrastructure is highly available across the globe</span></span>
* <span data-ttu-id="925a0-114">**관리 용이** – Azure Portal의 단순화된 관리 옵션을 사용하여 인프라를 관리하는 작업이 매우 간편하고 깔끔해 집니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-114">**Easy to Manage** – With highly simplified management options in Azure portal, managing your infrastructure is very easy and hassle-free</span></span> 

## <a name="design-principles"></a><span data-ttu-id="925a0-115">디자인 원칙</span><span class="sxs-lookup"><span data-stu-id="925a0-115">Design principles</span></span>
![배포 설계](./media/active-directory-aadconnect-azure-adfs/deployment.png)

<span data-ttu-id="925a0-117">위의 다이어그램에서는 Azure에서 AD FS 인프라를 배포하기 시작하는 데 권장되는 기본 토폴로지를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-117">The diagram above shows the recommended basic topology to start deploying your AD FS infrastructure in Azure.</span></span> <span data-ttu-id="925a0-118">토폴로지의 다양한 구성 요소의 원리는 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-118">The principles behind the various components of the topology are listed below:</span></span>

* <span data-ttu-id="925a0-119">**DC/AD FS 서버**: 사용자가 1,000명보다 적은 경우 도메인 컨트롤러에 AD FS 역할을 설치할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-119">**DC / ADFS Servers**: If you have fewer than 1,000 users you can simply install AD FS role on your domain controllers.</span></span> <span data-ttu-id="925a0-120">도메인 컨트롤러의 성능에 영향을 주지 않도록 하려는 경우 또는 사용자가 1,000명 이상인 경우 별도 서버에 AD FS를 배포합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-120">If you do not want any performance impact on the domain controllers or if you have more than 1,000 users, then deploy AD FS on separate servers.</span></span>
* <span data-ttu-id="925a0-121">**WAP 서버** – 사용자가 회사 네트워크에 있지 않은 경우 AD FS에 연결할 수 있도록 웹 응용 프로그램 프록시 서버를 배포해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-121">**WAP Server** – it is necessary to deploy Web Application Proxy servers, so that users can reach the AD FS when they are not on the company network also.</span></span>
* <span data-ttu-id="925a0-122">**DMZ**: 웹 응용 프로그램 프록시 서버는 DMZ에 배치되고 DMZ와 내부 서브넷 간에 TCP/443 액세스만이 허용됩니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-122">**DMZ**: The Web Application Proxy servers will be placed in the DMZ and ONLY TCP/443 access is allowed between the DMZ and the internal subnet.</span></span>
* <span data-ttu-id="925a0-123">**부하 분산 장치**: AD FS 및 웹 응용 프로그램 프록시 서버의 고가용성을 보장하려면 AD FS 서버용 내부 부하 분산 장치 및 웹 응용 프로그램 프록시 서버용 Azure Load Balancer를 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-123">**Load Balancers**: To ensure high availability of AD FS and Web Application Proxy servers, we recommend using an internal load balancer for AD FS servers and Azure Load Balancer for Web Application Proxy servers.</span></span>
* <span data-ttu-id="925a0-124">**가용성 집합**: AD FS 배포에 대한 중복성을 제공하려면 비슷한 워크로드에 대한 가용성 집합에 두 개 이상의 가상 컴퓨터를 그룹화하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-124">**Availability Sets**: To provide redundancy to your AD FS deployment, it is recommended that you group two or more virtual machines in an Availability Set for similar workloads.</span></span> <span data-ttu-id="925a0-125">이 구성은 계획된 유지 관리 또는 계획되지 않은 유지 관리 이벤트 중에 적어도 하나의 가상 컴퓨터를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-125">This configuration ensures that during either a planned or unplanned maintenance event, at least one virtual machine will be available</span></span>
* <span data-ttu-id="925a0-126">**Storage 계정**: 두 개의 저장소 계정을 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-126">**Storage Accounts**: It is recommended to have two storage accounts.</span></span> <span data-ttu-id="925a0-127">단일 저장소 계정을 만들면 단일 실패 지점이 생성될 수 있고 저장소 계정이 중단되는 가능성이 적은 시나리오에서 배포를 사용할 수 없게 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-127">Having a single storage account can lead to creation of a single point of failure and can cause the deployment to become unavailable in an unlikely scenario where the storage account goes down.</span></span> <span data-ttu-id="925a0-128">두 개의 저장소 계정이 있으면 각 오류 줄에 하나의 저장소 계정을 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-128">Two storage accounts will help associate one storage account for each fault line.</span></span>
* <span data-ttu-id="925a0-129">**네트워크 분리**: 웹 응용 프로그램 프록시 서버를 별도의 DMZ 네트워크에 배포해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-129">**Network segregation**:  Web Application Proxy servers should be deployed in a separate DMZ network.</span></span> <span data-ttu-id="925a0-130">하나의 가상 네트워크를 두 개의 서브넷으로 나누고 격리된 서브넷에는 웹 응용 프로그램 프록시 서버를 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-130">You can divide one virtual network into two subnets and then deploy the Web Application Proxy server(s) in an isolated subnet.</span></span> <span data-ttu-id="925a0-131">각 서브넷에 대한 네트워크 보안 그룹 설정을 구성하고 두 개의 서브넷 간에 필요한 통신만을 허용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-131">You can simply configure the network security group settings for each subnet and allow only required communication between the two subnets.</span></span> <span data-ttu-id="925a0-132">자세한 내용은 아래 배포 시나리오 별로 지정됩니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-132">More details are given per deployment scenario below</span></span>

## <a name="steps-to-deploy-ad-fs-in-azure"></a><span data-ttu-id="925a0-133">Azure에서 AD FS를 배포하는 단계</span><span class="sxs-lookup"><span data-stu-id="925a0-133">Steps to deploy AD FS in Azure</span></span>
<span data-ttu-id="925a0-134">이 섹션에 설명한 단계는 아래와 같이 Azure에서 AD FS 인프라를 배포하는 가이드를 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-134">The steps mentioned in this section outline the guide to deploy the below depicted AD FS infrastructure in Azure.</span></span>

### <a name="1-deploying-the-network"></a><span data-ttu-id="925a0-135">1. 네트워크 배포</span><span class="sxs-lookup"><span data-stu-id="925a0-135">1. Deploying the network</span></span>
<span data-ttu-id="925a0-136">위에서 설명한 대로 단일 가상 네트워크에 두 개의 서브넷을 만들거나 두 개의 완전히 다른 가상 네트워크(VNet)를 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-136">As outlined above, you can either create two subnets in a single virtual network or else create two completely different virtual networks (VNet).</span></span> <span data-ttu-id="925a0-137">이 문서는 단일 가상 네트워크를 배포하는 데 집중하고 해당 네트워크를 두 개의 서브넷으로 나눕니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-137">This article will focus on deploying a single virtual network and divide it into two subnets.</span></span> <span data-ttu-id="925a0-138">두 개의 별도 VNet에 통신용 VNet간 게이트웨이가 필요하기 때문에 현재로서는 쉬운 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-138">This is currently an easier approach as two separate VNets would require a VNet to VNet gateway for communications.</span></span>

<span data-ttu-id="925a0-139">**1.1 가상 네트워크 만들기**</span><span class="sxs-lookup"><span data-stu-id="925a0-139">**1.1 Create virtual network**</span></span>

![가상 네트워크 만들기](./media/active-directory-aadconnect-azure-adfs/deploynetwork1.png)

<span data-ttu-id="925a0-141">한 번 클릭하여 Azure Portal에서 가상 네트워크를 선택하고 가상 네트워크와 서브넷 하나를 즉시 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-141">In the Azure portal, select virtual network and you can deploy the virtual network and one subnet immediately with just one click.</span></span> <span data-ttu-id="925a0-142">INT 서브넷을 정의하여 이제 VM을 추가할 준비가 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-142">INT subnet is also defined and is ready now for VMs to be added.</span></span>
<span data-ttu-id="925a0-143">다음 단계는 네트워크에 다른 서브넷, 즉 DMZ 서브넷을 추가하는 작업입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-143">The next step is to add another subnet to the network, i.e. the DMZ subnet.</span></span> <span data-ttu-id="925a0-144">DMZ 서브넷을 만들려면</span><span class="sxs-lookup"><span data-stu-id="925a0-144">To create the DMZ subnet, simply</span></span>

* <span data-ttu-id="925a0-145">새로 만든 네트워크 선택</span><span class="sxs-lookup"><span data-stu-id="925a0-145">Select the newly created network</span></span>
* <span data-ttu-id="925a0-146">속성에서 서브넷 선택</span><span class="sxs-lookup"><span data-stu-id="925a0-146">In the properties select subnet</span></span>
* <span data-ttu-id="925a0-147">서브넷 패널에서 추가 단추 클릭</span><span class="sxs-lookup"><span data-stu-id="925a0-147">In the subnet panel click on the add button</span></span>
* <span data-ttu-id="925a0-148">서브넷을 만들려는 서브넷 이름 및 주소 공간 정보 제공</span><span class="sxs-lookup"><span data-stu-id="925a0-148">Provide the subnet name and address space information to create the subnet</span></span>

![서브넷](./media/active-directory-aadconnect-azure-adfs/deploynetwork2.png)

![서브넷 DMZ](./media/active-directory-aadconnect-azure-adfs/deploynetwork3.png)

<span data-ttu-id="925a0-151">**1.2. 네트워크 보안 그룹 만들기**</span><span class="sxs-lookup"><span data-stu-id="925a0-151">**1.2. Creating the network security groups**</span></span>

<span data-ttu-id="925a0-152">NSG(네트워크 보안 그룹)은 ACL(Access Control 목록)의 Virtual Network에 VM 인스턴스에 대한 허용 또는 거부 네트워크 트래픽 규칙의 목록을 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-152">A Network security group (NSG) contains a list of Access Control List (ACL) rules that allow or deny network traffic to your VM instances in a Virtual Network.</span></span> <span data-ttu-id="925a0-153">Nsg는 서브넷 또는 서브넷 내의 개별 VM 인스턴스 중 하나와 연결될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-153">NSGs can be associated with either subnets or individual VM instances within that subnet.</span></span> <span data-ttu-id="925a0-154">NSG를 서브넷과 연결한 경우 ACL 규칙은 해당 서브넷에 있는 모든 VM 인스턴스에 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-154">When an NSG is associated with a subnet, the ACL rules apply to all the VM instances in that subnet.</span></span>
<span data-ttu-id="925a0-155">이 지침을 위해 DMZ와 내부 네트워크용으로 각각 하나씩 두 개의 NSG를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-155">For the purpose of this guidance, we will create two NSGs: one each for an internal network and a DMZ.</span></span> <span data-ttu-id="925a0-156">각각 NSG_INT 및 NSG_DMZ라는 레이블이 지정됩니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-156">They will be labeled NSG_INT and NSG_DMZ respectively.</span></span>

![NSG 만들기](./media/active-directory-aadconnect-azure-adfs/creatensg1.png)

<span data-ttu-id="925a0-158">NSG를 만든 후에 인바운드 및 아웃 바운드 규칙이 없어집니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-158">After the NSG is created, there will be 0 inbound and 0 outbound rules.</span></span> <span data-ttu-id="925a0-159">각 서버의 역할이 설치되고 작동하면 원하는 보안 수준에 따라 인바운드 및 아웃 바운드 규칙을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-159">Once the roles on the respective servers are installed and functional, then the inbound and outbound rules can be made according to the desired level of security.</span></span>

![NSG 초기화](./media/active-directory-aadconnect-azure-adfs/nsgint1.png)

<span data-ttu-id="925a0-161">NSG를 만든 후에 NSG_INT를 서브넷 INT와 연결하고 NSG_DMZ를 서브넷 DMZ와 연결합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-161">After the NSGs are created, associate NSG_INT with subnet INT and NSG_DMZ with subnet DMZ.</span></span> <span data-ttu-id="925a0-162">예제 스크린샷은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-162">An example screenshot is given below:</span></span>

![NSG 구성](./media/active-directory-aadconnect-azure-adfs/nsgconfigure1.png)

* <span data-ttu-id="925a0-164">서브넷을 클릭하여 서브넷에 대한 패널을 엽니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-164">Click on Subnets to open the panel for subnets</span></span>
* <span data-ttu-id="925a0-165">NSG와 연결할 서브넷을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-165">Select the subnet to associate with the NSG</span></span> 

<span data-ttu-id="925a0-166">구성한 후에 서브넷에 대한 패널은 다음과 같이 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-166">After configuration, the panel for Subnets should look like below:</span></span>

![NSG 이후 서브넷](./media/active-directory-aadconnect-azure-adfs/nsgconfigure2.png)

<span data-ttu-id="925a0-168">**1.3. 온-프레미스에 대한 연결 만들기**</span><span class="sxs-lookup"><span data-stu-id="925a0-168">**1.3. Create Connection to on-premises**</span></span>

<span data-ttu-id="925a0-169">Azure에서 DC(도메인 컨트롤러)를 배포하기 위해 온-프레미스에 대한 연결이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-169">We will need a connection to on-premises in order to deploy the domain controller (DC) in azure.</span></span> <span data-ttu-id="925a0-170">Azure에서는 Azure 인프라에 온-프레미스 인프라를 연결하는 다양한 연결 옵션을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-170">Azure offers various connectivity options to connect your on-premises infrastructure to your Azure infrastructure.</span></span>

* <span data-ttu-id="925a0-171">지점 및 사이트 간</span><span class="sxs-lookup"><span data-stu-id="925a0-171">Point-to-site</span></span>
* <span data-ttu-id="925a0-172">Virtual Network 사이트 간</span><span class="sxs-lookup"><span data-stu-id="925a0-172">Virtual Network Site-to-site</span></span>
* <span data-ttu-id="925a0-173">ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="925a0-173">ExpressRoute</span></span>

<span data-ttu-id="925a0-174">ExpressRoute를 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-174">It is recommended to use ExpressRoute.</span></span> <span data-ttu-id="925a0-175">ExpressRoute를 사용하면 온-프레미스 또는 공동 배치 환경의 인프라와 Azure 데이터 센터 간에 개인 연결을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-175">ExpressRoute lets you create private connections between Azure datacenters and infrastructure that’s on your premises or in a co-location environment.</span></span> <span data-ttu-id="925a0-176">ExpressRoute 연결은 공용 인터넷을 통해 이동하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-176">ExpressRoute connections do not go over the public Internet.</span></span> <span data-ttu-id="925a0-177">Express 경로는 일반적인 인터넷을 통한 연결보다 안정적이고 속도가 빠르며 대기 시간이 짧고 보안성이 높습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-177">They offer more reliability, faster speeds, lower latencies and higher security than typical connections over the Internet.</span></span>
<span data-ttu-id="925a0-178">ExpressRoute를 사용하는 것이 좋지만 조직에 가장 적합한 연결 방법을 선택할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-178">While it is recommended to use ExpressRoute, you may choose any connection method best suited for your organization.</span></span> <span data-ttu-id="925a0-179">ExpressRoute 및 Express 경로를 사용하는 다양한 연결 옵션에 대해 자세히 알아보려면 [ExpressRoute 기술 개요](https://aka.ms/Azure/ExpressRoute)를 참고합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-179">To learn more about ExpressRoute and the various connectivity options using ExpressRoute, read [ExpressRoute technical overview](https://aka.ms/Azure/ExpressRoute).</span></span>

### <a name="2-create-storage-accounts"></a><span data-ttu-id="925a0-180">2. 저장소 계정 만들기</span><span class="sxs-lookup"><span data-stu-id="925a0-180">2. Create storage accounts</span></span>
<span data-ttu-id="925a0-181">고가용성을 유지하고 단일 저장소 계정에 대한 종속성을 방지하기 위해 두 개의 저장소 계정을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-181">In order to maintain high availability and avoid dependence on a single storage account, you can create two storage accounts.</span></span> <span data-ttu-id="925a0-182">각 가용성 집합의 컴퓨터를 두 그룹으로 나누고 각 그룹에 별도 저장소 계정을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-182">Divide the machines in each availability set into two groups and then assign each group a separate storage account.</span></span>

![저장소 계정 만들기](./media/active-directory-aadconnect-azure-adfs/storageaccount1.png)

### <a name="3-create-availability-sets"></a><span data-ttu-id="925a0-184">3. 가용성 집합 만들기</span><span class="sxs-lookup"><span data-stu-id="925a0-184">3. Create availability sets</span></span>
<span data-ttu-id="925a0-185">각 역할(DC/AD FS 및 WAP)에 최소한 2대의 컴퓨터를 포함하는 가용성 집합을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-185">For each role (DC/AD FS and WAP), create availability sets that will contain 2 machines each at the minimum.</span></span> <span data-ttu-id="925a0-186">각 역할이 높은 가용성을 달성하는 데 도움이 됩니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-186">This will help achieve higher availability for each role.</span></span> <span data-ttu-id="925a0-187">가용성 집합을 만드는 동안 필수적으로 다음을 결정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-187">While creating the availability sets, it is essential to decide on the following:</span></span>

* <span data-ttu-id="925a0-188">**장애 도메인**: 동일한 장애 도메인에 있는 가상 컴퓨터는 동일한 전원 및 물리적 네트워크 스위치를 공유합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-188">**Fault Domains**: Virtual machines in the same fault domain share the same power source and physical network switch.</span></span> <span data-ttu-id="925a0-189">최소 2개의 장애 도메인을 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-189">A minimum of 2 fault domains are recommended.</span></span> <span data-ttu-id="925a0-190">기본값은 3개이며 배포하기 위해 그대로 둘 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-190">The default value is 3 and you can leave it as is for the purpose of this deployment</span></span>
* <span data-ttu-id="925a0-191">**업데이트 도메인**: 업데이트하는 동안 동일한 업데이트 도메인에 속한 컴퓨터는 모두 다시 시작됩니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-191">**Update domains**: Machines belonging to the same update domain are restarted together during an update.</span></span> <span data-ttu-id="925a0-192">최소 2개의 업데이트 도메인이 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-192">You want to have minimum of 2 update domains.</span></span> <span data-ttu-id="925a0-193">기본값은 5개이며 배포하기 위해 그대로 둘 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-193">The default value is 5 and you can leave it as is for the purpose of this deployment</span></span>

![가용성 집합](./media/active-directory-aadconnect-azure-adfs/availabilityset1.png)

<span data-ttu-id="925a0-195">다음과 같은 가용성 집합 만들기</span><span class="sxs-lookup"><span data-stu-id="925a0-195">Create the following availability sets</span></span>

| <span data-ttu-id="925a0-196">가용성 집합</span><span class="sxs-lookup"><span data-stu-id="925a0-196">Availability Set</span></span> | <span data-ttu-id="925a0-197">역할</span><span class="sxs-lookup"><span data-stu-id="925a0-197">Role</span></span> | <span data-ttu-id="925a0-198">장애 도메인</span><span class="sxs-lookup"><span data-stu-id="925a0-198">Fault domains</span></span> | <span data-ttu-id="925a0-199">업데이트 도메인</span><span class="sxs-lookup"><span data-stu-id="925a0-199">Update domains</span></span> |
|:---:|:---:|:---:|:--- |
| <span data-ttu-id="925a0-200">contosodcset</span><span class="sxs-lookup"><span data-stu-id="925a0-200">contosodcset</span></span> |<span data-ttu-id="925a0-201">DC/ADFS</span><span class="sxs-lookup"><span data-stu-id="925a0-201">DC/ADFS</span></span> |<span data-ttu-id="925a0-202">3</span><span class="sxs-lookup"><span data-stu-id="925a0-202">3</span></span> |<span data-ttu-id="925a0-203">5</span><span class="sxs-lookup"><span data-stu-id="925a0-203">5</span></span> |
| <span data-ttu-id="925a0-204">contosowapset</span><span class="sxs-lookup"><span data-stu-id="925a0-204">contosowapset</span></span> |<span data-ttu-id="925a0-205">WAP</span><span class="sxs-lookup"><span data-stu-id="925a0-205">WAP</span></span> |<span data-ttu-id="925a0-206">3</span><span class="sxs-lookup"><span data-stu-id="925a0-206">3</span></span> |<span data-ttu-id="925a0-207">5</span><span class="sxs-lookup"><span data-stu-id="925a0-207">5</span></span> |

### <a name="4-deploy-virtual-machines"></a><span data-ttu-id="925a0-208">4. 가상 컴퓨터 배포</span><span class="sxs-lookup"><span data-stu-id="925a0-208">4. Deploy virtual machines</span></span>
<span data-ttu-id="925a0-209">다음 단계는 인프라의 다양한 역할을 호스팅하는 가상 컴퓨터를 배포하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-209">The next step is to deploy virtual machines that will host the different roles in your infrastructure.</span></span> <span data-ttu-id="925a0-210">각 가용성 집합에서 최소 두 대의 컴퓨터를 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-210">A minimum of two machines are recommended in each availability set.</span></span> <span data-ttu-id="925a0-211">기본 배포를 위해 4개의 가상 컴퓨터를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-211">Create four virtual machines for the basic deployment.</span></span>

| <span data-ttu-id="925a0-212">컴퓨터</span><span class="sxs-lookup"><span data-stu-id="925a0-212">Machine</span></span> | <span data-ttu-id="925a0-213">역할</span><span class="sxs-lookup"><span data-stu-id="925a0-213">Role</span></span> | <span data-ttu-id="925a0-214">서브넷</span><span class="sxs-lookup"><span data-stu-id="925a0-214">Subnet</span></span> | <span data-ttu-id="925a0-215">가용성 집합</span><span class="sxs-lookup"><span data-stu-id="925a0-215">Availability set</span></span> | <span data-ttu-id="925a0-216">Storage 계정</span><span class="sxs-lookup"><span data-stu-id="925a0-216">Storage account</span></span> | <span data-ttu-id="925a0-217">IP 주소</span><span class="sxs-lookup"><span data-stu-id="925a0-217">IP Address</span></span> |
|:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="925a0-218">contosodc1</span><span class="sxs-lookup"><span data-stu-id="925a0-218">contosodc1</span></span> |<span data-ttu-id="925a0-219">DC/ADFS</span><span class="sxs-lookup"><span data-stu-id="925a0-219">DC/ADFS</span></span> |<span data-ttu-id="925a0-220">INT</span><span class="sxs-lookup"><span data-stu-id="925a0-220">INT</span></span> |<span data-ttu-id="925a0-221">contosodcset</span><span class="sxs-lookup"><span data-stu-id="925a0-221">contosodcset</span></span> |<span data-ttu-id="925a0-222">contososac1</span><span class="sxs-lookup"><span data-stu-id="925a0-222">contososac1</span></span> |<span data-ttu-id="925a0-223">정적</span><span class="sxs-lookup"><span data-stu-id="925a0-223">Static</span></span> |
| <span data-ttu-id="925a0-224">contosodc2</span><span class="sxs-lookup"><span data-stu-id="925a0-224">contosodc2</span></span> |<span data-ttu-id="925a0-225">DC/ADFS</span><span class="sxs-lookup"><span data-stu-id="925a0-225">DC/ADFS</span></span> |<span data-ttu-id="925a0-226">INT</span><span class="sxs-lookup"><span data-stu-id="925a0-226">INT</span></span> |<span data-ttu-id="925a0-227">contosodcset</span><span class="sxs-lookup"><span data-stu-id="925a0-227">contosodcset</span></span> |<span data-ttu-id="925a0-228">contososac2</span><span class="sxs-lookup"><span data-stu-id="925a0-228">contososac2</span></span> |<span data-ttu-id="925a0-229">정적</span><span class="sxs-lookup"><span data-stu-id="925a0-229">Static</span></span> |
| <span data-ttu-id="925a0-230">contosowap1</span><span class="sxs-lookup"><span data-stu-id="925a0-230">contosowap1</span></span> |<span data-ttu-id="925a0-231">WAP</span><span class="sxs-lookup"><span data-stu-id="925a0-231">WAP</span></span> |<span data-ttu-id="925a0-232">DMZ</span><span class="sxs-lookup"><span data-stu-id="925a0-232">DMZ</span></span> |<span data-ttu-id="925a0-233">contosowapset</span><span class="sxs-lookup"><span data-stu-id="925a0-233">contosowapset</span></span> |<span data-ttu-id="925a0-234">contososac1</span><span class="sxs-lookup"><span data-stu-id="925a0-234">contososac1</span></span> |<span data-ttu-id="925a0-235">정적</span><span class="sxs-lookup"><span data-stu-id="925a0-235">Static</span></span> |
| <span data-ttu-id="925a0-236">contosowap2</span><span class="sxs-lookup"><span data-stu-id="925a0-236">contosowap2</span></span> |<span data-ttu-id="925a0-237">WAP</span><span class="sxs-lookup"><span data-stu-id="925a0-237">WAP</span></span> |<span data-ttu-id="925a0-238">DMZ</span><span class="sxs-lookup"><span data-stu-id="925a0-238">DMZ</span></span> |<span data-ttu-id="925a0-239">contosowapset</span><span class="sxs-lookup"><span data-stu-id="925a0-239">contosowapset</span></span> |<span data-ttu-id="925a0-240">contososac2</span><span class="sxs-lookup"><span data-stu-id="925a0-240">contososac2</span></span> |<span data-ttu-id="925a0-241">정적</span><span class="sxs-lookup"><span data-stu-id="925a0-241">Static</span></span> |

<span data-ttu-id="925a0-242">보시는 것처럼 NSG가 지정되지 않았습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-242">As you might have noticed, no NSG has been specified.</span></span> <span data-ttu-id="925a0-243">Azure가 서브넷 수준에서 NSG를 사용할 수 있도록 하기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-243">This is because azure lets you use NSG at the subnet level.</span></span> <span data-ttu-id="925a0-244">그러면 서브넷 또는 NIC 개체와 연결된 개별 NSG를 사용하여 컴퓨터 네트워크 트래픽을 제어할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-244">Then, you can control machine network traffic by using the individual NSG associated with either the subnet or else the NIC object.</span></span> <span data-ttu-id="925a0-245">자세한 내용은 [NSG(네트워크 보안 그룹)란](https://aka.ms/Azure/NSG)을 참고하세요.</span><span class="sxs-lookup"><span data-stu-id="925a0-245">Read more on [What is a Network Security Group (NSG)](https://aka.ms/Azure/NSG).</span></span>
<span data-ttu-id="925a0-246">DNS를 관리하는 경우 고정 IP 주소를 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-246">Static IP address is recommended if you are managing the DNS.</span></span> <span data-ttu-id="925a0-247">도메인에 대한 DNS 레코드 대신 Azure DNS를 사용할 수 있으며 해당 Azure FQDN에 의한 새 컴퓨터를 참조할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-247">You can use Azure DNS and instead in the DNS records for your domain, refer to the new machines by their Azure FQDNs.</span></span>
<span data-ttu-id="925a0-248">가상 컴퓨터 창은 배포가 완료된 후에 다음과 같이 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-248">Your virtual machine pane should look like below after the deployment is completed:</span></span>

![배포된 Virtual Machines](./media/active-directory-aadconnect-azure-adfs/virtualmachinesdeployed_noadfs.png)

### <a name="5-configuring-the-domain-controller--ad-fs-servers"></a><span data-ttu-id="925a0-250">5. 도메인 컨트롤러/AD FS 서버 구성</span><span class="sxs-lookup"><span data-stu-id="925a0-250">5. Configuring the domain controller / AD FS servers</span></span>
 <span data-ttu-id="925a0-251">들어오는 모든 요청을 인증하기 위해 AD FS는 도메인 컨트롤러에 연결해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-251">In order to authenticate any incoming request, AD FS will need to contact the domain controller.</span></span> <span data-ttu-id="925a0-252">인증을 위해 Azure에서 온-프레미스 DC까지 비용이 많이 드는 여정을 저장하려면 Azure에서 도메인 컨트롤러의 복제본을 배포하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-252">To save the costly trip from Azure to on-premises DC for authentication, it is recommended to deploy a replica of the domain controller in Azure.</span></span> <span data-ttu-id="925a0-253">고가용성을 달성하기 위해 최소 2개의 도메인 컨트롤러 가용성 집합을 만드는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-253">In order to attain high availability, it is recommended to create an availability set of at-least 2 domain controllers.</span></span>

| <span data-ttu-id="925a0-254">도메인 컨트롤러</span><span class="sxs-lookup"><span data-stu-id="925a0-254">Domain controller</span></span> | <span data-ttu-id="925a0-255">역할</span><span class="sxs-lookup"><span data-stu-id="925a0-255">Role</span></span> | <span data-ttu-id="925a0-256">Storage 계정</span><span class="sxs-lookup"><span data-stu-id="925a0-256">Storage account</span></span> |
|:---:|:---:|:---:|
| <span data-ttu-id="925a0-257">contosodc1</span><span class="sxs-lookup"><span data-stu-id="925a0-257">contosodc1</span></span> |<span data-ttu-id="925a0-258">복제본</span><span class="sxs-lookup"><span data-stu-id="925a0-258">Replica</span></span> |<span data-ttu-id="925a0-259">contososac1</span><span class="sxs-lookup"><span data-stu-id="925a0-259">contososac1</span></span> |
| <span data-ttu-id="925a0-260">contosodc2</span><span class="sxs-lookup"><span data-stu-id="925a0-260">contosodc2</span></span> |<span data-ttu-id="925a0-261">복제본</span><span class="sxs-lookup"><span data-stu-id="925a0-261">Replica</span></span> |<span data-ttu-id="925a0-262">contososac2</span><span class="sxs-lookup"><span data-stu-id="925a0-262">contososac2</span></span> |

* <span data-ttu-id="925a0-263">DNS을 사용하여 두 서버를 복제본 도메인 컨트롤러로 승격</span><span class="sxs-lookup"><span data-stu-id="925a0-263">Promote the two servers as replica domain controllers with DNS</span></span>
* <span data-ttu-id="925a0-264">서버 관리자를 사용하는 AD FS 역할을 설치하여 AD FS 서버를 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-264">Configure the AD FS servers by installing the AD FS role using the server manager.</span></span>

### <a name="6-deploying-internal-load-balancer-ilb"></a><span data-ttu-id="925a0-265">6. ILB(내부 부하 분산 장치) 배포</span><span class="sxs-lookup"><span data-stu-id="925a0-265">6. Deploying Internal Load Balancer (ILB)</span></span>
<span data-ttu-id="925a0-266">**6.1. ILB 만들기**</span><span class="sxs-lookup"><span data-stu-id="925a0-266">**6.1. Create the ILB**</span></span>

<span data-ttu-id="925a0-267">ILB를 배포하려면 Azure Portal에서 부하 분산 장치를 선택하고 추가(+)를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-267">To deploy an ILB, select Load Balancers in the Azure portal and click on add (+).</span></span>

> [!NOTE]
> <span data-ttu-id="925a0-268">메뉴에 **부하 분산 장치**가 표시되지 않으면 포털의 왼쪽 아래에서 **찾아보기**를 클릭하고 **부하 분산 장치**가 표시될 때까지 스크롤을 내립니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-268">if you do not see **Load Balancers** in your menu, click **Browse** in the lower left of the portal and scroll until you see **Load Balancers**.</span></span>  <span data-ttu-id="925a0-269">노란색 별표를 클릭하여 메뉴에 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-269">Then click the yellow star to add it to your menu.</span></span> <span data-ttu-id="925a0-270">이제 새 부하 분산 장치 아이콘을 선택하여 패널을 열고 부하 분산 장치를 구성하기 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-270">Now select the new load balancer icon to open the panel to begin configuration of the load balancer.</span></span>
> 
> 

![부하 분산 장치 찾아보기](./media/active-directory-aadconnect-azure-adfs/browseloadbalancer.png)

* <span data-ttu-id="925a0-272">**이름**: 부하 분산 장치에 적합한 이름을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-272">**Name**: Give any suitable name to the load balancer</span></span>
* <span data-ttu-id="925a0-273">**구성표**: 이 부하 분산 장치가 AD FS 서버 앞에 배치되고 내부 네트워크 연결에만 사용되기 때문에 "내부"를 선택합니다</span><span class="sxs-lookup"><span data-stu-id="925a0-273">**Scheme**: Since this load balancer will be placed in front of the AD FS servers and is meant for internal network connections ONLY, select “Internal”</span></span>
* <span data-ttu-id="925a0-274">**Virtual Network**: AD FS를 배포할 가상 네트워크를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-274">**Virtual Network**: Choose the virtual network where you are deploying your AD FS</span></span>
* <span data-ttu-id="925a0-275">**서브넷**: 여기서 내부 서브넷을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-275">**Subnet**: Choose the internal subnet here</span></span>
* <span data-ttu-id="925a0-276">**IP 주소 할당**: 정적</span><span class="sxs-lookup"><span data-stu-id="925a0-276">**IP Address assignment**: Static</span></span>

![내부 부하 분산 장치](./media/active-directory-aadconnect-azure-adfs/ilbdeployment1.png)

<span data-ttu-id="925a0-278">만들기를 클릭하여 ILB가 배포되면 부하 분산 장치 목록에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-278">After you click create and the ILB is deployed, you should see it in the list of load balancers:</span></span>

![ILB 이후 부하 분산 장치](./media/active-directory-aadconnect-azure-adfs/ilbdeployment2.png)

<span data-ttu-id="925a0-280">다음 단계는 백 엔드 풀 및 백 엔드 프로브를 구성하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-280">Next step is to configure the backend pool and the backend probe.</span></span>

<span data-ttu-id="925a0-281">**6.2. ILB 백 엔드 풀 구성**</span><span class="sxs-lookup"><span data-stu-id="925a0-281">**6.2. Configure ILB backend pool**</span></span>

<span data-ttu-id="925a0-282">부하 분산 장치 패널에서 새로 만든 ILB를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-282">Select the newly created ILB in the Load Balancers panel.</span></span> <span data-ttu-id="925a0-283">설정 패널이 열립니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-283">It will open the settings panel.</span></span> 

1. <span data-ttu-id="925a0-284">설정 패널에서 백 엔드 풀을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-284">Select backend pools from the settings panel</span></span>
2. <span data-ttu-id="925a0-285">백 엔드 풀 추가 패널에서 가상 컴퓨터 추가를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-285">In the add backend pool panel, click on add virtual machine</span></span>
3. <span data-ttu-id="925a0-286">가용성 집합을 선택할 수 있는 패널로 나타납니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-286">You will be presented with a panel where you can choose availability set</span></span>
4. <span data-ttu-id="925a0-287">AD FS 가용성 집합을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-287">Choose the AD FS availability set</span></span>

![ILB 백 엔드 풀 구성](./media/active-directory-aadconnect-azure-adfs/ilbdeployment3.png)

<span data-ttu-id="925a0-289">**6.3. 프로브 구성**</span><span class="sxs-lookup"><span data-stu-id="925a0-289">**6.3. Configuring probe**</span></span>

<span data-ttu-id="925a0-290">ILB 설정 패널에서 프로브를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-290">In the ILB settings panel, select Probes.</span></span>

1. <span data-ttu-id="925a0-291">추가를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-291">Click on add</span></span>
2. <span data-ttu-id="925a0-292">프로브에 대한 세부 정보를 제공합니다. a.</span><span class="sxs-lookup"><span data-stu-id="925a0-292">Provide details for probe a.</span></span> <span data-ttu-id="925a0-293">**이름**: 이름을 검색합니다. b.</span><span class="sxs-lookup"><span data-stu-id="925a0-293">**Name**: Probe name b.</span></span> <span data-ttu-id="925a0-294">**프로토콜**: TCP c.</span><span class="sxs-lookup"><span data-stu-id="925a0-294">**Protocol**: TCP c.</span></span> <span data-ttu-id="925a0-295">**포트**: 443(HTTPS) d.</span><span class="sxs-lookup"><span data-stu-id="925a0-295">**Port**: 443 (HTTPS) d.</span></span> <span data-ttu-id="925a0-296">**간격**: 기본값 5는 ILB가 백 엔드 풀에 있는 컴퓨터를 검색하는 간격입니다. e.</span><span class="sxs-lookup"><span data-stu-id="925a0-296">**Interval**: 5 (default value) – this is the interval at which ILB will probe the machines in the backend pool e.</span></span> <span data-ttu-id="925a0-297">**비정상 임계값 제한**: 기본값 2는 ILB가 백 엔드 풀에 있는 컴퓨터를 응답하지 않는다고 선언하고 트래픽을 보내지 않고 나서 연속 프로브 오류가 발생하는 임계값입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-297">**Unhealthy threshold limit**: 2 (default val ue) – this is the threshold of consecutive probe failures after which ILB will declare a machine in the backend pool non-responsive and stop sending traffic to it.</span></span>

![ILB 프로브 구성](./media/active-directory-aadconnect-azure-adfs/ilbdeployment4.png)

<span data-ttu-id="925a0-299">**6.4. 부하 분산 규칙 만들기**</span><span class="sxs-lookup"><span data-stu-id="925a0-299">**6.4. Create load balancing rules**</span></span>

<span data-ttu-id="925a0-300">트래픽을 효과적으로 분산하기 위해 ILB는 부하 분산 규칙을 사용하여 구성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-300">In order to effectively balance the traffic, the ILB should be configured with load balancing rules.</span></span> <span data-ttu-id="925a0-301">부하 분산 규칙을 만들려면</span><span class="sxs-lookup"><span data-stu-id="925a0-301">In order to create a load balancing rule,</span></span> 

1. <span data-ttu-id="925a0-302">ILB의 설정 패널에서 부하 분산 규칙을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-302">Select Load balancing rule from the settings panel of the ILB</span></span>
2. <span data-ttu-id="925a0-303">부하 분산 규칙 패널에서 추가를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-303">Click on Add in the Load balancing rule panel</span></span>
3. <span data-ttu-id="925a0-304">부하 분산 규칙 추가 패널에서 a.</span><span class="sxs-lookup"><span data-stu-id="925a0-304">In the Add load balancing rule panel a.</span></span> <span data-ttu-id="925a0-305">**이름**: 규칙의 이름을 지정합니다. b.</span><span class="sxs-lookup"><span data-stu-id="925a0-305">**Name**: Provide a name for the rule b.</span></span> <span data-ttu-id="925a0-306">**프로토콜**: TCP를 선택합니다. c.</span><span class="sxs-lookup"><span data-stu-id="925a0-306">**Protocol**: Select TCP c.</span></span> <span data-ttu-id="925a0-307">**포트**: 443 d.</span><span class="sxs-lookup"><span data-stu-id="925a0-307">**Port**: 443 d.</span></span> <span data-ttu-id="925a0-308">**백 엔드 포트**: 443 e.</span><span class="sxs-lookup"><span data-stu-id="925a0-308">**Backend port**: 443 e.</span></span> <span data-ttu-id="925a0-309">**백 엔드 풀**: 이전에 AD FS 클러스터에 만든 풀을 선택합니다. f.</span><span class="sxs-lookup"><span data-stu-id="925a0-309">**Backend pool**: Select the pool you created for the AD FS cluster earlier f.</span></span> <span data-ttu-id="925a0-310">**프로브**: 이전에 AD FS 서버에 만든 프로브를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-310">**Probe**: Select the probe created for AD FS servers earlier</span></span>

![ILB 분산 규칙 구성](./media/active-directory-aadconnect-azure-adfs/ilbdeployment5.png)

<span data-ttu-id="925a0-312">**6.5. ILB를 사용하여 DNS 업데이트**</span><span class="sxs-lookup"><span data-stu-id="925a0-312">**6.5. Update DNS with ILB**</span></span>

<span data-ttu-id="925a0-313">DNS 서버로 이동하고 ILB에 대한 CNAME을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-313">Go to your DNS server and create a CNAME for the ILB.</span></span> <span data-ttu-id="925a0-314">CNAME은 ILB의 IP 주소를 가리키는 IP 주소를 가진 페더레이션 서비스를 제공해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-314">The CNAME should be for the federation service with the IP address pointing to the IP address of the ILB.</span></span> <span data-ttu-id="925a0-315">예를 들어 ILB DIP 주소가 10.3.0.8이고 설치된 페더레이션 서비스가 fs.contoso.com이면 10.3.0.8을 가리키는 fs.contoso.com에 대한 CNAME을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-315">For example if the ILB DIP address is 10.3.0.8, and the federation service installed is fs.contoso.com, then create a CNAME for fs.contoso.com pointing to 10.3.0.8.</span></span>
<span data-ttu-id="925a0-316">이렇게 하면 fs.contoso.com과 관련된 모든 통신은 ILB로 끝나게 되고 적절하게 라우팅됩니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-316">This will ensure that all communication regarding fs.contoso.com end up at the ILB and are appropriately routed.</span></span>

### <a name="7-configuring-the-web-application-proxy-server"></a><span data-ttu-id="925a0-317">7. 웹 응용 프로그램 프록시 서버 구성</span><span class="sxs-lookup"><span data-stu-id="925a0-317">7. Configuring the Web Application Proxy server</span></span>
<span data-ttu-id="925a0-318">**7.1. AD FS 서버에 연결할 웹 응용 프로그램 프록시 서버 구성**</span><span class="sxs-lookup"><span data-stu-id="925a0-318">**7.1. Configuring the Web Application Proxy servers to reach AD FS servers**</span></span>

<span data-ttu-id="925a0-319">웹 응용 프로그램 프록시 서버가 ILB 다음에 AD FS 서버에 연결할 수 있도록 하려면 ILB용 %systemroot%\system32\drivers\etc\hosts에 레코드를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-319">In order to ensure that Web Application Proxy servers are able to reach the AD FS servers behind the ILB, create a record in the %systemroot%\system32\drivers\etc\hosts for the ILB.</span></span> <span data-ttu-id="925a0-320">DN(고유 이름)은 페더레이션 서비스 이름(예: fs.contoso.com)이 되도록 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-320">Note that the distinguished name (DN) should be the federation service name, for example fs.contoso.com.</span></span> <span data-ttu-id="925a0-321">또한 IP 항목은 ILB의 IP 주소(이 예제에서와 같이 10.3.0.8)여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-321">And the IP entry should be that of the ILB’s IP address (10.3.0.8 as in the example).</span></span>

<span data-ttu-id="925a0-322">**7.2. 웹 응용 프로그램 프록시 역할 설치**</span><span class="sxs-lookup"><span data-stu-id="925a0-322">**7.2. Installing the Web Application Proxy role**</span></span>

<span data-ttu-id="925a0-323">웹 응용 프로그램 프록시 서버가 ILB 다음에 AD FS 서버에 연결할 수 있는지를 확인한 후에 웹 응용 프로그램 프록시 서버를 설치할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-323">After you ensure that Web Application Proxy servers are able to reach the AD FS servers behind ILB, you can next install the Web Application Proxy servers.</span></span> <span data-ttu-id="925a0-324">웹 응용 프로그램 프록시 서버는 도메인에 조인되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-324">Web Application Proxy servers do not be joined to the domain.</span></span> <span data-ttu-id="925a0-325">원격 액세스 역할을 선택하여 두 개의 웹 응용 프로그램 프록시 서버에 웹 응용 프로그램 프록시 역할을 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-325">Install the Web Application Proxy roles on the two Web Application Proxy servers by selecting the Remote Access role.</span></span> <span data-ttu-id="925a0-326">서버 관리자에서는 WAP 설치를 완료하도록 안내합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-326">The server manager will guide you to complete the WAP installation.</span></span>
<span data-ttu-id="925a0-327">WAP를 배포하는 방법에 대한 자세한 내용은 [웹 응용 프로그램 프록시 서버 설치 및 구성](https://technet.microsoft.com/library/dn383662.aspx)을 참고합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-327">For more information on how to deploy WAP, read [Install and Configure the Web Application Proxy Server](https://technet.microsoft.com/library/dn383662.aspx).</span></span>

### <a name="8--deploying-the-internet-facing-public-load-balancer"></a><span data-ttu-id="925a0-328">8.  인터넷 연결 (공용) 부하 분산 장치 배포</span><span class="sxs-lookup"><span data-stu-id="925a0-328">8.  Deploying the Internet Facing (Public) Load Balancer</span></span>
<span data-ttu-id="925a0-329">**8.1.  인터넷 연결 (공용) 부하 분산 장치 만들기**</span><span class="sxs-lookup"><span data-stu-id="925a0-329">**8.1.  Create Internet Facing (Public) Load Balancer**</span></span>

<span data-ttu-id="925a0-330">Azure Portal에서 부하 분산 장치를 선택하고 추가를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-330">In the Azure portal, select Load balancers and then click on Add.</span></span> <span data-ttu-id="925a0-331">부하 분산 장치 만들기 패널에 다음 정보를 입력합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-331">In the Create load balancer panel, enter the following information</span></span>

1. <span data-ttu-id="925a0-332">**이름**: 부하 분산 장치의 이름</span><span class="sxs-lookup"><span data-stu-id="925a0-332">**Name**: Name for the load balancer</span></span>
2. <span data-ttu-id="925a0-333">**구성표**: 공용 – 이 옵션에서는 이 부하 분산 장치에 공용 주소가 필요하다는 것을 Azure에 알립니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-333">**Scheme**: Public – this option tells Azure that this load balancer will need a public address.</span></span>
3. <span data-ttu-id="925a0-334">**IP 주소**: 새로운 IP 주소(동적) 만들기</span><span class="sxs-lookup"><span data-stu-id="925a0-334">**IP Address**: Create a new IP address (dynamic)</span></span>

![인터넷 연결 부하 분산 장치](./media/active-directory-aadconnect-azure-adfs/elbdeployment1.png)

<span data-ttu-id="925a0-336">배포한 후에 부하 분산 장치는 부하 분산 장치 목록에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-336">After deployment, the load balancer will appear in the Load balancers list.</span></span>

![부하 분산 장치 목록](./media/active-directory-aadconnect-azure-adfs/elbdeployment2.png)

<span data-ttu-id="925a0-338">**8.2. 공용 IP에 DNS 레이블 할당**</span><span class="sxs-lookup"><span data-stu-id="925a0-338">**8.2. Assign a DNS label to the public IP**</span></span>

<span data-ttu-id="925a0-339">부하 분산 장치 패널에서 새로 만든 부하 분산 장치 항목을 클릭하여 구성에 대한 패널을 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-339">Click on the newly created load balancer entry in the Load balancers panel to bring up the panel for configuration.</span></span> <span data-ttu-id="925a0-340">다음 단계를 수행하여 공용 IP에 DNS 레이블을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-340">Follow below steps to configure the DNS label for the public IP:</span></span>

1. <span data-ttu-id="925a0-341">공용 IP 주소를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-341">Click on the public IP address.</span></span> <span data-ttu-id="925a0-342">공용 IP 및 해당 설정에 대한 패널이 열립니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-342">This will open the panel for the public IP and its settings</span></span>
2. <span data-ttu-id="925a0-343">구성을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-343">Click on Configuration</span></span>
3. <span data-ttu-id="925a0-344">DNS 레이블을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-344">Provide a DNS label.</span></span> <span data-ttu-id="925a0-345">예를 들어 contosofs.westus.cloudapp.azure.com과 같이 어디에서나 액세스할 수 있는 공용 DNS 레이블이 됩니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-345">This will become the public DNS label that you can access from anywhere, for example contosofs.westus.cloudapp.azure.com.</span></span> <span data-ttu-id="925a0-346">외부 부하 분산 장치(contosofs.westus.cloudapp.azure.com)의 DNS 레이블로 확인된 페더레이션 서비스(예: fs.contoso.com)에 대한 외부 DNS에 항목을 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-346">You can add an entry in the external DNS for the federation service (like fs.contoso.com) that resolves to the DNS label of the external load balancer (contosofs.westus.cloudapp.azure.com).</span></span>

![인터넷 연결 부하 분산 장치 구성](./media/active-directory-aadconnect-azure-adfs/elbdeployment3.png) 

![인터넷 연결 부하 분산 장치 구성(DNS)](./media/active-directory-aadconnect-azure-adfs/elbdeployment4.png)

<span data-ttu-id="925a0-349">**8.3. 인터넷 연결 (공용) 부하 분산 장치에 대한 백 엔드 풀 구성**</span><span class="sxs-lookup"><span data-stu-id="925a0-349">**8.3. Configure backend pool for Internet Facing (Public) Load Balancer**</span></span> 

<span data-ttu-id="925a0-350">내부 부하 분산 장치 만들기와 동일한 단계를 따라 WAP 서버에 대한 가용성 집합으로 인터넷 연결 (공용) 부하 분산 장치에 대한 백 엔드 풀을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-350">Follow the same steps as in creating the internal load balancer, to configure the backend pool for Internet Facing (Public) Load Balancer as the availability set for the WAP servers.</span></span> <span data-ttu-id="925a0-351">예를 들어 contosowapset입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-351">For example, contosowapset.</span></span>

![인터넷 연결 부하 분산 장치의 백 엔드 풀 구성](./media/active-directory-aadconnect-azure-adfs/elbdeployment5.png)

<span data-ttu-id="925a0-353">**8.4. 프로브 구성**</span><span class="sxs-lookup"><span data-stu-id="925a0-353">**8.4. Configure probe**</span></span>

<span data-ttu-id="925a0-354">내부 부하 분산 장치를 구성하는 동일한 단계를 따라 WAP 서버의 백 엔드 풀에 대한 프로브를 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-354">Follow the same steps as in configuring the internal load balancer  to configure the probe for the backend pool of WAP servers.</span></span>

![인터넷 연결 부하 분산 장치의 프로브 구성](./media/active-directory-aadconnect-azure-adfs/elbdeployment6.png)

<span data-ttu-id="925a0-356">**8.5. 부하 분산 규칙 만들기**</span><span class="sxs-lookup"><span data-stu-id="925a0-356">**8.5. Create load balancing rule(s)**</span></span>

<span data-ttu-id="925a0-357">ILB와 같은 단계를 수행하여 TCP 443에 대한 부하 분산 규칙을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-357">Follow the same steps as in ILB to configure the load balancing rule for TCP 443.</span></span>

![인터넷 연결 부하 분산 장치의 분산 규칙 구성](./media/active-directory-aadconnect-azure-adfs/elbdeployment7.png)

### <a name="9-securing-the-network"></a><span data-ttu-id="925a0-359">9. 네트워크 보안</span><span class="sxs-lookup"><span data-stu-id="925a0-359">9. Securing the network</span></span>
<span data-ttu-id="925a0-360">**9.1. 내부 서브넷 보안**</span><span class="sxs-lookup"><span data-stu-id="925a0-360">**9.1. Securing the internal subnet**</span></span>

<span data-ttu-id="925a0-361">전반적으로 내부 서브넷을 효율적으로 보호하기 위해 다음 규칙이 필요합니다(아래에 나열된 순서로).</span><span class="sxs-lookup"><span data-stu-id="925a0-361">Overall, you need the following rules to efficiently secure your internal subnet (in the order as listed below)</span></span>

| <span data-ttu-id="925a0-362">규칙</span><span class="sxs-lookup"><span data-stu-id="925a0-362">Rule</span></span> | <span data-ttu-id="925a0-363">설명</span><span class="sxs-lookup"><span data-stu-id="925a0-363">Description</span></span> | <span data-ttu-id="925a0-364">흐름</span><span class="sxs-lookup"><span data-stu-id="925a0-364">Flow</span></span> |
|:--- |:--- |:---:|
| <span data-ttu-id="925a0-365">AllowHTTPSFromDMZ</span><span class="sxs-lookup"><span data-stu-id="925a0-365">AllowHTTPSFromDMZ</span></span> |<span data-ttu-id="925a0-366">DMZ에서 HTTPS 통신을 허용합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-366">Allow the HTTPS communication from DMZ</span></span> |<span data-ttu-id="925a0-367">인바운드</span><span class="sxs-lookup"><span data-stu-id="925a0-367">Inbound</span></span> |
| <span data-ttu-id="925a0-368">DenyInternetOutbound</span><span class="sxs-lookup"><span data-stu-id="925a0-368">DenyInternetOutbound</span></span> |<span data-ttu-id="925a0-369">인터넷에 액세스할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-369">No access to internet</span></span> |<span data-ttu-id="925a0-370">아웃바운드</span><span class="sxs-lookup"><span data-stu-id="925a0-370">Outbound</span></span> |

![INT 액세스 규칙(인바운드)](./media/active-directory-aadconnect-azure-adfs/nsg_int.png)

<span data-ttu-id="925a0-372">[주석]: <> (![INT 액세스 규칙(인바운드)](./media/active-directory-aadconnect-azure-adfs/nsgintinbound.png)) [주석]: <> (![INT 액세스 규칙(아웃바운드)](./media/active-directory-aadconnect-azure-adfs/nsgintoutbound.png))</span><span class="sxs-lookup"><span data-stu-id="925a0-372">[comment]: <> (![INT access rules (inbound)](./media/active-directory-aadconnect-azure-adfs/nsgintinbound.png)) [comment]: <> (![INT access rules (outbound)](./media/active-directory-aadconnect-azure-adfs/nsgintoutbound.png))</span></span>

<span data-ttu-id="925a0-373">**9.2. DMZ 서브넷 보안**</span><span class="sxs-lookup"><span data-stu-id="925a0-373">**9.2. Securing the DMZ subnet**</span></span>

| <span data-ttu-id="925a0-374">규칙</span><span class="sxs-lookup"><span data-stu-id="925a0-374">Rule</span></span> | <span data-ttu-id="925a0-375">설명</span><span class="sxs-lookup"><span data-stu-id="925a0-375">Description</span></span> | <span data-ttu-id="925a0-376">흐름</span><span class="sxs-lookup"><span data-stu-id="925a0-376">Flow</span></span> |
|:--- |:--- |:---:|
| <span data-ttu-id="925a0-377">AllowHTTPSFromInternet</span><span class="sxs-lookup"><span data-stu-id="925a0-377">AllowHTTPSFromInternet</span></span> |<span data-ttu-id="925a0-378">인터넷에서 DMZ까지 HTTPS를 허용합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-378">Allow HTTPS from internet to the DMZ</span></span> |<span data-ttu-id="925a0-379">인바운드</span><span class="sxs-lookup"><span data-stu-id="925a0-379">Inbound</span></span> |
| <span data-ttu-id="925a0-380">DenyInternetOutbound</span><span class="sxs-lookup"><span data-stu-id="925a0-380">DenyInternetOutbound</span></span> |<span data-ttu-id="925a0-381">인터넷에 대한 HTTPS를 제외한 항목을 차단합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-381">Anything except HTTPS to internet is blocked</span></span> |<span data-ttu-id="925a0-382">아웃바운드</span><span class="sxs-lookup"><span data-stu-id="925a0-382">Outbound</span></span> |

![EXT 액세스 규칙(인바운드)](./media/active-directory-aadconnect-azure-adfs/nsg_dmz.png)

<span data-ttu-id="925a0-384">[주석]: <> (![EXT 액세스 규칙(인바운드)](./media/active-directory-aadconnect-azure-adfs/nsgdmzinbound.png)) [주석]: <> (![EXT 액세스 규칙(아웃바운드)](./media/active-directory-aadconnect-azure-adfs/nsgdmzoutbound.png))</span><span class="sxs-lookup"><span data-stu-id="925a0-384">[comment]: <> (![EXT access rules (inbound)](./media/active-directory-aadconnect-azure-adfs/nsgdmzinbound.png)) [comment]: <> (![EXT access rules (outbound)](./media/active-directory-aadconnect-azure-adfs/nsgdmzoutbound.png))</span></span>

> [!NOTE]
> <span data-ttu-id="925a0-385">클라이언트 사용자 인증서 인증(X509 사용자 인증서를 사용하는 clientTLS 인증)이 필요한 경우 AD FS는 TCP 포트 49443를 인바운드 액세스에 사용하도록 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-385">If client user certificate authentication (clientTLS authentication using X509 user certificates) is required, then AD FS requires TCP port 49443 be enabled for inbound access.</span></span>
> 
> 

### <a name="10-test-the-ad-fs-sign-in"></a><span data-ttu-id="925a0-386">10. AD FS 로그인 테스트</span><span class="sxs-lookup"><span data-stu-id="925a0-386">10. Test the AD FS sign-in</span></span>
<span data-ttu-id="925a0-387">가장 쉬운 방법은 IdpInitiatedSignon.aspx 페이지를 사용하여 AD FS를 테스트하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-387">The easiest way is to test AD FS is by using the IdpInitiatedSignon.aspx page.</span></span> <span data-ttu-id="925a0-388">이렇게 하려면 AD FS 속성에 IdpInitiatedSignOn을 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-388">In order to be able to do that, it is required to enable the IdpInitiatedSignOn on the AD FS properties.</span></span> <span data-ttu-id="925a0-389">AD FS 설치를 확인하려면 다음 단계를 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-389">Follow the steps below to verify your AD FS setup</span></span>

1. <span data-ttu-id="925a0-390">아래 AD FS 서버의 cmdlet을 실행하고 PowerShell을 사용하여 사용하도록 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-390">Run the below cmdlet on the AD FS server, using PowerShell, to set it to enabled.</span></span>
   <span data-ttu-id="925a0-391">Set-AdfsProperties -EnableIdPInitiatedSignonPage $true</span><span class="sxs-lookup"><span data-stu-id="925a0-391">Set-AdfsProperties -EnableIdPInitiatedSignonPage $true</span></span> 
2. <span data-ttu-id="925a0-392">외부 컴퓨터에서 https://adfs.thecloudadvocate.com/adfs/ls/IdpInitiatedSignon.aspx에 액세스합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-392">From any external machine access https://adfs.thecloudadvocate.com/adfs/ls/IdpInitiatedSignon.aspx</span></span>  
3. <span data-ttu-id="925a0-393">아래와 같은 AD FS 페이지를 참조해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-393">You should see the AD FS page like below:</span></span>

![테스트 로그인 페이지](./media/active-directory-aadconnect-azure-adfs/test1.png)

<span data-ttu-id="925a0-395">성공적으로 로그인하면 아래와 같은 성공 메시지가 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-395">On successful sign-in, it will provide you with a success message as shown below:</span></span>

![테스트 성공](./media/active-directory-aadconnect-azure-adfs/test2.png)

## <a name="template-for-deploying-ad-fs-in-azure"></a><span data-ttu-id="925a0-397">Azure에서 AD FS를 배포하는 템플릿</span><span class="sxs-lookup"><span data-stu-id="925a0-397">Template for deploying AD FS in Azure</span></span>
<span data-ttu-id="925a0-398">템플릿은 각 도메인 컨트롤러, AD FS 및 WAP 당 2개, 총 6개의 컴퓨터 설정을 배포합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-398">The template deploys a 6 machine setup, 2 each for Domain Controllers, AD FS and WAP.</span></span>

[<span data-ttu-id="925a0-399">Azure 배포 템플릿에서 AD FS</span><span class="sxs-lookup"><span data-stu-id="925a0-399">AD FS in Azure Deployment Template</span></span>](https://github.com/paulomarquesc/adfs-6vms-regular-template-based)

<span data-ttu-id="925a0-400">이 템플릿을 배포하는 동안 기존 가상 네트워크를 사용하거나 새 VNET을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-400">You can use an existing virtual network or create a new VNET while deploying this template.</span></span> <span data-ttu-id="925a0-401">배포를 사용자 지정하는 데 사용할 수 있는 다양한 매개 변수는 배포 프로세스의 매개 변수 사용에 대한 설명과 함께 아래에 나열됩니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-401">The various parameters available for customizing the deployment are listed below with the description of usage of the parameter in the deployment process.</span></span> 

| <span data-ttu-id="925a0-402">매개 변수</span><span class="sxs-lookup"><span data-stu-id="925a0-402">Parameter</span></span> | <span data-ttu-id="925a0-403">설명</span><span class="sxs-lookup"><span data-stu-id="925a0-403">Description</span></span> |
|:--- |:--- |
| <span data-ttu-id="925a0-404">위치</span><span class="sxs-lookup"><span data-stu-id="925a0-404">Location</span></span> |<span data-ttu-id="925a0-405">리소스를 배포하는 영역입니다(예:미국 동부).</span><span class="sxs-lookup"><span data-stu-id="925a0-405">The region to deploy the resources into, e.g. East US.</span></span> |
| <span data-ttu-id="925a0-406">StorageAccountType</span><span class="sxs-lookup"><span data-stu-id="925a0-406">StorageAccountType</span></span> |<span data-ttu-id="925a0-407">만든 Storage 계정 유형</span><span class="sxs-lookup"><span data-stu-id="925a0-407">The type of the Storage Account created</span></span> |
| <span data-ttu-id="925a0-408">VirtualNetworkUsage</span><span class="sxs-lookup"><span data-stu-id="925a0-408">VirtualNetworkUsage</span></span> |<span data-ttu-id="925a0-409">새 가상 네트워크를 만들지 아니면 기존 가상 네트워크를 사용할지를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-409">Indicates if a new virtual network will be created or use an existing one</span></span> |
| <span data-ttu-id="925a0-410">VirtualNetworkName</span><span class="sxs-lookup"><span data-stu-id="925a0-410">VirtualNetworkName</span></span> |<span data-ttu-id="925a0-411">기존 또는 새 가상 네트워크 사용에서 필수인 만들 Virtual Network의 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-411">The name of the Virtual Network to Create, mandatory on both existing or new virtual network usage</span></span> |
| <span data-ttu-id="925a0-412">VirtualNetworkResourceGroupName</span><span class="sxs-lookup"><span data-stu-id="925a0-412">VirtualNetworkResourceGroupName</span></span> |<span data-ttu-id="925a0-413">기존 가상 네트워크가 있는 리소스 그룹의 이름을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-413">Specifies the name of the resource group where the existing virtual network resides.</span></span> <span data-ttu-id="925a0-414">기존 가상 네트워크를 사용하는 경우 필수 매개 변수가 되므로 배포 시 기존 가상 네트워크 ID를 찾을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-414">When using an existing virtual network, this becomes a mandatory parameter so the deployment can find the ID of the existing virtual network</span></span> |
| <span data-ttu-id="925a0-415">VirtualNetworkAddressRange</span><span class="sxs-lookup"><span data-stu-id="925a0-415">VirtualNetworkAddressRange</span></span> |<span data-ttu-id="925a0-416">새 가상 네트워크를 만드는 경우 필수인 새 VNET 주소 범위입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-416">The address range of the new VNET, mandatory if creating a new virtual network</span></span> |
| <span data-ttu-id="925a0-417">InternalSubnetName</span><span class="sxs-lookup"><span data-stu-id="925a0-417">InternalSubnetName</span></span> |<span data-ttu-id="925a0-418">모든 가상 네트워크(신규 또는 기존) 사용 옵션에서 필수인 내부 서브넷의 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-418">The name of the internal subnet, mandatory on both virtual network usage options (new or existing)</span></span> |
| <span data-ttu-id="925a0-419">InternalSubnetAddressRange</span><span class="sxs-lookup"><span data-stu-id="925a0-419">InternalSubnetAddressRange</span></span> |<span data-ttu-id="925a0-420">새 가상 네트워크를 만드는 경우 필수인 도메인 컨트롤러 및 ADFS 서버를 포함하는 내부 서브넷의 주소 범위입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-420">The address range of the internal subnet, which contains the Domain Controllers and ADFS servers, mandatory if creating a new virtual network.</span></span> |
| <span data-ttu-id="925a0-421">DMZSubnetAddressRange</span><span class="sxs-lookup"><span data-stu-id="925a0-421">DMZSubnetAddressRange</span></span> |<span data-ttu-id="925a0-422">새 가상 네트워크를 만드는 경우 필수인 Windows 응용 프로그램 프록시 서버를 포함하는 DMZ 서브넷의 주소 범위입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-422">The address range of the dmz subnet, which contains the Windows application proxy servers, mandatory if creating a new virtual network.</span></span> |
| <span data-ttu-id="925a0-423">DMZSubnetName</span><span class="sxs-lookup"><span data-stu-id="925a0-423">DMZSubnetName</span></span> |<span data-ttu-id="925a0-424">모든 가상 네트워크(신규 또는 기존) 사용 옵션에서 필수인 내부 서브넷의 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-424">The name of the internal subnet, mandatory on both virtual network usage options (new or existing).</span></span> |
| <span data-ttu-id="925a0-425">ADDC01NICIPAddress</span><span class="sxs-lookup"><span data-stu-id="925a0-425">ADDC01NICIPAddress</span></span> |<span data-ttu-id="925a0-426">첫 번째 도메인 컨트롤러의 내부 IP 주소인 이 IP 주소는 DC에 정적으로 할당되고 내부 서브넷 내에서 유효한 IP 주소여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-426">The internal IP address of the first Domain Controller, this IP address will be statically assigned to the DC and must be a valid ip address within the Internal subnet</span></span> |
| <span data-ttu-id="925a0-427">ADDC02NICIPAddress</span><span class="sxs-lookup"><span data-stu-id="925a0-427">ADDC02NICIPAddress</span></span> |<span data-ttu-id="925a0-428">두 번째 도메인 컨트롤러의 내부 IP 주소인 이 IP 주소는 DC에 정적으로 할당되고 내부 서브넷 내에서 유효한 IP 주소여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-428">The internal IP address of the second Domain Controller, this IP address will be statically assigned to the DC and must be a valid ip address within the Internal subnet</span></span> |
| <span data-ttu-id="925a0-429">ADFS01NICIPAddress</span><span class="sxs-lookup"><span data-stu-id="925a0-429">ADFS01NICIPAddress</span></span> |<span data-ttu-id="925a0-430">첫 번째 ADFS 서버의 내부 IP 주소인 이 IP 주소는 ADFS 서버에 정적으로 할당되고 내부 서브넷 내에서 유효한 IP 주소여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-430">The internal IP address of the first ADFS server, this IP address will be statically assigned to the ADFS server and must be a valid ip address within the Internal subnet</span></span> |
| <span data-ttu-id="925a0-431">ADFS02NICIPAddress</span><span class="sxs-lookup"><span data-stu-id="925a0-431">ADFS02NICIPAddress</span></span> |<span data-ttu-id="925a0-432">두 번째 ADFS 서버의 내부 IP 주소인 이 IP 주소는 ADFS 서버에 정적으로 할당되고 내부 서브넷 내에서 유효한 IP 주소여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-432">The internal IP address of the second ADFS server, this IP address will be statically assigned to the ADFS server and must be a valid ip address within the Internal subnet</span></span> |
| <span data-ttu-id="925a0-433">WAP01NICIPAddress</span><span class="sxs-lookup"><span data-stu-id="925a0-433">WAP01NICIPAddress</span></span> |<span data-ttu-id="925a0-434">첫 번째 WAP 서버의 내부 IP 주소인 이 IP 주소는 WAP 서버에 정적으로 할당되고 DMZ 서브넷 내에서 유효한 IP 주소여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-434">The internal IP address of the first WAP server, this IP address will be statically assigned to the WAP server and must be a valid ip address within the DMZ subnet</span></span> |
| <span data-ttu-id="925a0-435">WAP02NICIPAddress</span><span class="sxs-lookup"><span data-stu-id="925a0-435">WAP02NICIPAddress</span></span> |<span data-ttu-id="925a0-436">두 번째 WAP 서버의 내부 IP 주소인 이 IP 주소는 WAP 서버에 정적으로 할당되고 DMZ 서브넷 내에서 유효한 IP 주소여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-436">The internal IP address of the second WAP server, this IP address will be statically assigned to the WAP server and must be a valid ip address within the DMZ subnet</span></span> |
| <span data-ttu-id="925a0-437">ADFSLoadBalancerPrivateIPAddress</span><span class="sxs-lookup"><span data-stu-id="925a0-437">ADFSLoadBalancerPrivateIPAddress</span></span> |<span data-ttu-id="925a0-438">ADFS 부하 분산 장치의 내부 IP 주소인 이 IP 주소는 부하 분산 장치에 정적으로 할당되고 내부 서브넷 내에서 유효한 IP 주소여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-438">The internal IP address of the ADFS load balancer, this IP address will be statically assigned to the load balancer and must be a valid ip address within the Internal subnet</span></span> |
| <span data-ttu-id="925a0-439">ADDCVMNamePrefix</span><span class="sxs-lookup"><span data-stu-id="925a0-439">ADDCVMNamePrefix</span></span> |<span data-ttu-id="925a0-440">도메인 컨트롤러의 가상 컴퓨터 이름 접두사입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-440">Virtual Machine name prefix for Domain Controllers</span></span> |
| <span data-ttu-id="925a0-441">ADFSVMNamePrefix</span><span class="sxs-lookup"><span data-stu-id="925a0-441">ADFSVMNamePrefix</span></span> |<span data-ttu-id="925a0-442">ADFS 서버의 가상 컴퓨터 이름 접두사입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-442">Virtual Machine name prefix for ADFS servers</span></span> |
| <span data-ttu-id="925a0-443">WAPVMNamePrefix</span><span class="sxs-lookup"><span data-stu-id="925a0-443">WAPVMNamePrefix</span></span> |<span data-ttu-id="925a0-444">WAP 서버의 가상 컴퓨터 이름 접두사입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-444">Virtual Machine name prefix for WAP servers</span></span> |
| <span data-ttu-id="925a0-445">ADDCVMSize</span><span class="sxs-lookup"><span data-stu-id="925a0-445">ADDCVMSize</span></span> |<span data-ttu-id="925a0-446">도메인 컨트롤러의 VM 크기입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-446">The vm size of the Domain Controllers</span></span> |
| <span data-ttu-id="925a0-447">ADFSVMSize</span><span class="sxs-lookup"><span data-stu-id="925a0-447">ADFSVMSize</span></span> |<span data-ttu-id="925a0-448">ADFS 서버의 VM 크기입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-448">The vm size of the ADFS servers</span></span> |
| <span data-ttu-id="925a0-449">WAPVMSize</span><span class="sxs-lookup"><span data-stu-id="925a0-449">WAPVMSize</span></span> |<span data-ttu-id="925a0-450">WAP 서버의 VM 크기입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-450">The vm size of the WAP servers</span></span> |
| <span data-ttu-id="925a0-451">AdminUserName</span><span class="sxs-lookup"><span data-stu-id="925a0-451">AdminUserName</span></span> |<span data-ttu-id="925a0-452">가상 컴퓨터의 로컬 관리자의 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-452">The name of the local Administrator of the virtual machines</span></span> |
| <span data-ttu-id="925a0-453">AdminPassword</span><span class="sxs-lookup"><span data-stu-id="925a0-453">AdminPassword</span></span> |<span data-ttu-id="925a0-454">가상 컴퓨터의 로컬 관리자 계정의 암호입니다.</span><span class="sxs-lookup"><span data-stu-id="925a0-454">The password for the local Administrator account of the virtual machines</span></span> |

## <a name="additional-resources"></a><span data-ttu-id="925a0-455">추가 리소스</span><span class="sxs-lookup"><span data-stu-id="925a0-455">Additional resources</span></span>
* [<span data-ttu-id="925a0-456">가용성 집합</span><span class="sxs-lookup"><span data-stu-id="925a0-456">Availability Sets</span></span>](https://aka.ms/Azure/Availability) 
* [<span data-ttu-id="925a0-457">Azure 부하 분산 장치</span><span class="sxs-lookup"><span data-stu-id="925a0-457">Azure Load Balancer</span></span>](https://aka.ms/Azure/ILB)
* [<span data-ttu-id="925a0-458">내부 부하 분산 장치</span><span class="sxs-lookup"><span data-stu-id="925a0-458">Internal Load Balancer</span></span>](https://aka.ms/Azure/ILB/Internal)
* [<span data-ttu-id="925a0-459">인터넷 연결 부하 분산 장치</span><span class="sxs-lookup"><span data-stu-id="925a0-459">Internet Facing Load Balancer</span></span>](https://aka.ms/Azure/ILB/Internet)
* [<span data-ttu-id="925a0-460">Storage 계정</span><span class="sxs-lookup"><span data-stu-id="925a0-460">Storage Accounts</span></span>](https://aka.ms/Azure/Storage)
* [<span data-ttu-id="925a0-461">Azure Virtual Networks</span><span class="sxs-lookup"><span data-stu-id="925a0-461">Azure Virtual Networks</span></span>](https://aka.ms/Azure/VNet)
* [<span data-ttu-id="925a0-462">AD FS 및 웹 응용 프로그램 프록시 링크</span><span class="sxs-lookup"><span data-stu-id="925a0-462">AD FS and Web Application Proxy Links</span></span>](http://aka.ms/ADFSLinks) 

## <a name="next-steps"></a><span data-ttu-id="925a0-463">다음 단계</span><span class="sxs-lookup"><span data-stu-id="925a0-463">Next steps</span></span>
* [<span data-ttu-id="925a0-464">Azure Active Directory와 온-프레미스 ID 통합</span><span class="sxs-lookup"><span data-stu-id="925a0-464">Integrating your on-premises identities with Azure Active Directory</span></span>](active-directory-aadconnect.md)
* [<span data-ttu-id="925a0-465">Azure AD Connect를 사용하여 AD FS 구성 및 관리</span><span class="sxs-lookup"><span data-stu-id="925a0-465">Configuring and managing your AD FS using Azure AD Connect</span></span>](active-directory-aadconnectfed-whatis.md)
* [<span data-ttu-id="925a0-466">Azure Traffic Manager를 사용하여 Azure에서 고가용성 교차 지리적 AD FS 배포</span><span class="sxs-lookup"><span data-stu-id="925a0-466">High availability cross-geographic AD FS deployment in Azure with Azure Traffic Manager</span></span>](../active-directory-adfs-in-azure-with-azure-traffic-manager.md)

