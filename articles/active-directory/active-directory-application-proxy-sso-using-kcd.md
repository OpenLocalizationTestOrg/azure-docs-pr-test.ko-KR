---
title: "응용 프로그램 프록시를 사용하는 Single Sign-On | Microsoft Docs"
description: "Azure AD 응용 프로그램 프록시를 사용하여 Single Sign-On을 제공하는 방법을 설명합니다."
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: ded0d9c9-45f6-47d7-bd0f-3f7fd99ab621
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/25/2017
ms.author: kgremban
ms.reviewer: harshja
ms.custom: H1Hack27Feb2017, it-pro
ms.openlocfilehash: 149af1f68e574f78127a9c2de8a0e79ed8774d29
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/18/2017
---
# <a name="kerberos-constrained-delegation-for-single-sign-on-to-your-apps-with-application-proxy"></a><span data-ttu-id="ca0fe-103">응용 프로그램 프록시를 사용하여 앱에 Single Sign-On에 대한 Kerberos 제한된 위임</span><span class="sxs-lookup"><span data-stu-id="ca0fe-103">Kerberos Constrained Delegation for single sign-on to your apps with Application Proxy</span></span>

<span data-ttu-id="ca0fe-104">Windows 통합 인증으로 보안되는 응용 프로그램 프록시를 통해 게시된 온-프레미스 응용 프로그램에 대한 Single Sign-On을 제공할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-104">You can provide single sign-on for on-premises applications published through Application Proxy that are secured with Integrated Windows Authentication.</span></span> <span data-ttu-id="ca0fe-105">이러한 응용 프로그램은 액세스를 위해 Kerberos 티켓이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-105">These applications require a Kerberos ticket for access.</span></span> <span data-ttu-id="ca0fe-106">응용 프로그램 프록시는 KCD(Kerberos 제한된 위임)을 사용하여 이러한 응용 프로그램을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-106">Application Proxy uses Kerberos Constrained Delegation (KCD) to support these applications.</span></span> 

<span data-ttu-id="ca0fe-107">Active Directory에 응용 프로그램 프록시 커넥터 사용 권한을 부여하여 사용자를 가장함으로써 IWA(Windows 통합 인증)를 사용하여 응용 프로그램에 SSO(Single Sign On)를 사용하게 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-107">You can enable single sign-on to your applications using Integrated Windows Authentication (IWA) by giving Application Proxy connectors permission in Active Directory to impersonate users.</span></span> <span data-ttu-id="ca0fe-108">커넥터는 이 사용 권한을 사용하여 사용자 대신 토큰을 주고받습니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-108">The connectors use this permission to send and receive tokens on their behalf.</span></span>

## <a name="how-single-sign-on-with-kcd-works"></a><span data-ttu-id="ca0fe-109">KCD를 사용하는 Single Sign-On 작동 방식</span><span class="sxs-lookup"><span data-stu-id="ca0fe-109">How single sign-on with KCD works</span></span>
<span data-ttu-id="ca0fe-110">사용자가 IWA를 사용하는 온-프레미스 응용 프로그램에 액세스를 시도할 때 이 다이어그램이 흐름을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-110">This diagram explains the flow when a user attempts to access an on-prem application that uses IWA.</span></span>

![Microsoft AAD 인증 흐름 다이어그램](./media/active-directory-application-proxy-sso-using-kcd/AuthDiagram.png)

1. <span data-ttu-id="ca0fe-112">사용자가 응용 프로그램 프록시를 통해 온-프레미스 응용 프로그램에 액세스하기 위한 URL을 입력합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-112">The user enters the URL to access the on-prem application through Application Proxy.</span></span>
2. <span data-ttu-id="ca0fe-113">응용 프로그램 프록시는 사전 인증을 위해 Azure AD 인증 서비스에 요청을 리디렉션합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-113">Application Proxy redirects the request to Azure AD authentication services to preauthenticate.</span></span> <span data-ttu-id="ca0fe-114">이 시점에서 Azure AD는 다단계 인증 등, 모든 적용 가능한 인증 및 권한 부여 정책을 적용합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-114">At this point, Azure AD applies any applicable authentication and authorization policies, such as multifactor authentication.</span></span> <span data-ttu-id="ca0fe-115">사용자가 확인되면 Azure AD에서 토큰을 만들어서 사용자에게 보냅니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-115">If the user is validated, Azure AD creates a token and sends it to the user.</span></span>
3. <span data-ttu-id="ca0fe-116">사용자는 토큰을 응용 프로그램 프록시로 전달합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-116">The user passes the token to Application Proxy.</span></span>
4. <span data-ttu-id="ca0fe-117">응용 프로그램 프록시는 토큰의 유효성을 검사하고 토큰에서 UPN(사용자 사용자 이름)을 검색한 다음, 요청, UPN 및 SPN(서비스 사용자 이름)을 이중 인증된 보안 채널을 통해 커넥터에 전송합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-117">Application Proxy validates the token and retrieves the User Principal Name (UPN) from it, and then sends the request, the UPN, and the Service Principal Name (SPN) to the Connector through a dually authenticated secure channel.</span></span>
5. <span data-ttu-id="ca0fe-118">그러면 커넥터에서 온-프레미스 AD와 함께 KCD(Kerberos 제한 위임) 협상을 수행하여 사용자를 가장하여 Kerberos 토큰을 응용 프로그램에 가져오게 합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-118">The Connector performs Kerberos Constrained Delegation (KCD) negotiation with the on-prem AD, impersonating the user to get a Kerberos token to the application.</span></span>
6. <span data-ttu-id="ca0fe-119">Active Directory는 응용 프로그램에 대한 Kerberos 토큰을 커넥터로 보냅니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-119">Active Directory sends the Kerberos token for the application to the Connector.</span></span>
7. <span data-ttu-id="ca0fe-120">그러면 커넥터에서 AD에서 받은 Kerberos 토큰을 사용하여 원래 요청을 응용 프로그램 서버에 보냅니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-120">The Connector sends the original request to the application server, using the Kerberos token it received from AD.</span></span>
8. <span data-ttu-id="ca0fe-121">응용 프로그램은 응답을 커넥터로 보냅니다. 그러면 해당 응답이 응용 프로그램 프록시 서비스를 거쳐 마지막으로 사용자에게 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-121">The application sends the response to the Connector, which is then returned to the Application Proxy service and finally to the user.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="ca0fe-122">필수 조건</span><span class="sxs-lookup"><span data-stu-id="ca0fe-122">Prerequisites</span></span>
<span data-ttu-id="ca0fe-123">IWA 응용 프로그램에 대한 Single Sign-On을 시작하기 전에 사용자 환경이 다음 설정 및 구성을 갖추고 준비되었는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-123">Before you get started with single sign-on for IWA applications, make sure your environment is ready with the following settings and configurations:</span></span>

* <span data-ttu-id="ca0fe-124">SharePoint 웹앱과 같은 앱이 Windows 통합 인증을 사용하도록 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-124">Your apps, like SharePoint Web apps, are set to use Integrated Windows Authentication.</span></span> <span data-ttu-id="ca0fe-125">자세한 내용은 [Kerberos 인증 지원 사용](https://technet.microsoft.com/library/dd759186.aspx) 또는 SharePoint의 경우 [SharePoint 2013에서 Kerberos 인증 계획](https://technet.microsoft.com/library/ee806870.aspx)(영문)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-125">For more information, see [Enable Support for Kerberos Authentication](https://technet.microsoft.com/library/dd759186.aspx), or for SharePoint see [Plan for Kerberos authentication in SharePoint 2013](https://technet.microsoft.com/library/ee806870.aspx).</span></span>
* <span data-ttu-id="ca0fe-126">모든 앱에는 [서비스 주체 이름](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx)이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-126">All your apps have [Service Principal Names](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx).</span></span>
* <span data-ttu-id="ca0fe-127">커넥터를 실행하는 서버 및 앱을 실행하는 서버가 도메인 가입 상태이고 동일한 도메인 또는 신뢰하는 도메인의 일부입니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-127">The server running the Connector and the server running the app are domain joined and part of the same domain or trusting domains.</span></span> <span data-ttu-id="ca0fe-128">도메인 가입에 대한 자세한 내용은 [컴퓨터를 도메인에 가입](https://technet.microsoft.com/library/dd807102.aspx)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-128">For more information on domain join, see [Join a Computer to a Domain](https://technet.microsoft.com/library/dd807102.aspx).</span></span>
* <span data-ttu-id="ca0fe-129">커넥터를 실행하는 서버는 사용자에 대한 TokenGroupsGlobalAndUniversal 특성 읽기 권한이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-129">The server running the Connector has access to read the TokenGroupsGlobalAndUniversal attribute for users.</span></span> <span data-ttu-id="ca0fe-130">이 기본 설정은 환경을 강화하는 보안에 의해 영향을 받았을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-130">This default setting might have been impacted by security hardening the environment.</span></span>

### <a name="configure-active-directory"></a><span data-ttu-id="ca0fe-131">Active Directory 구성</span><span class="sxs-lookup"><span data-stu-id="ca0fe-131">Configure Active Directory</span></span>
<span data-ttu-id="ca0fe-132">Active Directory 구성은 응용 프로그램 프록시 커넥터와 응용 프로그램 서버가 동일한 도메인에 있는지 여부에 따라 다양합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-132">The Active Directory configuration varies, depending on whether your Application Proxy connector and the application server are in the same domain or not.</span></span>

#### <a name="connector-and-application-server-in-the-same-domain"></a><span data-ttu-id="ca0fe-133">동일한 도메인 내의 커넥터와 응용 프로그램 서버</span><span class="sxs-lookup"><span data-stu-id="ca0fe-133">Connector and application server in the same domain</span></span>
1. <span data-ttu-id="ca0fe-134">Active Directory에서 **도구** > **사용자 및 컴퓨터**로 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-134">In Active Directory, go to **Tools** > **Users and Computers**.</span></span>
2. <span data-ttu-id="ca0fe-135">커넥터를 실행하는 서버를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-135">Select the server running the connector.</span></span>
3. <span data-ttu-id="ca0fe-136">마우스 오른쪽 단추를 클릭하고 **속성** > **위임**을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-136">Right-click and select **Properties** > **Delegation**.</span></span>
4. <span data-ttu-id="ca0fe-137">**지정한 서비스에 대한 위임용으로만 이 컴퓨터 트러스트**를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-137">Select **Trust this computer for delegation to specified services only**.</span></span> 
5. <span data-ttu-id="ca0fe-138">**이 계정으로 위임된 자격 증명을 사용할 수 있는 서비스** 아래에서 해당 응용 프로그램 서버의 SPN ID 값을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-138">Under **Services to which this account can present delegated credentials** add the value for the SPN identity of the application server.</span></span> <span data-ttu-id="ca0fe-139">그러면 응용 프로그램 프록시 커넥터가 목록에 정의된 응용 프로그램에 대해 AD에서 사용자를 가장할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-139">This enables the Application Proxy Connector to impersonate users in AD against the applications defined in the list.</span></span>

   ![커넥터 SVR 속성 창 스크린샷](./media/active-directory-application-proxy-sso-using-kcd/Properties.jpg)

#### <a name="connector-and-application-server-in-different-domains"></a><span data-ttu-id="ca0fe-141">다른 도메인 내의 커넥터와 응용 프로그램 서버</span><span class="sxs-lookup"><span data-stu-id="ca0fe-141">Connector and application server in different domains</span></span>
1. <span data-ttu-id="ca0fe-142">도메인에 걸쳐 KCD로 작업하기 위한 필수 구성 요소 목록은 [도메인 간의 Kerberos 제한 위임](https://technet.microsoft.com/library/hh831477.aspx)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-142">For a list of prerequisites for working with KCD across domains, see [Kerberos Constrained Delegation across domains](https://technet.microsoft.com/library/hh831477.aspx).</span></span>
2. <span data-ttu-id="ca0fe-143">커넥터 서버의 `principalsallowedtodelegateto` 속성을 사용하여 커넥터 서버에 대해 위임하도록 응용 프로그램 프록시를 활성화합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-143">Use the `principalsallowedtodelegateto` property on the Connector server to enable the Application Proxy to delegate for the Connector server.</span></span> <span data-ttu-id="ca0fe-144">응용 프로그램 서버는 `sharepointserviceaccount`이며 위임하는 서버는 `connectormachineaccount`입니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-144">The application server is `sharepointserviceaccount` and the delegating server is `connectormachineaccount`.</span></span> <span data-ttu-id="ca0fe-145">Windows 2012 R2의 경우 예로 이 코드를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-145">For Windows 2012 R2, use this code as an example:</span></span>

        $connector= Get-ADComputer -Identity connectormachineaccount -server dc.connectordomain.com

        Set-ADComputer -Identity sharepointserviceaccount -PrincipalsAllowedToDelegateToAccount $connector

        Get-ADComputer sharepointserviceaccount -Properties PrincipalsAllowedToDelegateToAccount

<span data-ttu-id="ca0fe-146">Sharepointserviceaccount는 해당 SPS 앱 풀이 실행되고 있는 SPS 컴퓨터 계정 또는 서비스 계정이 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-146">Sharepointserviceaccount can be the SPS machine account or a service account under which the SPS app pool is running.</span></span>

## <a name="configure-single-sign-on"></a><span data-ttu-id="ca0fe-147">Single Sign-On 구성</span><span class="sxs-lookup"><span data-stu-id="ca0fe-147">Configure single sign-on</span></span> 
1. <span data-ttu-id="ca0fe-148">[응용 프로그램 프록시로 응용 프로그램 게시](application-proxy-publish-azure-portal.md)에 설명된 지침에 따라 응용 프로그램을 게시합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-148">Publish your application according to the instructions described in [Publish applications with Application Proxy](application-proxy-publish-azure-portal.md).</span></span> <span data-ttu-id="ca0fe-149">반드시 **Azure Active Directory**를 **사전 인증 메서드**로 선택해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-149">Make sure to select **Azure Active Directory** as the **Preauthentication Method**.</span></span>
2. <span data-ttu-id="ca0fe-150">응용 프로그램이 엔터프라이즈 응용 프로그램 목록에 나타나면 선택하고 **Single Sign-On**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-150">After your application appears in the list of enterprise applications, select it and click **Single sign-on**.</span></span>
3. <span data-ttu-id="ca0fe-151">Single Sign-On 모드를 **Windows 통합 인증**으로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-151">Set the single sign-on mode to **Integrated Windows Authentication**.</span></span>  
4. <span data-ttu-id="ca0fe-152">응용 프로그램 서버의 **내부 응용 프로그램 SPN** 을 입력합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-152">Enter the **Internal Application SPN** of the application server.</span></span> <span data-ttu-id="ca0fe-153">이 예제에서는 게시된 응용 프로그램에 대한 SPN이 http/www.contoso.com입니다. 이 SPN은 커넥터가 위임된 자격 증명을 제공할 수 있는 서비스 목록에 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-153">In this example, the SPN for our published application is http/www.contoso.com. This SPN needs to be in the list of services to which the connector can present delegated credentials.</span></span> 
5. <span data-ttu-id="ca0fe-154">커넥터에 대한 **위임된 로그인 ID**를 선택하여 사용자를 대신하여 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-154">Choose the **Delegated Login Identity** for the connector to use on behalf of your users.</span></span> <span data-ttu-id="ca0fe-155">자세한 내용은 [다른 온-프레미스 및 클라우드 ID로 작업](#Working-with-different-on-premises-and-cloud-identities) 참조</span><span class="sxs-lookup"><span data-stu-id="ca0fe-155">For more information, see [Working with different on-premises and cloud identities](#Working-with-different-on-premises-and-cloud-identities)</span></span>

   ![고급 응용 프로그램 구성](./media/active-directory-application-proxy-sso-using-kcd/cwap_auth2.png)  


## <a name="sso-for-non-windows-apps"></a><span data-ttu-id="ca0fe-157">비 Windows 앱에 대한 SSO</span><span class="sxs-lookup"><span data-stu-id="ca0fe-157">SSO for non-Windows apps</span></span>
<span data-ttu-id="ca0fe-158">클라우드에서 Azure AD가 사용자를 인증할 때 Azure AD 응용 프로그램 프록시에서 Kerberos 위임 흐름이 시작됩니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-158">The Kerberos delegation flow in Azure AD Application Proxy starts when Azure AD authenticates the user in the cloud.</span></span> <span data-ttu-id="ca0fe-159">요청이 온-프레미스에 도착하면 Azure AD 응용 프로그램 프록시 커넥터는 로컬 Active Directory와 상호 작용하여 사용자 대신 Kerberos 티켓을 발급합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-159">Once the request arrives on-premises, the Azure AD Application Proxy connector issues a Kerberos ticket on behalf of the user by interacting with the local Active Directory.</span></span> <span data-ttu-id="ca0fe-160">해당 과정은 Kerberos 제한 위임(KCD)이라고 합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-160">This process is referred to as Kerberos Constrained Delegation (KCD).</span></span> <span data-ttu-id="ca0fe-161">다음 단계에서 요청은 백 엔드 응용 프로그램에 Kerberos 티켓으로 전송됩니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-161">In the next phase, a request is sent to the backend application with this Kerberos ticket.</span></span> <span data-ttu-id="ca0fe-162">이러한 요청을 보내는 방법을 정의하는 몇 가지 프로토콜이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-162">There are several protocols that define how to send such requests.</span></span> <span data-ttu-id="ca0fe-163">현재 비 Windows Server는 대부분 Azure AD 응용 프로그램 프록시에 지원되는 Negotiate/SPNego를 참조합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-163">Most non-Windows servers expect Negotiate/SPNego that is now supported on Azure AD Application Proxy.</span></span>

<span data-ttu-id="ca0fe-164">Kerberos에 대한 자세한 내용은 [KCD(Kerberos Constrained Delegation)에 대해 확인하려는 모든 정보](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-164">For more information about Kerberos, see [All you want to know about Kerberos Constrained Delegation (KCD)](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd).</span></span>

<span data-ttu-id="ca0fe-165">비 Windows 앱은 일반적으로 도메인 이메일 주소 대신 사용자 이름 또는 SAM 계정 이름을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-165">Non-Windows apps typically user usernames or SAM account names instead of domain email addresses.</span></span> <span data-ttu-id="ca0fe-166">해당 경우가 응용 프로그램에 적용되는 경우 클라우드 ID를 응용 프로그램 ID에 연결하도록 위임된 로그인 ID 필드를 구성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-166">If that situation applies to your applications, you need to configure the delegated login identity field to connect your cloud identities to your application identities.</span></span> 

## <a name="working-with-different-on-premises-and-cloud-identities"></a><span data-ttu-id="ca0fe-167">다른 온-프레미스 및 클라우드 ID로 작업</span><span class="sxs-lookup"><span data-stu-id="ca0fe-167">Working with different on-premises and cloud identities</span></span>
<span data-ttu-id="ca0fe-168">응용 프로그램 프록시는 사용자가 클라우드 및 온-프레미스에서 정확히 동일한 ID를 사용한다고 가정합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-168">Application Proxy assumes that users have exactly the same identity in the cloud and on-premises.</span></span> <span data-ttu-id="ca0fe-169">해당 경우가 아닌 경우 Single Sign-On에 여전히 KCD를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-169">If that's not the case, you can can still use KCD for single sign-on.</span></span> <span data-ttu-id="ca0fe-170">각 응용 프로그램에 **위임된 로그인 ID**를 구성하여 Single Sign-On을 수행할 때 어떤 ID를 사용해야 하는지 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-170">Configure a **Delegated login identity** for each application to specify which identity should be used when performing single sign-on.</span></span>  

<span data-ttu-id="ca0fe-171">이 기능을 사용하면 다른 온-프레미스 및 클라우드 ID가 있는 여러 조직이 사용자에게 다른 사용자 이름 및 암호를 입력하도록 하지 않고 클라우드에서 온-프레미스 앱으로 SSO를 갖게 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-171">This capability allows many organizations that have different on-premises and cloud identities to have SSO from the cloud to on-premises apps without requiring the users to enter different usernames and passwords.</span></span> <span data-ttu-id="ca0fe-172">이 작업은 다음의 조직을 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-172">This includes organizations that:</span></span>

* <span data-ttu-id="ca0fe-173">내부적으로 여러 도메인(joe@us.contoso.com, joe@eu.contoso.com)과 클라우드에서 단일 도메인(joe@contoso.com)이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-173">Have multiple domains internally (joe@us.contoso.com, joe@eu.contoso.com) and a single domain in the cloud (joe@contoso.com).</span></span>
* <span data-ttu-id="ca0fe-174">내부적으로 라우팅이 가능하지 않은 도메인 이름(joe@contoso.usa)과 클라우드에서 법적 도메인이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-174">Have non-routable domain name internally (joe@contoso.usa) and a legal one in the cloud.</span></span>
* <span data-ttu-id="ca0fe-175">내부적으로 도메인 이름을 사용하지 마십시오(joe).</span><span class="sxs-lookup"><span data-stu-id="ca0fe-175">Do not use domain names internally (joe)</span></span>
* <span data-ttu-id="ca0fe-176">온-프레미스 및 클라우드에서 다른 별칭을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-176">Use different aliases on-prem and in the cloud.</span></span> <span data-ttu-id="ca0fe-177">예제: joe-johns@contoso.com 및 joej@contoso.com</span><span class="sxs-lookup"><span data-stu-id="ca0fe-177">For example, joe-johns@contoso.com vs. joej@contoso.com</span></span>  

<span data-ttu-id="ca0fe-178">응용 프로그램 프록시를 사용하여 Kerberos 티켓을 얻기 위해 어떤 ID를 사용할지 선택할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-178">With Application Proxy, you can select which identity to use to obtain the Kerberos ticket.</span></span> <span data-ttu-id="ca0fe-179">이 설정은 응용 프로그램별입니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-179">This setting is per application.</span></span> <span data-ttu-id="ca0fe-180">이러한 옵션 중 일부는 전자 메일 주소 형식을 받아들이지 않는 시스템에 적합한 반면 다른 것들은 대체 로그인을 위해 설계되었습니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-180">Some of these options are suitable for systems that do not accept email address format, others are designed for alternative login.</span></span>

![위임된 로그인 ID 매개 변수 스크린샷](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_upn.png)

<span data-ttu-id="ca0fe-182">위임된 로그인 ID가 사용되는 경우 값은 조직 내의 모든 도메인 또는 포리스트에 대해 고유하지 않을 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-182">If delegated login identity is used, the value might not be unique across all the domains or forests in your organization.</span></span> <span data-ttu-id="ca0fe-183">다른 두 가지 커넥터 그룹을 사용하여 이러한 응용 프로그램을 두 번 게시함으로써 이 문제를 방지할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-183">You can avoid this issue by publishing these applications twice using two different Connector groups.</span></span> <span data-ttu-id="ca0fe-184">각 응용 프로그램에는 다른 사용자 대상 그룹이 있으므로 다른 도메인에 해당 커넥터를 조인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-184">Since each application has a different user audience, you can join its Connectors to a different domain.</span></span>

### <a name="configure-sso-for-different-identities"></a><span data-ttu-id="ca0fe-185">다른 ID에 대한 SSO 구성</span><span class="sxs-lookup"><span data-stu-id="ca0fe-185">Configure SSO for different identities</span></span>
1. <span data-ttu-id="ca0fe-186">주 ID가 전자 메일 주소가 되도록 Azure AD Connect 설정을 구성합니다(mail).</span><span class="sxs-lookup"><span data-stu-id="ca0fe-186">Configure Azure AD Connect settings so the main identity is the email address (mail).</span></span> <span data-ttu-id="ca0fe-187">이 작업은 동기화 설정에서 **사용자 계정 이름** 필드를 변경하여 사용자 지정 프로세스의 일부로 수행됩니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-187">This is done as part of the customize process, by changing the **User Principal Name** field in the sync settings.</span></span> <span data-ttu-id="ca0fe-188">또한 이러한 설정은 사용자가 ID 저장소로 Azure AD를 사용하는 Office 365, Windows 10 장치 및 다른 응용 프로그램에 로그인하는 방법을 결정합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-188">These settings also determine how users log in to Office365, Windows10 devices, and other applications that use Azure AD as their identity store.</span></span>  
   <span data-ttu-id="ca0fe-189">![사용자 식별 스크린샷 - 사용자 계정 이름 드롭다운](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_connect_settings.png)</span><span class="sxs-lookup"><span data-stu-id="ca0fe-189">![Identifying users screenshot - User Principal Name dropdown](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_connect_settings.png)</span></span>  
2. <span data-ttu-id="ca0fe-190">수정하려는 응용 프로그램에 대한 응용 프로그램 구성 설정에서 사용할 **위임된 로그인 ID** 를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-190">In the Application Configuration settings for the application you would like to modify, select the **Delegated Login Identity** to be used:</span></span>

   * <span data-ttu-id="ca0fe-191">사용자 계정 이름(예: joe@contoso.com)</span><span class="sxs-lookup"><span data-stu-id="ca0fe-191">User Principal Name (for example, joe@contoso.com)</span></span>
   * <span data-ttu-id="ca0fe-192">대체 사용자 계정 이름(예: joed@contoso.local)</span><span class="sxs-lookup"><span data-stu-id="ca0fe-192">Alternate User Principal Name (for example, joed@contoso.local)</span></span>
   * <span data-ttu-id="ca0fe-193">사용자 계정 이름의 사용자 이름 일부(예: joe)</span><span class="sxs-lookup"><span data-stu-id="ca0fe-193">Username part of User Principal Name (for example, joe)</span></span>
   * <span data-ttu-id="ca0fe-194">대체 사용자 계정 이름의 사용자 이름 일부(예: joed)</span><span class="sxs-lookup"><span data-stu-id="ca0fe-194">Username part of Alternate User Principal Name (for example, joed)</span></span>
   * <span data-ttu-id="ca0fe-195">온-프레미스 SAM 계정 이름(도메인 컨트롤러 구성에 따라 지정)</span><span class="sxs-lookup"><span data-stu-id="ca0fe-195">On-premises SAM account name (depends on the domain controller configuration)</span></span>

### <a name="troubleshooting-sso-for-different-identities"></a><span data-ttu-id="ca0fe-196">다른 ID에 대한 SSO 문제 해결</span><span class="sxs-lookup"><span data-stu-id="ca0fe-196">Troubleshooting SSO for different identities</span></span>
<span data-ttu-id="ca0fe-197">SSO 프로세스에 오류가 있으면 [문제 해결](application-proxy-back-end-kerberos-constrained-delegation-how-to.md)에서 설명한 대로 커넥터 컴퓨터 이벤트 로그에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-197">If there is an error in the SSO process, it appears in the connector machine event log as explained in [Troubleshooting](application-proxy-back-end-kerberos-constrained-delegation-how-to.md).</span></span>
<span data-ttu-id="ca0fe-198">그러나 어떤 경우에는 백 엔드 응용 프로그램에 요청을 성공적으로 보내는 반면 해당 응용 프로그램에서 다양한 다른 HTTP 응답으로 회신합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-198">But, in some cases, the request is successfully sent to the backend application while this application replies in various other HTTP responses.</span></span> <span data-ttu-id="ca0fe-199">이러한 경우 문제를 해결하려면 응용 프로그램 프록시 세션 이벤트 로그에서 커넥터 컴퓨터에 있는 이벤트 번호 24029의 검사를 시작해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-199">Troubleshooting these cases should start by examining event number 24029 on the connector machine in the Application Proxy session event log.</span></span> <span data-ttu-id="ca0fe-200">위임에 사용된 사용자 ID는 이벤트 세부 정보의 "user" 필드에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-200">The user identity that was used for delegation appears in the “user” field within the event details.</span></span> <span data-ttu-id="ca0fe-201">세션 로그를 켜려면 이벤트 뷰어 보기 메뉴에서 **분석 및 디버그 로그 표시** 를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="ca0fe-201">To turn on session log, select **Show analytic and debug logs** in the event viewer view menu.</span></span>

## <a name="next-steps"></a><span data-ttu-id="ca0fe-202">다음 단계</span><span class="sxs-lookup"><span data-stu-id="ca0fe-202">Next steps</span></span>

* [<span data-ttu-id="ca0fe-203">Kerberos 제한된 위임을 사용하도록 응용 프로그램 프록시 응용 프로그램을 구성하는 방법</span><span class="sxs-lookup"><span data-stu-id="ca0fe-203">How to configure an Application Proxy application to use Kerberos Constrained Delegation</span></span>](application-proxy-back-end-kerberos-constrained-delegation-how-to.md)
* [<span data-ttu-id="ca0fe-204">응용 프로그램 프록시에서 발생한 문제 해결</span><span class="sxs-lookup"><span data-stu-id="ca0fe-204">Troubleshoot issues you're having with Application Proxy</span></span>](active-directory-application-proxy-troubleshoot.md)


<span data-ttu-id="ca0fe-205">최신 뉴스 및 업데이트는 [응용 프로그램 프록시 블로그](http://blogs.technet.com/b/applicationproxyblog/)</span><span class="sxs-lookup"><span data-stu-id="ca0fe-205">For the latest news and updates, check out the [Application Proxy blog](http://blogs.technet.com/b/applicationproxyblog/)</span></span>

