---
title: "Azure Site Recovery로 StorSimple 파일 공유 DR 자동화 | Microsoft Docs"
description: "Microsoft Azure StorSimple 저장소에서 호스팅되는 파일 공유에 대한 재해 복구 솔루션을 만들기 위한 단계와 모범 사례에 대해 설명합니다."
services: storsimple
documentationcenter: NA
author: vidarmsft
manager: syadav
editor: 
ms.assetid: 23049a2c-055e-4d0e-b8f5-af2a87ecf53f
ms.service: storsimple
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/09/2017
ms.author: vidarmsft
ms.openlocfilehash: b4d575587eec1bcf43c33c7faeb8360ec67b5214
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/03/2017
---
# <a name="automated-disaster-recovery-solution-using-azure-site-recovery-for-file-shares-hosted-on-storsimple"></a><span data-ttu-id="7c841-103">StorSimple에서 호스트되는 파일 공유에 Azure Site Recovery를 사용하는 자동화된 재해 복구 솔루션</span><span class="sxs-lookup"><span data-stu-id="7c841-103">Automated Disaster Recovery solution using Azure Site Recovery for file shares hosted on StorSimple</span></span>
## <a name="overview"></a><span data-ttu-id="7c841-104">개요</span><span class="sxs-lookup"><span data-stu-id="7c841-104">Overview</span></span>
<span data-ttu-id="7c841-105">Microsoft Azure StorSimple은 일반적으로 파일 공유와 연결된 구조화되지 않은 데이터의 복잡성을 해결하는 하이브리드 클라우드 저장소 솔루션입니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-105">Microsoft Azure StorSimple is a hybrid cloud storage solution that addresses the complexities of unstructured data commonly associated with file shares.</span></span> <span data-ttu-id="7c841-106">StorSimple은 온-프레미스 솔루션의 확장으로 클라우드 저장소를 사용하여 자동으로 온-프레미스 솔루션 및 클라우드 저장소에서 데이터를 계층화합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-106">StorSimple uses cloud storage as an extension of the on-premises solution and automatically tiers data across on-premises storage and cloud storage.</span></span> <span data-ttu-id="7c841-107">로컬 및 클라우드 스냅숏과 함께 통합 데이터 보호 기능은 제멋대로 늘어나는 저장소 인프라의 필요성을 없애줍니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-107">Integrated data protection, with local and cloud snapshots, eliminates the need for a sprawling storage infrastructure.</span></span>

<span data-ttu-id="7c841-108">[Azure Site Recovery](../site-recovery/site-recovery-overview.md) 는 가상 컴퓨터의 복제, 장애 조치(failover) 및 복구를 오케스트레이션하여 DR(재해 복구) 기능을 제공하는 Azure 기반 서비스입니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-108">[Azure Site Recovery](../site-recovery/site-recovery-overview.md) is an Azure-based service that provides disaster recovery (DR) capabilities by orchestrating replication, failover, and recovery of virtual machines.</span></span> <span data-ttu-id="7c841-109">Azure Site Recovery는 가상 컴퓨터 및 응용 프로그램을 일관되게 복제하고 보호하며 사설/공용 클라우드 또는 호스트된 클라우드로 원활하게 장애 조치(failover)하기 위한 다양한 복제 기술을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-109">Azure Site Recovery supports a number of replication technologies to consistently replicate, protect, and seamlessly fail over virtual machines and applications to private/public or hosted clouds.</span></span>

<span data-ttu-id="7c841-110">Azure Site Recovery, 가상 컴퓨터 복제 및 StorSimple 클라우드 스냅숏 기능을 사용하여 전체 파일 서버 환경을 보호할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-110">Using Azure Site Recovery, virtual machine replication, and StorSimple cloud snapshot capabilities, you can protect the complete file server environment.</span></span> <span data-ttu-id="7c841-111">중단이 발생할 경우 클릭 한 번으로 단 몇 분 만에 Azure에서 파일 공유를 온라인 상태로 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-111">In the event of a disruption, you can use a single click to bring your file shares online in Azure in just a few minutes.</span></span>

<span data-ttu-id="7c841-112">이 문서에서는 StorSimple 저장소에서 호스트되는 파일 공유를 위한 재해 복구 솔루션을 만들고 원클릭 복구 계획을 사용하여 계획된 장애 조치(failover), 계획되지 않은 장애 조치(failover) 및 테스트 장애 조치(failover)를 수행하는 방법을 자세히 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-112">This document explains in detail how you can create a disaster recovery solution for your file shares hosted on StorSimple storage, and perform planned, unplanned, and test failovers using a one-click recovery plan.</span></span> <span data-ttu-id="7c841-113">기본적으로 Azure Site Recovery 자격 증명 모음에서 복구 계획을 수정하여 재해 시나리오 중에 StorSimple 장애 조치(failover)를 사용하도록 설정하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-113">In essence, it shows how you can modify the Recovery Plan in your Azure Site Recovery vault to enable StorSimple failovers during disaster scenarios.</span></span> <span data-ttu-id="7c841-114">또한 지원되는 구성 및 필수 조건을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-114">In addition, it describes supported configurations and prerequisites.</span></span> <span data-ttu-id="7c841-115">이 문서에서는 사용자가 Azure Site Recovery 및 StorSimple 아키텍처의 기본 사항을 잘 알고 있다고 가정합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-115">This document assumes that you are familiar with the basics of Azure Site Recovery and StorSimple architectures.</span></span>

## <a name="supported-azure-site-recovery-deployment-options"></a><span data-ttu-id="7c841-116">지원되는 Azure Site Recovery 배포 옵션</span><span class="sxs-lookup"><span data-stu-id="7c841-116">Supported Azure Site Recovery deployment options</span></span>
<span data-ttu-id="7c841-117">고객은 파일 서버를 Hyper-V 또는 VMware에서 실행되는 물리적 서버 또는 VM(가상 컴퓨터)으로 배포한 다음 StorSimple 저장소의 잘라낸 볼륨에서 파일 공유를 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-117">Customers can deploy file servers as physical servers or virtual machines (VMs) running on Hyper-V or VMware, and then create file shares from volumes carved out of StorSimple storage.</span></span> <span data-ttu-id="7c841-118">Azure Site Recovery는 보조 사이트 또는 Azure에 대한 실제 배포와 가상 배포를 모두 보호할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-118">Azure Site Recovery can protect both physical and virtual deployments to either a secondary site or to Azure.</span></span> <span data-ttu-id="7c841-119">이 문서에서는 Hyper-V에서 호스트되는 파일 서버 VM에 대한 복구 사이트로 Azure를 사용하고 StorSimple 저장소의 파일 공유를 사용하는 DR 솔루션의 세부 정보를 다룹니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-119">This document covers details of a DR solution with Azure as the recovery site for a file server VM hosted on Hyper-V and with file shares on StorSimple storage.</span></span> <span data-ttu-id="7c841-120">파일 서버 VM이 VMware VM 또는 물리적 컴퓨터에 있는 다른 시나리오도 유사하게 구현할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-120">Other scenarios in which the file server VM is on a VMware VM or a physical machine can be implemented similarly.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="7c841-121">필수 조건</span><span class="sxs-lookup"><span data-stu-id="7c841-121">Prerequisites</span></span>
<span data-ttu-id="7c841-122">StorSimple 저장소에서 호스트되는 파일 공유에 Azure Site Recovery를 사용하는 원클릭 재해 복구 솔루션을 구현할 경우 다음과 같은 필수 조건이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-122">Implementing a one-click disaster recovery solution that uses Azure Site Recovery for file shares hosted on StorSimple storage has the following prerequisites:</span></span>

* <span data-ttu-id="7c841-123">Hyper-V 또는 VMware나 물리적 컴퓨터에서 호스트되는 온-프레미스 Windows Server 2012 R2 파일 서버 VM</span><span class="sxs-lookup"><span data-stu-id="7c841-123">On-premises Windows Server 2012 R2 File server VM hosted on Hyper-V or VMware or a physical machine</span></span>
* <span data-ttu-id="7c841-124">Azure StorSimple Manager에 등록된 온-프레미스 StorSimple 저장소 장치</span><span class="sxs-lookup"><span data-stu-id="7c841-124">StorSimple storage device on-premises registered with Azure StorSimple manager</span></span>
* <span data-ttu-id="7c841-125">Azure StorSimple Manager에서 만들어진 StorSimple Cloud Appliance(종료 상태로 유지될 수 있음)</span><span class="sxs-lookup"><span data-stu-id="7c841-125">StorSimple Cloud Appliance created in the Azure StorSimple manager (this can be kept in shut down state)</span></span>
* <span data-ttu-id="7c841-126">StorSimple 저장소 장치에 구성된 볼륨에서 호스트되는 파일 공유</span><span class="sxs-lookup"><span data-stu-id="7c841-126">File shares hosted on the volumes configured on the StorSimple storage device</span></span>
* <span data-ttu-id="7c841-127">[Azure Site Recovery 서비스 자격 증명 모음](../site-recovery/site-recovery-vmm-to-vmm.md) </span><span class="sxs-lookup"><span data-stu-id="7c841-127">[Azure Site Recovery services vault](../site-recovery/site-recovery-vmm-to-vmm.md) created in a Microsoft Azure subscription</span></span>

<span data-ttu-id="7c841-128">또한 Azure가 복구 사이트인 경우 VM에서 [Azure 가상 컴퓨터 준비 평가 도구](http://azure.microsoft.com/downloads/vm-readiness-assessment/) 를 실행하여 Azure VM 및 Azure Site Recovery 서비스와 호환되는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-128">In addition, if Azure is your recovery site, run the [Azure Virtual Machine Readiness Assessment tool](http://azure.microsoft.com/downloads/vm-readiness-assessment/) on VMs to ensure that they are compatible with Azure VMs and Azure Site Recovery services.</span></span>

<span data-ttu-id="7c841-129">대기 시간 문제(많은 비용을 유발할 수 있음)를 방지하려면 StorSimple Cloud Appliance, 자동화 계정 및 저장소 계정을 같은 지역에서 만들도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-129">To avoid latency issues (which might result in higher costs), make sure that you create your StorSimple Cloud Appliance, automation account, and storage account(s) in the same region.</span></span>

## <a name="enable-dr-for-storsimple-file-shares"></a><span data-ttu-id="7c841-130">StorSimple 파일 공유에 DR 사용</span><span class="sxs-lookup"><span data-stu-id="7c841-130">Enable DR for StorSimple file shares</span></span>
<span data-ttu-id="7c841-131">완전한 복제 및 복구를 위해서는 온-프레미스 환경의 각 구성 요소를 보호해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-131">Each component of the on-premises environment needs to be protected to enable complete replication and recovery.</span></span> <span data-ttu-id="7c841-132">이 섹션에서는 다음 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-132">This section describes how to:</span></span>

* <span data-ttu-id="7c841-133">Active Directory 및 DNS 복제 설정(선택 사항)</span><span class="sxs-lookup"><span data-stu-id="7c841-133">Set up Active Directory and DNS replication (optional)</span></span>
* <span data-ttu-id="7c841-134">Azure Site Recovery를 사용하여 파일 서버 VM의 보호 사용</span><span class="sxs-lookup"><span data-stu-id="7c841-134">Use Azure Site Recovery to enable protection of the file server VM</span></span>
* <span data-ttu-id="7c841-135">StorSimple 볼륨의 보호 사용</span><span class="sxs-lookup"><span data-stu-id="7c841-135">Enable protection of StorSimple volumes</span></span>
* <span data-ttu-id="7c841-136">네트워크 구성</span><span class="sxs-lookup"><span data-stu-id="7c841-136">Configure the network</span></span>

### <a name="set-up-active-directory-and-dns-replication-optional"></a><span data-ttu-id="7c841-137">Active Directory 및 DNS 복제 설정(선택 사항)</span><span class="sxs-lookup"><span data-stu-id="7c841-137">Set up Active Directory and DNS replication (optional)</span></span>
<span data-ttu-id="7c841-138">DR 사이트에서 사용할 수 있도록 Active Directory 및 DNS를 실행하는 컴퓨터를 보호하려는 경우 인증을 통한 장애 조치(failover) 후 파일 서버에 액세스할 수 있도록 이러한 컴퓨터를 명시적으로 보호해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-138">If you want to protect the machines running Active Directory and DNS so that they are available on the DR site, you need to explicitly protect them (so that the file servers are accessible after fail over with authentication).</span></span> <span data-ttu-id="7c841-139">고객의 온-프레미스 환경 복잡도에 따라 권장되는 두 가지 옵션이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-139">There are two recommended options based on the complexity of the customer’s on-premises environment.</span></span>

#### <a name="option-1"></a><span data-ttu-id="7c841-140">옵션 1</span><span class="sxs-lookup"><span data-stu-id="7c841-140">Option 1</span></span>
<span data-ttu-id="7c841-141">고객이 적은 수의 응용 프로그램과 전체 온-프레미스 사이트에 대한 단일 도메인 컨트롤러를 보유하고 있고 전체 사이트를 장애 조치(failover)하려는 경우 Azure Site Recovery 복제를 사용하여 도메인 컨트롤러 컴퓨터를 보조 사이트로 복제하는 것이 좋습니다(사이트 간 및 사이트-Azure에 적용 가능).</span><span class="sxs-lookup"><span data-stu-id="7c841-141">If the customer has a small number of applications, a single domain controller for the entire on-premises site, and will be failing over the entire site, then we recommend using Azure Site Recovery replication to replicate the domain controller machine to a secondary site (this is applicable for both site-to-site and site-to-Azure).</span></span>

#### <a name="option-2"></a><span data-ttu-id="7c841-142">옵션 2</span><span class="sxs-lookup"><span data-stu-id="7c841-142">Option 2</span></span>
<span data-ttu-id="7c841-143">고객이 많은 수의 응용 프로그램을 보유하고 있고 Active Directory 포리스트를 실행 중이며 한 번에 소수의 응용 프로그램을 장애 조치(failover)하려는 경우 DR 사이트(보조 사이트 또는 Azure)에 추가 도메인 컨트롤러를 설정하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-143">If the customer has a large number of applications, is running an Active Directory forest, and will be failing over a few applications at a time, then we recommend setting up an additional domain controller on the DR site (either a secondary site or in Azure).</span></span>

<span data-ttu-id="7c841-144">DR 사이트에서 도메인 컨트롤러를 사용할 수 있도록 설정하는 경우의 지침은 [Azure Site Recovery를 사용한 Active Directory 및 DNS용 자동화된 DR 솔루션](../site-recovery/site-recovery-active-directory.md) 을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7c841-144">Please refer to [Automated DR solution for Active Directory and DNS using Azure Site Recovery](../site-recovery/site-recovery-active-directory.md) for instructions when making a domain controller available on the DR site.</span></span> <span data-ttu-id="7c841-145">이 문서의 나머지 부분에서는 DR 사이트에서 도메인 컨트롤러를 사용할 수 있다고 가정합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-145">For the remainder of this document, we will assume a domain controller is available on the DR site.</span></span>

### <a name="use-azure-site-recovery-to-enable-protection-of-the-file-server-vm"></a><span data-ttu-id="7c841-146">Azure Site Recovery를 사용하여 파일 서버 VM의 보호 사용</span><span class="sxs-lookup"><span data-stu-id="7c841-146">Use Azure Site Recovery to enable protection of the file server VM</span></span>
<span data-ttu-id="7c841-147">이 단계를 수행하려면 온-프레미스 파일 서버 환경을 준비하고, Azure Site Recovery 자격 증명 모음을 만들고 준비하며, VM의 파일 보호를 사용하도록 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-147">This step requires that you prepare the on-premises file server environment, create and prepare an Azure Site Recovery vault, and enable file protection of the VM.</span></span>

#### <a name="to-prepare-the-on-premises-file-server-environment"></a><span data-ttu-id="7c841-148">온-프레미스 파일 서버 환경을 준비하려면</span><span class="sxs-lookup"><span data-stu-id="7c841-148">To prepare the on-premises file server environment</span></span>
1. <span data-ttu-id="7c841-149">**사용자 계정 컨트롤**을 **알리지 않음**으로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-149">Set the **User Account Control** to **Never Notify**.</span></span> <span data-ttu-id="7c841-150">Azure Site Recovery로 장애 조치(failover) 후 Azure 자동화 스크립트를 사용하여 iSCSI 대상을 연결할 수 있도록 이 작업이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-150">This is required so that you can use Azure automation scripts to connect the iSCSI targets after fail over by Azure Site Recovery.</span></span>

   1. <span data-ttu-id="7c841-151">Windows 키+Q를 누르고 **UAC**를 검색합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-151">Press the Windows key +Q and search for **UAC**.</span></span>
   2. <span data-ttu-id="7c841-152">**사용자 계정 컨트롤 설정 변경**을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-152">Select **Change User Account Control settings**.</span></span>
   3. <span data-ttu-id="7c841-153">막대를 **알리지 않음**을 향해 아래쪽으로 끕니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-153">Drag the bar to the bottom towards **Never Notify**.</span></span>
   4. <span data-ttu-id="7c841-154">**확인**을 클릭한 다음 메시지가 표시되면 **예**를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-154">Click **OK** and then select **Yes** when prompted.</span></span>

      ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image1.png)
2. <span data-ttu-id="7c841-155">각 파일 서버 VM에 VM 에이전트를 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-155">Install the VM Agent on each of the file server VMs.</span></span> <span data-ttu-id="7c841-156">장애 조치(failover)된 VM에 대해 Azure 자동화 스크립트를 실행할 수 있도록 이 작업이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-156">This is required so that you can run Azure automation scripts on the failed over VMs.</span></span>

   1. <span data-ttu-id="7c841-157">`C:\\Users\\<username>\\Downloads`에 [에이전트를 다운로드](http://aka.ms/vmagentwin)합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-157">[Download the agent](http://aka.ms/vmagentwin) to `C:\\Users\\<username>\\Downloads`.</span></span>
   2. <span data-ttu-id="7c841-158">관리자 모드(관리자 권한으로 실행)에서 Windows PowerShell을 열고 다음 명령을 입력하여 다운로드 위치로 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-158">Open Windows PowerShell in Administrator mode (Run as Administrator), and then enter the following command to navigate to the download location:</span></span>

      `cd C:\\Users\\<username>\\Downloads\\WindowsAzureVmAgent.2.6.1198.718.rd\_art\_stable.150415-1739.fre.msi`

      > [!NOTE]
      > <span data-ttu-id="7c841-159">파일 이름은 버전에 따라 변경될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-159">The file name may change depending on the version.</span></span>
      >
      >
3. <span data-ttu-id="7c841-160">**다음**을 누릅니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-160">Click **Next**.</span></span>
4. <span data-ttu-id="7c841-161">**Terms of Agreement(계약 조건)**에 동의하고 **다음**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-161">Accept the **Terms of Agreement** and then click **Next**.</span></span>
5. <span data-ttu-id="7c841-162">**Finish**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-162">Click **Finish**.</span></span>
6. <span data-ttu-id="7c841-163">StorSimple 저장소의 잘라낸 볼륨을 사용하여 파일 공유를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-163">Create file shares using volumes carved out of StorSimple storage.</span></span> <span data-ttu-id="7c841-164">자세한 내용은 [StorSimple Manager 서비스를 사용하여 볼륨 관리](storsimple-manage-volumes.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7c841-164">For more information, see [Use the StorSimple Manager service to manage volumes](storsimple-manage-volumes.md).</span></span>

   1. <span data-ttu-id="7c841-165">온-프레미스 VM에서 Windows 키+Q를 누르고 **iSCSI**를 검색합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-165">On your on-premises VMs, press the Windows key +Q and search for **iSCSI**.</span></span>
   2. <span data-ttu-id="7c841-166">**iSCSI 초기자**를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-166">Select **iSCSI initiator**.</span></span>
   3. <span data-ttu-id="7c841-167">**구성** 탭을 선택하고 초기자 이름을 복사합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-167">Select the **Configuration** tab and copy the initiator name.</span></span>
   4. <span data-ttu-id="7c841-168">[Azure 포털](https://portal.azure.com/)에 로그인합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-168">Log in to the [Azure portal](https://portal.azure.com/).</span></span>
   5. <span data-ttu-id="7c841-169">**StorSimple** 탭을 선택한 다음 물리적 장치를 포함하는 StorSimple Manager 서비스를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-169">Select the **StorSimple** tab and then select the StorSimple Manager Service that contains the physical device.</span></span>
   6. <span data-ttu-id="7c841-170">볼륨 컨테이너를 만든 다음 볼륨을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-170">Create volume container(s) and then create volume(s).</span></span> <span data-ttu-id="7c841-171">(이러한 볼륨은 파일 서버 VM의 파일 공유용입니다.)</span><span class="sxs-lookup"><span data-stu-id="7c841-171">(These volumes are for the file share(s) on the file server VMs).</span></span> <span data-ttu-id="7c841-172">초기자 이름을 복사하고 볼륨을 만들 때 액세스 제어 레코드에 적절한 이름을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-172">Copy the initiator name and give an appropriate name for the Access Control Records when you create the volumes.</span></span>
   7. <span data-ttu-id="7c841-173">**구성** 탭을 선택하고 장치의 IP 주소를 적어둡니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-173">Select the **Configure** tab and note down the IP address of the device.</span></span>
   8. <span data-ttu-id="7c841-174">온-프레미스 VM에서 다시 **iSCSI 초기자** 로 이동하여 빠른 연결 섹션에 IP를 입력합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-174">On your on-premises VMs, go to the **iSCSI initiator** again and enter the IP in the Quick Connect section.</span></span> <span data-ttu-id="7c841-175">**빠른 연결** 을 클릭합니다(이제 장치가 연결됨).</span><span class="sxs-lookup"><span data-stu-id="7c841-175">Click **Quick Connect** (the device should now be connected).</span></span>
   9. <span data-ttu-id="7c841-176">Azure 포털을 열고 **볼륨 및 장치** 탭을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-176">Open the Azure portal and select the **Volumes and Devices** tab.</span></span> <span data-ttu-id="7c841-177">**자동 구성**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-177">Click **Auto Configure**.</span></span> <span data-ttu-id="7c841-178">방금 만든 볼륨이 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-178">The volume that you just created should appear.</span></span>
   10. <span data-ttu-id="7c841-179">포털에서 **장치** 탭을 선택한 다음 **Create a New Virtual Device(새 가상 장치 만들기)**를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-179">In the portal, select the **Devices** tab and then select **Create a New Virtual Device.**</span></span> <span data-ttu-id="7c841-180">를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-180">(This virtual device will be used if a failover occurs).</span></span> <span data-ttu-id="7c841-181">(이 가상 장치는 장애 조치(failover)가 발생하는 경우 사용됩니다.) 이 새 가상 장치는 추가 비용을 방지하기 위해 오프라인 상태로 유지될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-181">This new virtual device can be kept in an offline state to avoid extra costs.</span></span> <span data-ttu-id="7c841-182">가상 장치를 오프라인 상태로 전환하려면 포털에서 **가상 컴퓨터** 섹션으로 이동하여 해당 가상 장치를 종료합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-182">To take the virtual device offline, go to the **Virtual Machines** section on the Portal and shut it down.</span></span>
   11. <span data-ttu-id="7c841-183">온-프레미스 VM으로 돌아가 디스크 관리를 엽니다(Windows 키+X를 누르고 **디스크 관리**를 선택).</span><span class="sxs-lookup"><span data-stu-id="7c841-183">Go back to the on-premises VMs and open Disk Management (press the Windows key + X and select **Disk Management**).</span></span>
   12. <span data-ttu-id="7c841-184">만든 볼륨 수에 따라 몇 가지 추가 디스크가 표시될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-184">You will notice some extra disks (depending on the number of volumes you have created).</span></span> <span data-ttu-id="7c841-185">첫 번째 디스크를 마우스 오른쪽 단추로 클릭하고 **디스크 초기화**를 선택한 다음 **확인**을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-185">Right-click the first one, select **Initialize Disk**, and select **OK**.</span></span> <span data-ttu-id="7c841-186">**할당되지 않음** 섹션에서 마우스 오른쪽 단추를 클릭하고 **새 단순 볼륨**을 선택한 다음 드라이브 문자를 할당하고 마법사를 마칩니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-186">Right-click the **Unallocated** section, select **New Simple Volume**, assign it a drive letter, and finish the wizard.</span></span>
   13. <span data-ttu-id="7c841-187">모든 디스크에 대해 l단계를 반복합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-187">Repeat step l for all the disks.</span></span> <span data-ttu-id="7c841-188">이제 Windows 탐색기에서 **내 PC** 의 모든 디스크를 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-188">You can now see all the disks on **This PC** in the Windows Explorer.</span></span>
   14. <span data-ttu-id="7c841-189">파일 및 저장소 서비스 역할을 사용하여 이러한 볼륨에서 파일 공유를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-189">Use the File and Storage Services role to create file shares on these volumes.</span></span>

#### <a name="to-create-and-prepare-an-azure-site-recovery-vault"></a><span data-ttu-id="7c841-190">Azure Site Recovery 자격 증명 모음을 만들고 준비하려면</span><span class="sxs-lookup"><span data-stu-id="7c841-190">To create and prepare an Azure Site Recovery vault</span></span>
<span data-ttu-id="7c841-191">파일 서버 VM을 보호하기 전에 [Azure Site Recovery 설명서](../site-recovery/site-recovery-hyper-v-site-to-azure.md) 를 참조하여 Azure Site Recovery를 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-191">Refer to the [Azure Site Recovery documentation](../site-recovery/site-recovery-hyper-v-site-to-azure.md) to get started with Azure Site Recovery before protecting the file server VM.</span></span>

#### <a name="to-enable-protection"></a><span data-ttu-id="7c841-192">보호를 사용하도록 설정하려면</span><span class="sxs-lookup"><span data-stu-id="7c841-192">To enable protection</span></span>
1. <span data-ttu-id="7c841-193">Azure Site Recovery를 통해 보호하려는 온-프레미스 VM에서 iSCSI 대상의 연결을 끊습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-193">Disconnect the iSCSI target(s) from the on-premises VMs that you want to protect through Azure Site Recovery:</span></span>

   1. <span data-ttu-id="7c841-194">Windows 키+Q를 누르고 **iSCSI**를 검색합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-194">Press Windows key + Q and search for **iSCSI**.</span></span>
   2. <span data-ttu-id="7c841-195">**iSCSI 초기자 설정**을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-195">Select **Set up iSCSI initiator**.</span></span>
   3. <span data-ttu-id="7c841-196">이전에 연결한 StorSimple 장치의 연결을 끊습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-196">Disconnect the StorSimple device that you connected previously.</span></span> <span data-ttu-id="7c841-197">또는 보호를 사용하도록 설정할 때 몇 분간 파일 서버를 끌 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-197">Alternatively, you can switch off the file server for a few minutes when enabling protection.</span></span>

   > [!NOTE]
   > <span data-ttu-id="7c841-198">이렇게 하면 파일 공유를 일시적으로 사용할 수 없게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-198">This will cause the file shares to be temporarily unavailable.</span></span>
   >
   >
2. <span data-ttu-id="7c841-199">Azure Site Recovery 포털에서 파일 서버 VM의 [가상 컴퓨터 보호를 사용](../site-recovery/site-recovery-hyper-v-site-to-azure.md)하도록 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-199">[Enable virtual machine protection](../site-recovery/site-recovery-hyper-v-site-to-azure.md) of the file server VM from the Azure Site Recovery portal.</span></span>
3. <span data-ttu-id="7c841-200">초기 동기화가 시작되면 대상을 다시 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-200">When the initial synchronization begins, you can reconnect the target again.</span></span> <span data-ttu-id="7c841-201">iSCSI 초기자로 이동하여 StorSimple 장치를 선택한 다음 **연결**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-201">Go to the iSCSI initiator, select the StorSimple device, and click **Connect**.</span></span>
4. <span data-ttu-id="7c841-202">동기화가 완료되고 VM 상태가 **보호됨**이면 VM을 선택하고 **구성** 탭을 선택한 다음 VM 네트워크(장애 조치(failover)된 VM이 속할 네트워크)를 적절하게 업데이트합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-202">When the synchronization is complete and the status of the VM is **Protected**, select the VM, select the **Configure** tab, and update the network of the VM accordingly (this is the network that the failed over VM(s) will be a part of).</span></span> <span data-ttu-id="7c841-203">네트워크가 표시되지 않으면 동기화가 아직 진행되고 있는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-203">If the network doesn’t show up, it means that the sync is still going on.</span></span>

### <a name="enable-protection-of-storsimple-volumes"></a><span data-ttu-id="7c841-204">StorSimple 볼륨의 보호 사용</span><span class="sxs-lookup"><span data-stu-id="7c841-204">Enable protection of StorSimple volumes</span></span>
<span data-ttu-id="7c841-205">StorSimple 볼륨에 대해 **이 볼륨에 대한 기본 백업 사용** 옵션을 선택하지 않은 경우 StorSimple Manager 서비스의 **백업 정책**으로 이동하여 모든 볼륨에 적합한 백업 정책을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-205">If you have not selected the **Enable a default backup for this volume** option for the StorSimple volumes, go to **Backup Policies** in the StorSimple Manager service, and create a suitable backup policy for all the volumes.</span></span> <span data-ttu-id="7c841-206">응용 프로그램에 대해 확인할 RPO(복구 지점 목표)의 백업 빈도를 설정하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-206">We recommend that you set the frequency of backups to the recovery point objective (RPO) that you would like to see for the application.</span></span>

### <a name="configure-the-network"></a><span data-ttu-id="7c841-207">네트워크 구성</span><span class="sxs-lookup"><span data-stu-id="7c841-207">Configure the network</span></span>
<span data-ttu-id="7c841-208">파일 서버 VM의 경우 VM 네트워크가 장애 조치(failover) 후 올바른 DR 네트워크에 연결되도록 Azure Site Recovery에서 네트워크 설정을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-208">For the file server VM, configure network settings in Azure Site Recovery so that the VM networks are attached to the correct DR network after failover.</span></span>

<span data-ttu-id="7c841-209">다음 그림과 같이 **복제 항목** VM을 선택하여 네트워크 설정을 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-209">You can select the VM in the **Replicated items** tab to configure the network settings, as shown in the following illustration.</span></span>

![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image2.png)

## <a name="create-a-recovery-plan"></a><span data-ttu-id="7c841-210">복구 계획 만들기</span><span class="sxs-lookup"><span data-stu-id="7c841-210">Create a recovery plan</span></span>
<span data-ttu-id="7c841-211">ASR에서 복구 계획을 만들어 파일 공유의 장애 조치(failover) 프로세스를 자동화할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-211">You can create a recovery plan in ASR to automate the failover process of the file shares.</span></span> <span data-ttu-id="7c841-212">중단이 발생할 경우 클릭 한 번으로 몇 분 만에 파일 공유를 온라인 상태로 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-212">If a disruption occurs, you can bring the file shares up in a few minutes with just a single click.</span></span> <span data-ttu-id="7c841-213">이 자동화를 사용하도록 설정하려면 Azure 자동화 계정이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-213">To enable this automation, you will need an Azure automation account.</span></span>

#### <a name="to-create-an-automation-account"></a><span data-ttu-id="7c841-214">Automation 계정을 만들려면</span><span class="sxs-lookup"><span data-stu-id="7c841-214">To create an Automation account</span></span>
1. <span data-ttu-id="7c841-215">Azure 포털의 &gt; **자동화** 섹션으로 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-215">Go to the Azure portal &gt; **Automation** section.</span></span>
2. <span data-ttu-id="7c841-216">**+ 추가** 단추를 클릭하면 아래에 블레이드가 열립니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-216">Click **+ Add** button, opens below blade.</span></span>

   ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image11.png)

   * <span data-ttu-id="7c841-217">이름 - 새 Automation 계정을 입력합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-217">Name - Enter a new automation account</span></span>
   * <span data-ttu-id="7c841-218">구독 - 구독을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-218">Subscription - Choose subscription</span></span>
   * <span data-ttu-id="7c841-219">리소스 그룹 - 새 리소스 그룹을 만들거나 기존 리소스 그룹을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-219">Resource group - Create new/choose existing resource group</span></span>
   * <span data-ttu-id="7c841-220">위치 - 위치를 선택하고 이 위치를 StorSimple Cloud Appliance 및 저장소 계정을 만든 것과 같은 지역/하위 지역에 유지합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-220">Location - Choose location, keep it in the same geo/region in which the StorSimple Cloud Appliance and Storage Accounts were created.</span></span>
   * <span data-ttu-id="7c841-221">Azure 실행 계정 만들기 - **예** 옵션을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-221">Create Azure Run As account - Select **Yes** option.</span></span>

3. <span data-ttu-id="7c841-222">자동화 계정에서 **Runbooks** &gt; **갤러리 찾아보기**를 클릭하여 필요한 모든 Runbook을 자동화 계정으로 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-222">Go to the Automation account, click **Runbooks** &gt; **Browse Gallery** to import all the required runbooks into the automation account.</span></span>
4. <span data-ttu-id="7c841-223">갤러리의 **재해 복구** 태그를 찾아서 다음 Runbook을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-223">Add the following runbooks by finding **Disaster Recovery** tag in the gallery:</span></span>

   * <span data-ttu-id="7c841-224">TFO(테스트 장애 조치(failover)) 후 StorSimple 볼륨 정리</span><span class="sxs-lookup"><span data-stu-id="7c841-224">Clean up of StorSimple volumes after Test Failover (TFO)</span></span>
   * <span data-ttu-id="7c841-225">StorSimple 볼륨 컨테이너 장애 조치(failover)</span><span class="sxs-lookup"><span data-stu-id="7c841-225">Failover StorSimple volume containers</span></span>
   * <span data-ttu-id="7c841-226">장애 조치(failover) 후 StorSimple 장치에서 볼륨 탑재</span><span class="sxs-lookup"><span data-stu-id="7c841-226">Mount volumes on StorSimple device after failover</span></span>
   * <span data-ttu-id="7c841-227">Azure VM에서 사용자 지정 스크립트 확장 제거</span><span class="sxs-lookup"><span data-stu-id="7c841-227">Uninstall custom script extension in Azure VM</span></span>
   * <span data-ttu-id="7c841-228">StorSimple 가상 어플라이언스 시작</span><span class="sxs-lookup"><span data-stu-id="7c841-228">Start StorSimple Virtual Appliance</span></span>

     ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image3.png)

5. <span data-ttu-id="7c841-229">자동화 계정에서 Runbook을 선택하여 모든 스크립트를 게시하고 **편집** &gt; **게시**를 차례로 클릭한 다음 확인 메시지에 **예**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-229">Publish all the scripts by selecting the runbook in the automation account and click **Edit** &gt; **Publish** and then **Yes** to the verification message.</span></span> <span data-ttu-id="7c841-230">이 단계 후에 **Runbook** 탭은 다음과 같이 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-230">After this step, the **Runbooks** tab will appear as follows:</span></span>

    ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image4.png)

6. <span data-ttu-id="7c841-231">자동화 계정에서 **자산** 탭 &gt;을 선택한 다음 **변수** &gt; **변수 추가**를 클릭하고 다음 변수를 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-231">In the automation account, select the **Assets** tab &gt; click **Variables** &gt; **Add a variable** and add the following variables.</span></span> <span data-ttu-id="7c841-232">이러한 자산을 암호화하도록 선택할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-232">You can choose to encrypt these assets.</span></span> <span data-ttu-id="7c841-233">이러한 변수는 복구 계획과 관련됩니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-233">These variables are recovery plan–specific.</span></span> <span data-ttu-id="7c841-234">복구 계획(다음 단계에서 만듦) 이름이 TestPlan이면 변수는 TestPlan-StorSimRegKey, TestPlan-AzureSubscriptionName 등과 같아야 합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-234">If your recovery plan (which you will create in the next step) name is TestPlan, then your variables should be TestPlan-StorSimRegKey, TestPlan-AzureSubscriptionName, and so on.</span></span>

   * <span data-ttu-id="7c841-235">*RecoveryPlanName***-StorSimRegKey**: StorSimple Manager 서비스의 등록 키입니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-235">*RecoveryPlanName***-StorSimRegKey**: The registration key for the StorSimple Manager service.</span></span>
   * <span data-ttu-id="7c841-236">*RecoveryPlanName***-AzureSubscriptionName**: Azure 구독의 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-236">*RecoveryPlanName***-AzureSubscriptionName**: The name of the Azure subscription.</span></span>
   * <span data-ttu-id="7c841-237">*RecoveryPlanName***-ResourceName**: StorSimple 장치를 포함하는 StorSimple 리소스의 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-237">*RecoveryPlanName***-ResourceName**: The name of the StorSimple resource that has the StorSimple device.</span></span>
   * <span data-ttu-id="7c841-238">*RecoveryPlanName***-DeviceName**: 장애 조치(failover)해야 할 장치입니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-238">*RecoveryPlanName***-DeviceName**: The device that has to be failed over.</span></span>
   * <span data-ttu-id="7c841-239">*RecoveryPlanName***-VolumeContainers**: 장애 조치(failover)해야 할 장치에 있는 볼륨 컨테이너의 쉼표로 구분된 문자열입니다(예: volcon1,volcon2, volcon3).</span><span class="sxs-lookup"><span data-stu-id="7c841-239">*RecoveryPlanName***-VolumeContainers**: A comma-separated string of volume containers present on the device that need to be failed over; for example, volcon1,volcon2, volcon3.</span></span>
   * <span data-ttu-id="7c841-240">*RecoveryPlanName***-TargetDeviceName**: 컨테이너를 장애 조치(failover)할 StorSimple Cloud Appliance입니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-240">*RecoveryPlanName***-TargetDeviceName**: The StorSimple Cloud Appliance on which the containers are to be failed over.</span></span>
   * <span data-ttu-id="7c841-241">*RecoveryPlanName***-TargetDeviceDnsName**: 대상 장치의 서비스 이름입니다(**가상 컴퓨터** 섹션에서 찾을 수 있으며, 서비스 이름은 DNS 이름과 같음).</span><span class="sxs-lookup"><span data-stu-id="7c841-241">*RecoveryPlanName***-TargetDeviceDnsName**: The service name of the target device (this can be found in the **Virtual Machine** section: the service name is the same as the DNS name).</span></span>
   * <span data-ttu-id="7c841-242">*RecoveryPlanName***-StorageAccountName**: 스크립트(장애 조치(failover)된 VM에서 실행해야 함)를 저장할 저장소 계정 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-242">*RecoveryPlanName***-StorageAccountName**: The storage account name in which the script (which has to run on the failed over VM) will be stored.</span></span> <span data-ttu-id="7c841-243">이 계정 이름은 스크립트를 임시로 저장할 공간이 있는 모든 저장소 계정일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-243">This can be any storage account that has some space to store the script temporarily.</span></span>
   * <span data-ttu-id="7c841-244">*RecoveryPlanName***-StorageAccountKey**: 위 저장소 계정의 액세스 키입니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-244">*RecoveryPlanName***-StorageAccountKey**: The access key for the above storage account.</span></span>
   * <span data-ttu-id="7c841-245">*RecoveryPlanName***-ScriptContainer**: 클라우드에서 스크립트를 저장할 컨테이너의 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-245">*RecoveryPlanName***-ScriptContainer**: The name of the container in which the script will be stored in the cloud.</span></span> <span data-ttu-id="7c841-246">컨테이너가 없으면 컨테이너가 만들어집니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-246">If the container doesn’t exist, it will be created.</span></span>
   * <span data-ttu-id="7c841-247">*RecoveryPlanName***-VMGUIDS**: VM을 보호할 때 Azure Site Recovery에서는 모든 VM에 장애 조치(failover)된 VM의 세부 정보를 제공하는 고유 ID를 할당합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-247">*RecoveryPlanName***-VMGUIDS**: Upon protecting a VM, Azure Site Recovery assigns every VM a unique ID that gives the details of the failed over VM.</span></span> <span data-ttu-id="7c841-248">VMGUID를 가져오려면 **Recovery Services** 탭을 선택하고 **보호된 항목** &gt; **보호 그룹** &gt; **컴퓨터** &gt; **속성**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-248">To obtain the VMGUID, select the **Recovery Services** tab and click **Protected Item** &gt; **Protection Groups** &gt; **Machines** &gt; **Properties**.</span></span> <span data-ttu-id="7c841-249">여러 VM이 있는 경우 GUID를 쉼표로 구분된 문자열로 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-249">If you have multiple VMs, then add the GUIDs as a comma-separated string.</span></span>
   * <span data-ttu-id="7c841-250">*RecoveryPlanName***-AutomationAccountName**: Runbook 및 자산을 추가한 자동화 계정의 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-250">*RecoveryPlanName***-AutomationAccountName** – The name of the automation account in which you have added the runbooks and the assets.</span></span>

  <span data-ttu-id="7c841-251">예를 들어 복구 계획 이름이 fileServerpredayRP인 경우 모든 자산을 추가한 후에 **자격 증명** & **변수** 탭이 다음과 같이 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-251">For example, if the name of the recovery plan is fileServerpredayRP, then your **Credentials** & **Variables** tabs should appear as follows after you add all the assets.</span></span>

   ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image5.png)

7. <span data-ttu-id="7c841-252">**복구 서비스** 섹션으로 이동하여 앞서 만든 Azure Site Recovery 자격 증명 모음을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-252">Go to the **Recovery Services** section and select the Azure Site Recovery vault that you created earlier.</span></span>
8. <span data-ttu-id="7c841-253">**관리** 그룹에서 **복구 계획 (사이트 복구)** 옵션을 선택하여 다음과 같이 새로운 복구 계획을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-253">Select the **Recovery Plans (Site Recovery)** option from **Manage** group and create a new recovery plan as follows:</span></span>

   <span data-ttu-id="7c841-254">a.</span><span class="sxs-lookup"><span data-stu-id="7c841-254">a.</span></span>  <span data-ttu-id="7c841-255">**+ 복구 계획** 단추를 클릭하여 아래의 블레이드를 엽니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-255">Click **+ Recover plan** button, opens below blade.</span></span>

      ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image6.png)

   <span data-ttu-id="7c841-256">b.</span><span class="sxs-lookup"><span data-stu-id="7c841-256">b.</span></span>  <span data-ttu-id="7c841-257">복구 계획 이름을 입력하고 원본, 대상 및 배포 모델 값을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-257">Enter a recovery plan name, choose Source, Target & Deployment model values.</span></span>

   <span data-ttu-id="7c841-258">c.</span><span class="sxs-lookup"><span data-stu-id="7c841-258">c.</span></span>  <span data-ttu-id="7c841-259">보호 그룹에서 복구 계획에 포함할 VM을 선택하고 **확인** 단추를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-259">Select the VMs from the protection group that you want to include in the recovery plan and click **OK** button.</span></span>

   <span data-ttu-id="7c841-260">d.</span><span class="sxs-lookup"><span data-stu-id="7c841-260">d.</span></span>  <span data-ttu-id="7c841-261">이전에 만든 복구 계획을 선택하고 **사용자 지정** 단추를 클릭하여 복구 계획 사용자 지정 보기를 엽니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-261">Select Recovery plan that you created earlier, click **Customize** button to open the Recovery plan customization view.</span></span>

   <span data-ttu-id="7c841-262">e.</span><span class="sxs-lookup"><span data-stu-id="7c841-262">e.</span></span>  <span data-ttu-id="7c841-263">마우스 오른쪽 단추로 **모든 그룹 종료**를 클릭하고 **사전 작업 추가**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-263">Right click on **All groups shutdown** and click **Add pre action**.</span></span>

   <span data-ttu-id="7c841-264">f.</span><span class="sxs-lookup"><span data-stu-id="7c841-264">f.</span></span>  <span data-ttu-id="7c841-265">삽입 작업 블레이드를 열고 이름을 입력한 후 옵션을 실행할 곳에서 **기본 측** 옵션을 선택하고 자동화 계정(Runbook을 추가한)을 선택한 다음 **Failover-StorSimple-Volume-Containers** Runbook을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-265">Opens Insert action blade, enter a name, select **Primary side** option in Where to run option, select Automation account (in which you added the runbooks) and then select the **Failover-StorSimple-Volume-Containers** runbook.</span></span>

   <span data-ttu-id="7c841-266">g.</span><span class="sxs-lookup"><span data-stu-id="7c841-266">g.</span></span>  <span data-ttu-id="7c841-267">마우스 오른쪽 단추로 **그룹 1: 시작**을 클릭하고 **보호된 항목 추가** 옵션을 클릭한 다음 복구 계획에서 보호할 VM을 선택하고 **확인** 단추를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-267">Right click on **Group 1: Start** and click **Add protected items** option then select the VMs that are to be protected in the recovery plan and Click **Ok** button.</span></span> <span data-ttu-id="7c841-268">이미 선택된 VM인 경우 선택 사항입니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-268">Optional, if it's already selected VMs.</span></span>

   <span data-ttu-id="7c841-269">h.</span><span class="sxs-lookup"><span data-stu-id="7c841-269">h.</span></span>  <span data-ttu-id="7c841-270">마우스 오른쪽 단추로 **그룹 1: 시작**을 클릭하고 **사후 작업** 옵션을 클릭한 후 다음의 모든 스크립트를 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-270">Right click on **Group 1: Start** and click **Post action** option then add all the following scripts:</span></span>

   * <span data-ttu-id="7c841-271">Start-StorSimple-Virtual-Appliance Runbook</span><span class="sxs-lookup"><span data-stu-id="7c841-271">Start-StorSimple-Virtual-Appliance runbook</span></span>
   * <span data-ttu-id="7c841-272">Fail over-StorSimple-volume-containers Runbook</span><span class="sxs-lookup"><span data-stu-id="7c841-272">Fail over-StorSimple-volume-containers runbook</span></span>
   * <span data-ttu-id="7c841-273">Mount-volumes-after-failover Runbook</span><span class="sxs-lookup"><span data-stu-id="7c841-273">Mount-volumes-after-failover runbook</span></span>
   * <span data-ttu-id="7c841-274">Uninstall-custom-script-extension Runbook</span><span class="sxs-lookup"><span data-stu-id="7c841-274">Uninstall-custom-script-extension runbook</span></span>

   <span data-ttu-id="7c841-275">i.</span><span class="sxs-lookup"><span data-stu-id="7c841-275">i.</span></span>  <span data-ttu-id="7c841-276">같은 **그룹 1: 사후 단계** 섹션에서 위의 4개 스크립트 뒤에 수동 작업을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-276">Add a manual action after the above 4 scripts in the same **Group 1: Post-steps** section.</span></span> <span data-ttu-id="7c841-277">이 작업은 모든 항목이 제대로 작동하는지 확인할 수 있는 지점입니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-277">This action is the point at which you can verify that everything is working correctly.</span></span> <span data-ttu-id="7c841-278">이 작업은 테스트 장애 조치(failover)의 일부로만 추가해야 합니다(따라서 **테스트 장애 조치(failover)** 확인란만 선택).</span><span class="sxs-lookup"><span data-stu-id="7c841-278">This action needs to be added only as a part of Test failover (so only select the **Test Failover** checkbox).</span></span>

   <span data-ttu-id="7c841-279">j.</span><span class="sxs-lookup"><span data-stu-id="7c841-279">j.</span></span>  <span data-ttu-id="7c841-280">수동 작업 뒤에 다른 Runbook에 사용한 것과 동일한 절차를 사용하여 **정리** 스크립트를 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-280">After the manual action, add the **Cleanup** script using the same procedure that you used for the other runbooks.</span></span> <span data-ttu-id="7c841-281">복구 계획을 **저장**합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-281">**Save** the recovery plan.</span></span>

    > [!NOTE]
    > <span data-ttu-id="7c841-282">테스트 장애 조치(failover)를 실행할 때, 대상 장치에 복제된 StorSimple 볼륨이 수동 작업이 완료된 후 정리의 일부로 삭제되므로 수동 작업 단계에서 모든 항목을 확인해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-282">When running a test failover, you should verify everything at the manual action step because the StorSimple volumes that had been cloned on the target device will be deleted as a part of the cleanup after the manual action is completed.</span></span>
    >

    ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image7.png)

## <a name="perform-a-test-failover"></a><span data-ttu-id="7c841-283">테스트 장애 조치(failover) 수행</span><span class="sxs-lookup"><span data-stu-id="7c841-283">Perform a test failover</span></span>
<span data-ttu-id="7c841-284">테스트 장애 조치(failover) 중 Active Directory 관련 고려 사항은 [Active Directory DR 솔루션](../site-recovery/site-recovery-active-directory.md) 도우미 가이드를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7c841-284">Refer to the [Active Directory DR Solution](../site-recovery/site-recovery-active-directory.md) companion guide for considerations specific to Active Directory during the test failover.</span></span> <span data-ttu-id="7c841-285">테스트 장애 조치(failover) 발생 시 온-프레미스 설치는 전혀 방해받지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-285">The on-premises setup is not disturbed at all when the test failover occurs.</span></span> <span data-ttu-id="7c841-286">온-프레미스 VM에 연결된 StorSimple 볼륨은 Azure에서 StorSimple Cloud Appliance에 복제됩니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-286">The StorSimple volumes that were attached to the on-premises VM are cloned to the StorSimple Cloud Appliance on Azure.</span></span> <span data-ttu-id="7c841-287">테스트 목적의 VM은 Azure에서 온라인 상태가 되며 복제된 볼륨은 VM에 연결됩니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-287">A VM for test purposes is brought up in Azure and the cloned volumes are attached to the VM.</span></span>

#### <a name="to-perform-the-test-failover"></a><span data-ttu-id="7c841-288">테스트 장애 조치(failover)를 수행하려면</span><span class="sxs-lookup"><span data-stu-id="7c841-288">To perform the test failover</span></span>
1. <span data-ttu-id="7c841-289">Azure 포털에서 사이트 복구 자격 증명 모음을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-289">In the Azure portal, select your site recovery vault.</span></span>
2. <span data-ttu-id="7c841-290">파일 서버 VM에 대해 만든 복구 계획을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-290">Click the recovery plan created for the file server VM.</span></span>
3. <span data-ttu-id="7c841-291">**테스트 장애 조치(failover)**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-291">Click **Test Failover**.</span></span>
4. <span data-ttu-id="7c841-292">장애 조치(Failover)가 발생한 후에 Azure VM이 연결될 Azure 가상 네트워크를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-292">Select the Azure virtual network to which Azure VMs will be connected after failover occurs.</span></span>

   ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image8.png)
5. <span data-ttu-id="7c841-293">**확인**을 클릭하여 장애 조치(Failover)를 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-293">Click **OK** to begin the failover.</span></span> <span data-ttu-id="7c841-294">VM을 클릭하여 속성을 열거나 자격 증명 모음 이름 &gt; **작업** &gt; **Site Recovery 작업**에서 **테스트 장애 조치(failover)**에서 진행률을 추적할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-294">You can track progress by clicking on the VM to open its properties, or on the **Test failover job** in vault name &gt; **Jobs** &gt; **Site Recovery jobs**.</span></span>
6. <span data-ttu-id="7c841-295">또한 장애 조치(failover)가 완료된 후 Azure 포털 &gt; **Virtual Machines**에 Azure 컴퓨터 복제본이 나타나는 것을 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-295">After the failover completes, you should also be able to see the replica Azure machine appear in the Azure portal &gt; **Virtual Machines**.</span></span> <span data-ttu-id="7c841-296">유효성 검사를 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-296">You can perform your validations.</span></span>
7. <span data-ttu-id="7c841-297">유효성 검사가 완료된 후 **유효성 검사 완료**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-297">After the validations are done, click **Validations Complete**.</span></span> <span data-ttu-id="7c841-298">이렇게 하여 StorSimple 볼륨을 정리하고 StorSimple Cloud Appliance를 종료합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-298">This will cleanup the StorSimple Volumes and shutdown the StorSimple Cloud Appliance.</span></span>
8. <span data-ttu-id="7c841-299">작업이 완료되면 복구 계획에서 **테스트 장애 조치 정리**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-299">Once you're done, click **Cleanup test failover** on the recovery plan.</span></span> <span data-ttu-id="7c841-300">참고에서 테스트 장애 조치와 연관된 모든 관측 내용을 기록하고 저장합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-300">In Notes record and save any observations associated with the test failover.</span></span> <span data-ttu-id="7c841-301">그러면 테스트 장애 조치 중에 생성된 가상 컴퓨터가 삭제됩니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-301">This will delete the virtual machine that were created during test failover.</span></span>

## <a name="perform-a-planned-failover"></a><span data-ttu-id="7c841-302">계획된 장애 조치(failover) 수행</span><span class="sxs-lookup"><span data-stu-id="7c841-302">Perform a planned failover</span></span>
   <span data-ttu-id="7c841-303">계획된 장애 조치(failover) 중에 온-프레미스 파일 서버 VM은 정상적으로 종료되고 StorSimple 장치에서 볼륨의 클라우드 백업 스냅숏이 만들어집니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-303">During a planned failover, the on-premises file server VM is shut down gracefully and a cloud backup snapshot of the volumes on StorSimple device is taken.</span></span> <span data-ttu-id="7c841-304">StorSimple 볼륨이 가상 장치에 장애 조치(failover)되고, 복제본 VM이 Azure에서 온라인 상태가 되며, 볼륨이 VM에 연결됩니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-304">The StorSimple volumes are failed over to the virtual device, a replica VM is brought up on Azure, and the volumes are attached to the VM.</span></span>

#### <a name="to-perform-a-planned-failover"></a><span data-ttu-id="7c841-305">계획된 장애 조치(failover)를 수행하려면</span><span class="sxs-lookup"><span data-stu-id="7c841-305">To perform a planned failover</span></span>
1. <span data-ttu-id="7c841-306">Azure 포털에서 파일 서버 VM에 대해 만들어진 **복구 서비스** 자격 증명 모음 &gt; **복구 계획(사이트 복구)** &gt; **recoveryplan_name**을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-306">In the Azure portal, select **Recovery services** vault &gt; **Recovery plans (Site recovery)** &gt; **recoveryplan_name** created for the file server VM.</span></span>
2. <span data-ttu-id="7c841-307">복구 계획 블레이드에서 **추가 정보** &gt;  **계획된 장애 조치**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-307">On the Recovery plan blade, Click **More** &gt;  **Planned failover**.</span></span>

   ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image9.png)
3. <span data-ttu-id="7c841-308">**계획된 장애 조치 확인** 블레이드에서 소스 및 대상 위치를 선택하고 대상 네트워크를 선택한 다음 ✓ 아이콘을 선택하여 장애 조치 프로세스를 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-308">On the **Confirm Planned Failover** blade, choose the source and target locations and select target network and click the check icon ✓ to start the failover process.</span></span>
4. <span data-ttu-id="7c841-309">복제본 가상 컴퓨터가 만들어진 후에는 커밋 대기중 상태입니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-309">After replica virtual machines are created they're in a commit pending state.</span></span> <span data-ttu-id="7c841-310">**커밋** 을 클릭하여 장애 조치를 커밋합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-310">Click **Commit** to commit the failover.</span></span>
5. <span data-ttu-id="7c841-311">복제가 완료되면 보조 위치에서 가상 컴퓨터가 시작됩니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-311">After replication is complete, the virtual machines start up at the secondary location.</span></span>

## <a name="perform-a-failover"></a><span data-ttu-id="7c841-312">장애 조치 수행</span><span class="sxs-lookup"><span data-stu-id="7c841-312">Perform a failover</span></span>
<span data-ttu-id="7c841-313">계획되지 않은 장애 조치(failover) 중에 StorSimple 볼륨이 가상 장치에 장애 조치(failover)되고, 복제본 VM이 Azure에서 온라인 상태가 되며, 볼륨이 VM에 연결됩니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-313">During an unplanned failover, the StorSimple volumes are failed over to the virtual device, a replica VM will be brought up on Azure, and the volumes are attached to the VM.</span></span>

#### <a name="to-perform-a-failover"></a><span data-ttu-id="7c841-314">장애 조치를 수행하려면</span><span class="sxs-lookup"><span data-stu-id="7c841-314">To perform a failover</span></span>
1. <span data-ttu-id="7c841-315">Azure 포털에서 파일 서버 VM에 대해 만들어진 **복구 서비스** 자격 증명 모음 &gt; **복구 계획(사이트 복구)** &gt; **recoveryplan_name**을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-315">In the Azure portal, select **Recovery services** vault &gt; **Recovery plans (Site recovery)** &gt; **recoveryplan_name** created for the file server VM.</span></span>
2. <span data-ttu-id="7c841-316">복구 계획 블레이드에서 **추가 정보** &gt;  **장애 조치**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-316">On the Recovery plan blade, Click **More** &gt;  **Failover**.</span></span>
3. <span data-ttu-id="7c841-317">**장애 조치 확인** 블레이드에서 원본 및 대상 위치를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-317">On the **Confirm Failover** blade, choose the source and target locations.</span></span>
4. <span data-ttu-id="7c841-318">**가상 컴퓨터 종료 및 최신 데이터 동기화**를 선택하여 사이트 복구가 보호된 가상 컴퓨터를 종료하고 데이터를 동기화하여 최신 버전의 데이터가 장애 조치되도록 지정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-318">Select **Shut down virtual machines and synchronize the latest data** to specify that Site Recovery should try to shut down the protected virtual machine and synchronize the data so that the latest version of the data will be failed over.</span></span>
5. <span data-ttu-id="7c841-319">가상 컴퓨터는 장애 조치 후에 커밋 보류 중 상태입니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-319">After the failover, the virtual machines are in a commit pending state.</span></span> <span data-ttu-id="7c841-320">**커밋** 을 클릭하여 장애 조치를 커밋합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-320">Click **Commit** to commit the failover.</span></span>


## <a name="perform-a-failback"></a><span data-ttu-id="7c841-321">장애 복구(failback) 수행</span><span class="sxs-lookup"><span data-stu-id="7c841-321">Perform a failback</span></span>
<span data-ttu-id="7c841-322">장애 복구(failback) 중에 StorSimple 볼륨 컨테이너는 백업이 만들어진 후 물리적 장치에 장애 복구(failback)됩니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-322">During a failback, StorSimple volume containers are failed over back to the physical device after a backup is taken.</span></span>

#### <a name="to-perform-a-failback"></a><span data-ttu-id="7c841-323">장애 복구(failback)를 수행하려면</span><span class="sxs-lookup"><span data-stu-id="7c841-323">To perform a failback</span></span>
1. <span data-ttu-id="7c841-324">Azure 포털에서 파일 서버 VM에 대해 만들어진 **복구 서비스** 자격 증명 모음 &gt; **복구 계획(사이트 복구)** &gt; **recoveryplan_name**을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-324">In the Azure portal, select **Recovery services** vault &gt; **Recovery plans (Site Recovery)** &gt; **recoveryplan_name** created for the file server VM.</span></span>
2. <span data-ttu-id="7c841-325">복구 계획 블레이드에서 **추가 정보** &gt;  **계획된 장애 조치**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-325">On the Recovery plan blade, Click **More** &gt;  **Planned Failover**.</span></span>
3. <span data-ttu-id="7c841-326">원본 및 대상 위치를 선택하고 적절한 데이터 동기화 및 VM 만들기 옵션을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-326">Choose the source and target locations, select the appropriate Data synchronization and VM creation options.</span></span>
4. <span data-ttu-id="7c841-327">**확인** 단추를 클릭하여 장애 조치 프로세스를 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-327">Click **OK** button to start the failback process.</span></span>

   ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image10.png)

## <a name="best-practices"></a><span data-ttu-id="7c841-328">모범 사례</span><span class="sxs-lookup"><span data-stu-id="7c841-328">Best Practices</span></span>
### <a name="capacity-planning-and-readiness-assessment"></a><span data-ttu-id="7c841-329">용량 계획 및 준비 평가</span><span class="sxs-lookup"><span data-stu-id="7c841-329">Capacity planning and readiness assessment</span></span>
#### <a name="hyper-v-site"></a><span data-ttu-id="7c841-330">Hyper-V 사이트</span><span class="sxs-lookup"><span data-stu-id="7c841-330">Hyper-V site</span></span>
<span data-ttu-id="7c841-331">[User Capacity planner tool(사용자 Capacity Planner 도구)](http://www.microsoft.com/download/details.aspx?id=39057) 을 사용하여 Hyper-V 복제본 환경에 대한 서버, 저장소 및 네트워크 인프라를 디자인합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-331">Use the [User Capacity planner tool](http://www.microsoft.com/download/details.aspx?id=39057) to design the server, storage, and network infrastructure for your Hyper-V replica environment.</span></span>

#### <a name="azure"></a><span data-ttu-id="7c841-332">Azure</span><span class="sxs-lookup"><span data-stu-id="7c841-332">Azure</span></span>
<span data-ttu-id="7c841-333">VM에서 [Azure 가상 컴퓨터 준비 평가 도구](http://azure.microsoft.com/downloads/vm-readiness-assessment/) 를 실행하여 VM이 Azure VM 및 Azure Site Recovery 서비스와 호환되는지 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-333">You can run the [Azure Virtual Machine Readiness Assessment tool](http://azure.microsoft.com/downloads/vm-readiness-assessment/) on VMs to ensure that they are compatible with Azure VMs and Azure Site Recovery Services.</span></span> <span data-ttu-id="7c841-334">준비 평가 도구는 VM 구성을 확인하고 구성이 Azure와 호환되지 않는 경우 경고합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-334">The Readiness Assessment Tool checks VM configurations and warns when configurations are incompatible with Azure.</span></span> <span data-ttu-id="7c841-335">예를 들어 C: 드라이브가 127GB 보다 큰 경우 경고가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-335">For example, it issues a warning if a C: drive is larger than 127 GB.</span></span>

<span data-ttu-id="7c841-336">용량 계획은 다음과 같은 두 개 이상의 중요 프로세스로 구성됩니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-336">Capacity planning is made up of at least two important processes:</span></span>

* <span data-ttu-id="7c841-337">온-프레미스 Hyper-V VM을 Azure VM 크기(예: A6, A7, A8, A9)에 매핑</span><span class="sxs-lookup"><span data-stu-id="7c841-337">Mapping on-premises Hyper-V VMs to Azure VM sizes (such as A6, A7, A8, and A9).</span></span>
* <span data-ttu-id="7c841-338">필요한 인터넷 대역폭 확인</span><span class="sxs-lookup"><span data-stu-id="7c841-338">Determining the required Internet bandwidth.</span></span>

## <a name="limitations"></a><span data-ttu-id="7c841-339">제한 사항</span><span class="sxs-lookup"><span data-stu-id="7c841-339">Limitations</span></span>
* <span data-ttu-id="7c841-340">.현재는 StorSimple 장치 1개만 장애 조치(failover)할 수 있습니다(단일 StorSimple Cloud Appliance에).</span><span class="sxs-lookup"><span data-stu-id="7c841-340">Currently, only 1 StorSimple device can be failed over (to a single StorSimple Cloud Appliance).</span></span> <span data-ttu-id="7c841-341">여러 StorSimple 장치에 걸쳐 있는 파일 서버 시나리오는 아직 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-341">The scenario of a file server that spans several StorSimple devices is not yet supported.</span></span>
* <span data-ttu-id="7c841-342">VM에 대한 보호를 사용하도록 설정하는 동안 오류가 발생하는 경우 iSCSI 대상의 연결을 끊었는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-342">If you get an error while enabling protection for a VM, make sure that you have disconnected the iSCSI targets.</span></span>
* <span data-ttu-id="7c841-343">볼륨 컨테이너에 걸쳐 있는 백업 정책으로 인해 함께 그룹화된 모든 볼륨 컨테이너는 함께 장애 조치(failover)됩니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-343">All the volume containers that have been grouped together because of backup policies spanning across volume containers will be failed over together.</span></span>
* <span data-ttu-id="7c841-344">선택한 볼륨 컨테이너에 있는 모든 볼륨은 장애 조치(failover)됩니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-344">All the volumes in the volume containers you have chosen will be failed over.</span></span>
* <span data-ttu-id="7c841-345">64TB 이상까지 추가되는 볼륨은 단일 StorSimple Cloud Appliance의 최대 용량이 64TB이므로 장애 조치(failover)될 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-345">Volumes that add up to more than 64 TB can’t be failed over because the maximum capacity of a single StorSimple Cloud Appliance is 64 TB.</span></span>
* <span data-ttu-id="7c841-346">계획된/계획되지 않은 장애 조치(failover)가 실패하고 Azure에서 VM이 만들어지는 경우 VM을 정리하지 마세요.</span><span class="sxs-lookup"><span data-stu-id="7c841-346">If the planned/unplanned failover fails and the VMs are created in Azure, then do not clean up the VMs.</span></span> <span data-ttu-id="7c841-347">대신 장애 복구(failback)를 수행하세요.</span><span class="sxs-lookup"><span data-stu-id="7c841-347">Instead, do a failback.</span></span> <span data-ttu-id="7c841-348">VM을 삭제하는 경우 온-프레미스 VM을 다시 켤 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-348">If you delete the VMs then the on-premises VMs cannot be turned on again.</span></span>
* <span data-ttu-id="7c841-349">장애 조치(failover) 후 볼륨이 표시되지 않는 경우 VM으로 이동하여 디스크 관리를 열고 디스크를 다시 검색한 다음 온라인 상태로 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-349">After a failover, if you are not able to see the volumes, go to the VMs, open Disk Management, rescan the disks, and then bring them online.</span></span>
* <span data-ttu-id="7c841-350">일부 경우 DR 사이트의 드라이브 문자가 온-프레미스의 드라이브 문자와 다를 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-350">In some instances, the drive letters in the DR site might be different than the letters on-premises.</span></span> <span data-ttu-id="7c841-351">이 문제가 발생할 경우 장애 조치(failover)가 완료된 후 수동으로 문제를 해결해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-351">If this occurs, you will need to manually correct the problem after the failover is finished.</span></span>
* <span data-ttu-id="7c841-352">자동화 계정에 자산으로 입력된 Azure 자격 증명에 대해 다단계 인증을 사용하지 않도록 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-352">Multi-factor authentication should be disabled for the Azure credential that is entered in the automation account as an asset.</span></span> <span data-ttu-id="7c841-353">이 인증을 사용하지 않도록 설정하지 않으면 스크립트를 자동으로 실행할 수 없어 복구 계획이 실패합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-353">If this authentication is not disabled, scripts will not be allowed to run automatically and the recovery plan will fail.</span></span>
* <span data-ttu-id="7c841-354">장애 조치(failover) 작업 시간 제한: 볼륨 컨테이너의 장애 조치(failover)에 스크립트당 Azure Site Recovery 제한(현재 120분)보다 많은 시간이 걸리는 경우 StorSimple 스크립트 시간 제한이 초과합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-354">Failover job timeout: The StorSimple script will time out if the failover of volume containers takes more time than the Azure Site Recovery limit per script (currently 120 minutes).</span></span>
* <span data-ttu-id="7c841-355">백업 작업 시간 제한: 볼륨의 백업에 스크립트당 Azure Site Recovery 제한(현재 120분)보다 많은 시간이 걸리는 경우 StorSimple 스크립트 시간 제한이 초과합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-355">Backup job timeout: The StorSimple script times out if the backup of volumes takes more time than the Azure Site Recovery limit per script (currently 120 minutes).</span></span>

  > [!IMPORTANT]
  > <span data-ttu-id="7c841-356">Azure 포털에서 수동으로 백업을 실행한 다음 다시 복구 계획을 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-356">Run the backup manually from the Azure portal and then run the recovery plan again.</span></span>

* <span data-ttu-id="7c841-357">복제 작업 시간 제한: 볼륨의 복제에 스크립트당 Azure Site Recovery 제한(현재 120분)보다 많은 시간이 걸리는 경우 StorSimple 스크립트 시간 제한이 초과합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-357">Clone job timeout: The StorSimple script times out if the cloning of volumes takes more time than the Azure Site Recovery limit per script (currently 120 minutes).</span></span>
* <span data-ttu-id="7c841-358">시간 동기화 오류: 포털에서 백업에 성공한 경우에도 백업에 실패했다는 StorSimple 스크립트 오류가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-358">Time synchronization error: The StorSimple scripts errors out saying that the backups were unsuccessful even though the backup is successful in the portal.</span></span> <span data-ttu-id="7c841-359">이 오류의 가능한 원인은 StorSimple 어플라이언스의 시간이 표준 시간대의 현재 시간과 동기화되지 않았기 때문일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-359">A possible cause for this might be that the StorSimple appliance’s time might be out of sync with the current time in the time zone.</span></span>

  > [!IMPORTANT]
  > <span data-ttu-id="7c841-360">어플라이언스 시간을 표준 시간대의 현재 시간과 동기화합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-360">Sync the appliance time with the current time in the time zone.</span></span>

* <span data-ttu-id="7c841-361">어플라이언스 장애 조치(failover) 오류: 복구 계획이 실행 중일 때 어플라이언스 장애 조치(failover)가 있는 경우 StorSimple 스크립트가 실패할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-361">Appliance failover error: The StorSimple script might fail if there is an appliance failover when the recovery plan is running.</span></span>

  > [!IMPORTANT]
  > <span data-ttu-id="7c841-362">어플라이언스 장애 조치(failover)가 완료된 후 복구 계획을 다시 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-362">Rerun the recovery plan after the appliance failover is complete.</span></span>


## <a name="summary"></a><span data-ttu-id="7c841-363">요약</span><span class="sxs-lookup"><span data-stu-id="7c841-363">Summary</span></span>
<span data-ttu-id="7c841-364">Azure Site Recovery를 사용하여 StorSimple 저장소에 호스트된 파일 공유가 있는 파일 서버 VM에 대한 전체 자동화된 재해 복구 계획을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-364">Using Azure Site Recovery, you can create a complete automated disaster recovery plan for a file server VM having file shares hosted on StorSimple storage.</span></span> <span data-ttu-id="7c841-365">중단이 발생할 경우 어디서나 몇 초 이내에 장애 조치(failover)를 시작하고 몇 분 만에 응용 프로그램을 가동할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7c841-365">You can initiate the failover within seconds from anywhere in the event of a disruption and get the application up and running in a few minutes.</span></span>
