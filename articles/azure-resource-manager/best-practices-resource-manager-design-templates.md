---
title: "복잡한 솔루션에 대한 Azure 템플릿 디자인 | Microsoft Docs"
description: "복잡한 시나리오에 대한 Azure Resource Manager 템플릿 디자인에 대한 모범 사례 표시"
services: azure-resource-manager
documentationcenter: 
author: tfitzmac
manager: timlt
editor: tysonn
ms.assetid: ce1141d6-ece7-4976-acea-1db1f775409e
ms.service: azure-resource-manager
ms.workload: multiple
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 12/19/2016
ms.author: tomfitz
ms.openlocfilehash: dcc31f7a8c85a8f7fbd554371a66fb1e348bca17
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/03/2017
---
# <a name="design-patterns-for-azure-resource-manager-templates-when-deploying-complex-solutions"></a><span data-ttu-id="507d1-103">복잡한 솔루션을 배포할 때 Azure Resource Manager 템플릿에 대한 디자인 패턴</span><span class="sxs-lookup"><span data-stu-id="507d1-103">Design patterns for Azure Resource Manager templates when deploying complex solutions</span></span>
<span data-ttu-id="507d1-104">Azure Resource Manager 템플릿을 기반으로 유연한 접근 방식을 사용하면 복잡한 토폴로지를 신속하고 일관되게 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-104">Using a flexible approach based on Azure Resource Manager templates, you can deploy complex topologies quickly and consistently.</span></span> <span data-ttu-id="507d1-105">코어 제품이 진화함에 따라 또는 이상값 시나리오나 고객에 대한 변화를 수용할 수 있도록 이러한 배포를 쉽게 조정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-105">You can adapt these deployments easily as core offerings evolve or to accommodate variants for outlier scenarios or customers.</span></span>

<span data-ttu-id="507d1-106">이 항목은 더 큰 백서의 일부입니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-106">This topic is part of a larger whitepaper.</span></span> <span data-ttu-id="507d1-107">전체 문서를 읽으려면 [세계적인 Resource Manager 템플릿 고려 사항 및 입증 사례](http://download.microsoft.com/download/8/E/1/8E1DBEFA-CECE-4DC9-A813-93520A5D7CFE/World Class ARM Templates - Considerations and Proven Practices.pdf)를 다운로드합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-107">To read the full paper, download [World Class Azure Resource Manager Templates Considerations and Proven Practices](http://download.microsoft.com/download/8/E/1/8E1DBEFA-CECE-4DC9-A813-93520A5D7CFE/World Class ARM Templates - Considerations and Proven Practices.pdf).</span></span>

<span data-ttu-id="507d1-108">템플릿은 기본 Azure 리소스 관리자의 이점과 JSON(JavaScript Object Notation)의 적응성 및 가독성을 결합합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-108">Templates combine the benefits of the underlying Azure Resource Manager with the adaptability and readability of JavaScript Object Notation (JSON).</span></span> <span data-ttu-id="507d1-109">템플릿을 사용하여 가능한 작업:</span><span class="sxs-lookup"><span data-stu-id="507d1-109">Using templates, you can:</span></span>

* <span data-ttu-id="507d1-110">토폴로지 및 토폴로지의 워크로드를 일관되게 배포합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-110">Deploy topologies and their workloads consistently.</span></span>
* <span data-ttu-id="507d1-111">리소스 그룹을 사용하여 하나의 응용 프로그램에서 모든 리소스를 함께 관리합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-111">Manage all your resources in an application together using resource groups.</span></span>
* <span data-ttu-id="507d1-112">사용자, 그룹 및 서비스에 적합한 액세스를 허용하도록 역할 기반 액세스 제어(RBAC)를 적용합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-112">Apply role-based access control (RBAC) to grant appropriate access to users, groups, and services.</span></span>
* <span data-ttu-id="507d1-113">태그 지정 연결을 사용하여 청구 롤업과 같은 작업을 간소화합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-113">Use tagging associations to streamline tasks such as billing rollups.</span></span>

<span data-ttu-id="507d1-114">이 문서는 Azure 고객 자문 팀(AzureCAT) 고객과의 실제 환경 템플릿 구현 및 설계 세션 중에 확인된 소비 시나리오, 아키텍처, 및 구현 패턴에 대해 자세한 내용을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-114">This article provides details on consumption scenarios, architecture, and implementation patterns identified during our design sessions and real-world template implementations with Azure Customer Advisory Team (AzureCAT) customers.</span></span> <span data-ttu-id="507d1-115">이러한 접근 방식은 학술적이지는 않았지만 Apache Kafka, Apache Spark, Cloudera, Couchbase, Hortonworks HDP, DataStax Enterprise powered by Apache Cassandra, Elasticsearch, Jenkins, MongoDB, PostgreSQL, Redis 및 Nagios를 비롯한 상위 Linux 기반 OSS 기술 중 12가지에 대한 템플릿의 개발을 통해 알려진 검증된 작업 방식입니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-115">Far from academic, these approaches are proven practices informed by the development of templates for 12 of the top Linux-based OSS technologies, including: Apache Kafka, Apache Spark, Cloudera, Couchbase, Hortonworks HDP, DataStax Enterprise powered by Apache Cassandra, Elasticsearch, Jenkins, MongoDB, PostgreSQL, Redis, and Nagios.</span></span> 

<span data-ttu-id="507d1-116">이 문서는 최고 수준의 Azure 리소스 관리자 템플릿을 구성하는데 도움을 주기 위하여 검증된 작업 방식을 공유합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-116">This article shares these proven practices to help you architect world class Azure Resource Manager templates.</span></span>  

<span data-ttu-id="507d1-117">고객과의 작업에서 엔터프라이즈, SI(시스템 통합자) 및 CSV의 몇몇 Resource Manager 템플릿 소비 경험을 확인했습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-117">In our work with customers, we have identified several Resource Manager template consumption experiences across enterprises, System Integrators (SI)s, and CSVs.</span></span> <span data-ttu-id="507d1-118">다음 섹션은 다양한 유형의 고객에 대한 일반적인 시나리오와 패턴의 대략적인 개요를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-118">The following sections provide a high-level overview of common scenarios and patterns for different customer types.</span></span>

## <a name="enterprises-and-system-integrators"></a><span data-ttu-id="507d1-119">엔터프라이즈 및 시스템 통합 업체</span><span class="sxs-lookup"><span data-stu-id="507d1-119">Enterprises and system integrators</span></span>
<span data-ttu-id="507d1-120">큰 조직에는 일반적으로 두 가지 Resource Manager 템플릿 소비자(내부 소프트웨어 개발 팀 및 기업 IT)가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-120">Within large organizations, we commonly see two consumers of Resource Manager templates: internal software development teams and corporate IT.</span></span> <span data-ttu-id="507d1-121">SI용 시나리오는 엔터프라이즈용 시나리오에 매핑되므로 동일한 고려 사항이 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-121">We've found that the scenarios for the SIs map to the scenarios for Enterprises, so the same considerations apply.</span></span>

### <a name="internal-software-development-teams"></a><span data-ttu-id="507d1-122">내부 소프트웨어 개발 팀</span><span class="sxs-lookup"><span data-stu-id="507d1-122">Internal software development teams</span></span>
<span data-ttu-id="507d1-123">템플릿은 비즈니스를 지원하는 소프트웨어를 개발하는 팀에게 비즈니스 특유의 솔루션에 사용하기 위한 기술을 신속하게 배포할 수 있는 쉬운 방법을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-123">If your team develops software to support your business, templates provide an easy way to quickly deploy technologies for use in business-specific solutions.</span></span> <span data-ttu-id="507d1-124">템플릿을 사용하여 팀 멤버가 필요한 기량을 습득할 수 있는 교육 환경을 신속하게 만들 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-124">You can also use templates to rapidly create training environments that enable team members to gain necessary skills.</span></span>

<span data-ttu-id="507d1-125">템플릿을 있는 그대로 사용하거나 요구에 맞게 확장 또는 작성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-125">You can use templates as-is or extend or compose them to accommodate your needs.</span></span> <span data-ttu-id="507d1-126">템플릿 내에서 태그 지정을 사용하면 팀, 프로젝트, 개인 및 교육과 같은 다양한 보기로 청구 요약을 제공할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-126">Using tagging within templates, you can provide a billing summary with various views such as team, project, individual, and education.</span></span>

<span data-ttu-id="507d1-127">기업에서는 종종 소프트웨어 개발 팀이 일관성 있는 솔루션 배포를 위한 템플릿을 만들기를 원합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-127">Businesses often want software development teams to create a template for consistent deployment of a solution.</span></span> <span data-ttu-id="507d1-128">템플릿을 통해 해당 환경 내의 특정 항목이 고정되어 겹쳐 쓸 수 없도록 하는 제약 조건을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-128">The template facilitates constraints so certain items within that environment remain fixed and can't be overridden.</span></span> <span data-ttu-id="507d1-129">예를 들어 은행의 경우 프로그래머가 개인 저장소 계정에 데이터를 보내기 위해 뱅킹 솔루션을 변경할 수 없도록 템플릿에 RBAC를 포함시켜야 합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-129">For example, a bank might require a template to include RBAC so a programmer can’t revise a banking solution to send data to a personal storage account.</span></span>

### <a name="corporate-it"></a><span data-ttu-id="507d1-130">기업 IT</span><span class="sxs-lookup"><span data-stu-id="507d1-130">Corporate IT</span></span>
<span data-ttu-id="507d1-131">기업 IT 조직은 일반적으로 클라우드 용량 및 클라우드 호스티드 기능을 제공하기 위한 템플릿을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-131">Corporate IT organizations typically use templates for delivering cloud capacity and cloud-hosted capabilities.</span></span>

#### <a name="cloud-capacity"></a><span data-ttu-id="507d1-132">클라우드 용량</span><span class="sxs-lookup"><span data-stu-id="507d1-132">Cloud capacity</span></span>
<span data-ttu-id="507d1-133">기업 IT 그룹이 팀을 대상으로 클라우드 용량을 제공하는 일반적은 방법에는 "티셔츠 크기" 개념을 사용하는데 이것은 대, 중, 소와 같은 표준 제품 크기를 의미합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-133">A common way for corporate IT groups to provide cloud capacity for teams is with "t-shirt sizes", which are standard offering sizes such as small, medium, and large.</span></span> <span data-ttu-id="507d1-134">티셔츠 크기의 제품은 템플릿 사용이 가능하도록 일정 수준의 표준화를 제공하면서 다양한 리소스 유형과 수량을 혼합할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-134">The t-shirt sized offerings can mix different resource types and quantities while providing a level of standardization that makes it possible to use templates.</span></span> <span data-ttu-id="507d1-135">템플릿은 기업 정책을 적용하는 일관된 방식으로 용량을 제공하고 소비 조직에 환불을 제공하기 위하여 태그 지정을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-135">The templates deliver capacity in a consistent way that enforces corporate policies and uses tagging to provide chargeback to consuming organizations.</span></span>

<span data-ttu-id="507d1-136">예를 들어 소프트웨어 개발 팀이 솔루션을 배포할 수 있는 환경 내에 개발, 테스트 또는 프러덕션 환경을 제공해야 하는 경우가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-136">For example, you may need to provide development, test, or production environments within which the software development teams can deploy their solutions.</span></span> <span data-ttu-id="507d1-137">환경에는 공용 인터넷 및 패킷 검사에 대한 액세스를 관리하는 규칙과 같이 소프트웨어 개발 팀이 변경할 수 없는 미리 정의된 네트워크 토폴로지와 요소가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-137">The environment has a predefined network topology and elements that the software development teams cannot change, such as rules governing access to the public internet and packet inspection.</span></span> <span data-ttu-id="507d1-138">환경에 대해 뚜렷한 액세스 권한을 소유하는 환경에 대한 조직 고유한 역할이 있을 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-138">You may also have organization-specific roles for these environments with distinct access rights for the environment.</span></span>

#### <a name="cloud-hosted-capabilities"></a><span data-ttu-id="507d1-139">클라우드 호스티드 기능</span><span class="sxs-lookup"><span data-stu-id="507d1-139">Cloud-hosted capabilities</span></span>
<span data-ttu-id="507d1-140">템플릿을 사용하여 비즈니스 내부 회선에 제공되는 복합 제품이나 개인 소프트웨어 패키지를 비롯한 클라우드 호스티드 기능을 지원할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-140">You can use templates to support cloud-hosted capabilities, including individual software packages or composite offerings that are offered to internal lines of business.</span></span> <span data-ttu-id="507d1-141">복합 제품의 예에는 미리 정의된 네트워크 토폴로지에 최적화되어 연결된 구성으로 제공되는 Analytics-as-a-service(분석, 시각화 및 기타 기술)가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-141">An example of a composite offering would be analytics-as-a-service—analytics, visualization, and other technologies—delivered in an optimized, connected configuration on a predefined network topology.</span></span>

<span data-ttu-id="507d1-142">클라우드 호스티드 기능은 제공되는 클라우드 용량 제품에 설정된 보안 및 역할 고려 사항의 영향을 받습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-142">Cloud-hosted capabilities are affected by the security and role considerations established by the cloud capacity offering on which they’re built.</span></span> <span data-ttu-id="507d1-143">이러한 기능은 있는 그대로 제공되거나 관리 서비스로 제공됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-143">These capabilities are offered as is or as a managed service.</span></span> <span data-ttu-id="507d1-144">후자의 경우 관리를 목적으로 환경에 액세스 할 수 있도록 하기 위해 액세스 제한 역할이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-144">For the latter, access-constrained roles are required to enable access into the environment for management purposes.</span></span>

## <a name="cloud-service-vendors"></a><span data-ttu-id="507d1-145">클라우드 서비스 공급업체</span><span class="sxs-lookup"><span data-stu-id="507d1-145">Cloud service vendors</span></span>
<span data-ttu-id="507d1-146">많은 CSV와의 논의 끝에 관련 요구 사항 및 고객을 위한 서비스를 배포하기 위해 취할 수 있는 여러 가지 접근 방식을 확인했습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-146">After talking to many CSVs, we identified multiple approaches you can take to deploy services for your customers and associated requirements.</span></span>

### <a name="csv-hosted-offering"></a><span data-ttu-id="507d1-147">CSV 호스티드 제품</span><span class="sxs-lookup"><span data-stu-id="507d1-147">CSV-hosted offering</span></span>
<span data-ttu-id="507d1-148">사용자가 소유하는 Azure 구독 내에 제품을 호스트하는 경우 두 가지 호스팅 접근 방식이 일반적이며, 모든 고객을 위한 고유한 배포를 수행하거나 모든 고객에 대해 사용되는 공유 인프라의 기초가 되는 배율 단위를 배포합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-148">If you host your offering in your own Azure subscription, two hosting approaches are common: deploying a distinct deployment for every customer or deploying scale units that underpin a shared infrastructure used for all customers.</span></span>

* <span data-ttu-id="507d1-149">**각 고객에 대한 고유한 배포.**</span><span class="sxs-lookup"><span data-stu-id="507d1-149">**Distinct deployments for each customer.**</span></span> <span data-ttu-id="507d1-150">고객 당 고유한 배포에는 알려져 있는 다양한 구성에 대한 고정 토폴로지가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-150">Distinct deployments per customer require fixed topologies of different known configurations.</span></span> <span data-ttu-id="507d1-151">이러한 배포를 통해 다양한 VM(가상 컴퓨터) 크기, 다양한 수의 노드, 다양한 크기의 관련 저장소가 포함될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-151">These deployments may have different virtual machine (VM) sizes, varying numbers of nodes, and different amounts of associated storage.</span></span> <span data-ttu-id="507d1-152">배포 태그 지정은 각 고객의 롤업 청구에 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-152">Tagging of deployments is used for roll-up billing of each customer.</span></span> <span data-ttu-id="507d1-153">RBAC는 고객이 소유하는 클라우드 환경에 액세스하도록 허용하기 위해 사용될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-153">RBAC may be enabled to allow customers access to aspects of their cloud environment.</span></span>
* <span data-ttu-id="507d1-154">**공유 다중 테넌트 환경의 배율 단위.**</span><span class="sxs-lookup"><span data-stu-id="507d1-154">**Scale units in shared multi-tenant environments.**</span></span> <span data-ttu-id="507d1-155">템플릿은 다중 테넌트 환경에 대한 배율 단위를 나타낼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-155">A template can represent a scale unit for multi-tenant environments.</span></span> <span data-ttu-id="507d1-156">이런 경우 동일한 인프라가 모든 고객을 지원하는데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-156">In this case, the same infrastructure is used to support all customers.</span></span> <span data-ttu-id="507d1-157">배포는 사용자 수 및 트랜잭션 수와 같이 호스팅되는 제품에 대한 용량 수준을 제공하는 리소스 그룹을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-157">The deployments represent a group of resources that deliver a level of capacity for the hosted offering, such as number of users and number of transactions.</span></span> <span data-ttu-id="507d1-158">이러한 배율 단위는 요구 사항의 필요에 따라서 증가되거나 감소됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-158">These scale units are increased or decreased as demand requires.</span></span>

### <a name="csv-offering-injected-into-customer-subscription"></a><span data-ttu-id="507d1-159">고객 구독에 삽입되는 CSV 제품</span><span class="sxs-lookup"><span data-stu-id="507d1-159">CSV offering injected into customer subscription</span></span>
<span data-ttu-id="507d1-160">사용자의 소프트웨어를 최종 고객이 소유하는 구독에 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-160">You may want to deploy your software into subscriptions owned by end customers.</span></span> <span data-ttu-id="507d1-161">템플릿을 사용하여 고객의 Azure 계정으로 고유한 배포를 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-161">You can use templates to deploy distinct deployments into a customer’s Azure account.</span></span>

<span data-ttu-id="507d1-162">이러한 배포는 고객의 계정 내에서 배포를 업데이트하고 관리할 수 있도록 RBAC를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-162">These deployments use RBAC so you can update and manage the deployment within the customer’s account.</span></span>

### <a name="azure-marketplace"></a><span data-ttu-id="507d1-163">Azure 마켓플레이스</span><span class="sxs-lookup"><span data-stu-id="507d1-163">Azure Marketplace</span></span>
<span data-ttu-id="507d1-164">Azure Marketplace 같은 마켓플레이스를 통해 제품을 광고하고 판매하기 위해 고객의 Azure 계정에서 실행되는 고유한 배포 유형을 제공하도록 템플릿을 개발할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-164">To advertise and sell your offerings through a marketplace, such as Azure Marketplace, you can develop templates to deliver distinct types of deployments that run in a customer’s Azure account.</span></span> <span data-ttu-id="507d1-165">고유한 배포는 일반적으로 티셔츠 크기(대, 중, 소), 제품/대상 그룹 유형(커뮤니티, 개발자, 엔터프라이즈) 또는 기능 유형(기본, 고가용성)으로 명시됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-165">These distinct deployments can be typically described as a t-shirt size (small, medium, large), product/audience type (community, developer, enterprise), or feature type (basic, high availability).</span></span>  <span data-ttu-id="507d1-166">이런 유형을 통해 VM 유형이나 디스크 수와 같은 배포의 특성을 지정할 수 있는 경우도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-166">In some cases, these types allow you to specify certain attributes of the deployment, such as VM type or number of disks.</span></span>

## <a name="oss-projects"></a><span data-ttu-id="507d1-167">OSS 프로젝트</span><span class="sxs-lookup"><span data-stu-id="507d1-167">OSS projects</span></span>
<span data-ttu-id="507d1-168">오픈 소스 프로젝트 내에서 리소스 관리자 템플릿을 사용하면 입증된 작업 방식을 사용하여 커뮤니티에서 신속하게 솔루션을 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-168">Within open source projects, Resource Manager templates enable a community to deploy a solution quickly using proven practices.</span></span> <span data-ttu-id="507d1-169">시간이 지난 후에 커뮤니티에서 수정할 수 있도록 GitHub 리포지터리에 템플릿을 저장할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-169">You can store templates in a GitHub repository so the community can revise them over time.</span></span> <span data-ttu-id="507d1-170">사용자는 자신의 Azure 구독에 이 템플릿을 배포합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-170">Users deploy these templates in their own Azure subscriptions.</span></span>

<span data-ttu-id="507d1-171">다음 섹션에서는 솔루션을 설계하기 전에 고려해야 할 사항을 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-171">The following sections identify the things you need to consider before designing your solution.</span></span>

## <a name="identifying-what-is-outside-and-inside-a-vm"></a><span data-ttu-id="507d1-172">VM의 외부 및 내부 항목 확인</span><span class="sxs-lookup"><span data-stu-id="507d1-172">Identifying what is outside and inside a VM</span></span>
<span data-ttu-id="507d1-173">템플릿을 설계하는 경우 가상 컴퓨터(VM) 외부 및 내부 항목에 관한 요구 사항을 살펴보는 것이 도움이 됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-173">As you design your template, it’s helpful to look at the requirements in terms of what's outside and inside the virtual machines (VMs):</span></span>

* <span data-ttu-id="507d1-174">외부는 VM 및 네트워크 토폴로지, 태그 지정, 인증/기밀 정보에 대한 참조, 역할 기반 액세스 제어 같은 배포의 기타 리소스를 의미합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-174">Outside means the VMs and other resources of your deployment, such as the network topology, tagging, references to the certs/secrets, and role-based access control.</span></span> <span data-ttu-id="507d1-175">이러한 모든 리소스가 템플릿의 일부입니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-175">All these resources are part of your template.</span></span>
* <span data-ttu-id="507d1-176">내부는 설치된 소프트웨어 및 전체적으로 필요한 상태 구성을 의미합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-176">Inside means the installed software and overall desired state configuration.</span></span> <span data-ttu-id="507d1-177">그 외에 VM 확장 또는 스크립트 같은 기타 메커니즘이 전체적으로 또는 부분적으로 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-177">Other mechanisms, such as VM extensions or scripts, are used in whole or in part.</span></span> <span data-ttu-id="507d1-178">이러한 메커니즘은 템플릿으로 식별하고 실행할 수 있지만 템플릿에 포함되어 있지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-178">These mechanisms may be identified and executed by the template but aren’t in it.</span></span>

<span data-ttu-id="507d1-179">“박스 안”에서 수행하는 작업의 일반적인 예</span><span class="sxs-lookup"><span data-stu-id="507d1-179">Common examples of activities you would do “inside the box” include -</span></span>  

* <span data-ttu-id="507d1-180">서버 역할 및 기능을 설치 또는 제거</span><span class="sxs-lookup"><span data-stu-id="507d1-180">Install or remove server roles and features</span></span>
* <span data-ttu-id="507d1-181">노드 또는 클러스터 수준에서 소프트웨어를 설치 및 구성</span><span class="sxs-lookup"><span data-stu-id="507d1-181">Install and configure software at the node or cluster level</span></span>
* <span data-ttu-id="507d1-182">웹 서버에서 웹 사이트 배포</span><span class="sxs-lookup"><span data-stu-id="507d1-182">Deploy websites on a web server</span></span>
* <span data-ttu-id="507d1-183">데이터베이스 스키마 배포</span><span class="sxs-lookup"><span data-stu-id="507d1-183">Deploy database schemas</span></span>
* <span data-ttu-id="507d1-184">레지스트리 또는 다른 유형의 구성 설정 관리</span><span class="sxs-lookup"><span data-stu-id="507d1-184">Manage registry or other types of configuration settings</span></span>
* <span data-ttu-id="507d1-185">파일 및 디렉터리 관리</span><span class="sxs-lookup"><span data-stu-id="507d1-185">Manage files and directories</span></span>
* <span data-ttu-id="507d1-186">프로세스 및 서비스 시작, 중지 및 관리</span><span class="sxs-lookup"><span data-stu-id="507d1-186">Start, stop, and manage processes and services</span></span>
* <span data-ttu-id="507d1-187">로컬 그룹 및 사용자 계정 관리</span><span class="sxs-lookup"><span data-stu-id="507d1-187">Manage local groups and user accounts</span></span>
* <span data-ttu-id="507d1-188">패키지(.msi, .exe, yum 등) 설치 및 관리</span><span class="sxs-lookup"><span data-stu-id="507d1-188">Install and manage packages (.msi, .exe, yum, etc.)</span></span>
* <span data-ttu-id="507d1-189">환경 변수 관리</span><span class="sxs-lookup"><span data-stu-id="507d1-189">Manage environment variables</span></span>
* <span data-ttu-id="507d1-190">네이티브 스크립트(Windows PowerShell, bash 등) 실행</span><span class="sxs-lookup"><span data-stu-id="507d1-190">Run native scripts (Windows PowerShell, bash, etc.)</span></span>

### <a name="desired-state-configuration-dsc"></a><span data-ttu-id="507d1-191">DSC(필요한 상태 구성)</span><span class="sxs-lookup"><span data-stu-id="507d1-191">Desired state configuration (DSC)</span></span>
<span data-ttu-id="507d1-192">배포 이외에 VM 내부 상태와 관련하여 배포에 대해 직접 정의하고 소스 제어에 체크 인해 놓은 구성이 상황에 따라 변경되지 않도록 하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-192">Thinking about the internal state of your VMs beyond deployment, you want to make sure this deployment doesn’t "drift" from the configuration that you have defined and checked into source control.</span></span> <span data-ttu-id="507d1-193">이러한 접근 방식은 개발자나 운영 담당자가 소스 제어 내에서 조사하거나 테스트하거나 기록하지 않은 환경을 임의 변경을 하지 않도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-193">This approach ensures your developers or operations staff don’t make ad-hoc changes to an environment that are not vetted, tested, or recorded in source control.</span></span> <span data-ttu-id="507d1-194">수동으로 변경한 내용은 소스 제어에 없으므로 이 제어는 중요합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-194">This control is important, because the manual changes are not in source control.</span></span> <span data-ttu-id="507d1-195">또한 표준 배포에 포함되지 않으며 향후 소프트웨어 자동 배포에 영향을 줍니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-195">They are also not part of the standard deployment and will impact future automated deployments of the software.</span></span>

<span data-ttu-id="507d1-196">내부 직원 외에 필요한 상태 구성은 보안적인 관점에서 중요합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-196">Beyond your internal employees, desired state configuration is also important from a security perspective.</span></span> <span data-ttu-id="507d1-197">해커는 주기적으로 소프트웨어 시스템을 손상시키고 악용하려는 시도를 합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-197">Hackers are regularly trying to compromise and exploit software systems.</span></span> <span data-ttu-id="507d1-198">성공한 경우에는 일반적으로 파일을 설치하고 그렇지 않으면 손상된 시스템의 상태를 변경합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-198">When successful, it's common to install files and otherwise change the state of a compromised system.</span></span> <span data-ttu-id="507d1-199">필요한 상태 구성을 사용하면 필요한 상태와 실제 상태 간의 델타를 확인하고 알려진 구성을 복원할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-199">Using desired state configuration, you can identify deltas between the desired and actual state and restore a known configuration.</span></span>

<span data-ttu-id="507d1-200">가장 인기있는 DSC 메커니즘에 대한 리소스 확장이 있습니다(PowerShell DSC, Chef, 및 Puppet).</span><span class="sxs-lookup"><span data-stu-id="507d1-200">There are resource extensions for the most popular mechanisms for DSC - PowerShell DSC, Chef, and Puppet.</span></span> <span data-ttu-id="507d1-201">이러한 각각의 확장은 VM의 초기 상태를 배포할 수 있고 필요한 상태가 유지되도록 하는 데 사용될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-201">Each of these extensions can deploy the initial state of your VM and also be used to make sure the desired state is maintained.</span></span>

## <a name="common-template-scopes"></a><span data-ttu-id="507d1-202">일반적인 템플릿 범위</span><span class="sxs-lookup"><span data-stu-id="507d1-202">Common template scopes</span></span>
<span data-ttu-id="507d1-203">경험을 통해 세 가지 주요 솔루션 템플릿을 확인하였습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-203">In our experience, we’ve seen three key solution templates scopes emerge.</span></span> <span data-ttu-id="507d1-204">이 세 가지 범위, 즉 용량, 기능 및 종단간 솔루션이 다음 섹션에 설명되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-204">These three scopes – capacity, capability, and end-to-end solution – are described in the following sections.</span></span>

### <a name="capacity-scope"></a><span data-ttu-id="507d1-205">용량 범위</span><span class="sxs-lookup"><span data-stu-id="507d1-205">Capacity scope</span></span>
<span data-ttu-id="507d1-206">용량 범위는 규정 및 정책을 준수하도록 미리 구성된 표준 토폴로지로 리소스 세트를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-206">A capacity scope delivers a set of resources in a standard topology that is pre-configured to be in compliance with regulations and policies.</span></span> <span data-ttu-id="507d1-207">가장 일반적인 사례는 엔터프라이즈 IT 또는 SI 시나리오에서 표준 개발 환경을 배포하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-207">The most common example is deploying a standard development environment in an Enterprise IT or SI scenario.</span></span>

### <a name="capability-scope"></a><span data-ttu-id="507d1-208">기능 범위</span><span class="sxs-lookup"><span data-stu-id="507d1-208">Capability scope</span></span>
<span data-ttu-id="507d1-209">기능 범위는 특정 기술에 대한 토폴로지를 배포 및 구성하는 것에 초점을 맞춥니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-209">A capability scope is focused on deploying and configuring a topology for a given technology.</span></span> <span data-ttu-id="507d1-210">일반적인 시나리오는 SQL Server, Cassandra, Hadoop 같은 기술을 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-210">Common scenarios including technologies such as SQL Server, Cassandra, Hadoop.</span></span>

### <a name="end-to-end-solution-scope"></a><span data-ttu-id="507d1-211">종단간 솔루션 범위</span><span class="sxs-lookup"><span data-stu-id="507d1-211">End-to-end solution scope</span></span>
<span data-ttu-id="507d1-212">종단간 솔루션 범위는 단일 기능 이상을 목표로 하며 복수의 기능으로 구성된 종단간 솔루션을 제공하는 것에 중점을 둡니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-212">An End-to-End Solution Scope is targeted beyond a single capability, and instead focused on delivering an end to end solution comprised of multiple capabilities.</span></span>  

<span data-ttu-id="507d1-213">솔루션 범위 템플릿의 범위는 솔루션 고유의 리소스, 논리 및 필요한 상태를 포함하는 하나 이상의 기능 범위 템플릿 집합으로 자체 명시됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-213">A solution-scoped template scope manifests itself as a set of one or more capability-scoped templates with solution-specific resources, logic, and desired state.</span></span> <span data-ttu-id="507d1-214">솔루션 범위 템플릿의 예제는 종단간 데이터 파이프라인 솔루션 템플릿입니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-214">An example of a solution-scoped template is an end to end data pipeline solution template.</span></span> <span data-ttu-id="507d1-215">템플릿은 솔루션별 토폴로지와 상태를 Kafka, Storm, Hadoop과 같은 여러 기능 범위 솔루션 템플릿과 혼합할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-215">The template might mix solution-specific topology and state with multiple capability-scoped solution templates such as Kafka, Storm, and Hadoop.</span></span>

## <a name="choosing-free-form-vs-known-configurations"></a><span data-ttu-id="507d1-216">자유 형식 또는 알려진 구성 선택</span><span class="sxs-lookup"><span data-stu-id="507d1-216">Choosing free-form vs. known configurations</span></span>
<span data-ttu-id="507d1-217">처음에는 템플릿이 소비자에게 최대의 유연성을 제공해야 한다고 생각할 수 있지만 자유 형식 구성과 알려진 구성 중에 무엇을 선택할지에 대해서는 많은 고려 사항이 영향을 미칩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-217">You might initially think a template should give consumers the utmost flexibility, but many considerations affect the choice of whether to use free-form configurations vs. known configurations.</span></span> <span data-ttu-id="507d1-218">이 섹션에서는 이 문서에서 공유한 접근 방식을 형성하는 기술적인 고려 사항과 주요 고객 요구 사항을 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-218">This section identifies the key customer requirements and technical considerations that shaped the approach shared in this document.</span></span>

### <a name="free-form-configurations"></a><span data-ttu-id="507d1-219">자유 형식 구성</span><span class="sxs-lookup"><span data-stu-id="507d1-219">Free-form configurations</span></span>
<span data-ttu-id="507d1-220">표면적으로는 자유 형식 구성이 이상적으로 보입니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-220">On the surface, free-form configurations sound ideal.</span></span> <span data-ttu-id="507d1-221">VM 유형을 선택할 수 있고 임의의 수의 노드 및 그 노드와 연결된 디스크를 제공하고 매개 변수가 템플릿에 제공하듯이 편리한 기능을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-221">They allow you to select a VM type and provide an arbitrary number of nodes and attached disks for those nodes — and do so as parameters to a template.</span></span> <span data-ttu-id="507d1-222">그러나 이 접근 방식은 일부 시나리오에는 적합하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-222">However, this approach is not ideal for some scenarios.</span></span>

<span data-ttu-id="507d1-223">[가상 컴퓨터의 크기](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)에서 다양한 VM 유형과 사용 가능한 크기 및 각각 연결할 수 있는 지속형 디스크의 수(2, 4, 8, 16, 또는 32)를 식별합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-223">In [Sizes for virtual machines](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), the different VM types and available sizes are identified, and each of the number of durable disks (2, 4, 8, 16, or 32) that can be attached.</span></span> <span data-ttu-id="507d1-224">각각의 연결된 디스크는 500 IOPS를 제공하며 이 디스크의 배수는 해당 IOPS의 승수로 풀링될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-224">Each attached disk provides 500 IOPS and multiples of these disks can be pooled for a multiplier of that number of IOPS.</span></span> <span data-ttu-id="507d1-225">예를 들어 디스크 16개는 8,000 IOPS를 제공하도록 풀링될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-225">For example, 16 disks can be pooled to provide 8,000 IOPS.</span></span> <span data-ttu-id="507d1-226">풀링은 Microsoft Windows 저장소 공간 또는 Linux의 RAID(Redundant Array of Inexpensive Disks)를 사용하여 운영 체제에서 구성을 사용하여 수행됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-226">Pooling is done with configuration in the operating system, using Microsoft Windows Storage Spaces or redundant array of inexpensive disks (RAID) in Linux.</span></span>

<span data-ttu-id="507d1-227">자유 형식 구성에서는 여러 VM 인스턴스, 해당 인스턴스의 다양한 VM 형식 및 크기, VM 형식의 다양한 디스크 및 VM 콘텐츠를 구성하는 하나 이상의 스크립트를 선택할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-227">A free-form configuration enables the selection several VM instances, various VM types and sizes for those instances, various disks for the VM type, and one or more scripts to configure the VM contents.</span></span>

<span data-ttu-id="507d1-228">모든 노드 유형에 대해 유연성이 제공될 수 있도록 배포에는 마스터 및 데이터 노드 같이 여러 가지 유형의 노드를 포함하는 것이 일반적입니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-228">It is common that a deployment may have multiple types of nodes, such as master and data nodes, so this flexibility is often provided for every node type.</span></span>

<span data-ttu-id="507d1-229">어떠한 중요도의 클러스터에 대한 배포를 시작하든 이러한 복잡한 시나리오로 작업을 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-229">As you start to deploy clusters of any significance, you begin to work with these complex scenarios.</span></span> <span data-ttu-id="507d1-230">예를 들어, 마스터 노드 8개와 데이터 노드 200개를 포함하는 Hadoop 클러스터를 배포하는 경우 각 마스터 노드에 대해 연결된 디스크를 4개 풀링하고 데이터 노드 당 연결된 디스크를 16개 풀링하면 관리할 VM은 208개가 되고 디스크는 3,232개가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-230">If you were deploying a Hadoop cluster, for example, with 8 master nodes and 200 data nodes, and pooled 4 attached disks on each master node and pooled 16 attached disks per data node, you would have 208 VMs and 3,232 disks to manage.</span></span>

<span data-ttu-id="507d1-231">저장소 계정은 초당 20,000개의 식별된 트랜잭션을 초과하는 요청을 제한하므로 저장소 계정 분할에 주목하고 계산을 사용하여 토폴로지를 수용하기에 적합한 저장소 계정의 수를 판단하도록 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-231">A storage account will throttle requests above its identified 20,000 transactions/second limit, so you should look at storage account partitioning and use calculations to determine the appropriate number of storage accounts to accommodate this topology.</span></span> <span data-ttu-id="507d1-232">자유 형식 접근 방식으로 지원되는 조합이 다수인 경우에는 적합한 분산을 판단하기 위하여 동적 계산이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-232">Given the multitude of combinations supported by the free-form approach, dynamic calculations are required to determine the appropriate partitioning.</span></span> <span data-ttu-id="507d1-233">Azure 리소스 관리자 템플릿 언어는 현재 수학 함수를 제공하지 않으므로 적절한 세부 사항이 고유하게 하드 코딩된 템플릿을 생성하는 코드로 계산을 수행해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-233">The Azure Resource Manager Template Language does not presently provide mathematical functions, so you must perform these calculations in code, generating a unique, hard-coded template with the appropriate details.</span></span>

<span data-ttu-id="507d1-234">엔터프라이즈 IT 및 SI 시나리오에서 누군가는 템플릿을 유지 관리해야 하고 한 곳 이상의 조직에 배포된 토폴로지를 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-234">In enterprise IT and SI scenarios, someone must maintain the templates and support the deployed topologies for one or more organizations.</span></span> <span data-ttu-id="507d1-235">고객별로 구성과 템플릿이 다르기 때문에 발생하는 부가적인 오버헤드는 결코 바람직하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-235">This additional overhead — different configurations and templates for each customer — is far from desirable.</span></span>

<span data-ttu-id="507d1-236">이 템플릿을 사용하면 고객의 Azure 구독에 환경을 배포하면서도 고객 청구에 대해 환불 기능을 사용하여 기업 IT 팀과 CSV 양쪽 모두가 전과 같이 자체적인 구독에 환경을 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-236">You can use these templates to deploy environments in your customer’s Azure subscription, but both corporate IT teams and CSVs typically deploy them into their own subscriptions, using a chargeback function to bill their customers.</span></span> <span data-ttu-id="507d1-237">이 시나리오의 목표는 구독 풀 전체적으로 복수 고객을 위한 수용량을 배포하고 구독이 불규칙하게 퍼지는 현상(스프롤)을 최소화하여 관리할 구독이 더 많도록 구독에 배포가 촘촘하게 채워진 상태를 유지하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-237">In these scenarios, the goal is to deploy capacity for multiple customers across a pool of subscriptions and keep deployments densely populated into the subscriptions to minimize subscription sprawl—that is, more subscriptions to manage.</span></span> <span data-ttu-id="507d1-238">실제로 동적인 배포 크기에 대해 이런 유형의 밀도를 달성하려면 조직을 위한 신중한 계획과 스캐폴딩 작업을 위한 추가적인 개발이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-238">With truly dynamic deployment sizes, achieving this type of density requires careful planning and additional development for scaffolding work on behalf of the organization.</span></span>

<span data-ttu-id="507d1-239">또한 API 호출을 통해 구독을 만들 수 없지만 포털을 통해 수동으로 이를 수행해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-239">In addition, you can’t create subscriptions via an API call but must do so manually through the portal.</span></span> <span data-ttu-id="507d1-240">구독의 수가 증가하면 그로 인해 발생하는 구독 스프롤에 사용자의 개입이 필요합니다. 이 작업은 자동화가 불가능합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-240">As the number of subscriptions increases, any resulting subscription sprawl requires human intervention—it can’t be automated.</span></span> <span data-ttu-id="507d1-241">배포의 크기에 변화가 큰 경우에는 배포의 가용성을 확실하게 하기 위해 구독의 수를 수동으로 미리 프로비전해야 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-241">With so much variability in the sizes of deployments, you would have to pre-provision a number of subscriptions manually to ensure subscriptions are available.</span></span>

<span data-ttu-id="507d1-242">이러한 모든 요소를 고려하면 진정한 자유 형식 구성은 언뜻 보기에 덜 매력적입니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-242">Considering all these factors, a truly free-form configuration is less appealing than at first blush.</span></span>

### <a name="known-configurations--the-t-shirt-sizing-approach"></a><span data-ttu-id="507d1-243">알려진 구성 — 티셔츠 크기 접근 방식</span><span class="sxs-lookup"><span data-stu-id="507d1-243">Known configurations — the t-shirt sizing approach</span></span>
<span data-ttu-id="507d1-244">경험에 따르면 절대적인 유연성과 수많은 변형을 제공하는 템플릿을 제공하기 보다는 알려진 구성(실제로 샌드박스, 대, 중, 소 같은 표준 티셔츠 크기)을 선택하도록 기능을 제공하는 것이 일반적인 패턴입니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-244">Rather than offer a template that provides total flexibility and countless variations, in our experience a common pattern is to provide the ability to select known configurations — in effect, standard t-shirt sizes such as sandbox, small, medium, and large.</span></span> <span data-ttu-id="507d1-245">티셔츠 크기의 다른 예에는 커뮤니티 버전이나 엔터프라이즈 버전 같은 제품이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-245">Other examples of t-shirt sizes are product offerings, such as community edition or enterprise edition.</span></span>  <span data-ttu-id="507d1-246">그 외 경우에는 Map Reduce 또는 No SQL 같은 특정 워크로드에 대한 기술 구성이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-246">In other cases, it may be workload-specific configurations of a technology – such as map reduce or no sql.</span></span>

<span data-ttu-id="507d1-247">많은 엔터프라이즈 IT 조직, OSS 공급업체 및 SI에서 현재 이러한 방식으로 온-프레미스, 가상화된 환경(엔터프라이즈) 또는 SaaS(Software-as-a-Service) 제품(CSV 및 OSV)으로 자사의 제품을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-247">Many enterprise IT organizations, OSS vendors, and SIs make their offerings available today in this way in on-premises, virtualized environments (enterprises) or as software-as-a-service (SaaS) offerings (CSVs and OSVs).</span></span>

<span data-ttu-id="507d1-248">이러한 접근 방식은 고객을 위해 미리 구성된 다양한 크기의 좋은, 알려진 구성을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-248">This approach provides good, known configurations of varying sizes that are preconfigured for customers.</span></span> <span data-ttu-id="507d1-249">알려진 구성이 없는 경우, 최종 고객은 자체적으로 클러스터 크기, 플랫폼 리소스 제약 조건의 요소를 결정해야 하고 그에 따라 파생되는 저장소 계정 및 기타 리소스(클러스터 크기 및 리소스 제약 조언에 따른)에 대한 분할을 식별하기 위해 수학을 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-249">Without known configurations, end customers must determine cluster sizing on their own, factor in platform resource constraints, and do math to identify the resulting partitioning of storage accounts and other resources (due to cluster size and resource constraints).</span></span> <span data-ttu-id="507d1-250">알려진 구성을 통해 고객은 적절한 티셔츠 크기 즉, 주어진 배포를 쉽게 선택할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-250">Known configurations enable customers to easily select the right t-shirt size—that is, a given deployment.</span></span> <span data-ttu-id="507d1-251">고객을 위한 환경을 개선하는 것 외에도, 소수의 알려진 구성은 지원하기가 쉽고 높은 수준의 밀도를 제공하는데 도움이 됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-251">In addition to making a better experience for the customer, a small number of known configurations is easier to support and can help you deliver a higher level of density.</span></span>

<span data-ttu-id="507d1-252">티셔츠 크기에 중점을 두는 알려진 구성 접근 방식은 하나의 크기 내에 다양한 수의 노드를 둘 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-252">A known configuration approach focused on t-shirt sizes may also have varying number of nodes within a size.</span></span> <span data-ttu-id="507d1-253">예를 들어 작은 티셔츠 크기는 3개에서 10개 사이의 노드가 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-253">For example, a small t-shirt size may be between 3 and 10 nodes.</span></span>  <span data-ttu-id="507d1-254">티셔츠 크기는 최대 10개의 노드를 수용하도록 설계되며 식별되는 최대 크기 내에서 고객이 자유 형식의 선택을 할 수 있도록 제공됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-254">The t-shirt size would be designed to accommodate up to 10 nodes and provide the consumer the ability to make free form selections up to the maximum size identified.</span></span>  

<span data-ttu-id="507d1-255">워크로드 유형에 기반하는 티셔츠 크기는 배포될 수 있는 노드의 수 측면에서 본질적으로 자유 형식에 더 가까울 수 있지만 노드의 소프트웨어에 대한 구성 및 워크로드 고유의 노드 크기를 갖습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-255">A t-shirt size based on workload type, may be more free form in nature in terms of the number of nodes that can be deployed but will have workload distinct node size and configuration of the software on the node.</span></span>

<span data-ttu-id="507d1-256">커뮤니티 또는 엔터프라이즈 같이 제품을 기반으로 하는 티셔츠 크기는 고유의 리소스 유형 및 배포될 수 있는 최대 노드 수를 가질 수 있고 일반적으로 여러 가지 제품에 대해 라이선스 고려 사항이나 기능의 가용성이 제한됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-256">T-shirt sizes based on product offerings, such as community or Enterprise, may have distinct resource types and maximum number of nodes that can be deployed, typically tied to licensing considerations or feature availability across the different offerings.</span></span>

<span data-ttu-id="507d1-257">JSON 기반 템플릿을 사용하여 고객에게 고유한 변형을 제공할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-257">You can also accommodate customers with unique variants using the JSON-based templates.</span></span> <span data-ttu-id="507d1-258">이상값을 처리하는 경우 개발, 지원 및 비용을 위해 적절한 계획과 고려 사항을 통합할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-258">When dealing with outliers, you can incorporate the appropriate planning and considerations for development, support, and costing.</span></span>

<span data-ttu-id="507d1-259">고객 템플릿 소비 시나리오 및 이 문서의 시작 부분에서 식별한 요구 사항을 기반으로 템플릿 분해 패턴을 식별했습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-259">Based on the customer template consumption scenarios, and requirements identified at the start of this document, we identified a pattern for template decomposition.</span></span>

## <a name="capacity-and-capability-scoped-solution-templates"></a><span data-ttu-id="507d1-260">용량 및 기능 범위 솔루션 템플릿</span><span class="sxs-lookup"><span data-stu-id="507d1-260">Capacity and capability-scoped solution templates</span></span>
<span data-ttu-id="507d1-261">분해는 재사용, 확장성, 테스트 및 도구를 지원하는 템플릿 개발에 대한 모듈식 접근 방식을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-261">Decomposition provides a modular approach to template development that supports reuse, extensibility, testing, and tooling.</span></span> <span data-ttu-id="507d1-262">이 섹션은 분해 접근 방식이 용량 및 기능 범위를 포함하는 템플릿에 적용되는 방법에 대한 세부 사항을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-262">This section provides detail on how a decomposition approach can be applied to templates with a Capacity or Capability scope.</span></span>

<span data-ttu-id="507d1-263">이 접근 방식에서 기본 템플릿은 템플릿 소비자로부터 매개 변수 값을 받은 후 아래 표시된 것과 같이 몇 가지 유형의 템플릿과 스크립트에 연결합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-263">In this approach, a main template receives parameter values from a template consumer, then links to several types of templates and scripts downstream as shown below.</span></span> <span data-ttu-id="507d1-264">매개 변수, 정적 변수 및 생성된 변수는 연결된 템플릿의 내부 및 외부 값을 제공하는데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-264">Parameters, static variables, and generated variables are used to provide values in and out of the linked templates.</span></span>

![템플릿 매개 변수](./media/best-practices-resource-manager-design-templates/template-parameters.png)

<span data-ttu-id="507d1-266">**매개 변수는 기본 템플릿에 전달된 후 연결된 템플릿으로 전달됩니다.**</span><span class="sxs-lookup"><span data-stu-id="507d1-266">**Parameters are passed to a main template then to linked templates**</span></span>

<span data-ttu-id="507d1-267">다음 섹션은 단일 템플릿이 분해되는 스크립트와 템플릿의 유형을 중점적으로 설명하고</span><span class="sxs-lookup"><span data-stu-id="507d1-267">The following sections focus on the types of templates and scripts that a single template is decomposed into.</span></span> <span data-ttu-id="507d1-268">템플릿 사이에서 상태 정보를 전달하는 접근 방식을 살펴봅니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-268">The sections present approaches for passing state information among the templates.</span></span> <span data-ttu-id="507d1-269">이미지에 포함된 각 템플릿과 스크립트 유형은 예제와 함께 설명됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-269">Each template and the script types in the image are described along with examples.</span></span> <span data-ttu-id="507d1-270">상황별 예제를 보려면 이 문서의 뒷부분에서 “요약: 샘플 구현"을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="507d1-270">For a contextual example, see "Putting it together: a sample implementation" later in this document.</span></span>

### <a name="template-metadata"></a><span data-ttu-id="507d1-271">템플릿 메타데이터</span><span class="sxs-lookup"><span data-stu-id="507d1-271">Template metadata</span></span>
<span data-ttu-id="507d1-272">템플릿 메타데이터(metadata.json 파일)는 사람과 소프트웨어 시스템이 읽을 수 있는 JSON으로 템플릿을 설명한 키/값 쌍을 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-272">Template metadata (the metadata.json file) contains key/value pairs that describe a template in JSON, which can be read by humans and software systems.</span></span>

![템플릿 메타데이터](./media/best-practices-resource-manager-design-templates/template-metadata.png)

<span data-ttu-id="507d1-274">**템플릿 메타데이터는 metadata.json 파일에 설명됩니다.**</span><span class="sxs-lookup"><span data-stu-id="507d1-274">**Template metadata is described in the metadata.json file**</span></span>

<span data-ttu-id="507d1-275">소프트웨어 에이전트는 metadata.json 파일을 검색하고 정보와 링크를 웹 페이지 또는 디렉터리의 템플릿에 게시할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-275">Software agents can retrieve the metadata.json file and publish the information and a link to the template in a web page or directory.</span></span> <span data-ttu-id="507d1-276">요소는 *itemDisplayName*, *description*, *summary*, *githubUsername* 및 *dateUpdated*를 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-276">Elements include *itemDisplayName*, *description*, *summary*, *githubUsername*, and *dateUpdated*.</span></span>

<span data-ttu-id="507d1-277">예제 파일 전체가 아래에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-277">An example file is shown below in its entirety.</span></span>

    {
        "itemDisplayName": "PostgreSQL 9.3 on Ubuntu VMs",
        "description": "This template creates a PostgreSQL streaming-replication between a master and one or more slave servers each with 2 striped data disks. The database servers are deployed into a private-only subnet with one publicly accessible jumpbox VM in a DMZ subnet with public IP.",
        "summary": "PostgreSQL stream-replication with multiple slave servers and a publicly accessible jumpbox VM",
        "githubUsername": "arsenvlad",
        "dateUpdated": "2015-04-24"
    }

### <a name="main-template"></a><span data-ttu-id="507d1-278">기본 템플릿</span><span class="sxs-lookup"><span data-stu-id="507d1-278">Main template</span></span>
<span data-ttu-id="507d1-279">기본 템플릿은 사용자로부터 매개 변수를 받아서 복잡한 개체 변수를 채우는 데 해당 정보를 사용하고 연결된 템플릿을 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-279">The main template receives parameters from a user, uses that information to populate complex object variables, and executes the linked templates.</span></span>

![기본 템플릿](./media/best-practices-resource-manager-design-templates/main-template.png)

<span data-ttu-id="507d1-281">**기본 템플릿은 사용자로부터 매개 변수를 받습니다.**</span><span class="sxs-lookup"><span data-stu-id="507d1-281">**The main template receives parameters from a user**</span></span>

<span data-ttu-id="507d1-282">제공되는 하나의 매개 변수는 대, 중, 소 같이 규격화된 값 때문에 티셔츠 크기 매개 변수로도 알려져 있는 구성 유형입니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-282">One parameter that is provided is a known configuration type also known as the t-shirt size parameter because of its standardized values such as small, medium, or large.</span></span> <span data-ttu-id="507d1-283">실제로 이 매개 변수를 여러 가지 방식으로 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-283">In practice, you can use this parameter in multiple ways.</span></span> <span data-ttu-id="507d1-284">자세한 내용은 이 문서의 뒷부분에서 “알려진 구성 리소스 템플릿"을 참조하십시오.</span><span class="sxs-lookup"><span data-stu-id="507d1-284">For details, see "Known configuration resources template" later in this document.</span></span>

<span data-ttu-id="507d1-285">일부 리소스는 사용자 매개 변수로 지정된 알려진 구성과 관계없이 배포됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-285">Some resources are deployed regardless of the known configuration specified by a user parameter.</span></span> <span data-ttu-id="507d1-286">이런 리소스는 단일 공유 리소스 템플릿을 사용하여 프로비전되고 다른 템플릿에서 공유되어 공유 리소스 템플릿이 먼저 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-286">These resources are provisioned using a single shared resource template and are shared by other templates, so the shared resource template is run first.</span></span>

<span data-ttu-id="507d1-287">일부 리소스는 지정된 알려진 구성에 관계없이 선택적으로 배포됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-287">Some resources are deployed optionally regardless of the specified known configuration.</span></span>

### <a name="shared-resources-template"></a><span data-ttu-id="507d1-288">공유 리소스 템플릿</span><span class="sxs-lookup"><span data-stu-id="507d1-288">Shared resources template</span></span>
<span data-ttu-id="507d1-289">이 템플릿은 알려진 모든 구성에 공통적인 리소스를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-289">This template delivers resources that are common across all known configurations.</span></span> <span data-ttu-id="507d1-290">가상 네트워크, 가용성 집합 및 배포되는 알려진 구성 템플릿과 관계없이 필요한 기타 리소스를 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-290">It contains the virtual network, availability sets, and other resources that are required regardless of the known configuration template that is deployed.</span></span>

![템플릿 리소스](./media/best-practices-resource-manager-design-templates/template-resources.png)

<span data-ttu-id="507d1-292">**공유 리소스 템플릿**</span><span class="sxs-lookup"><span data-stu-id="507d1-292">**Shared resources template**</span></span>

<span data-ttu-id="507d1-293">가상 네트워크 이름 같은 리소스 이름은 기본 템플릿을 기반으로 합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-293">Resource names, such as the virtual network name, are based on the main template.</span></span> <span data-ttu-id="507d1-294">조직의 요구에 따라서 해당 템플릿에 포함된 변수로 이름을 지정하거나 사용자로부터 매개 변수로 이름을 받을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-294">You can specify them as a variable within that template or receive them as a parameter from the user, as required by your organization.</span></span>

### <a name="optional-resources-template"></a><span data-ttu-id="507d1-295">선택적 리소스 템플릿</span><span class="sxs-lookup"><span data-stu-id="507d1-295">Optional resources template</span></span>
<span data-ttu-id="507d1-296">선택적 리소스 템플릿은 매개 변수 또는 변수의 값에 기반한 프로그래밍 방식으로 배포된 리소스를 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-296">The optional resources template contains resources that are programmatically deployed based on the value of a parameter or variable.</span></span>

![선택적 리소스](./media/best-practices-resource-manager-design-templates/optional-resources.png)

<span data-ttu-id="507d1-298">**선택적 리소스 템플릿**</span><span class="sxs-lookup"><span data-stu-id="507d1-298">**Optional resources template**</span></span>

<span data-ttu-id="507d1-299">예를 들어 선택적 리소스 템플릿을 사용하여 공용 인터넷에서 배포된 환경에 간접적인 액세스를 가능하게 하는 jumpbox를 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-299">For example, you can use an optional resources template to configure a jumpbox that enables indirect access to a deployed environment from the public Internet.</span></span> <span data-ttu-id="507d1-300">매개 변수 또는 변수를 사용하여 jumpbox 사용 여부를 확인하고 *concat* 함수를 사용하여 템플릿에 대한 대상 이름(예: *jumpbox_enabled.json*)을 빌드할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-300">You would use a parameter or variable to identify whether the jumpbox should be enabled and the *concat* function to build the target name for the template, such as *jumpbox_enabled.json*.</span></span> <span data-ttu-id="507d1-301">템플릿 연결은 jumpbox를 설치하기 위해 생성된 변수를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-301">Template linking would use the resulting variable to install the jumpbox.</span></span>

<span data-ttu-id="507d1-302">여러 위치에서 선택적 리소스 템플릿을 링크할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-302">You can link the optional resources template from multiple places:</span></span>

* <span data-ttu-id="507d1-303">모든 배포에 해당되는 경우 공유 리소스 템플릿에서 매개 변수 기반 링크를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-303">When applicable to every deployment, create a parameter-driven link from the shared resources template.</span></span>
* <span data-ttu-id="507d1-304">알려진 구성을 선택하는 경우에 해당되면(예를 들어 대형 배포에 설치하는 경우) 알려진 구성 템플릿으로부터 매개 변수 기반 또는 변수 기반 링크를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-304">When applicable to select known configurations—for example, only install on large deployments—create a parameter-driven or variable-driven link from the known configuration template.</span></span>

<span data-ttu-id="507d1-305">지정된 리소스가 선택적인 리소스가 될지 여부는 템플릿 소비자가 아닌 템플릿 공급자에 기반합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-305">Whether a given resource is optional may not be driven by the template consumer but instead by the template provider.</span></span> <span data-ttu-id="507d1-306">예를 들어 특정한 제품 요구 사항 또는 제품 추가 기능(CSV에 공통적인)을 충족해야 하거나 정책을 적용해야 하는 경우(SI 및 엔터프라이즈 IT 그룹에 일반적인)가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-306">For example, you may need to satisfy a particular product requirement or product add-on (common for CSVs) or to enforce policies (common for SIs and enterprise IT groups).</span></span> <span data-ttu-id="507d1-307">이런 경우 리소스 배포 여부를 확인하는 변수를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-307">In these cases, you can use a variable to identify whether the resource should be deployed.</span></span>

### <a name="known-configuration-resources-template"></a><span data-ttu-id="507d1-308">알려진 구성 리소스 템플릿</span><span class="sxs-lookup"><span data-stu-id="507d1-308">Known configuration resources template</span></span>
<span data-ttu-id="507d1-309">기본 템플릿에서 템플릿 소비자가 배포에 필요한 알려진 구성을 지정하도록 매개 변수를 노출할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-309">In the main template, a parameter can be exposed to allow the template consumer to specify a desired known configuration to deploy.</span></span> <span data-ttu-id="507d1-310">알려진 구성은 샌드박스, 대, 중, 소와 같은 고정된 구성 확장 집합으로 티셔츠 크기 접근 방식을 자주 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-310">Often, this known configuration uses a t-shirt size approach with a set of fixed configuration sizes such as sandbox, small, medium, and large.</span></span>

![알려진 구성 리소스](./media/best-practices-resource-manager-design-templates/known-config.png)

<span data-ttu-id="507d1-312">**알려진 구성 리소스 템플릿**</span><span class="sxs-lookup"><span data-stu-id="507d1-312">**Known configuration resources template**</span></span>

<span data-ttu-id="507d1-313">티셔츠 크기 접근 방식이 일반적으로 사용되지만 매개 변수는 알려진 모든 구성 집합을 나타낼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-313">The t-shirt size approach is commonly used, but the parameters can represent any set of known configurations.</span></span> <span data-ttu-id="507d1-314">예를 들어 개발, 테스트, 제품 같은 엔터프라이즈 응용 프로그램을 위한 환경 집합을 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-314">For example, you can specify a set of environments for an enterprise application such as Development, Test, and Product.</span></span> <span data-ttu-id="507d1-315">또는 클라우드 서비스에 대해 여러 가지 배율 단위, 제품 버전, 또는 커뮤니티, 개발자, 또는 엔터프라이즈 같은 제품 구성을 나타내도록 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-315">Or you could use it for a cloud service to represent different scale units, product versions, or product configurations such as Community, Developer, or Enterprise.</span></span>

<span data-ttu-id="507d1-316">공유 리소스 템플릿에서와 같이 변수는 아래 항목 중 하나로부터 알려진 구성 템플릿으로 전달됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-316">As with the shared resource template, variables are passed to the known configurations template from either:</span></span>

* <span data-ttu-id="507d1-317">최종 사용자—기본 템플릿에 전송되는 매개 변수</span><span class="sxs-lookup"><span data-stu-id="507d1-317">An end user—that is, the parameters sent to the main template.</span></span>
* <span data-ttu-id="507d1-318">조직—내부 요구 사항 또는 정책을 나타내는 기본 템플릿에 포함된 매개 변수</span><span class="sxs-lookup"><span data-stu-id="507d1-318">An organization—that is, the variables in the main template that represent internal requirements or policies.</span></span>

### <a name="member-resources-template"></a><span data-ttu-id="507d1-319">멤버 리소스 템플릿</span><span class="sxs-lookup"><span data-stu-id="507d1-319">Member resources template</span></span>
<span data-ttu-id="507d1-320">알려진 구성 내에는 하나 이상의 멤버 노드 유형이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-320">Within a known configuration, one or more member node types are often included.</span></span> <span data-ttu-id="507d1-321">예를 들어 Hadoop에 마스터 노드와 데이터 노드를 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-321">For example, with Hadoop you have master nodes and data nodes.</span></span> <span data-ttu-id="507d1-322">MongoDB를 설치하는 경우 데이터 노드와 중재자를 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-322">If you are installing MongoDB, you have data nodes and an arbiter.</span></span> <span data-ttu-id="507d1-323">DataStax를 배포하는 경우 데이터 노드는 물론 OpsCenter가 설치된 VM을 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-323">If you are deploying DataStax, you have data nodes and a VM with OpsCenter installed.</span></span>

![멤버 리소스](./media/best-practices-resource-manager-design-templates/member-resources.png)

<span data-ttu-id="507d1-325">**멤버 리소스 템플릿**</span><span class="sxs-lookup"><span data-stu-id="507d1-325">**Member resources template**</span></span>

<span data-ttu-id="507d1-326">각 노드 유형은 크기가 다른 VM, 다수의 연결된 디스크, 노드를 설치하고 설정할 스크립트, VM에 대한 포트 구성, 다수의 인스턴스 및 기타 세부 사항을 포함할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-326">Each type of nodes can have different sizes of VMs, numbers of attached disks, scripts to install and set up the nodes, port configurations for the VMs, number of instances, and other details.</span></span> <span data-ttu-id="507d1-327">따라서 각 노드 유형은 인프라 배포 및 구성에 대한 세부 사항은 물론 VM 내에서 소프트웨어를 배포 및 구성하기 위한 실행 스크립트를 포함하는 고유의 멤버 리소스 템플릿을 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-327">So each node type gets its own member resource template, which contains the details for deploying and configuring an infrastructure as well as executing scripts to deploy and configure software within the VM.</span></span>

<span data-ttu-id="507d1-328">VM의 경우 일반적으로 두 가지 유형의 스크립트(광범위한 재사용이 가능한 스크립트와 사용자 지정 스크립트)가 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-328">For VMs, typically two types of scripts are used, widely reusable and custom scripts.</span></span>

### <a name="widely-reusable-scripts"></a><span data-ttu-id="507d1-329">광범위한 재사용이 가능한 스크립트</span><span class="sxs-lookup"><span data-stu-id="507d1-329">Widely reusable scripts</span></span>
<span data-ttu-id="507d1-330">광범위한 재사용이 가능한 스크립트는 여러 가지 유형의 템플릿에서 사용될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-330">Widely reusable scripts can be used across multiple types of templates.</span></span> <span data-ttu-id="507d1-331">광범위한 재사용이 가능한 스크립트의 좋은 예 중 하나는 디스크를 풀링하고 더 많은 IOPS를 확보하기 위해 Linux에서 RAID를 설정하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-331">One of the better examples of these widely reusable scripts sets up RAID on Linux to pool disks and gain a greater number of IOPS.</span></span> <span data-ttu-id="507d1-332">VM에 설치되는 소프트웨어와 관계없이 이 스크립트는 공통 시나리오에 대해 검증된 작업 방식의 재사용을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-332">Regardless of the software being installed in the VM, this script provides reuse of proven practices for common scenarios.</span></span>

![재사용이 가능한 스크립트](./media/best-practices-resource-manager-design-templates/reusable-scripts.png)

<span data-ttu-id="507d1-334">**멤버 리소스 템플릿은 광범위한 재사용이 가능한 스크립트를 호출할 수 있습니다.**</span><span class="sxs-lookup"><span data-stu-id="507d1-334">**Member resources templates can call widely reusable scripts**</span></span>

### <a name="custom-scripts"></a><span data-ttu-id="507d1-335">사용자 지정 스크립트</span><span class="sxs-lookup"><span data-stu-id="507d1-335">Custom scripts</span></span>
<span data-ttu-id="507d1-336">템플릿은 일반적으로 VM 내에 소프트웨어를 설치 및 구성하는 스크립트를 하나 이상 호출합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-336">Templates commonly call one or more scripts that install and configure software within VMs.</span></span> <span data-ttu-id="507d1-337">하나 이상의 멤버 유형의 여러 인스턴스가 배포되는 큰 토폴로지에서 일반적인 패턴이 보입니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-337">A common pattern is seen with large topologies where multiple instances of one or more member types are deployed.</span></span> <span data-ttu-id="507d1-338">설치 스크립트가 병렬 실행이 가능한 모든 VM에 대해 시작되고 모든 VM(또는 지정된 멤버 유형의 모든 VM)이 배포된 후에 호출되는 설정 스크립트가 그 뒤를 따릅니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-338">An installation script is initiated for every VM that can be run in parallel, followed by a setup script that is called after all VMs (or all VMs of a given member type) are deployed.</span></span>

![사용자 지정 스크립트](./media/best-practices-resource-manager-design-templates/custom-scripts.png)

<span data-ttu-id="507d1-340">**멤버 리소스 템플릿은 VM 구성 같은 특정 목적을 위한 스크립트를 호출할 수 있습니다.**</span><span class="sxs-lookup"><span data-stu-id="507d1-340">**Member resources templates can call scripts for a specific purpose such as VM configuration**</span></span>

## <a name="capability-scoped-solution-template-example---redis"></a><span data-ttu-id="507d1-341">기능 범위 솔루션 템플릿 예 - Redis</span><span class="sxs-lookup"><span data-stu-id="507d1-341">Capability-scoped solution template example - Redis</span></span>
<span data-ttu-id="507d1-342">구현의 작동 원리를 보기 위해 표준 티셔츠 크기로 Redis의 배포 및 구성에 도움이 되는 템플릿을 빌드하는 실례를 살펴보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-342">To show how an implementation might work, let's look at a practical example of building a template that facilitates the deployment and configuration of Redis in standard t-shirt sizes.</span></span>  

<span data-ttu-id="507d1-343">배포에 대해 공유 리소스 집합(가상 네트워크, 저장소 계정, 가용성 집합)과 선택적 리소스(jumpbox)가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-343">For the deployment, there are a set of shared resources (virtual network, storage account, availability sets) and an optional resource (jumpbox).</span></span> <span data-ttu-id="507d1-344">티셔츠 크기(대, 중, 소)로 표시되지만 각각 단일 노드 유형을 포함하는 여러 개의 알려진 구성이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-344">There are multiple known configurations represented as t-shirt sizes (small, medium, large) but each with a single node type.</span></span> <span data-ttu-id="507d1-345">또한 특정 목적에 따른 스크립트(설치, 구성)가 두 개 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-345">There are also two purpose-specific scripts (installation, configuration).</span></span>

### <a name="creating-the-template-files"></a><span data-ttu-id="507d1-346">템플릿 파일 만들기</span><span class="sxs-lookup"><span data-stu-id="507d1-346">Creating the template files</span></span>
<span data-ttu-id="507d1-347">이름이 azuredeploy.json인 기본 템플릿을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-347">You would create a Main Template named azuredeploy.json.</span></span>

<span data-ttu-id="507d1-348">이름이 shared-resources.json인 공유 리소스 템플릿을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-348">You create Shared Resources Template named shared-resources.json</span></span>

<span data-ttu-id="507d1-349">이름이 jumpbox_enabled.json인 jumpbox를 배포할 수 있도록 선택적 리소스 템플릿을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-349">You create an Optional Resource Template to enable the deployment of a jumpbox, named jumpbox_enabled.json</span></span>

<span data-ttu-id="507d1-350">Redis는 단일 노드 유형만을 사용하므로 이름이 node-resources.json인 단일 멤버 리소스 템플릿을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-350">Redis uses just a single node type, so you create a single Member Resource Template named node-resources.json.</span></span>

<span data-ttu-id="507d1-351">Redis를 사용하여 각각의 개별 노드를 설치한 후 클러스터를 설정하려고 합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-351">With Redis, you want to install each individual node, and then set up the cluster.</span></span>  <span data-ttu-id="507d1-352">설치 및 설정을 수용할 스크립트가 있습니다(redis-cluster-install.sh 및 redis-cluster-setup.sh).</span><span class="sxs-lookup"><span data-stu-id="507d1-352">You have scripts to accommodate the installation and set up, redis-cluster-install.sh and redis-cluster-setup.sh.</span></span>

### <a name="linking-the-templates"></a><span data-ttu-id="507d1-353">템플릿 연결</span><span class="sxs-lookup"><span data-stu-id="507d1-353">Linking the templates</span></span>
<span data-ttu-id="507d1-354">기본 템플릿은 템플릿 연결을 사용하여 공유 리소스 템플릿으로 연결하고 이를 통해 가상 네트워크가 수립됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-354">Using template linking, the main template links out to the shared resources template, which establishes the virtual network.</span></span>

<span data-ttu-id="507d1-355">jumpbox 배포 여부를 템플릿 소비자가 지정할 수 있도록 기본 템플릿 내에 논리가 추가됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-355">Logic is added within the main template to enable consumers of the template to specify whether a jumpbox should be deployed.</span></span> <span data-ttu-id="507d1-356">*EnableJumpbox* 매개 변수에 *enabled* 값을 설정하면 고객이 jumpbox 배포를 원한다는 것을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-356">An *enabled* value for the *EnableJumpbox* parameter indicates that the customer wants to deploy a jumpbox.</span></span> <span data-ttu-id="507d1-357">이 값이 제공되면 템플릿은 jumpbox 기능에 대한 기본 템플릿 이름에 *_enabled*를 접미사로 연결합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-357">When this value is provided, the template concatenates *_enabled* as a suffix to a base template name for the jumpbox capability.</span></span>

<span data-ttu-id="507d1-358">기본 템플릿은 티셔츠 크기에 대한 기본 템플릿 이름에 대한 접미사로 *large* 매개 변수 값을 적용한 후 *technology_on_os_large.json*에 대한 템플릿 링크에 해당 값을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-358">The main template applies the *large* parameter value as a suffix to a base template name for t-shirt sizes, and then uses that value in a template link out to *technology_on_os_large.json*.</span></span>

<span data-ttu-id="507d1-359">토폴로지는 이러한 예시와 유사합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-359">The topology would resemble this illustration.</span></span>

![Redis 템플릿](./media/best-practices-resource-manager-design-templates/redis-template.png)

<span data-ttu-id="507d1-361">**Redis 템플릿에 대한 템플릿 구조**</span><span class="sxs-lookup"><span data-stu-id="507d1-361">**Template structure for a Redis template**</span></span>

### <a name="configuring-state"></a><span data-ttu-id="507d1-362">구성 상태</span><span class="sxs-lookup"><span data-stu-id="507d1-362">Configuring state</span></span>
<span data-ttu-id="507d1-363">클러스터의 노드에는 상태를 구성하는 두 가지 단계가 있으며 양쪽 모두 특정 목적에 따른 스크립트로 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-363">For the nodes in the cluster, there are two steps to configuring the state, both represented by Purpose Specific Scripts.</span></span>  <span data-ttu-id="507d1-364">“redis-cluster-install.sh”는 Redis를 설치하고 “redis-cluster-setup.sh”는 클러스터를 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-364">"redis-cluster-install.sh" installs Redis and "redis-cluster-setup.sh" sets up the cluster.</span></span>

### <a name="supporting-different-size-deployments"></a><span data-ttu-id="507d1-365">갖가지 크기의 배포 지원</span><span class="sxs-lookup"><span data-stu-id="507d1-365">Supporting Different Size Deployments</span></span>
<span data-ttu-id="507d1-366">변수 내에서 티셔츠 크기 템플릿은 지정된 크기(*large*)로 배포할 각 유형의 노드 수를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-366">Inside variables, the t-shirt size template specifies the number of nodes of each type to deploy for the specified size (*large*).</span></span> <span data-ttu-id="507d1-367">그런 다음 리소스 루프를 사용하여 VM 인스턴스를 해당되는 수만큼 배포하고 *copyIndex()*로부터 숫자형 시퀀스 번호를 노드 이름에 추가하여 리소스에 고유한 이름을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-367">It then deploys that number of VM instances using resource loops, providing unique names to resources by appending a node name with a numeric sequence number from *copyIndex()*.</span></span> <span data-ttu-id="507d1-368">티셔츠 이름 템플릿에 정의된 바와 같이 핫 존과 웜 존 모두에 대해 이 단계를 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-368">It does these steps for both hot and warm zone VMs, as defined in the t-shirt name template</span></span>

## <a name="decomposition-and-end-to-end-solution-scoped-templates"></a><span data-ttu-id="507d1-369">분해 및 종단간 솔루션 범위 템플릿</span><span class="sxs-lookup"><span data-stu-id="507d1-369">Decomposition and end-to-end solution scoped templates</span></span>
<span data-ttu-id="507d1-370">종단간 솔루션 범위를 포함하는 솔루션 템플릿은 종단간 솔루션을 제공하는데 중점을 둡니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-370">A solution template with an end-to-end solution scope is focused on delivering an end-to-end solution.</span></span>  <span data-ttu-id="507d1-371">일반적으로 이 접근 방식은 추가적인 리소스, 논리 및 상태를 포함하는 복수의 기능 범위 템플릿의 컴퍼지션입니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-371">This approach is typically a composition of multiple capability-scoped templates with additional resources, logic, and state.</span></span>

<span data-ttu-id="507d1-372">아래 이미지의 강조 표시와 같이 기능 범위 템플릿에 사용되는 동일한 모델이 종단간 솔루션 범위를 포함하는 템플릿에 대해 확장됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-372">As highlighted in the image below, the same model used for capability scoped templates is extended for templates with an End-to-End Solution Scope.</span></span>

<span data-ttu-id="507d1-373">공유 리소스 템플릿 및 선택적 리소스 템플릿은 용량 및 기능 범위 템플릿 접근 방식과 동일한 기능을 제공하지만 종단간 솔루션에 대해 범위가 지정됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-373">A Shared Resources Template and Optional Resources Templates serve the same function as in the capacity and capability scoped template approaches, but are scoped for the end to end solution.</span></span>

<span data-ttu-id="507d1-374">종단간 솔루션 범위 템플릿 역시 티셔츠 크기를 포함할 수 있듯이, 알려진 구성 리소스 템플릿은 솔루션에 지정된 알려진 구성에 무엇이 필요한지를 반영합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-374">As end to end solution scoped templates also can typically have t-shirt sizes, the Known Configuration Resources template reflects what is required for a given known configuration of the solution.</span></span>

<span data-ttu-id="507d1-375">알려진 구성 리소스 템플릿은 종단간 솔루션과 관련된 하나 이상의 기능 범위 솔루션 템플릿은 물론 종단간 솔루션에 필요한 멤버 리소스 템플릿에 연결됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-375">The Known Configuration Resources Template links to one or more capability scoped solution templates that are relevant to the end to end solution as well as the Member Resource Templates that are required for the end to end solution.</span></span>

<span data-ttu-id="507d1-376">솔루션의 티셔츠 크기는 개별적인 기능 범위 템플릿의 그것과 다를 수 있으며 알려진 구성 리소스 템플릿에 포함된 변수는 적절한 티셔츠 크기를 배포하기 위하여 다운스트림 기능 범위 솔루션 템플릿에 적절한 값을 제공하기 위해 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-376">As the t-shirt size of the solution may be different than the individual capability-scoped template, variables within the Known Configuration Resources Template are used to provide the appropriate values for downstream capability scoped solution templates to deploy the appropriate t-shirt size.</span></span>

![종단간](./media/best-practices-resource-manager-design-templates/end-to-end.png)

<span data-ttu-id="507d1-378">**용량 또는 기능 범위 솔루션 템플릿에 사용되는 모델은 종단간 솔루션 템플릿 범위에 대해 즉시 확장될 수 있습니다.**</span><span class="sxs-lookup"><span data-stu-id="507d1-378">**The model used for capacity or capability scoped solution templates can be readily extended for end to end solution template scopes**</span></span>

## <a name="preparing-templates-for-the-marketplace"></a><span data-ttu-id="507d1-379">마켓플레이스에 대한 템플릿 준비</span><span class="sxs-lookup"><span data-stu-id="507d1-379">Preparing templates for the Marketplace</span></span>
<span data-ttu-id="507d1-380">앞의 접근 방식은 엔터프라이즈, SI, CSV가 직접 템플릿을 배포하거나 고객이 스스로 배포하도록 만드는 시나리오를 쉽게 수용합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-380">The preceding approach readily accommodates scenarios where Enterprises, SIs, and CSVs want to either deploy the templates themselves or enable their customers to deploy on their own.</span></span>

<span data-ttu-id="507d1-381">여기서 더 필요한 시나리오는 마켓플레이스를 통해 템플릿을 배포하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-381">Another desired scenario is deploying a template via the marketplace.</span></span>  <span data-ttu-id="507d1-382">이러한 분해 접근 방식은 마켓플레이스는 물론 일부 경미한 변경이 있는 경우에 유용합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-382">This decomposition approach works for the marketplace as well, with some minor changes.</span></span>

<span data-ttu-id="507d1-383">이전에 설명했지만 템플릿은 마켓플레이스에서 판매를 위한 고유 배포 유형을 제공하는데 사용될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-383">As mentioned previously, templates can be used to offer distinct deployment types for sale in the marketplace.</span></span> <span data-ttu-id="507d1-384">고유 배포 유형은 티셔츠 크기(대, 중, 소), 제품/대상 그룹 유형(커뮤니티, 개발자, 엔터프라이즈) 또는 기능 유형(기본, 고가용성)이 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-384">Distinct deployment types may be t-shirt sizes (small, medium, large), product/audience type (community, developer, enterprise), or feature type (basic, high availability).</span></span>

<span data-ttu-id="507d1-385">아래 표시된 것처럼 기존의 종단간 솔루션 또는 기능 범위 템플릿은 마켓플레이스에서 갖가지 알려진 구성을 나열하기 위해 즉시 활용될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-385">As shown below, the existing end to end solution or capability scoped templates can be readily utilized to list the different known configurations in the marketplace.</span></span>

<span data-ttu-id="507d1-386">기본 템플릿에 대한 매개 변수는 우선 이름이 tshirtSize인 인바운드 매개 변수를 제거하기 위해 수정됩니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-386">The parameters to the main template are first modified to remove the inbound parameter named tshirtSize.</span></span>

<span data-ttu-id="507d1-387">고유의 배포 유형이 알려진 구성 리소스 템플릿에 매핑되는 동안 공유 리소스 템플릿에 있는 공통 리소스 및 구성이 필요하며 선택적 리소스 템플릿에 포함된 구성이 잠재적으로 필요할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-387">While the distinct deployment types map to the Known Configuration Resources Template, they also need the common resources and configuration found in the Shared Resources Template and potentially those in Optional Resource Templates.</span></span>

<span data-ttu-id="507d1-388">마켓플레이스에 템플릿을 게시하려면 템플릿에 포함된 변수에 대해 이전에 사용이 가능했던 tshirtSize의 인바운드 매개 변수를 대체하는 기본 템플릿의 사본을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="507d1-388">If you want to publish your template to the marketplace, you establish distinct copies of your Main template that replaces the previously available inbound parameter of tshirtSize to a variable embedded within the template.</span></span>

![마켓플레이스](./media/best-practices-resource-manager-design-templates/marketplace.png)

<span data-ttu-id="507d1-390">**마켓플레이스에 대해 솔루션 범위 템플릿 조정**</span><span class="sxs-lookup"><span data-stu-id="507d1-390">**Adapting a solution scoped template for the marketplace**</span></span>

## <a name="next-steps"></a><span data-ttu-id="507d1-391">다음 단계</span><span class="sxs-lookup"><span data-stu-id="507d1-391">Next steps</span></span>
* <span data-ttu-id="507d1-392">템플릿 내부 및 외부로 상태를 공유하는 방법을 알아보려면 [Azure 리소스 관리자 템플릿에서 상태 공유](best-practices-resource-manager-state.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="507d1-392">To learn about sharing state into and out of templates, see [Sharing state in Azure Resource Manager templates](best-practices-resource-manager-state.md).</span></span>
* <span data-ttu-id="507d1-393">엔터프라이즈에서 리소스 관리자를 사용하여 구독을 효과적으로 관리할 수 있는 방법에 대한 지침은 [Azure 엔터프라이즈 스캐폴드 - 규범적 구독 거버넌스](resource-manager-subscription-governance.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="507d1-393">For guidance on how enterprises can use Resource Manager to effectively manage subscriptions, see [Azure enterprise scaffold - prescriptive subscription governance](resource-manager-subscription-governance.md).</span></span>

