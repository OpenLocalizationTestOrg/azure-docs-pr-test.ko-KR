---
title: "Azure SQL Database를 사용하여 항상 사용 가능한 서비스 디자인 | Microsoft Docs"
description: "Azure SQL Database를 사용하여 항상 사용 가능한 서비스를 위한 응용 프로그램 디자인에 대해 알아봅니다."
keywords: "클라우드 재해 복구, 재해 복구 솔루션, 앱 데이터 백업, 지역에서 복제, 무중단 업무 방식 계획"
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: e8a346ac-dd08-41e7-9685-46cebca04582
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: data-management
ms.date: 04/21/2017
ms.author: sashan
ms.openlocfilehash: 40fe0ae04eb94322356ed19773512e3bc383639c
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/11/2017
---
# <a name="designing-highly-available-services-using-azure-sql-database"></a>Azure SQL Database를 사용하여 항상 사용 가능한 서비스 디자인

Azure SQL Database에서 항상 사용 가능한 서비스를 빌드하고 배포하는 경우 [장애 조치 그룹 및 활성 지역 복제](sql-database-geo-replication-overview.md)를 사용하여 지역 오류 및 심각한 서비스 중단에 대한 복원 기능을 제공하고 보조 데이터베이스에 대한 빠른 복구를 사용하도록 설정합니다. 이 문서에서는 일반적인 응용 프로그램 패턴에 초점을 맞추고, 응용 프로그램 배포 요구 사항, 대상 서비스 수준 약정, 트래픽 대기 시간 및 비용에 따라 각 옵션의 장단점에 대해 설명합니다. 탄력적 풀의 활성 지역 복제에 대한 자세한 내용은 [탄력적 풀 재해 복구 전략](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md)을 참조하세요.

## <a name="design-pattern-1-active-passive-deployment-for-cloud-disaster-recovery-with-a-co-located-database"></a>디자인 패턴 1: 함께 배치된 데이터베이스와 클라우드 재해 복구에 대한 활성-수동 배포
이 옵션은 다음 특성을 가진 응용 프로그램에 가장 적합합니다.

* 단일 Azure 지역의 활성 인스턴스
* 데이터에 대한 읽기-쓰기(RW) 액세스의 강력한 종속성
* 대기 시간 및 트래픽 비용으로 인해 허용되지 않는 웹 응용 프로그램과 데이터베이스의 지역 간 연결    

이 경우 응용 프로그램 배포 토폴로지는 모든 응용 프로그램 구성 요소가 영향을 받고 하나의 단위로 장애 조치해야 할 때 지역 재해를 처리하기 위해 최적화됩니다. 지리적 중복성을 위해 응용 프로그램 논리와 데이터베이스 모두는 다른 지역에 복제되지만 정상 조건에서는 응용 프로그램 워크로드에 사용되지 않습니다. 보조 지역의 응용 프로그램은 보조 데이터베이스에 대해 SQL 연결 문자열을 사용하도록 구성되어야 합니다. 트래픽 관리자는 [장애 조치 라우팅 메서드](../traffic-manager/traffic-manager-configure-failover-routing-method.md)를 사용하도록 설정됩니다.  

> [!NOTE]
> [Azure Traffic Manager](../traffic-manager/traffic-manager-overview.md)는 이 문서 전체에서 설명을 위한 용도로만 사용됩니다. 장애 조치(failover) 라우팅 메서드를 지원하는 모든 부하 분산 솔루션을 사용할 수 있습니다.    
>

다음 다이어그램은 작동 중단 전의 이 구성을 보여 줍니다.

![SQL Database 지역에서 복제 구성 클라우드 재해 복구](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-1.png)

주 지역에서 가동 중단된 후 SQL Database 서비스는 주 데이터베이스에 액세스할 수 없음을 검색하여 자동 장애 조치 정책의 매개 변수를 기반으로 하여 보조 데이터베이스로 장애 조치를 트리거합니다. 응용 프로그램 SLA에 따라 가동 중단 감지와 장애 조치 자체 사이의 유예 기간을 구성하도록 결정할 수 있습니다. 유예 기간을 구성하면 가동 중단이 치명적이며 해당 지역의 가용성을 빠르게 복원할 수 없을 때 데이터 손실 위험을 줄입니다. 장애 조치 그룹에서 데이터베이스 장애 조치를 트리거하기 전에 Traffic Manager에서 끝점 장애 조치를 시작하면 웹 응용 프로그램이 데이터베이스에 다시 연결할 수 없게 됩니다. 데이터베이스 장애 조치가 완료되는 즉시 응용 프로그램에서 다시 연결하려는 시도가 자동으로 성공합니다. 

> [!NOTE]
> 응용 프로그램과 데이터베이스에 대해 완벽하게 조정된 장애 조치를 수행하려면, 자체 모니터링 방법을 직접 고안하고 웹 응용 프로그램 끝점과 데이터베이스에 대한 수동 장애 조치를 사용해야 합니다.
>

응용 프로그램의 끝점과 데이터베이스의 장애 조치가 완료되면, 응용 프로그램은 지역 B에서 사용자 요청 처리를 다시 시작하고, 주 데이터베이스가 현재 지역 B에 있기 때문에 데이터베이스와 함께 동일한 위치에서 유지됩니다. 이 시나리오는 다음 다이어그램에서 보여 줍니다. 모든 다이어그램에서 실선은 활성 연결을 나타내고, 점선은 일시 중단된 연결을 나타내며, 중지 기호는 작업 트리거를 나타냅니다.

![지역에서 복제: 보조 데이터베이스로 장애 조치 앱 데이터 백업](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-2.png)

보조 지역에서 가동 중단이 발생하는 경우 주 데이터베이스와 보조 데이터베이스 간의 복제 링크가 일시 중단되지만, 주 데이터베이스가 영향을 받지 않으므로 장애 조치는 트리거되지 않습니다. 이 경우 응용 프로그램의 가용성은 변경되지 않지만, 두 지역이 연속적으로 실패할 경우 응용 프로그램이 노출된 상태로 작동하므로 위험이 더 높아집니다.

> [!NOTE]
> 재해 복구의 경우 응용 프로그램 배포를 두 지역으로 제한하여 구성하는 것이 좋습니다. 대부분의 경우 Azure 지역이 두 개뿐이기 때문입니다. 이 구성은 두 영역에서 동시에 발생하는 치명적인 오류로부터 응용 프로그램을 보호하지 않습니다.  이러한 발생 가능성이 없는 실패 시 [지리적 복원 작업](sql-database-disaster-recovery.md#recover-using-geo-restore)을 사용하여 세 번째 지역에서 데이터베이스를 복구할 수 있습니다.
>

가동 중단이 완화되면 보조 데이터베이스가 주 데이터베이스와 자동으로 다시 동기화됩니다. 동기화하는 동안 주 데이터베이스의 성능은 동기화되어야 하는 데이터의 양에 따라 약간 영향을 받을 수 있습니다. 다음 다이어그램은 보조 지역의 작동 중단을 보여 줍니다.

![주 데이터베이스와 동기화된 보조 데이터베이스 클라우드 재해 복구](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-3.png)

이 설계 패턴의 주요 **장점** 은 다음과 같습니다.

* 동일한 웹 응용 프로그램은 모든 지역 관련 구성 및 장애 조치에 반응하는 추가 논리가 없이 두 지역 모두에 배포됩니다. 
* 웹 응용 프로그램과 데이터베이스가 항상 동일한 위치에 배치되므로 응용 프로그램의 성능은 장애 조치의 영향을 받지 않습니다.

보조 지역의 중복 응용 프로그램 인스턴스인 주 **절충** 은 재해 복구를 위해서만 사용됩니다.

## <a name="design-pattern-2-active-active-deployment-for-application-load-balancing"></a>디자인 패턴 2: 응용 프로그램 부하 분산에 대한 활성-활성 배포
이 클라우드 재해 복구 옵션은 다음 특성을 가진 응용 프로그램에 가장 적합합니다.

* 높은 비율의 데이터베이스 읽기 및 쓰기
* 최종 사용자 환경에서 데이터베이스 읽기 대기 시간은 쓰기 대기 시간보다 더 중요합니다. 
* 읽기 전용 논리가 다른 연결 문자열을 사용하여 읽기-쓰기 논리에서 분리될 수 있음
* 읽기 전용 논리가 최신 업데이트를 통해 완전하게 동기화되는 데이터에 의존하지 않음  

응용 프로그램에 이러한 특성이 있는 경우 다른 지역의 여러 응용 프로그램 인스턴스에서 최종 사용자 연결의 부하를 분산하면 전반적인 최종 사용자 환경이 크게 향상될 수 있습니다. 지역 중 두 개를 DR 쌍으로 선택하고 장애 조치 그룹은 이러한 지역에 데이터베이스를 포함해야 합니다. 부하 분산을 구현하려면 읽기-쓰기(RW) 논리가 장애 조치 그룹의 읽기-쓰기 수신기 끝점에 연결된 응용 프로그램의 활성 인스턴스가 각 지역에 있어야 합니다. 주 데이터베이스가 가동 중단으로 영향을 받는 경우 장애 조치가 자동으로 시작되도록 보장합니다. 웹 응용 프로그램의 읽기 전용 논리(RO)는 해당 지역의 데이터베이스에 직접 연결해야 합니다. 트래픽 관리자는 각 응용 프로그램 인스턴스에 대해 [끝점 모니터링](../traffic-manager/traffic-manager-monitoring.md)을 활성화하는 [성능 라우팅](../traffic-manager/traffic-manager-configure-performance-routing-method.md)을 사용하도록 설정되어야 합니다.

패턴 #1에서와 같이 유사한 모니터링 응용 프로그램 배포를 고려해야 합니다. 하지만 패턴 #1과 달리, 모니터링 응용 프로그램은 끝점 장애 조치 트리거에 대한 책임이 없습니다.

> [!NOTE]
> 이 패턴은 둘 이상의 보조 데이터베이스를 사용하지만, 장애 조치에는 지역 B의 보조 데이터베이스만 사용되며 장애 조치 그룹의 일부여야 합니다.
>

트래픽 관리자는 사용자의 지리적 위치에 가장 가까운 응용 프로그램 인스턴스에 대한 사용자 직접 연결에 성능 라우팅을 위해 구성되어야 합니다. 다음 다이어그램은 작동 중단 전의 이 구성을 보여 줍니다.

![가동 중단 없음: 가장 가까운 응용 프로그램으로 라우팅하는 성능입니다. 지역에서 복제](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-1.png)

지역 A의 데이터베이스 가동 중단이 검색되면 장애 조치 그룹은 지역 A의 주 데이터베이스에서 지역 B의 보조 데이터베이스로의 장애 조치를 자동으로 시작합니다. 또한 읽기-쓰기 수신기 끝점을 지역 B로 자동 업데이트하여 웹 응용 프로그램의 읽기-쓰기 연결에 영향을 주지 않습니다. 트래픽 관리자는 라우팅 테이블에서 오프라인 끝점을 제외하지만 최종 사용자 트래픽은 나머지 온라인 인스턴스로 계속 라우팅됩니다. 읽기 전용 SQL 연결 문자열은 항상 동일한 지역의 데이터베이스를 가리키므로 영향을 받지 않습니다. 

다음 다이어그램은 장애 조치 후 새 구성을 보여 줍니다.

![장애 조치 후 구성 클라우드 재해 복구](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-2.png)

보조 지역 중 한 곳에서 가동 중단이 발생하면 트래픽 관리자는 라우팅 테이블에서 해당 지역의 오프라인 끝점을 자동으로 제거합니다. 해당 지역의 보조 데이터베이스에 대한 복제 채널이 일시 중단됩니다. 이 시나리오에서 나머지 지역은 추가 사용자 트래픽을 받으므로 가동 중단 동안 응용 프로그램의 성능에 영향을 줍니다. 가동 중단이 완화되면 영향을 받은 지역의 보조 데이터베이스가 주 데이터베이스와 즉시 동기화됩니다. 동기화하는 동안 동기화해야 하는 데이터의 양에 따라 주 데이터베이스의 성능이 약간 영향을 받을 수 있습니다. 다음 다이어그램에서는 지역 B의 가동 중단을 보여 줍니다.

![보조 지역에서 중단 클라우드 재해 복구 - 지역에서 복제](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-3.png)

이 디자인 패턴의 주요 **장점** 은 여러 보조 데이터베이스에서 응용 프로그램 워크로드를 확장하여 최적의 최종 사용자 성능을 얻을 수 있는 것입니다. 이 옵션의 **장단점** 은 다음과 같습니다.

* 응용 프로그램 인스턴스 및 데이터베이스 간의 읽기-쓰기 연결에는 다양한 대기 시간 및 비용이 있음
* 작동 중단 동안 응용 프로그램 성능이 저하됨

> [!NOTE]
> 작업 보고, 비즈니스 인텔리전스 도구 또는 백업과 같은 특수한 워크로드를 오프로드하는데 유사한 방법을 사용할 수 있습니다. 일반적으로 이러한 워크로드는 상당한 데이터베이스 리소스를 소비하므로 예상된 워크로드와 일치하는 성능 수준으로 보조 데이터베이스 중 하나를 지정하는 것이 좋습니다.
>

## <a name="design-pattern-3-active-passive-deployment-for-data-preservation"></a>디자인 패턴 3: 데이터 보존에 대한 활성-수동 배포
이 옵션은 다음 특성을 가진 응용 프로그램에 가장 적합합니다.

* 어떤 경우든 데이터 손실은 비즈니스에 큰 위험이 됩니다. 가동 중단이 치명적인 경우 데이터베이스 장애 조치는 최후의 수단으로만 사용할 수 있습니다.
* 응용 프로그램에서 작업의 읽기 전용 및 읽기-쓰기 모드를 지원하며, 일정 기간 동안 "읽기 전용 모드"에서 작동할 수 있습니다.

이 패턴에서 읽기-쓰기 연결에 대한 시간 제한 오류가 발생하기 시작하면 응용 프로그램이 읽기 전용 모드로 전환됩니다. 웹 응용 프로그램은 두 지역 모두에 배포되며, 읽기-쓰기 수신기 끝점에 대한 연결과 읽기 전용 수신기 끝점에 대한 다른 연결을 포함합니다. 트래픽 관리자는 각 지역의 응용 프로그램 인스턴스에 대해 [끝점 모니터링](../traffic-manager/traffic-manager-monitoring.md)을 활성화하는 [장애 조치 라우팅](../traffic-manager/traffic-manager-configure-failover-routing-method.md)을 사용하도록 설정되어야 합니다.

다음 다이어그램은 작동 중단 전의 이 구성을 보여 줍니다.

![장애 조치 전 활성-수동 배포 클라우드 재해 복구](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-1.png)

트래픽 관리자에서 지역 A에 대한 연결 장애를 검색하면 사용자 트래픽을 지역 B의 응용 프로그램 인스턴스로 자동 전환합니다. 이 패턴을 사용하면 데이터 손실이 있는 유예 기간을 충분히 높은 값(예: 24시간)으로 설정하는 것이 중요합니다. 이 시간 내에 가동 중단이 완화되면 데이터 손실이 방지됩니다. 지역 B의 웹 응용 프로그램이 활성화되면 읽기-쓰기 작업이 실패하기 시작합니다. 이 시점에서 읽기 전용 모드로 전환해야 합니다. 이 모드에서는 요청이 자동으로 보조 데이터베이스로 라우팅됩니다. 치명적인 장애가 발생하는 경우 유예 기간 내에 장애 조치가 완화되지 않으며 장애 조치 그룹에서 장애 조치를 트리거합니다. 그러면 읽기-쓰기 수신기를 사용할 수 있게 되고 이 수신기에 대한 호출 실패가 중지됩니다. 이 내용은 다음 다이어그램에서 설명됩니다.

![작동 중단: 읽기 전용 모드의 응용 프로그램 클라우드 재해 복구](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-2.png)

주 지역의 가동 중단이 유예 기간 내에 완화되면 트래픽 관리자에서 주 지역의 연결 복원을 검색하고 사용자 트래픽을 지역 A의 응용 프로그램 인스턴스로 다시 전환합니다. 해당 응용 프로그램 인스턴스는 지역 A의 주 데이터베이스를 사용하여 읽기-쓰기 모드에서 다시 시작되어 작동합니다.

지역 B에서 가동 중단이 발생하면 Traffic Manager에서 지역 B의 응용 프로그램 끝점 장애를 검색하고 장애 조치 그룹에서 읽기 전용 수신기를 지역 A로 전환합니다. 이 가동 중단은 최종 사용자 환경에 영향을 주지 않지만 가동 중단 발생 시 주 데이터베이스가 노출됩니다. 이 내용은 다음 다이어그램에서 설명됩니다.

![중단: 보조 데이터베이스 클라우드 재해 복구](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-3.png)

가동 중단이 완화되면 보조 데이터베이스는 즉시 주 데이터베이스와 동기화되고, 읽기 전용 수신기는 지역 B의 보조 데이터베이스로 다시 전환됩니다. 동기화하는 동안 동기화해야 하는 데이터의 양에 따라 주 데이터베이스의 동기화 성능에 약간 영향을 줄 수 있습니다.

이 디자인 패턴에는 다음과 같은 여러 **장점**이 있습니다.

* 임시 작동 중단 동안 데이터 손실 방지
* 가동 중지 시간은 트래픽 관리자가 구성 가능한 연결 실패를 얼마나 빨리 감지하는지에 따라 달라짐

**단점**은 다음과 같습니다.

* 응용 프로그램은 읽기 전용 모드에서 작동할 수 있어야 함

> [!NOTE]
> 지역에서 영구 서비스 중단이 발생할 경우 수동으로 데이터베이스 장애 조치를 활성화하고 데이터 손실을 허용합니다. 응용 프로그램은 데이터베이스에 대한 읽기-쓰기 액세스로 보조 지역에서 작동됩니다.
>

## <a name="business-continuity-planning-choose-an-application-design-for-cloud-disaster-recovery"></a>무중단 업무 방식 계획: 클라우드 재해 복구에 대한 응용 프로그램 디자인 선택
특정 클라우드 재해 복구 전략은 응용 프로그램의 요구 사항을 최상으로 충족하도록 이러한 디자인 패턴을 결합하거나 확장할 수 있습니다.  앞에서 설명한 대로 선택한 전략은 고객 및 응용 프로그램 배포 토폴로지에 제공하려는 SLA에 따라 달라집니다. 결정에 도움을 주기 위해 다음 테이블에서는 예상된 데이터 손실 또는 복구 시점 목표(RPO) 및 예상 복구 시간(ERT)에 따라 선택 항목을 비교합니다.

| 패턴 | RPO | ERT |
|:--- |:--- |:--- |
| 배치된 데이터베이스 액세스로 재해 복구에 대한 활성-수동 배포 |읽기-쓰기 액세스 < 5초 |장애 감지 시간 + DNS TTL |
| 응용 프로그램 부하 분산에 대한 활성-활성 배포 |읽기-쓰기 액세스 < 5초 |장애 감지 시간 + DNS TTL |
| 데이터 보존에 대한 활성-수동 배포 |읽기 전용 액세스 < 5초 | 읽기 전용 액세스 = 0 |
||읽기-쓰기 액세스 = 0 | 읽기-쓰기 액세스 = 장애 감지 시간 + 데이터 손실이 있는 유예 기간 |
|||

## <a name="next-steps"></a>다음 단계
* Azure SQL 데이터베이스 자동화 백업에 대한 자세한 내용은 [SQL 데이터베이스 자동화 백업](sql-database-automated-backups.md)
* 비즈니스 연속성의 개요 및 시나리오를 보려면 [비즈니스 연속성 개요](sql-database-business-continuity.md)
* 복구를 위해 자동화된 백업을 사용하는 방법을 알아보려면 [서비스에서 시작한 백업에서 데이터베이스 복원](sql-database-recovery-using-backups.md)
* 빠른 복구 옵션에 대해 알아보려면 [활성 지역 복제](sql-database-geo-replication-overview.md)를 참조하세요.  
* 보관을 위해 자동화된 백업을 사용하는 방법을 알아보려면 [데이터베이스 복사](sql-database-copy.md)
* 탄력적 풀의 활성 지역 복제에 대한 자세한 내용은 [탄력적 풀 재해 복구 전략](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md)을 참조하세요.
