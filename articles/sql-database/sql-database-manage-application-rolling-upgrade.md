---
title: "Azure SQL 데이터베이스-aaaRolling 응용 프로그램 업그레이드 | Microsoft Docs"
description: "자세한 내용은 방법 클라우드 응용 프로그램의 Azure SQL 데이터베이스 지역에서 복제 toouse toosupport 온라인 업그레이드 합니다."
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: 58f42859-1e37-463c-a3d8-a3ca2e867148
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 07/16/2016
ms.author: sashan
ms.openlocfilehash: 18c56300916d129bff141624cc5c416b500408d4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/06/2017
---
# <a name="managing-rolling-upgrades-of-cloud-applications-using-sql-database-active-geo-replication"></a><span data-ttu-id="ce85d-103">SQL Database 활성 지역 복제를 사용하여 클라우드 응용 프로그램의 롤링 업그레이드 관리</span><span class="sxs-lookup"><span data-stu-id="ce85d-103">Managing rolling upgrades of cloud applications using SQL Database active geo-replication</span></span>
> [!NOTE]
> <span data-ttu-id="ce85d-104">[활성 지역 복제](sql-database-geo-replication-overview.md)는 현재 모든 계층의 모든 데이터베이스에 대해 제공됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-104">[Active geo-replication](sql-database-geo-replication-overview.md) is now available for all databases in all tiers.</span></span>
> 

<span data-ttu-id="ce85d-105">자세한 내용은 방법 toouse [지리적 복제](sql-database-geo-replication-overview.md) tooenable SQL 데이터베이스의에서 롤링 업그레이드 클라우드 응용 프로그램의 경우.</span><span class="sxs-lookup"><span data-stu-id="ce85d-105">Learn how toouse [geo-replication](sql-database-geo-replication-overview.md) in SQL Database tooenable rolling upgrades of your cloud application.</span></span> <span data-ttu-id="ce85d-106">업그레이드는 중단 작업이기 때문에 무중단 업무 방식 계획 및 디자인의 일부여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-106">Because upgrade is a disruptive operation, it should be part of your business continuity planning and design.</span></span> <span data-ttu-id="ce85d-107">Hello 조정의 두 가지 방법에 살펴보기이 문서에서 업그레이드 작업을 하 고 hello 이점 및 각 옵션의 장단점을 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-107">In this article we look at two different methods of orchestrating hello upgrade process, and discuss hello benefits and trade-offs of each option.</span></span> <span data-ttu-id="ce85d-108">이 여기서 해결 hello에 대 한 웹 사이트 연결 된 tooa 단일 데이터베이스의 데이터 계층으로 구성 된 간단한 응용 프로그램을 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-108">For hello purposes of this article we will use a simple application that consists of a web site connected tooa single database as its data tier.</span></span> <span data-ttu-id="ce85d-109">목표는 tooupgrade 버전 1의 중요 한 영향 주지 않고 응용 프로그램 tooversion hello 2 hello 최종 사용자 환경에 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-109">Our goal is tooupgrade version 1 of hello application tooversion 2 without any significant impact on hello end-user experience.</span></span> 

<span data-ttu-id="ce85d-110">Hello 업그레이드 옵션을 평가할 때 hello를 요인에 따라이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-110">When evaluating hello upgrade options you should consider hello following factors:</span></span>

* <span data-ttu-id="ce85d-111">업그레이드 중에 응용 프로그램 가용성에 미치는 영향</span><span class="sxs-lookup"><span data-stu-id="ce85d-111">Impact on application availability during upgrades.</span></span> <span data-ttu-id="ce85d-112">시간 hello 응용 프로그램 기능 제한 또는 저하 됨 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-112">How long hello application function may be limited or degraded.</span></span>
* <span data-ttu-id="ce85d-113">업그레이드 오류가 발생할 경우 다시 tooroll 기능입니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-113">Ability tooroll back in case of an upgrade failure.</span></span>
* <span data-ttu-id="ce85d-114">Hello 응용 프로그램에서 관련 없는 치명적인 오류가 hello 업그레이드 하는 동안 발생 하는 경우의 보안 문제가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-114">Vulnerability of hello application if an unrelated catastrophic failure occurs during hello upgrade.</span></span>
* <span data-ttu-id="ce85d-115">총 달러 비용.</span><span class="sxs-lookup"><span data-stu-id="ce85d-115">Total dollar cost.</span></span>  <span data-ttu-id="ce85d-116">추가적인 중복성이 구현 및 hello 업그레이드 프로세스에서 사용 된 hello 임시 구성 요소의 증분 비용이 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-116">This includes additional redundancy and incremental costs of hello temporary components  used by hello upgrade process.</span></span> 

## <a name="upgrading-applications-that-rely-on-database-backups-for-disaster-recovery"></a><span data-ttu-id="ce85d-117">재해 복구에 대해 데이터베이스 백업을 사용하는 응용 프로그램 업그레이드</span><span class="sxs-lookup"><span data-stu-id="ce85d-117">Upgrading applications that rely on database backups for disaster recovery</span></span>
<span data-ttu-id="ce85d-118">응용 프로그램 자동 데이터베이스 백업에 의존 하 고 재해 복구에 대 한 지역에서 복원을 사용 하 여, 경우 일반적으로 배포 된 tooa 단일 Azure 지역입니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-118">If your application relies on automatic database backups and uses geo-restore for disaster recovery, it is usually deployed tooa single Azure region.</span></span> <span data-ttu-id="ce85d-119">이 경우 hello 업그레이드 프로세스는 hello 업그레이드에 포함 된 모든 응용 프로그램 구성 요소의 백업 배포를 만들려면 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-119">In this case hello upgrade process involves creating a backup deployment of all application components involved in hello upgrade.</span></span> <span data-ttu-id="ce85d-120">Azure 트래픽 관리자 (WATM)를 활용 하 여 hello 장애 조치 프로필로 됩니다 toominimize hello 최종 사용자 중단.</span><span class="sxs-lookup"><span data-stu-id="ce85d-120">toominimize hello end-user disruption you will leverage Azure Traffic Manager (WATM) with hello failover profile.</span></span>  <span data-ttu-id="ce85d-121">다음 다이어그램 hello hello 운영 환경을 이전 toohello 업그레이드 프로세스를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-121">hello following diagram illustrates hello operational environment prior toohello upgrade process.</span></span> <span data-ttu-id="ce85d-122">끝점 hello <i>contoso 1.azurewebsites.net</i> toobe 업그레이드 하는 hello 응용 프로그램의는 프로덕션 슬롯을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-122">hello endpoint <i>contoso-1.azurewebsites.net</i> represents a production slot of hello application that needs toobe upgraded.</span></span> <span data-ttu-id="ce85d-123">tooenable hello 기능 tooroll 다시 hello 업그레이드, 완벽 하 게 동기화 된 hello 응용 프로그램의 복사본으로 단계 슬롯을 만들어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-123">tooenable hello ability tooroll back hello upgrade, you need create a stage slot with a fully synchronized copy of hello application.</span></span> <span data-ttu-id="ce85d-124">hello 다음 단계는 hello 업그레이드에 필요한 tooprepare hello 응용 프로그램.</span><span class="sxs-lookup"><span data-stu-id="ce85d-124">hello following steps are required tooprepare hello application for hello upgrade:</span></span>

1. <span data-ttu-id="ce85d-125">Hello 업그레이드에 대 한 단계 슬롯을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-125">Create a stage slot for hello upgrade.</span></span> <span data-ttu-id="ce85d-126">toodo 보조 데이터베이스 (1)을 만들고 hello에는 동일한 웹 사이트를 배포 하는 동일한 Azure 지역에 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-126">toodo that create a secondary database (1) and deploy an identical web site in hello same Azure region.</span></span> <span data-ttu-id="ce85d-127">프로세스를 시드 hello에 완료 되 면 hello 보조 toosee를 모니터링 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-127">Monitor hello secondary toosee if hello seeding process is completed.</span></span>
2. <span data-ttu-id="ce85d-128"><i>contoso-1.azurewebsites.net</i>을 온라인 끝점으로 하고 <i>contoso-2.azurewebsites.net</i>을 오프라인으로 하여 WATM에서 장애 조치(failover) 프로필을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-128">Create a failover profile in WATM with <i>contoso-1.azurewebsites.net</i> as online endpoint and <i>contoso-2.azurewebsites.net</i> as offline.</span></span> 

> [!NOTE]
> <span data-ttu-id="ce85d-129">참고 hello 준비 단계 hello 응용 프로그램 hello 프로덕션 슬롯에 영향을 주지 않을 하 고 전체 액세스 모드에서 작동할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-129">Note hello preparation steps will not impact hello application in hello production slot and it can function in full access mode.</span></span>
>  

![SQL 데이터베이스 지역에서 복제 구성](media/sql-database-manage-application-rolling-upgrade/Option1-1.png)

<span data-ttu-id="ce85d-132">Hello 준비 단계가 완료 되 면 hello 응용 프로그램은 실제 업그레이드를 hello 준비가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-132">Once hello preparation steps are completed hello application is ready for hello actual upgrade.</span></span> <span data-ttu-id="ce85d-133">다음 다이어그램 hello hello 업그레이드 프로세스에 관련 된 hello 단계를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-133">hello following diagram illustrates hello steps involved in hello upgrade process.</span></span> 

1. <span data-ttu-id="ce85d-134">Hello 프로덕션 슬롯 tooread 전용 모드 (3) hello 주 데이터베이스를 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-134">Set hello primary database in hello production slot tooread-only mode (3).</span></span> <span data-ttu-id="ce85d-135">이렇게 하면 해당 hello hello (V1) 응용 프로그램의 프로덕션 인스턴스에 읽기 전용 이어서 hello V1 및 V2 데이터베이스 인스턴스 간의 데이터 차이 hello 없는 hello 업그레이드 하는 동안 유지 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-135">This will guarantee that hello production instance of hello application (V1) will remain read-only during hello upgrade thus preventing hello data divergence between hello V1 and V2 database instances.</span></span>  
2. <span data-ttu-id="ce85d-136">Hello 계획 된 종료 모드 (4)를 사용 하 여 hello 보조 데이터베이스를 분리 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-136">Disconnect hello secondary database using hello planned termination mode (4).</span></span> <span data-ttu-id="ce85d-137">Hello 주 데이터베이스의 완전 하 게 동기화 된 독립 복사본을 만들어집니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-137">It will create a fully synchronized independent copy of hello primary database.</span></span> <span data-ttu-id="ce85d-138">이 데이터베이스가 업그레이드됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-138">This database will be upgraded.</span></span>
3. <span data-ttu-id="ce85d-139">Hello 주 데이터베이스 tooread-쓰기 모드를 설정 하 고 hello 단계 슬롯 (5)의 hello 업그레이드 스크립트를 실행 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-139">Turn hello primary database tooread-write mode and run hello upgrade script in hello stage slot  (5).</span></span>     

![SQL Database 지역에서 복제 구성](media/sql-database-manage-application-rolling-upgrade/Option1-2.png)

<span data-ttu-id="ce85d-142">Hello 업그레이드가 성공적으로 완료 하는 경우 준비 tooswitch hello 최종 사용자가 준비 된 toohello 복사 hello 응용이 나타납니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-142">If hello upgrade completed successfully you are now ready tooswitch hello end users toohello staged copy hello application.</span></span> <span data-ttu-id="ce85d-143">이제 hello 응용 프로그램의 hello 프로덕션 슬롯 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-143">It will now become hello production slot of hello application.</span></span>  <span data-ttu-id="ce85d-144">Hello 다이어그램을 다음에 설명 된 대로 몇 가지 더 많은 단계가 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-144">This involves a few more steps as illustrated on hello following diagram.</span></span>

1. <span data-ttu-id="ce85d-145">Hello WATM 프로필의 hello 온라인 끝점을 너무 전환<i>contoso 2.azurewebsites.net</i>, 어떤 포인트 toohello V2 버전의 hello 웹 사이트 (6).</span><span class="sxs-lookup"><span data-stu-id="ce85d-145">Switch hello online endpoint in hello WATM profile too<i>contoso-2.azurewebsites.net</i>, which points toohello V2 version of hello web site (6).</span></span> <span data-ttu-id="ce85d-146">이제 hello 프로덕션 슬롯 hello V2 응용 프로그램을 되며 hello 최종 사용자 트래픽이 directed tooit입니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-146">It now becomes hello production slot with hello V2 application and hello end-user traffic is directed tooit.</span></span>  
2. <span data-ttu-id="ce85d-147">안전 하 게 할 수 있도록 hello V1 응용 프로그램 구성 요소를 더 이상 필요 제거 (7).</span><span class="sxs-lookup"><span data-stu-id="ce85d-147">If you no longer need hello V1 application components so you can safely remove them (7).</span></span>   

![SQL Database 지역에서 복제 구성](media/sql-database-manage-application-rolling-upgrade/Option1-3.png)

<span data-ttu-id="ce85d-150">Hello 업그레이드 프로세스가 실패할 경우 예를 들어 스크립트를 업그레이드 하는 hello에서는 tooan 오류 인해 hello 단계 슬롯 고려할 손상 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-150">If hello upgrade process is unsuccessful, for example due tooan error in hello upgrade script, hello stage slot should be considered compromised.</span></span> <span data-ttu-id="ce85d-151">tooroll 백업 hello 응용 프로그램 toohello 업그레이드 전 상태 hello 프로덕션 슬롯 toofull 액세스의 hello 응용 프로그램을 되돌리면 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-151">tooroll back hello application toohello pre-upgrade state you simply revert hello application in hello production slot toofull access.</span></span> <span data-ttu-id="ce85d-152">관련 된 hello 단계 hello 다음 다이어그램에 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-152">hello steps involved are shown on hello next diagram.</span></span>    

1. <span data-ttu-id="ce85d-153">Hello 데이터베이스 복사본 tooread-쓰기 모드 (8)를 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-153">Set hello database copy tooread-write mode (8).</span></span> <span data-ttu-id="ce85d-154">이렇게 하면 복원 됩니다 hello 프로덕션 슬롯에서 기능적으로 전체 V1 hello 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-154">This will restore hello full V1 functionally in hello production slot.</span></span>
2. <span data-ttu-id="ce85d-155">Hello 근본 원인 분석을 수행 하 고 hello 단계 슬롯 (9)의 보안이 손상 hello 구성 요소를 제거 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-155">Perform hello root cause analysis and remove hello compromised components in hello stage slot (9).</span></span> 

<span data-ttu-id="ce85d-156">이 경우 hello 응용 프로그램의 모든 기능이 작동 하 고 hello 업그레이드 단계를 반복할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-156">At this point hello application is fully functional and hello upgrade steps can be repeated.</span></span>

> [!NOTE]
> <span data-ttu-id="ce85d-157">hello 롤백 하지 않아도 WATM 프로필의 변경 내용을 이미 가리키도록 너무 대로<i>contoso 1.azurewebsites.net</i> hello 활성 끝점으로 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-157">hello rollback does not require changes in WATM profile as it already points too<i>contoso-1.azurewebsites.net</i> as hello active endpoint.</span></span>
> 
> 

![SQL Database 지역에서 복제 구성](media/sql-database-manage-application-rolling-upgrade/Option1-4.png)

<span data-ttu-id="ce85d-160">hello 키 **장점은** 이 옵션은 일련의 간단한 단계를 사용 하 여 단일 지역에서 응용 프로그램을 업그레이드할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-160">hello key **advantage** of this option is that you can upgrade an application in a single region using a set of simple steps.</span></span> <span data-ttu-id="ce85d-161">hello 비용 (달러) hello 업그레이드의 상대적으로 낮습니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-161">hello dollar cost of hello upgrade is relatively low.</span></span> <span data-ttu-id="ce85d-162">주 hello **단점이** hello 업그레이드 hello 복구 toohello 업그레이드 전 상태 동안 심각한 오류가 발생 한 경우는 포함 된 서로 다른 지역 및 hello 데이터베이스에서 복원 hello 응용 프로그램 배포는 지역에서 복원을 사용 하 여 백업입니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-162">hello main **tradeoff** is that if a catastrophic failure occurs during hello upgrade hello recovery toohello pre-upgrade state will involve re-deployment of hello application in a different region and restoring hello database from backup using geo-restore.</span></span> <span data-ttu-id="ce85d-163">이 프로세스를 통해 상당한 가동 중지 시간이 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-163">This process will result in significant downtime.</span></span>   

## <a name="upgrading-applications-that-rely-on-database-geo-replication-for-disaster-recovery"></a><span data-ttu-id="ce85d-164">재해 복구에 대해 데이터베이스 지역에서 복제를 사용하는 응용 프로그램 업그레이드</span><span class="sxs-lookup"><span data-stu-id="ce85d-164">Upgrading applications that rely on database geo-replication for disaster recovery</span></span>
<span data-ttu-id="ce85d-165">비즈니스 연속성에 대 한 지리적 복제를 활용 하는 응용 프로그램을 경우 기본 지역에서 활성 배포와 대기 배포 백업 지역에 배포 된 tooat 최소 두 개의 서로 다른 지역입니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-165">If your application leverages geo-replication for business continuity, it is deployed  tooat least two different regions with an active deployment in Primary region and a standby deployment in Backup region.</span></span> <span data-ttu-id="ce85d-166">또한 toohello 요소 앞에서 언급 한, hello 업그레이드 프로세스는 하도록 보장 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-166">In addition toohello factors mentioned earlier, hello upgrade process must guarantee that:</span></span>

* <span data-ttu-id="ce85d-167">hello hello 업그레이드 프로세스 중 언제 든 치명적인 오류 로부터 보호 하는 응용 프로그램은 유지</span><span class="sxs-lookup"><span data-stu-id="ce85d-167">hello application remains protected from catastrophic failures at all times during hello upgrade process</span></span>
* <span data-ttu-id="ce85d-168">hello 활성 구성 요소를 병렬로 hello 응용 프로그램의 hello 지리적 중복 구성 요소가 업그레이드</span><span class="sxs-lookup"><span data-stu-id="ce85d-168">hello geo-redundant components of hello application are upgraded in parallel with hello active components</span></span>

<span data-ttu-id="ce85d-169">tooachieve 활성 배포와 세 개의 백업 끝점으로 프로 파일링 이러한 목표는 Azure 트래픽 관리자 (WATM) hello 장애 조치를 사용 하 여를 이용 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-169">tooachieve these goals you will leverage Azure Traffic Manager (WATM) using hello failover profile with one active and three backup endpoints.</span></span>  <span data-ttu-id="ce85d-170">다음 다이어그램 hello hello 운영 환경을 이전 toohello 업그레이드 프로세스를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-170">hello following diagram illustrates hello operational environment prior toohello upgrade process.</span></span> <span data-ttu-id="ce85d-171">웹 사이트를 hello <i>contoso 1.azurewebsites.net</i> 및 <i>contoso dr.azurewebsites.net</i> 전체 지리적 중복 hello 응용 프로그램의 프로덕션 슬롯을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-171">hello web sites <i>contoso-1.azurewebsites.net</i> and <i>contoso-dr.azurewebsites.net</i> represent a production slot of hello application with full geographic redundancy.</span></span> <span data-ttu-id="ce85d-172">tooenable hello 기능 tooroll 다시 hello 업그레이드, 완벽 하 게 동기화 된 hello 응용 프로그램의 복사본으로 단계 슬롯을 만들어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-172">tooenable hello ability tooroll back hello upgrade, you need create a stage slot with a fully synchronized copy of hello application.</span></span> <span data-ttu-id="ce85d-173">Hello 응용 프로그램 hello 업그레이드 프로세스 중에 치명적인 오류가 발생 하는 경우를 빠르게 복구할 수 tooensure 필요 하기 때문에 hello 단계 슬롯 필요 toobe 지리적 중복도 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-173">Because you need tooensure that hello application can quickly recover in case a catastrophic failure occurs during hello upgrade process, hello stage slot needs toobe geo-redundant as well.</span></span> <span data-ttu-id="ce85d-174">hello 다음 단계는 hello 업그레이드에 필요한 tooprepare hello 응용 프로그램.</span><span class="sxs-lookup"><span data-stu-id="ce85d-174">hello following steps are required tooprepare hello application for hello upgrade:</span></span>

1. <span data-ttu-id="ce85d-175">Hello 업그레이드에 대 한 단계 슬롯을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-175">Create a stage slot for hello upgrade.</span></span> <span data-ttu-id="ce85d-176">toodo 보조 데이터베이스 (1)을 만들고 hello에서 hello 웹 사이트의 동일한 복사본을 배포 하는 동일한 Azure 지역에 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-176">toodo that create a secondary database (1) and deploy an identical copy of hello web site in hello same Azure region.</span></span> <span data-ttu-id="ce85d-177">프로세스를 시드 hello에 완료 되 면 hello 보조 toosee를 모니터링 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-177">Monitor hello secondary toosee if hello seeding process is completed.</span></span>
2. <span data-ttu-id="ce85d-178">지리적 복제 하 여 hello 단계 슬롯에 지리적 중복 보조 데이터베이스를 만들 hello 보조 데이터베이스 toohello 백업 영역 (라고 "지리적 복제 연결").</span><span class="sxs-lookup"><span data-stu-id="ce85d-178">Create a geo-redundant secondary database in hello stage slot by geo-replicating hello secondary database toohello backup region (this is called "chained geo-replication").</span></span> <span data-ttu-id="ce85d-179">프로세스를 시드 hello이 완료 된 (3) 백업 보조 toosee hello를 모니터링 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-179">Monitor hello backup secondary toosee if hello seeding process is completed (3).</span></span>
3. <span data-ttu-id="ce85d-180">Hello 백업 영역의 hello 웹 사이트의 대기 복사본을 만들고 toohello 지리적 중복 보조 데이터베이스 (4)에 연결 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-180">Create a standby copy of hello web site in hello backup region and link it toohello geo-redundant secondary (4).</span></span>  
4. <span data-ttu-id="ce85d-181">Hello 추가 끝점을 추가 <i>contoso 2.azurewebsites.net</i> 및 <i>contoso 3.azurewebsites.net</i> toohello 장애 조치 프로필 WATM에 오프 라인 (5)의 끝점으로 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-181">Add hello additional endpoints <i>contoso-2.azurewebsites.net</i> and <i>contoso-3.azurewebsites.net</i> toohello failover profile in WATM as offline endpoints (5).</span></span> 

> [!NOTE]
> <span data-ttu-id="ce85d-182">참고 hello 준비 단계 hello 응용 프로그램 hello 프로덕션 슬롯에 영향을 주지 않을 하 고 전체 액세스 모드에서 작동할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-182">Note hello preparation steps will not impact hello application in hello production slot and it can function in full access mode.</span></span>
> 
> 

![SQL Database 지역에서 복제 구성](media/sql-database-manage-application-rolling-upgrade/Option2-1.png)

<span data-ttu-id="ce85d-185">Hello 준비 단계가 완료 되 면 hello 단계 슬롯이 hello 업그레이드 준비 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-185">Once hello preparation steps are completed, hello stage slot is ready for hello upgrade.</span></span> <span data-ttu-id="ce85d-186">다음 다이어그램 hello hello 업그레이드 단계를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-186">hello following diagram illustrates hello upgrade steps.</span></span>

1. <span data-ttu-id="ce85d-187">Hello 프로덕션 슬롯 tooread 전용 모드 (6) hello 주 데이터베이스를 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-187">Set hello primary database in hello production slot tooread-only mode (6).</span></span> <span data-ttu-id="ce85d-188">이렇게 하면 해당 hello hello (V1) 응용 프로그램의 프로덕션 인스턴스에 읽기 전용 이어서 hello V1 및 V2 데이터베이스 인스턴스 간의 데이터 차이 hello 없는 hello 업그레이드 하는 동안 유지 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-188">This will guarantee that hello production instance of hello application (V1) will remain read-only during hello upgrade thus preventing hello data divergence between hello V1 and V2 database instances.</span></span>  
2. <span data-ttu-id="ce85d-189">Hello 보조 데이터베이스를 분리 hello 계획 된 종료 모드 (7)를 사용 하 여 동일한 지역 hello에 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-189">Disconnect hello secondary database in hello same region using hello planned termination mode (7).</span></span> <span data-ttu-id="ce85d-190">Hello 종료 된 후 기본 될 자동으로 hello 주 데이터베이스의 완전 하 게 동기화 된 독립 복사본을 만들어집니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-190">It will create a fully synchronized independent copy of hello primary database, which will automatically become a primary after hello termination.</span></span> <span data-ttu-id="ce85d-191">이 데이터베이스가 업그레이드됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-191">This database will be upgraded.</span></span>
3. <span data-ttu-id="ce85d-192">Hello 단계 슬롯 tooread 쓰기 모드로 hello 주 데이터베이스를 설정 하 고 hello 업그레이드 스크립트 (8)를 실행 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-192">Turn hello primary database in hello stage slot tooread-write mode and run hello upgrade script (8).</span></span>    

![SQL Database 지역에서 복제 구성](media/sql-database-manage-application-rolling-upgrade/Option2-2.png)

<span data-ttu-id="ce85d-195">Hello 업그레이드가 성공적으로 완료 하는 경우 준비 tooswitch hello 최종 사용자에 게 toohello V2 버전의 hello 응용 프로그램이 나타납니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-195">If hello upgrade completed successfully you are now ready tooswitch hello end users toohello V2 version of hello application.</span></span> <span data-ttu-id="ce85d-196">다음 다이어그램 hello hello 단계를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-196">hello following diagram illustrates hello steps involved.</span></span>

1. <span data-ttu-id="ce85d-197">Hello WATM 프로필의 hello 활성 끝점을 너무 전환<i>contoso 2.azurewebsites.net</i>, 이제 toohello V2 버전의 hello 웹 사이트 (9)를 가리킵니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-197">Switch hello active endpoint in hello WATM profile too<i>contoso-2.azurewebsites.net</i>, which now points toohello V2 version of hello web site (9).</span></span> <span data-ttu-id="ce85d-198">이제 프로덕션 슬롯 hello V2 응용 프로그램을 되며 최종 사용자 트래픽이 directed tooit입니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-198">It now becomes a production slot with hello V2 application and end-user traffic is directed tooit.</span></span> 
2. <span data-ttu-id="ce85d-199">안전 하 게 할 수 있도록 hello V1 응용 프로그램을 더 이상 해야 하는 경우 제거 (10과 11).</span><span class="sxs-lookup"><span data-stu-id="ce85d-199">If you no longer need hello V1 application so you can safely remove it (10 and 11).</span></span>  

![SQL Database 지역에서 복제 구성](media/sql-database-manage-application-rolling-upgrade/Option2-3.png)

<span data-ttu-id="ce85d-202">Hello 업그레이드 프로세스가 실패할 경우 예를 들어 스크립트를 업그레이드 하는 hello에서는 tooan 오류 인해 hello 단계 슬롯 고려할 손상 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-202">If hello upgrade process is unsuccessful, for example due tooan error in hello upgrade script, hello stage slot should be considered compromised.</span></span> <span data-ttu-id="ce85d-203">tooroll 백업 hello 응용 프로그램 toohello 업그레이드 전 상태 전체 액세스 권한이 있는 hello 프로덕션 슬롯에서 toousing hello 응용 프로그램을 되돌리면 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-203">tooroll back hello application toohello pre-upgrade state you simply revert toousing hello application in hello production slot with full access.</span></span> <span data-ttu-id="ce85d-204">관련 된 hello 단계 hello 다음 다이어그램에 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-204">hello steps involved are shown on hello next diagram.</span></span>    

1. <span data-ttu-id="ce85d-205">집합 hello는 hello 프로덕션 슬롯 tooread-쓰기 모드 (12)의 복사본을 주 데이터베이스입니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-205">Set hello primary database copy in hello production slot tooread-write mode (12).</span></span> <span data-ttu-id="ce85d-206">이렇게 하면 복원 됩니다 hello 프로덕션 슬롯에서 기능적으로 전체 V1 hello 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-206">This will restore hello full V1 functionally in hello production slot.</span></span>
2. <span data-ttu-id="ce85d-207">Hello 근본 원인 분석을 수행 하 고 hello 단계 슬롯 (13 및 14)의 보안이 손상 hello 구성 요소를 제거 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-207">Perform hello root cause analysis and remove hello compromised components in hello stage slot (13 and 14).</span></span> 

<span data-ttu-id="ce85d-208">이 경우 hello 응용 프로그램의 모든 기능이 작동 하 고 hello 업그레이드 단계를 반복할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-208">At this point hello application is fully functional and hello upgrade steps can be repeated.</span></span>

> [!NOTE]
> <span data-ttu-id="ce85d-209">hello 롤백 하지 않아도 WATM 프로필의 변경 내용을 이미 가리키도록 너무 대로 <i>contoso 1.azurewebsites.net</i> hello 활성 끝점으로 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-209">hello rollback does not require changes in WATM profile as it already points too <i>contoso-1.azurewebsites.net</i> as hello active endpoint.</span></span>
> 
> 

![SQL Database 지역에서 복제 구성](media/sql-database-manage-application-rolling-upgrade/Option2-4.png)

<span data-ttu-id="ce85d-212">hello 키 **장점은** 은이 옵션의 hello 업그레이드 하는 동안 비즈니스 연속성을 유지 하면서 hello 응용 프로그램과 병렬로 지리적 중복 복사본을 모두 업그레이드할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-212">hello key **advantage** of this option is that you can upgrade both hello application and its geo-redundant copy in parallel without compromising your business continuity during hello upgrade.</span></span> <span data-ttu-id="ce85d-213">주 hello **적절 한 균형을** 이중 중복 각 응용 프로그램 구성 요소에 필요 하며 따라서에 주는 영향이 더 높은 달러 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-213">hello main **tradeoff** is that it requires double redundancy of each application component and therefore incurs higher dollar cost.</span></span> <span data-ttu-id="ce85d-214">또한 더 복잡한 워크플로가 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-214">It also involves a more complicated workflow.</span></span> 

## <a name="summary"></a><span data-ttu-id="ce85d-215">요약</span><span class="sxs-lookup"><span data-stu-id="ce85d-215">Summary</span></span>
<span data-ttu-id="ce85d-216">hello 문서에서 설명 하는 hello 두 업그레이드 방법 비용 복잡성과 hello 달러만 모두 집중 때 hello 최종 사용자가 제한 된 tooread 전용 작업 hello 시간을 최소화 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-216">hello two upgrade methods described in hello article differ in complexity and hello dollar cost but they both focus on minimizing hello time when hello end user is limited tooread-only operations.</span></span> <span data-ttu-id="ce85d-217">이때는 hello 업그레이드 스크립트의 hello 기간으로 직접 정의 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-217">That time is directly defined by hello duration of hello upgrade script.</span></span> <span data-ttu-id="ce85d-218">Hello 데이터베이스 크기에 의존 하지 않는, 선택, hello 웹 사이트 구성 및 쉽게 제어할 수 없는 기타 요인 hello 서비스 계층 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-218">It does not depend on hello database size, hello service tier you chose, hello web site configuration and other factors that you cannot easily control.</span></span> <span data-ttu-id="ce85d-219">이므로 모든 hello 준비 단계 hello 업그레이드 단계에서 분리 되어 hello 프로덕션 응용 프로그램에 영향을 주지 않고 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-219">This is because all hello preparation steps are decoupled from hello upgrade steps and can be done without impacting hello production application.</span></span> <span data-ttu-id="ce85d-220">hello 업그레이드 스크립트의 hello 효율성은 업그레이드 중 hello 최종 사용자 환경을 결정 하는 hello 주요 요소입니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-220">hello efficiency of hello upgrade script is hello key factor that determines hello end-user experience during upgrades.</span></span> <span data-ttu-id="ce85d-221">따라서 hello 가장 좋은 방법은 향상 시킬 수 있습니다는 hello 업그레이드 스크립트를 최대한 효율적으로 만드는 작업을 중심으로 합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-221">So hello best way you can improve it is by focusing your efforts on making hello upgrade script as efficient as possible.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="ce85d-222">다음 단계</span><span class="sxs-lookup"><span data-stu-id="ce85d-222">Next steps</span></span>
* <span data-ttu-id="ce85d-223">비즈니스 연속성의 개요 및 시나리오를 보려면 [비즈니스 연속성 개요](sql-database-business-continuity.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ce85d-223">For a business continuity overview and scenarios, see [Business continuity overview](sql-database-business-continuity.md).</span></span>
* <span data-ttu-id="ce85d-224">Azure SQL 데이터베이스 자동화 된 백업에 대 한 toolearn 참조 [SQL 데이터베이스 자동화 된 백업을](sql-database-automated-backups.md)합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-224">toolearn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md).</span></span>
* <span data-ttu-id="ce85d-225">복구를 위한 자동화 된 백업을 사용 하는 방법에 대 한 toolearn 참조 [자동화 된 백업에서 데이터베이스를 복원](sql-database-recovery-using-backups.md)합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-225">toolearn about using automated backups for recovery, see [restore a database from automated backups](sql-database-recovery-using-backups.md).</span></span>
* <span data-ttu-id="ce85d-226">빠른 복구 옵션에 대 한 toolearn 참조 [활성 지리적 복제](sql-database-geo-replication-overview.md)합니다.</span><span class="sxs-lookup"><span data-stu-id="ce85d-226">toolearn about faster recovery options, see [active geo-replication](sql-database-geo-replication-overview.md).</span></span>


