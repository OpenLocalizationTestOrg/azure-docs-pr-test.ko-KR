---
title: "클라우드 데이터베이스의 분산 트랜잭션"
description: "Azure SQL 데이터베이스와 탄력적 데이터베이스 트랜잭션 개요"
services: sql-database
documentationcenter: 
author: torsteng
manager: jhubbard
editor: torsteng
ms.assetid: e14df7a3-7788-4cfb-bcd1-7ad6433ef1f9
ms.service: sql-database
ms.custom: scale out apps
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: sql-database
ms.date: 05/27/2016
ms.author: torsteng
ms.openlocfilehash: f7f1ad3f1933b39a0030a784cae40521254037d6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/11/2017
---
# <a name="distributed-transactions-across-cloud-databases"></a><span data-ttu-id="50373-103">클라우드 데이터베이스의 분산 트랜잭션</span><span class="sxs-lookup"><span data-stu-id="50373-103">Distributed transactions across cloud databases</span></span>
<span data-ttu-id="50373-104">Azure SQL 데이터베이스(SQL DB)용 탄력적 데이터베이스를 사용하면 SQL DB의 여러 데이터베이스에 걸쳐 트랜잭션을 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-104">Elastic database transactions for Azure SQL Database (SQL DB) allow you to run transactions that span several databases in SQL DB.</span></span> <span data-ttu-id="50373-105">SQL DB용 탄력적 데이터베이스 트랜잭션은 ADO .NET을 사용하여 .NET 응용 프로그램에서 사용할 수 있고 [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) 클래스를 사용하여 친숙한 프로그래밍 환경과 통합될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-105">Elastic database transactions for SQL DB are available for .NET applications using ADO .NET and integrate with the familiar programming experience using the [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) classes.</span></span> <span data-ttu-id="50373-106">라이브러리를 가져오려면 [.NET Framework 4.6.1(웹 설치 관리자)](https://www.microsoft.com/download/details.aspx?id=49981)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="50373-106">To get the library, see [.NET Framework 4.6.1 (Web Installer)](https://www.microsoft.com/download/details.aspx?id=49981).</span></span>

<span data-ttu-id="50373-107">온-프레미스에서 이러한 시나리오는 Microsoft Distributed Transaction Coordinator(MSDTC) 실행을 필요로 합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-107">On premises, such a scenario usually required running Microsoft Distributed Transaction Coordinator (MSDTC).</span></span> <span data-ttu-id="50373-108">MSDTC는 Azure의 PaaS(Platform-as-a-Service) 응용 프로그램에서 사용할 수 없기 때문에 분산된 트랜잭션을 조정할 수 있는 기능이 SQL DB와 직접적으로 통합되었습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-108">Since MSDTC is not available for Platform-as-a-Service application in Azure, the ability to coordinate distributed transactions has now been directly integrated into SQL DB.</span></span> <span data-ttu-id="50373-109">응용 프로그램은 분산된 트랜잭션을 시작하도록 모든 SQL 데이터베이스에 연결할 수 있으며, 다음 그림에 표시된 것처럼 데이터베이스 중 하나는 분산된 트랜잭션을 투명하게 조정합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-109">Applications can connect to any SQL Database to launch distributed transactions, and one of the databases will transparently coordinate the distributed transaction, as shown in the following figure.</span></span> 

  ![<span data-ttu-id="50373-110">탄력적 데이터베이스 트랜잭션을 사용한 Azure SQL 데이터베이스와 분산 트랜잭션</span><span class="sxs-lookup"><span data-stu-id="50373-110">Distributed transactions with Azure SQL Database using elastic database transactions</span></span> ][1]

## <a name="common-scenarios"></a><span data-ttu-id="50373-111">일반적인 시나리오</span><span class="sxs-lookup"><span data-stu-id="50373-111">Common scenarios</span></span>
<span data-ttu-id="50373-112">SQL DB용 탄력적 데이터베이스 트랜잭션은 여러 개의 다른 SQL 데이터베이스에 저장된 데이터에 대한 응용 프로그램의 원자성 변경을 가능하게 합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-112">Elastic database transactions for SQL DB enable applications to make atomic changes to data stored in several different SQL Databases.</span></span> <span data-ttu-id="50373-113">미리 보기는 C# 및 .NET의 클라이언트 쪽 개발 환경에 중점을 둡니다.</span><span class="sxs-lookup"><span data-stu-id="50373-113">The preview focuses on client-side development experiences in C# and .NET.</span></span> <span data-ttu-id="50373-114">T-SQL을 사용한 서버 쪽 환경은 차후에 계획되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-114">A server-side experience using T-SQL is planned for a later time.</span></span>  
<span data-ttu-id="50373-115">탄력적 데이터베이스 트랜잭션은 다음과 같은 시나리오를 대상으로 합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-115">Elastic database transactions targets the following scenarios:</span></span>

* <span data-ttu-id="50373-116">Azure의 다중 데이터베이스 응용 프로그램: 이 시나리오의 경우 데이터가 SQL DB의 여러 데이터베이스에 걸쳐 수직으로 분할되어 있고 다른 종류의 데이터가 다른 데이터베이스에 상주합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-116">Multi-database applications in Azure: With this scenario, data is vertically partitioned across several databases in SQL DB such that different kinds of data reside on different databases.</span></span> <span data-ttu-id="50373-117">일부 작업은 둘 이상의 데이터베이스에 보관되는 데이터에 대한 변경을 필요로 합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-117">Some operations require changes to data which is kept in two or more databases.</span></span> <span data-ttu-id="50373-118">응용 프로그램은 여러 데이터베이스에 걸쳐 변경을 조정하고 원자성을 보장하기 위해 탄력적 데이터베이스 트랜잭션을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-118">The application uses elastic database transactions to coordinate the changes across databases and ensure atomicity.</span></span>
* <span data-ttu-id="50373-119">Azure의 분할된 데이터베이스 응용 프로그램: 이 시나리오의 경우, 데이터 계층은 [탄력적 데이터베이스 클라이언트 라이브러리](sql-database-elastic-database-client-library.md) 또는 자체 분할을 사용하여 SQL DB의 여러 데이터베이스에 걸쳐있는 데이터를 수평적으로 분할합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-119">Sharded database applications in Azure: With this scenario, the data tier uses the [Elastic Database client library](sql-database-elastic-database-client-library.md) or self-sharding to horizontally partition the data across many databases in SQL DB.</span></span> <span data-ttu-id="50373-120">한 가지 주요한 사용 사례는 여러 테넌트에 변경이 미칠 때 분할된 다중 테넌트 응용 프로그램에 원자성 변경을 수행해야 하는 경우입니다.</span><span class="sxs-lookup"><span data-stu-id="50373-120">One prominent use case is the need to perform atomic changes for a sharded multi-tenant application when changes span tenants.</span></span> <span data-ttu-id="50373-121">서로 다른 데이터베이스에 상주하는 하나의 테넌트에서 다른 테넌트로 전송하는 인스턴스를 생각해 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-121">Think for instance of a transfer from one tenant to another, both residing on different databases.</span></span> <span data-ttu-id="50373-122">두 번째 사례는 대규모 테넌트에 필요한 용량을 공급하기 위한 세분화된 분할이며, 일반적으로 원자성 작업이 동일한 테넌트의 여러 데이터베이스에까지 결과적으로 영향을 미쳐야 하는 필요성을 수반합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-122">A second case is fine-grained sharding to accommodate capacity needs for a large tenant which in turn typically implies that some atomic operations needs to stretch across several databases used for the same tenant.</span></span> <span data-ttu-id="50373-123">세 번째 사례는 여러 데이터베이스에 걸쳐 복제되는 참조 데이터에 대한 원자성 업데이트입니다.</span><span class="sxs-lookup"><span data-stu-id="50373-123">A third case is atomic updates to reference data that are replicated across databases.</span></span> <span data-ttu-id="50373-124">이러한 방식의 트랜잭션 처리된, 원자성, 작업은 미리 보기를 사용하여 여러 데이터베이스에 걸쳐 조정될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-124">Atomic, transacted, operations along these lines can now be coordinated across several databases using the preview.</span></span>
  <span data-ttu-id="50373-125">탄력적 데이터베이스 트랜잭션은 여러 데이터베이스에 걸쳐 트랜잭션 원자성을 보장하기 위해 2단계 커밋을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-125">Elastic database transactions use two-phase commit to ensure transaction atomicity across databases.</span></span> <span data-ttu-id="50373-126">이것은 단일 트랜잭션 내에 한 번에 100개 미만의 데이터베이스가 관여되는 트랜잭션에 적합합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-126">It is a good fit for transactions that involve less than 100 databases at a time within a single transaction.</span></span> <span data-ttu-id="50373-127">이 한도가 강제로 적용되지는 않지만, 한도를 초과하는 경우 탄력적 데이터베이스의 성능 및 성공률이 불리해질 수 있다는 것을 예상해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-127">These limits are not enforced, but one should expect performance and success rates for elastic database transactions to suffer when exceeding these limits.</span></span>

## <a name="installation-and-migration"></a><span data-ttu-id="50373-128">설치 및 마이그레이션</span><span class="sxs-lookup"><span data-stu-id="50373-128">Installation and migration</span></span>
<span data-ttu-id="50373-129">SQL DB의 탄력적 데이터베이스 트랜잭션 기능은 .NET 라이브러리 System.Data.dll 및 System.Transactions.dll 업데이트를 통해 제공됩니다.</span><span class="sxs-lookup"><span data-stu-id="50373-129">The capabilities for elastic database transactions in SQL DB are provided through updates to the .NET libraries System.Data.dll and System.Transactions.dll.</span></span> <span data-ttu-id="50373-130">DLL은 원자성을 보장하기 위해 필요한 경우 2단계 커밋이 사용되도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-130">The DLLs ensure that two-phase commit is used where necessary to ensure atomicity.</span></span> <span data-ttu-id="50373-131">탄력적 데이터베이스 트랜잭션을 사용하여 응용 프로그램 개발을 시작하려면 [.NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) 이상 버전을 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-131">To start developing applications using elastic database transactions, install [.NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) or a later version.</span></span> <span data-ttu-id="50373-132">이전 버전의 .NET framework를 실행하면, 트랜잭션이 분산 트랜잭션으로 승격하지 못하고 예외가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-132">When running on an earlier version of the .NET framework, transactions will fail to promote to a distributed transaction and an exception will be raised.</span></span>

<span data-ttu-id="50373-133">설치 후에는 SQL DB 연결과 함께 System.Transactions에 분산 트랜잭션 API를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-133">After installation, you can use the distributed transaction APIs in System.Transactions with connections to SQL DB.</span></span> <span data-ttu-id="50373-134">기존 MSDTC 응용 프로그램에서 이러한 API를 사용하고 있는 경우에는 4.6.1 Framework를 설치한 후에 .NET 4.6에 대한 기존 응용 프로그램을 간단히 다시 빌드합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-134">If you have existing MSDTC applications using these APIs, simply rebuild your existing applications for .NET 4.6 after installing the 4.6.1 Framework.</span></span> <span data-ttu-id="50373-135">프로젝트가 .NET 4.6을 대상으로 하는 경우에는, 새 Framework 버전에서 업데이트된 DLL이 자동으로 사용되고 분산 트랜잭션 API 호출이 SQL DB 연결과 함께 성공합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-135">If your projects target .NET 4.6, they will automatically use the updated DLLs from the new Framework version and distributed transaction API calls in combination with connections to SQL DB will now succeed.</span></span>

<span data-ttu-id="50373-136">탄력적 데이터베이스 트랜잭션은 MSDTC를 설치할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-136">Remember that elastic database transactions do not require installing MSDTC.</span></span> <span data-ttu-id="50373-137">대신 탄력적 데이터베이스 트랜잭션은 SQL DB 내에서 SQL DB에 의해 직접적으로 관리됩니다.</span><span class="sxs-lookup"><span data-stu-id="50373-137">Instead, elastic database transactions are directly managed by and within SQL DB.</span></span> <span data-ttu-id="50373-138">분산된 트랜잭션을 SQL DB와 사용하기 위해 MSDTC 배포가 필요하지 않기 때문에 클라우드 시나리오를 상당히 간소화시킵니다.</span><span class="sxs-lookup"><span data-stu-id="50373-138">This significantly simplifies cloud scenarios since a deployment of MSDTC is not necessary to use distributed transactions with SQL DB.</span></span> <span data-ttu-id="50373-139">섹션 4는 탄력적 데이터베이스 트랜잭션 배포 방법 및 필요한 .NET framework를 Azure에 대한 클라우드 응용 프로그램과 함께 보다 자세히 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-139">Section 4 explains in more detail how to deploy elastic database transactions and the required .NET framework together with your cloud applications to Azure.</span></span>

## <a name="development-experience"></a><span data-ttu-id="50373-140">개발 환경</span><span class="sxs-lookup"><span data-stu-id="50373-140">Development experience</span></span>
### <a name="multi-database-applications"></a><span data-ttu-id="50373-141">다중 데이터베이스 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="50373-141">Multi-database applications</span></span>
<span data-ttu-id="50373-142">다음 샘플 코드는 .NET System.Transactions와 친숙한 프로그래밍 환경을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-142">The following sample code uses the familiar programming experience with .NET System.Transactions.</span></span> <span data-ttu-id="50373-143">TransactionScope 클래스는 .NET에서 앰비언트 트랜잭션을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-143">The TransactionScope class establishes an ambient transaction in .NET.</span></span> <span data-ttu-id="50373-144">(“앰비언트 트랜잭션”이란 현재 스레드에 존재하는 트랜잭션입니다.) 모든 연결은 트랜잭션에 참여하는 TransactionScope 내에서 열려 있습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-144">(An “ambient transaction” is one that lives in the current thread.) All connections opened within the TransactionScope participate in the transaction.</span></span> <span data-ttu-id="50373-145">다른 데이터베이스가 참여하면, 트랜잭션은 분산 트랜잭션으로 자동 승격됩니다.</span><span class="sxs-lookup"><span data-stu-id="50373-145">If different databases participate, the transaction is automatically elevated to a distributed transaction.</span></span> <span data-ttu-id="50373-146">트랜잭션의 결과는 커밋을 나타내기 위해 완료해야 하는 범위를 설정하여 제어됩니다.</span><span class="sxs-lookup"><span data-stu-id="50373-146">The outcome of the transaction is controlled by setting the scope to complete to indicate a commit.</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = new SqlConnection(connStrDb1))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = new SqlConnection(connStrDb2))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T2 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }

### <a name="sharded-database-applications"></a><span data-ttu-id="50373-147">분할된 데이터베이스 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="50373-147">Sharded database applications</span></span>
<span data-ttu-id="50373-148">SQL DB용 탄력적 데이터베이스 트랜잭션은 확장된 데이터 층에 대한 연결을 열기 위해 탄력적 데이터베이스 라이브러리의 OpenConnectionForKey 메서드를 사용할 수 있는 분산 트랜잭션 조정을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-148">Elastic database transactions for SQL DB also support coordinating distributed transactions where you use the OpenConnectionForKey method of the elastic database client library to open connections for a scaled out data tier.</span></span> <span data-ttu-id="50373-149">여러 개의 다른 분할 키 값에 걸쳐 변경 사항에 대해 트랜잭션 일관성을 보장해야 하는 경우를 고려해 보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-149">Consider cases where you need to guarantee transactional consistency for changes across several different sharding key values.</span></span> <span data-ttu-id="50373-150">다른 분할 키 값을 호스팅하는 분할에 대한 연결은 OpenConnectionForKey를 사용하여 중개됩니다.</span><span class="sxs-lookup"><span data-stu-id="50373-150">Connections to the shards hosting the different sharding key values are brokered using OpenConnectionForKey.</span></span> <span data-ttu-id="50373-151">일반적인 상황에서 트랜잭션 보장이 분산 트랜잭션을 요구하도록 하기 위해서 다른 분할에 연결될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-151">In the general case, the connections can be to different shards such that ensuring transactional guarantees requires a distributed transaction.</span></span> <span data-ttu-id="50373-152">다음 코드 샘플에서 이 접근 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="50373-152">The following code sample illustrates this approach.</span></span> <span data-ttu-id="50373-153">shardmap이라는 매개 변수가 탄력적 데이터베이스 클라이언트 라이브러리의 분할된 데이터베이스 맵을 나타내기 위해 사용된다고 가정합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-153">It assumes that a variable called shardmap is used to represent a shard map from the elastic database client library:</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = shardmap.OpenConnectionForKey(tenantId1, credentialsStr))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = shardmap.OpenConnectionForKey(tenantId2, credentialsStr))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T1 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }


## <a name="net-installation-for-azure-cloud-services"></a><span data-ttu-id="50373-154">Azure 클라우드 서비스용 .NET 설치</span><span class="sxs-lookup"><span data-stu-id="50373-154">.NET installation for Azure Cloud Services</span></span>
<span data-ttu-id="50373-155">Azure에서는 .NET 응용 프로그램을 호스트하는 여러 제품을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-155">Azure provides several offerings to host .NET applications.</span></span> <span data-ttu-id="50373-156">[Azure 앱 서비스, 클라우드 서비스 및 가상 컴퓨터 비교](../app-service-web/choose-web-site-cloud-service-vm.md)에서 다양한 제품을 비교할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-156">A comparison of the different offerings is available in [Azure App Service, Cloud Services, and Virtual Machines comparison](../app-service-web/choose-web-site-cloud-service-vm.md).</span></span> <span data-ttu-id="50373-157">제품의 게스트 OS가 탄력적인 트랜잭션에 필요한 .NET 4.6.1보다 작은 경우 게스트 OS를 4.6.1로 업그레이드해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-157">If the guest OS of the offering is smaller than .NET 4.6.1 required for elastic transactions, you need to upgrade the guest OS to 4.6.1.</span></span> 

<span data-ttu-id="50373-158">Azure 앱 서비스의 경우에는 현재 게스트 OS 업그레이드가 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-158">For Azure App Services, upgrades to the guest OS are currently not supported.</span></span> <span data-ttu-id="50373-159">Azure 가상 컴퓨터의 경우 VM에 로그인하여 최신 .NET Framework용 설치 관리자를 실행하기만 하면 됩니다.</span><span class="sxs-lookup"><span data-stu-id="50373-159">For Azure Virtual Machines, simply log into the VM and run the installer for the latest .NET framework.</span></span> <span data-ttu-id="50373-160">Azure 클라우드 서비스의 경우 최신 .NET 버전의 설치를 배포의 시작 작업에 포함해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-160">For Azure Cloud Services, you need to include the installation of a newer .NET version into the startup tasks of your deployment.</span></span> <span data-ttu-id="50373-161">개념 및 단계는 [클라우드 서비스 역할에 .NET 설치](../cloud-services/cloud-services-dotnet-install-dotnet.md)에 문서화되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-161">The concepts and steps are documented in [Install .NET on a Cloud Service Role](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span></span>  

<span data-ttu-id="50373-162">.NET 4.6.1용 설치 관리자는 Azure 클라우드 서비스에서 프로세스를 부트스트랩하는 과정에서 .NET 4.6용 설치 관리자보다 더 많은 임시 저장 공간을 필요로 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-162">Note that the installer for .NET 4.6.1 may require more temporary storage during the bootstrapping process on Azure cloud services than the installer for .NET 4.6.</span></span> <span data-ttu-id="50373-163">성공적인 설치를 위해 다음 예에서처럼 LocalResources 섹션의 ServiceDefinition.csdef 파일과 시작 작업의 환경 설정에서 Azure 클라우드 서비스의 임시 저장 공간을 늘려야 합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-163">To ensure a successful installation, you need to increase temporary storage for your Azure cloud service in your ServiceDefinition.csdef file in the LocalResources section and the environment settings of your startup task, as shown in the following sample:</span></span>

    <LocalResources>
    ...
        <LocalStorage name="TEMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
        <LocalStorage name="TMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
    </LocalResources>
    <Startup>
        <Task commandLine="install.cmd" executionContext="elevated" taskType="simple">
            <Environment>
        ...
                <Variable name="TEMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TEMP']/@path" />
                </Variable>
                <Variable name="TMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TMP']/@path" />
                </Variable>
            </Environment>
        </Task>
    </Startup>

## <a name="transactions-across-multiple-servers"></a><span data-ttu-id="50373-164">여러 서버 간의 트랜잭션</span><span class="sxs-lookup"><span data-stu-id="50373-164">Transactions across multiple servers</span></span>
<span data-ttu-id="50373-165">탄력적 데이터베이스 트랜잭션은 Azure SQL 데이터베이스의 여러 논리 서버에 걸쳐 지원됩니다.</span><span class="sxs-lookup"><span data-stu-id="50373-165">Elastic database transactions are supported across different logical servers in Azure SQL Database.</span></span> <span data-ttu-id="50373-166">트랜잭션이 논리 서버 경계를 교차하는 경우 참여하는 서버는 먼저 상호 통신 관계가 설정되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-166">When transactions cross logical server boundaries, the participating servers first need to be entered into a mutual communication relationship.</span></span> <span data-ttu-id="50373-167">통신 관계가 설정된 후에는 두 서버 중 하나의 모든 데이터베이스가 다른 서버 데이터베이스와의 탄력적인 트랜잭션에 참여할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-167">Once the communication relationship has been established, any database in any of the two servers can participate in elastic transactions with databases from the other server.</span></span> <span data-ttu-id="50373-168">트랜잭션이 둘 이상의 논리 서버에 걸친 경우 모든 논리 서버 쌍에 대해 통신 관계가 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-168">With transactions spanning more than two logical servers, a communication relationship needs to be in place for any pair of logical servers.</span></span>

<span data-ttu-id="50373-169">다음 PowerShell cmdlet을 사용하여 탄력적인 데이터베이스 트랜잭션에 대한 서버 간 통신 관계를 관리할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-169">Use the following PowerShell cmdlets to manage cross-server communication relationships for elastic database transactions:</span></span>

* <span data-ttu-id="50373-170">**New-AzureRmSqlServerCommunicationLink**: Azure SQL DB에서 두 개의 논리 서버 간에 새로운 통신 관계를 만들려면 이 cmdlet을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-170">**New-AzureRmSqlServerCommunicationLink**: Use this cmdlet to create a new communication relationship between two logical servers in Azure SQL DB.</span></span> <span data-ttu-id="50373-171">관계는 대칭적입니다. 즉, 두 서버 모두 상대 서버와의 트랜잭션을 시작할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-171">The relationship is symmetric which means both servers can initiate transactions with the other server.</span></span>
* <span data-ttu-id="50373-172">**Get-AzureRmSqlServerCommunicationLink**: 기존 통신 관계와 해당 속성을 검색하려면 이 cmdlet을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-172">**Get-AzureRmSqlServerCommunicationLink**: Use this cmdlet to retrieve existing communication relationships and their properties.</span></span>
* <span data-ttu-id="50373-173">**Remove-AzureRmSqlServerCommunicationLink**: 기존 통신 관계와 해당 속성을 제거하려면 이 cmdlet을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-173">**Remove-AzureRmSqlServerCommunicationLink**: Use this cmdlet to remove an existing communication relationship.</span></span> 

## <a name="monitoring-transaction-status"></a><span data-ttu-id="50373-174">트랜잭션 상태 모니터링</span><span class="sxs-lookup"><span data-stu-id="50373-174">Monitoring transaction status</span></span>
<span data-ttu-id="50373-175">SQL DB의 동적 관리 뷰(DMV)를 사용하여 진행 중인 탄력적 데이터베이스 트랜잭션의 상태와 진행률을 모니터링합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-175">Use Dynamic Management Views (DMVs) in SQL DB to monitor status and progress of your ongoing elastic database transactions.</span></span> <span data-ttu-id="50373-176">트랜잭션과 관련된 모든 DMV는 SQL DB의 분산 트랜잭션과 관련이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-176">All DMVs related to transactions are relevant for distributed transactions in SQL DB.</span></span> <span data-ttu-id="50373-177">해당 DMV 목록은 [트랜잭션 관련 동적 관리 뷰 및 함수(Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx)에서 찾을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-177">You can find the corresponding list of DMVs here: [Transaction Related Dynamic Management Views and Functions (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span></span>

<span data-ttu-id="50373-178">다음 DMV는 특히 유용합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-178">These DMVs are particularly useful:</span></span>

* <span data-ttu-id="50373-179">**sys.dm\_tran\_active\_transactions**: 현재 활성 트랜잭션과 그 상태를 나열합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-179">**sys.dm\_tran\_active\_transactions**: Lists currently active transactions and their status.</span></span> <span data-ttu-id="50373-180">UOW(작업 단위) 열은 동일한 분산 트랜잭션에 속하는 다른 자식 트랜잭션을 식별할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-180">The UOW (Unit Of Work) column can identify the different child transactions that belong to the same distributed transaction.</span></span> <span data-ttu-id="50373-181">동일한 분산 트랜잭션 내의 모든 트랜잭션은 동일한 UOW 값을 갖습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-181">All transactions within the same distributed transaction carry the same UOW value.</span></span> <span data-ttu-id="50373-182">자세한 내용은 [DMV 설명서](https://msdn.microsoft.com/library/ms174302.aspx) 를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="50373-182">See the [DMV documentation](https://msdn.microsoft.com/library/ms174302.aspx) for more details.</span></span>
* <span data-ttu-id="50373-183">**sys.dm\_tran\_database\_transactions**: 로그에 트랜잭션 배치 같은 트랜잭션에 대한 추가적인 정보를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-183">**sys.dm\_tran\_database\_transactions**: Provides additional information about transactions, such as placement of the transaction in the log.</span></span> <span data-ttu-id="50373-184">자세한 내용은 [DMV 설명서](https://msdn.microsoft.com/library/ms186957.aspx) 를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="50373-184">See the [DMV documentation](https://msdn.microsoft.com/library/ms186957.aspx) for more details.</span></span>
* <span data-ttu-id="50373-185">**sys.dm\_tran\_locks**: 진행 중인 트랜잭션에 의해 현재 유지되는 잠금에 대한 정보를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-185">**sys.dm\_tran\_locks**: Provides information about the locks that are currently held by ongoing transactions.</span></span> <span data-ttu-id="50373-186">자세한 내용은 [DMV 설명서](https://msdn.microsoft.com/library/ms190345.aspx) 를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="50373-186">See the [DMV documentation](https://msdn.microsoft.com/library/ms190345.aspx) for more details.</span></span>

## <a name="limitations"></a><span data-ttu-id="50373-187">제한 사항</span><span class="sxs-lookup"><span data-stu-id="50373-187">Limitations</span></span>
<span data-ttu-id="50373-188">다음 제한 사항은 SQL DB의 탄력적 데이터베이스 트랜잭션에 현재 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="50373-188">The following limitations currently apply to elastic database transactions in SQL DB:</span></span>

* <span data-ttu-id="50373-189">SQL DB의 데이터베이스 간 트랜잭션만 지원됩니다.</span><span class="sxs-lookup"><span data-stu-id="50373-189">Only transactions across databases in SQL DB are supported.</span></span> <span data-ttu-id="50373-190">다른 [X/Open XA](https://en.wikipedia.org/wiki/X/Open_XA) 리소스 공급자 및 SQL DB 이외의 데이터베이스는 탄력적 데이터베이스 트랜잭션에 참여할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-190">Other [X/Open XA](https://en.wikipedia.org/wiki/X/Open_XA) resource providers and databases outside of SQL DB cannot participate in elastic database transactions.</span></span> <span data-ttu-id="50373-191">탄력적 데이터베이스 트랜잭션은 온-프레미스 SQL Server와 Azure SQL 데이터베이스 사이에서 확장될 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-191">That means that elastic database transactions cannot stretch across on premises SQL Server and Azure SQL Databases.</span></span> <span data-ttu-id="50373-192">온-프레미스 분산 트랜잭션을 위해서는 MSDTC를 계속 사용하세요.</span><span class="sxs-lookup"><span data-stu-id="50373-192">For distributed transactions on premises, continue to use MSDTC.</span></span> 
* <span data-ttu-id="50373-193">.NET 응용 프로그램의 클라이언트 조정 트랜잭션만 지원됩니다.</span><span class="sxs-lookup"><span data-stu-id="50373-193">Only client-coordinated transactions from a .NET application are supported.</span></span> <span data-ttu-id="50373-194">BEGIN DISTRIBUTED TRANSACTION 같은 T-SQL에 대한 서버 쪽 지원이 계획되어 있지만 아직 제공되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-194">Server-side support for T-SQL such as BEGIN DISTRIBUTED TRANSACTION is planned, but not yet available.</span></span> 
* <span data-ttu-id="50373-195">WCF 서비스에서 트랜잭션은 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-195">Transactions across WCF services are not supported.</span></span> <span data-ttu-id="50373-196">예를 들어 트랜잭션을 실행하는 WCF 서비스 메서드가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="50373-196">For example, you have a WCF service method that executes a transaction.</span></span> <span data-ttu-id="50373-197">트랜잭션 범위 내로 호출을 묶으면 [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception)으로 실패합니다.</span><span class="sxs-lookup"><span data-stu-id="50373-197">Enclosing the call within a transaction scope will fail as a [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span></span>

## <a name="next-steps"></a><span data-ttu-id="50373-198">다음 단계</span><span class="sxs-lookup"><span data-stu-id="50373-198">Next steps</span></span>
<span data-ttu-id="50373-199">의문 사항이 있으면 [SQL Database 포럼](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted)에 문의하고, 기능에 대한 요청이 있는 경우 해당 기능을 [SQL Database 사용자 의견 포럼](https://feedback.azure.com/forums/217321-sql-database/)에 추가하세요.</span><span class="sxs-lookup"><span data-stu-id="50373-199">For questions, please reach out to us on the [SQL Database forum](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) and for feature requests, please add them to the [SQL Database feedback forum](https://feedback.azure.com/forums/217321-sql-database/).</span></span>

<!--Image references-->
[1]: ./media/sql-database-elastic-transactions-overview/distributed-transactions.png



