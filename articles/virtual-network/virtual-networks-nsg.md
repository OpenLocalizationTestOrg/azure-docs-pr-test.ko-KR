---
title: "Azure의 네트워크 보안 그룹 | Microsoft Docs"
description: "네트워크 보안 그룹을 사용하여 Azure에서 분산된 방화벽을 사용하여 가상 네트워크 내에서 트래픽 흐름을 격리하고 제어하는 방법을 알아봅니다."
services: virtual-network
documentationcenter: na
author: jimdial
manager: timlt
editor: tysonn
ms.assetid: 20e850fc-6456-4b5f-9a3f-a8379b052bc9
ms.service: virtual-network
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/11/2016
ms.author: jdial
ms.openlocfilehash: fac6ee69b5f0377e0515ac9abeb28788cbef9b79
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/18/2017
---
# <a name="filter-network-traffic-with-network-security-groups"></a><span data-ttu-id="93e8d-103">네트워크 보안 그룹을 사용하여 네트워크 트래픽 필터링</span><span class="sxs-lookup"><span data-stu-id="93e8d-103">Filter network traffic with network security groups</span></span>

<span data-ttu-id="93e8d-104">NSG(네트워크 보안 그룹)에는 VNet(Azure Virtual Network)에 연결된 리소스에 대한 네트워크 트래픽을 허용하거나 거부하는 보안 규칙 목록이 포함되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-104">A network security group (NSG) contains a list of security rules that allow or deny network traffic to resources connected to Azure Virtual Networks (VNet).</span></span> <span data-ttu-id="93e8d-105">NSG는 서브넷, 개별 VM(클래식) 또는 VM(Resource Manager)에 연결된 개별 NIC(네트워크 인터페이스)와 연결될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-105">NSGs can be associated to subnets, individual VMs (classic), or individual network interfaces (NIC) attached to VMs (Resource Manager).</span></span> <span data-ttu-id="93e8d-106">NSG를 서브넷에 연결하면 규칙이 서브넷에 연결된 모든 리소스에 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-106">When an NSG is associated to a subnet, the rules apply to all resources connected to the subnet.</span></span> <span data-ttu-id="93e8d-107">또한 NSG를 VM 또는 NIC에 연결하여 트래픽을 더욱 제한할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-107">Traffic can further be restricted by also associating an NSG to a VM or NIC.</span></span>

> [!NOTE]
> <span data-ttu-id="93e8d-108">Azure에는 리소스를 만들고 작업하는 [Resource Manager와 클래식](../resource-manager-deployment-model.md)이라는 두 가지 배포 모델이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-108">Azure has two different deployment models for creating and working with resources:  [Resource Manager and classic](../resource-manager-deployment-model.md).</span></span> <span data-ttu-id="93e8d-109">이 문서에서는 두 모델을 모두 사용하여 설명하지만 대부분의 새로운 배포에는 리소스 관리자 모델을 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-109">This article covers using both models, but Microsoft recommends that most new deployments use the Resource Manager model.</span></span>

## <a name="nsg-resource"></a><span data-ttu-id="93e8d-110">NSG 리소스</span><span class="sxs-lookup"><span data-stu-id="93e8d-110">NSG resource</span></span>
<span data-ttu-id="93e8d-111">NSG에는 다음과 속성이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-111">NSGs contain the following properties:</span></span>

| <span data-ttu-id="93e8d-112">속성</span><span class="sxs-lookup"><span data-stu-id="93e8d-112">Property</span></span> | <span data-ttu-id="93e8d-113">설명</span><span class="sxs-lookup"><span data-stu-id="93e8d-113">Description</span></span> | <span data-ttu-id="93e8d-114">제약 조건</span><span class="sxs-lookup"><span data-stu-id="93e8d-114">Constraints</span></span> | <span data-ttu-id="93e8d-115">고려 사항</span><span class="sxs-lookup"><span data-stu-id="93e8d-115">Considerations</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="93e8d-116">Name</span><span class="sxs-lookup"><span data-stu-id="93e8d-116">Name</span></span> |<span data-ttu-id="93e8d-117">NSG 이름</span><span class="sxs-lookup"><span data-stu-id="93e8d-117">Name for the NSG</span></span> |<span data-ttu-id="93e8d-118">지역 내에서 고유해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-118">Must be unique within the region.</span></span><br/><span data-ttu-id="93e8d-119">문자, 숫자, 밑줄, 마침표 및 하이픈을 포함할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-119">Can contain letters, numbers, underscores, periods, and hyphens.</span></span><br/><span data-ttu-id="93e8d-120">문자 또는 숫자로 시작해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-120">Must start with a letter or number.</span></span><br/><span data-ttu-id="93e8d-121">문자, 숫자 또는 밑줄로 끝나야 합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-121">Must end with a letter, number, or underscore.</span></span><br/><span data-ttu-id="93e8d-122">80자를 초과할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-122">Cannot exceed 80 characters.</span></span> |<span data-ttu-id="93e8d-123">NSG를 여러 개 만들어야 하는 경우 NSG 기능을 쉽게 식별할 수 있는 명명 규칙을 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-123">Since you may need to create several NSGs, make sure you have a naming convention that makes it easy to identify the function of your NSGs.</span></span> |
| <span data-ttu-id="93e8d-124">지역</span><span class="sxs-lookup"><span data-stu-id="93e8d-124">Region</span></span> |<span data-ttu-id="93e8d-125">NSG를 만들 Azure [지역](https://azure.microsoft.com/regions)</span><span class="sxs-lookup"><span data-stu-id="93e8d-125">Azure [region](https://azure.microsoft.com/regions) where the NSG is created.</span></span> |<span data-ttu-id="93e8d-126">NSG는 NSG와 동일한 지역 내의 리소스에만 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-126">NSGs can only be associated to resources within the same region as the NSG.</span></span> |<span data-ttu-id="93e8d-127">지역별 NSG 수에 대한 자세한 내용은 [Azure 제한](../azure-subscription-service-limits.md#virtual-networking-limits-classic) 문서를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="93e8d-127">To learn about how many NSGs you can have per region, read the [Azure limits](../azure-subscription-service-limits.md#virtual-networking-limits-classic) article.</span></span>|
| <span data-ttu-id="93e8d-128">리소스 그룹</span><span class="sxs-lookup"><span data-stu-id="93e8d-128">Resource group</span></span> |<span data-ttu-id="93e8d-129">NSG가 속한 [리소스 그룹](../azure-resource-manager/resource-group-overview.md#resource-groups)</span><span class="sxs-lookup"><span data-stu-id="93e8d-129">The [resource group](../azure-resource-manager/resource-group-overview.md#resource-groups) the NSG exists in.</span></span> |<span data-ttu-id="93e8d-130">NSG는 하나의 리소스 그룹에 속하지만, NSG와 동일한 Azure 지역의 일부인 리소스는 모든 리소스 그룹의 리소스에 연결될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-130">Although an NSG exists in a resource group, it can be associated to resources in any resource group, as long as the resource is part of the same Azure region as the NSG.</span></span> |<span data-ttu-id="93e8d-131">리소스 그룹은 하나의 배포 단위로 여러 리소스를 함께 관리하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-131">Resource groups are used to manage multiple resources together, as a deployment unit.</span></span><br/><span data-ttu-id="93e8d-132">연결된 리소스와 함께 NSG를 그룹화하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-132">You may consider grouping the NSG with resources it is associated to.</span></span> |
| <span data-ttu-id="93e8d-133">규칙</span><span class="sxs-lookup"><span data-stu-id="93e8d-133">Rules</span></span> |<span data-ttu-id="93e8d-134">허용되거나 거부되는 트래픽을 정의하는 인바운드 또는 아웃바운드 규칙</span><span class="sxs-lookup"><span data-stu-id="93e8d-134">Inbound or outbound rules that define what traffic is allowed or denied.</span></span> | |<span data-ttu-id="93e8d-135">이 문서의 [NSG 규칙](#Nsg-rules) 섹션을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="93e8d-135">See the [NSG rules](#Nsg-rules) section of this article.</span></span> |

> [!NOTE]
> <span data-ttu-id="93e8d-136">끝점 기반 ACL과 네트워크 보안 그룹은 동일한 VM 인스턴스에서 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-136">Endpoint-based ACLs and network security groups are not supported on the same VM instance.</span></span> <span data-ttu-id="93e8d-137">NSG를 사용하려는데 끝점 ACL이 이미 있는 경우 먼저, 끝점 ACL을 제거합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-137">If you want to use an NSG and have an endpoint ACL already in place, first remove the endpoint ACL.</span></span> <span data-ttu-id="93e8d-138">ACL을 제거하는 방법에 대한 자세한 내용은 [PowerShell을 사용하여 끝점에 대한 ACL(Access Control 목록) 관리](virtual-networks-acl-powershell.md) 문서를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="93e8d-138">To learn how to remove an ACL, read the [Managing Access Control Lists (ACLs) for Endpoints by using PowerShell](virtual-networks-acl-powershell.md) article.</span></span>
> 

### <a name="nsg-rules"></a><span data-ttu-id="93e8d-139">NSG 규칙</span><span class="sxs-lookup"><span data-stu-id="93e8d-139">NSG rules</span></span>
<span data-ttu-id="93e8d-140">NSG 규칙은 다음 속성을 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-140">NSG rules contain the following properties:</span></span>

| <span data-ttu-id="93e8d-141">속성</span><span class="sxs-lookup"><span data-stu-id="93e8d-141">Property</span></span> | <span data-ttu-id="93e8d-142">설명</span><span class="sxs-lookup"><span data-stu-id="93e8d-142">Description</span></span> | <span data-ttu-id="93e8d-143">제약 조건</span><span class="sxs-lookup"><span data-stu-id="93e8d-143">Constraints</span></span> | <span data-ttu-id="93e8d-144">고려 사항</span><span class="sxs-lookup"><span data-stu-id="93e8d-144">Considerations</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="93e8d-145">**Name**</span><span class="sxs-lookup"><span data-stu-id="93e8d-145">**Name**</span></span> |<span data-ttu-id="93e8d-146">규칙의 이름</span><span class="sxs-lookup"><span data-stu-id="93e8d-146">Name for the rule.</span></span> |<span data-ttu-id="93e8d-147">지역 내에서 고유해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-147">Must be unique within the region.</span></span><br/><span data-ttu-id="93e8d-148">문자, 숫자, 밑줄, 마침표 및 하이픈을 포함할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-148">Can contain letters, numbers, underscores, periods, and hyphens.</span></span><br/><span data-ttu-id="93e8d-149">문자 또는 숫자로 시작해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-149">Must start with a letter or number.</span></span><br/><span data-ttu-id="93e8d-150">문자, 숫자 또는 밑줄로 끝나야 합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-150">Must end with a letter, number, or underscore.</span></span><br/><span data-ttu-id="93e8d-151">80자를 초과할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-151">Cannot exceed 80 characters.</span></span> |<span data-ttu-id="93e8d-152">NSG에는 여러 규칙이 있을 수 있으므로 규칙의 기능을 식별할 수 있는 명명 규칙을 따라야 합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-152">You may have several rules within an NSG, so make sure you follow a naming convention that allows you to identify the function of your rule.</span></span> |
| <span data-ttu-id="93e8d-153">**프로토콜**</span><span class="sxs-lookup"><span data-stu-id="93e8d-153">**Protocol**</span></span> |<span data-ttu-id="93e8d-154">규칙과 일치하는 프로토콜</span><span class="sxs-lookup"><span data-stu-id="93e8d-154">Protocol to match for the rule.</span></span> |<span data-ttu-id="93e8d-155">TCP, UDP, 또는 *</span><span class="sxs-lookup"><span data-stu-id="93e8d-155">TCP, UDP, or *</span></span> |<span data-ttu-id="93e8d-156">프로토콜로 *(별표)를 사용하면 UDP와 TCP뿐만 아니라 ICMP(동부 및 서부 트래픽만)도 포함되며, 필요한 규칙의 수를 줄일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-156">Using * as a protocol includes ICMP (East-West traffic only), as well as UDP and TCP, and may reduce the number of rules you need.</span></span><br/><span data-ttu-id="93e8d-157">동시에 *를 사용하면 너무 광범위할 수 있으므로 필요한 경우에만 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-157">At the same time, using * might be too broad an approach, so it's recommended that you use * only when necessary.</span></span> |
| <span data-ttu-id="93e8d-158">**원본 포트 범위**</span><span class="sxs-lookup"><span data-stu-id="93e8d-158">**Source port range**</span></span> |<span data-ttu-id="93e8d-159">규칙과 일치하는 원본 포트 범위</span><span class="sxs-lookup"><span data-stu-id="93e8d-159">Source port range to match for the rule.</span></span> |<span data-ttu-id="93e8d-160">1-65535의 단일 포트 번호, 포트 범위(예: 1-65535) 또는 *(모든 포트의 경우)</span><span class="sxs-lookup"><span data-stu-id="93e8d-160">Single port number from 1 to 65535, port range (example: 1-65535), or * (for all ports).</span></span> |<span data-ttu-id="93e8d-161">원본 포트는 사용 후 삭제될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-161">Source ports could be ephemeral.</span></span> <span data-ttu-id="93e8d-162">클라이언트 프로그램에서 특정 포트를 사용하지 않는 한 대부분의 경우 "*"를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-162">Unless your client program is using a specific port, use * in most cases.</span></span><br/><span data-ttu-id="93e8d-163">여러 규칙이 필요하지 않도록 포트 범위를 가능한 한 많이 사용하도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-163">Try to use port ranges as much as possible to avoid the need for multiple rules.</span></span><br/><span data-ttu-id="93e8d-164">여러 포트 또는 포트 범위는 쉼표로 그룹화할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-164">Multiple ports or port ranges cannot be grouped by a comma.</span></span> |
| <span data-ttu-id="93e8d-165">**대상 포트 범위**</span><span class="sxs-lookup"><span data-stu-id="93e8d-165">**Destination port range**</span></span> |<span data-ttu-id="93e8d-166">규칙과 일치하는 대상 포트 범위</span><span class="sxs-lookup"><span data-stu-id="93e8d-166">Destination port range to match for the rule.</span></span> |<span data-ttu-id="93e8d-167">1-65535의 단일 포트 번호, 포트 범위(예: 1-65535) 또는 \*(모든 포트의 경우)</span><span class="sxs-lookup"><span data-stu-id="93e8d-167">Single port number from 1 to 65535, port range (example: 1-65535), or \* (for all ports).</span></span> |<span data-ttu-id="93e8d-168">여러 규칙이 필요하지 않도록 포트 범위를 가능한 한 많이 사용하도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-168">Try to use port ranges as much as possible to avoid the need for multiple rules.</span></span><br/><span data-ttu-id="93e8d-169">여러 포트 또는 포트 범위는 쉼표로 그룹화할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-169">Multiple ports or port ranges cannot be grouped by a comma.</span></span> |
| <span data-ttu-id="93e8d-170">**원본 주소 접두사**</span><span class="sxs-lookup"><span data-stu-id="93e8d-170">**Source address prefix**</span></span> |<span data-ttu-id="93e8d-171">규칙과 일치하는 원본 주소 접두사 또는 태그</span><span class="sxs-lookup"><span data-stu-id="93e8d-171">Source address prefix or tag to match for the rule.</span></span> |<span data-ttu-id="93e8d-172">단일 IP 주소(예: 10.10.10.10), IP 서브넷(예: 192.168.1.0/24), [기본 태그](#default-tags) 또는 *(모든 주소의 경우)</span><span class="sxs-lookup"><span data-stu-id="93e8d-172">Single IP address (example: 10.10.10.10), IP subnet (example: 192.168.1.0/24), [default tag](#default-tags), or * (for all addresses).</span></span> |<span data-ttu-id="93e8d-173">범위, 기본 태그, *를 사용하여 규칙의 수를 줄이는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-173">Consider using ranges, default tags, and * to reduce the number of rules.</span></span> |
| <span data-ttu-id="93e8d-174">**대상 주소 접두사**</span><span class="sxs-lookup"><span data-stu-id="93e8d-174">**Destination address prefix**</span></span> |<span data-ttu-id="93e8d-175">규칙과 일치하는 대상 주소 접두사 또는 태그</span><span class="sxs-lookup"><span data-stu-id="93e8d-175">Destination address prefix or tag to match for the rule.</span></span> | <span data-ttu-id="93e8d-176">단일 IP 주소(예: 10.10.10.10), IP 서브넷(예: 192.168.1.0/24), [기본 태그](#default-tags) 또는 *(모든 주소의 경우)</span><span class="sxs-lookup"><span data-stu-id="93e8d-176">Single IP address (example: 10.10.10.10), IP subnet (example: 192.168.1.0/24), [default tag](#default-tags), or * (for all addresses).</span></span> |<span data-ttu-id="93e8d-177">범위, 기본 태그, *를 사용하여 규칙의 수를 줄이는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-177">Consider using ranges, default tags, and * to reduce the number of rules.</span></span> |
| <span data-ttu-id="93e8d-178">**방향**</span><span class="sxs-lookup"><span data-stu-id="93e8d-178">**Direction**</span></span> |<span data-ttu-id="93e8d-179">규칙과 일치하는 트래픽의 방향</span><span class="sxs-lookup"><span data-stu-id="93e8d-179">Direction of traffic to match for the rule.</span></span> |<span data-ttu-id="93e8d-180">인바운드 또는 아웃바운드</span><span class="sxs-lookup"><span data-stu-id="93e8d-180">Inbound or outbound.</span></span> |<span data-ttu-id="93e8d-181">인바운드 규칙과 아웃바운드 규칙은 방향에 따라 개별적으로 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-181">Inbound and outbound rules are processed separately, based on direction.</span></span> |
| <span data-ttu-id="93e8d-182">**우선 순위**</span><span class="sxs-lookup"><span data-stu-id="93e8d-182">**Priority**</span></span> |<span data-ttu-id="93e8d-183">규칙은 우선 순위에 따라 검사됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-183">Rules are checked in the order of priority.</span></span> <span data-ttu-id="93e8d-184">규칙이 적용되면 일치하는 규칙은 더 이상 테스트되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-184">Once a rule applies, no more rules are tested for matching.</span></span> | <span data-ttu-id="93e8d-185">100~4096 사이의 숫자</span><span class="sxs-lookup"><span data-stu-id="93e8d-185">Number between 100 and 4096.</span></span> | <span data-ttu-id="93e8d-186">나중에 만들 수 있는 새로운 규칙을 위해 각 규칙마다 우선 순위를 100씩 건너뛰도록 만드는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-186">Consider creating rules jumping priorities by 100 for each rule to leave space for new rules you might create in the future.</span></span> |
| <span data-ttu-id="93e8d-187">**Access**</span><span class="sxs-lookup"><span data-stu-id="93e8d-187">**Access**</span></span> |<span data-ttu-id="93e8d-188">규칙이 일치하는 경우 적용할 액세스 유형</span><span class="sxs-lookup"><span data-stu-id="93e8d-188">Type of access to apply if the rule matches.</span></span> | <span data-ttu-id="93e8d-189">허용 또는 거부</span><span class="sxs-lookup"><span data-stu-id="93e8d-189">Allow or deny.</span></span> | <span data-ttu-id="93e8d-190">패킷에 대한 허용 규칙을 찾을 수 없으면 해당 패킷이 삭제됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-190">Keep in mind that if an allow rule is not found for a packet, the packet is dropped.</span></span> |

<span data-ttu-id="93e8d-191">NSG에는 두 가지 규칙 집합, 즉 인바운드 및 아웃바운드가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-191">NSGs contain two sets of rules: Inbound and outbound.</span></span> <span data-ttu-id="93e8d-192">규칙에 대한 우선 순위는 각 집합 내에서 고유해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-192">The priority for a rule must be unique within each set.</span></span> 

![NSG 규칙 처리](./media/virtual-network-nsg-overview/figure3.png) 

<span data-ttu-id="93e8d-194">위의 그림에서는 NSG 규칙을 처리하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-194">The previous picture shows how NSG rules are processed.</span></span>

### <a name="default-tags"></a><span data-ttu-id="93e8d-195">기본 태그</span><span class="sxs-lookup"><span data-stu-id="93e8d-195">Default Tags</span></span>
<span data-ttu-id="93e8d-196">기본 태그는 IP 주소의 범주를 다루기 위해 시스템에서 제공한 식별자입니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-196">Default tags are system-provided identifiers to address a category of IP addresses.</span></span> <span data-ttu-id="93e8d-197">모든 규칙의 **원본 주소 접두사** 및 **대상 주소 접두사** 속성에 있는 기본 태그를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-197">You can use default tags in the **source address prefix** and **destination address prefix** properties of any rule.</span></span> <span data-ttu-id="93e8d-198">다음 3개의 기본 태그를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-198">There are three default tags you can use:</span></span>

* <span data-ttu-id="93e8d-199">**VirtualNetwork**(Resource Manager) (클래식의 경우 **VIRTUAL_NETWORK**): 이 태그에는 가상 네트워크 주소 공간(Azure에 정의된 CIDR 범위), 연결된 모든 온-프레미스 주소 공간 및 연결된 Azure VNet(로컬 네트워크)이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-199">**VirtualNetwork** (Resource Manager) (**VIRTUAL_NETWORK** for classic): This tag includes the virtual network address space (CIDR ranges defined in Azure), all connected on-premises address spaces, and connected Azure VNets (local networks).</span></span>
* <span data-ttu-id="93e8d-200">**AZURE_LOADBALANCER**(Resource Manager) (클래식의 경우 **AzureLoadBalancer**): 이 태그는 Azure의 인프라 부하 분산 장치를 나타내며,</span><span class="sxs-lookup"><span data-stu-id="93e8d-200">**AzureLoadBalancer** (Resource Manager) (**AZURE_LOADBALANCER** for classic): This tag denotes Azure’s infrastructure load balancer.</span></span> <span data-ttu-id="93e8d-201">Azure의 상태 검색이 시작되는 Azure 데이터 센터 IP로 변환됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-201">The tag translates to an Azure datacenter IP where Azure’s health probes originate.</span></span>
* <span data-ttu-id="93e8d-202">**Internet**(Resource Manager) (클래식의 경우 **INTERNET**): 이 태그는 가상 네트워크 외부에 있고 공용 인터넷에서 연결할 수 있는 IP 주소 공간을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-202">**Internet** (Resource Manager) (**INTERNET** for classic): This tag denotes the IP address space that is outside the virtual network and reachable by public Internet.</span></span> <span data-ttu-id="93e8d-203">범위에는 [Azure에서 소유하는 공용 IP 공간](https://www.microsoft.com/download/details.aspx?id=41653)이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-203">The range includes the [Azure owned public IP space](https://www.microsoft.com/download/details.aspx?id=41653).</span></span>

### <a name="default-rules"></a><span data-ttu-id="93e8d-204">기본 규칙</span><span class="sxs-lookup"><span data-stu-id="93e8d-204">Default rules</span></span>
<span data-ttu-id="93e8d-205">모든 NSG에는 기본 규칙 집합이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-205">All NSGs contain a set of default rules.</span></span> <span data-ttu-id="93e8d-206">기본 규칙은 삭제할 수 없지만, 가장 낮은 우선순위가 할당되기 때문에 직접 만든 규칙으로 재정의할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-206">The default rules cannot be deleted, but because they are assigned the lowest priority, they can be overridden by the rules that you create.</span></span> 

<span data-ttu-id="93e8d-207">기본 규칙은 다음과 같이 트래픽을 허용하거나 허용하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-207">The default rules allow and disallow traffic as follows:</span></span>
- <span data-ttu-id="93e8d-208">**가상 네트워크:** 가상 네트워크에서 시작하고 끝나는 트래픽은 인바운드와 아웃바운드 방향 둘 다에서 허용됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-208">**Virtual network:** Traffic originating and ending in a virtual network is allowed both in inbound and outbound directions.</span></span>
- <span data-ttu-id="93e8d-209">**인터넷:** 아웃바운드 트래픽은 허용되지만 인바운드 트래픽은 차단됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-209">**Internet:** Outbound traffic is allowed, but inbound traffic is blocked.</span></span>
- <span data-ttu-id="93e8d-210">**부하 분산 장치:** Azure의 부하 분산 장치에서 VM과 역할 인스턴스의 상태를 검색할 수 있도록 허용합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-210">**Load balancer:** Allow Azure’s load balancer to probe the health of your VMs and role instances.</span></span> <span data-ttu-id="93e8d-211">부하 분산된 집합을 사용하지 않는 경우 이 규칙을 무시할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-211">If you are not using a load balanced set you can override this rule.</span></span>

<span data-ttu-id="93e8d-212">**인바운드 기본 규칙**</span><span class="sxs-lookup"><span data-stu-id="93e8d-212">**Inbound default rules**</span></span>

| <span data-ttu-id="93e8d-213">Name</span><span class="sxs-lookup"><span data-stu-id="93e8d-213">Name</span></span> | <span data-ttu-id="93e8d-214">우선 순위</span><span class="sxs-lookup"><span data-stu-id="93e8d-214">Priority</span></span> | <span data-ttu-id="93e8d-215">원본 IP</span><span class="sxs-lookup"><span data-stu-id="93e8d-215">Source IP</span></span> | <span data-ttu-id="93e8d-216">원본 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-216">Source Port</span></span> | <span data-ttu-id="93e8d-217">대상 IP</span><span class="sxs-lookup"><span data-stu-id="93e8d-217">Destination IP</span></span> | <span data-ttu-id="93e8d-218">대상 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-218">Destination Port</span></span> | <span data-ttu-id="93e8d-219">프로토콜</span><span class="sxs-lookup"><span data-stu-id="93e8d-219">Protocol</span></span> | <span data-ttu-id="93e8d-220">Access</span><span class="sxs-lookup"><span data-stu-id="93e8d-220">Access</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="93e8d-221">AllowVNetInBound</span><span class="sxs-lookup"><span data-stu-id="93e8d-221">AllowVNetInBound</span></span> |<span data-ttu-id="93e8d-222">65000</span><span class="sxs-lookup"><span data-stu-id="93e8d-222">65000</span></span> | <span data-ttu-id="93e8d-223">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="93e8d-223">VirtualNetwork</span></span> | * | <span data-ttu-id="93e8d-224">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="93e8d-224">VirtualNetwork</span></span> | * | * | <span data-ttu-id="93e8d-225">허용</span><span class="sxs-lookup"><span data-stu-id="93e8d-225">Allow</span></span> |
| <span data-ttu-id="93e8d-226">AllowAzureLoadBalancerInBound</span><span class="sxs-lookup"><span data-stu-id="93e8d-226">AllowAzureLoadBalancerInBound</span></span> | <span data-ttu-id="93e8d-227">65001</span><span class="sxs-lookup"><span data-stu-id="93e8d-227">65001</span></span> | <span data-ttu-id="93e8d-228">AzureLoadBalancer</span><span class="sxs-lookup"><span data-stu-id="93e8d-228">AzureLoadBalancer</span></span> | * | * | * | * | <span data-ttu-id="93e8d-229">허용</span><span class="sxs-lookup"><span data-stu-id="93e8d-229">Allow</span></span> |
| <span data-ttu-id="93e8d-230">DenyAllInBound</span><span class="sxs-lookup"><span data-stu-id="93e8d-230">DenyAllInBound</span></span> |<span data-ttu-id="93e8d-231">65500</span><span class="sxs-lookup"><span data-stu-id="93e8d-231">65500</span></span> | * | * | * | * | * | <span data-ttu-id="93e8d-232">거부</span><span class="sxs-lookup"><span data-stu-id="93e8d-232">Deny</span></span> |

<span data-ttu-id="93e8d-233">**아웃바운드 기본 규칙**</span><span class="sxs-lookup"><span data-stu-id="93e8d-233">**Outbound default rules**</span></span>

| <span data-ttu-id="93e8d-234">Name</span><span class="sxs-lookup"><span data-stu-id="93e8d-234">Name</span></span> | <span data-ttu-id="93e8d-235">우선 순위</span><span class="sxs-lookup"><span data-stu-id="93e8d-235">Priority</span></span> | <span data-ttu-id="93e8d-236">원본 IP</span><span class="sxs-lookup"><span data-stu-id="93e8d-236">Source IP</span></span> | <span data-ttu-id="93e8d-237">원본 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-237">Source Port</span></span> | <span data-ttu-id="93e8d-238">대상 IP</span><span class="sxs-lookup"><span data-stu-id="93e8d-238">Destination IP</span></span> | <span data-ttu-id="93e8d-239">대상 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-239">Destination Port</span></span> | <span data-ttu-id="93e8d-240">프로토콜</span><span class="sxs-lookup"><span data-stu-id="93e8d-240">Protocol</span></span> | <span data-ttu-id="93e8d-241">Access</span><span class="sxs-lookup"><span data-stu-id="93e8d-241">Access</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="93e8d-242">AllowVnetOutBound</span><span class="sxs-lookup"><span data-stu-id="93e8d-242">AllowVnetOutBound</span></span> | <span data-ttu-id="93e8d-243">65000</span><span class="sxs-lookup"><span data-stu-id="93e8d-243">65000</span></span> | <span data-ttu-id="93e8d-244">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="93e8d-244">VirtualNetwork</span></span> | * | <span data-ttu-id="93e8d-245">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="93e8d-245">VirtualNetwork</span></span> | * | * | <span data-ttu-id="93e8d-246">허용</span><span class="sxs-lookup"><span data-stu-id="93e8d-246">Allow</span></span> |
| <span data-ttu-id="93e8d-247">AllowInternetOutBound</span><span class="sxs-lookup"><span data-stu-id="93e8d-247">AllowInternetOutBound</span></span> | <span data-ttu-id="93e8d-248">65001</span><span class="sxs-lookup"><span data-stu-id="93e8d-248">65001</span></span> | * | * | <span data-ttu-id="93e8d-249">인터넷</span><span class="sxs-lookup"><span data-stu-id="93e8d-249">Internet</span></span> | * | * | <span data-ttu-id="93e8d-250">허용</span><span class="sxs-lookup"><span data-stu-id="93e8d-250">Allow</span></span> |
| <span data-ttu-id="93e8d-251">DenyAllOutBound</span><span class="sxs-lookup"><span data-stu-id="93e8d-251">DenyAllOutBound</span></span> | <span data-ttu-id="93e8d-252">65500</span><span class="sxs-lookup"><span data-stu-id="93e8d-252">65500</span></span> | * | * | * | * | * | <span data-ttu-id="93e8d-253">거부</span><span class="sxs-lookup"><span data-stu-id="93e8d-253">Deny</span></span> |

## <a name="associating-nsgs"></a><span data-ttu-id="93e8d-254">NSG 연결</span><span class="sxs-lookup"><span data-stu-id="93e8d-254">Associating NSGs</span></span>
<span data-ttu-id="93e8d-255">다음과 같이 사용하는 배포 모델에 따라 NSG를 VM, NIC 및 서브넷에 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-255">You can associate an NSG to VMs, NICs, and subnets, depending on the deployment model you are using, as follows:</span></span>

* <span data-ttu-id="93e8d-256">**VM(클래식만):** 보안 규칙이 VM과의 모든 트래픽에 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-256">**VM (classic only):** Security rules are applied to all traffic to/from the VM.</span></span> 
* <span data-ttu-id="93e8d-257">**NIC(Resource Manager만):** 보안 규칙이 NSG가 연결된 NIC와의 모든 트래픽에 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-257">**NIC (Resource Manager only):** Security rules are applied to all traffic to/from the NIC the NSG is associated to.</span></span> <span data-ttu-id="93e8d-258">다중 NIC VM에서 각각의 NIC에 서로 다르거나 동일한 NSG를 개별적으로 적용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-258">In a multi-NIC VM, you can apply different (or the same) NSG to each NIC individually.</span></span> 
* <span data-ttu-id="93e8d-259">**서브넷(Resource Manager 및 클래식):** 보안 규칙이 VNet에 연결된 모든 리소스에 대한 모든 트래픽에 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-259">**Subnet (Resource Manager and classic):** Security rules are applied to any traffic to/from any resources connected to the VNet.</span></span>

<span data-ttu-id="93e8d-260">다른 NSG를 VM(또는 배포 모델에 따라 NIC)에 연결할 수 있고, NIC 또는 VM이 바인딩된 서브넷에 연결될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-260">You can associate different NSGs to a VM (or NIC, depending on the deployment model) and the subnet that a NIC or VM is connected to.</span></span> <span data-ttu-id="93e8d-261">보안 규칙은 우선 순위에 따라 각 NSG에서 다음과 같은 순서로 트래픽에 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-261">Security rules are applied to the traffic, by priority, in each NSG, in the following order:</span></span>

- <span data-ttu-id="93e8d-262">**인바운드 트래픽**</span><span class="sxs-lookup"><span data-stu-id="93e8d-262">**Inbound traffic**</span></span>

  1. <span data-ttu-id="93e8d-263">**서브넷에 적용된 NSG:** 서브넷 NSG에 트래픽을 거부하는 규칙과 일치하는 규칙이 있는 경우 패킷이 삭제됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-263">**NSG applied to subnet:** If a subnet NSG has a matching rule to deny traffic, the packet is dropped.</span></span>

  2. <span data-ttu-id="93e8d-264">**NIC에 적용된 NSG**(Resource Manager) 또는 VM(클래식): VM\NIC NSG에 트래픽을 거부하는 규칙과 일치하는 규칙이 있는 경우 서브넷 NSG에 트래픽을 허용하는 규칙과 일치하는 규칙이 있더라도 VM\NIC에서 패킷이 삭제됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-264">**NSG applied to NIC** (Resource Manager) or VM (classic): If VM\NIC NSG has a matching rule that denies traffic, packets are dropped at the VM\NIC, even if a subnet NSG has a matching rule that allows traffic.</span></span>

- <span data-ttu-id="93e8d-265">**아웃바운드 트래픽**</span><span class="sxs-lookup"><span data-stu-id="93e8d-265">**Outbound traffic**</span></span>

  1. <span data-ttu-id="93e8d-266">**NIC에 적용된 NSG**(Resource Manager) 또는 VM(클래식): VM\NIC NSG에 트래픽을 거부하는 규칙과 일치하는 규칙이 있는 경우 패킷이 삭제됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-266">**NSG applied to NIC** (Resource Manager) or VM (classic): If a VM\NIC NSG has a matching rule that denies traffic, packets are dropped.</span></span>

  2. <span data-ttu-id="93e8d-267">**서브넷에 적용된 NSG:** 서브넷 NSG에 트래픽을 거부하는 규칙과 일치하는 규칙이 있는 경우 VM\NIC NSG에 트래픽을 허용하는 규칙과 일치하는 규칙이 있더라도 패킷이 삭제됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-267">**NSG applied to subnet:** If a subnet NSG has a matching rule that denies traffic, packets are dropped, even if a VM\NIC NSG has a matching rule that allows traffic.</span></span>

> [!NOTE]
> <span data-ttu-id="93e8d-268">서브넷, VM 또는 NIC에 단일 NSG만 연결할 수 있지만 동일한 NSG를 원하는 수만큼 많은 리소스에 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-268">Although you can only associate a single NSG to a subnet, VM, or NIC; you can associate the same NSG to as many resources as you want.</span></span>
>

## <a name="implementation"></a><span data-ttu-id="93e8d-269">구현</span><span class="sxs-lookup"><span data-stu-id="93e8d-269">Implementation</span></span>
<span data-ttu-id="93e8d-270">다음 도구를 사용하여 Resource Manager 또는 클래식 배포 모델에서 NSG를 구현할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-270">You can implement NSGs in the Resource Manager or classic deployment models using the following tools:</span></span>

| <span data-ttu-id="93e8d-271">배포 도구</span><span class="sxs-lookup"><span data-stu-id="93e8d-271">Deployment tool</span></span> | <span data-ttu-id="93e8d-272">클래식</span><span class="sxs-lookup"><span data-stu-id="93e8d-272">Classic</span></span> | <span data-ttu-id="93e8d-273">리소스 관리자</span><span class="sxs-lookup"><span data-stu-id="93e8d-273">Resource Manager</span></span> |
| --- | --- | --- |
| <span data-ttu-id="93e8d-274">Azure Portal</span><span class="sxs-lookup"><span data-stu-id="93e8d-274">Azure portal</span></span>   | <span data-ttu-id="93e8d-275">예</span><span class="sxs-lookup"><span data-stu-id="93e8d-275">Yes</span></span> | [<span data-ttu-id="93e8d-276">예</span><span class="sxs-lookup"><span data-stu-id="93e8d-276">Yes</span></span>](virtual-networks-create-nsg-arm-pportal.md) |
| <span data-ttu-id="93e8d-277">PowerShell</span><span class="sxs-lookup"><span data-stu-id="93e8d-277">PowerShell</span></span>     | [<span data-ttu-id="93e8d-278">예</span><span class="sxs-lookup"><span data-stu-id="93e8d-278">Yes</span></span>](virtual-networks-create-nsg-classic-ps.md) | [<span data-ttu-id="93e8d-279">예</span><span class="sxs-lookup"><span data-stu-id="93e8d-279">Yes</span></span>](virtual-networks-create-nsg-arm-ps.md) |
| <span data-ttu-id="93e8d-280">Azure CLI **V1**</span><span class="sxs-lookup"><span data-stu-id="93e8d-280">Azure CLI **V1**</span></span>   | [<span data-ttu-id="93e8d-281">예</span><span class="sxs-lookup"><span data-stu-id="93e8d-281">Yes</span></span>](virtual-networks-create-nsg-classic-cli.md) | [<span data-ttu-id="93e8d-282">예</span><span class="sxs-lookup"><span data-stu-id="93e8d-282">Yes</span></span>](virtual-networks-create-nsg-cli-nodejs.md) |
| <span data-ttu-id="93e8d-283">Azure CLI **V2**</span><span class="sxs-lookup"><span data-stu-id="93e8d-283">Azure CLI **V2**</span></span>   | <span data-ttu-id="93e8d-284">아니요</span><span class="sxs-lookup"><span data-stu-id="93e8d-284">No</span></span> | [<span data-ttu-id="93e8d-285">예</span><span class="sxs-lookup"><span data-stu-id="93e8d-285">Yes</span></span>](virtual-networks-create-nsg-arm-cli.md) |
| <span data-ttu-id="93e8d-286">Azure Resource Manager 템플릿</span><span class="sxs-lookup"><span data-stu-id="93e8d-286">Azure Resource Manager template</span></span>   | <span data-ttu-id="93e8d-287">아니요</span><span class="sxs-lookup"><span data-stu-id="93e8d-287">No</span></span>  | [<span data-ttu-id="93e8d-288">예</span><span class="sxs-lookup"><span data-stu-id="93e8d-288">Yes</span></span>](virtual-networks-create-nsg-arm-template.md) |

## <a name="planning"></a><span data-ttu-id="93e8d-289">계획</span><span class="sxs-lookup"><span data-stu-id="93e8d-289">Planning</span></span>
<span data-ttu-id="93e8d-290">NSG를 구현하기 전에 아래 질문에 답변해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-290">Before implementing NSGs, you need to answer the following questions:</span></span>

1. <span data-ttu-id="93e8d-291">트래픽을 필터링할 리소스 종류는 무엇입니까?</span><span class="sxs-lookup"><span data-stu-id="93e8d-291">What types of resources do you want to filter traffic to or from?</span></span> <span data-ttu-id="93e8d-292">NIC(Resource Manager), VM(클래식), Cloud Services, Application Service Environments 및 VM Scale Sets와 같은 리소스를 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-292">You can connect resources such as NICs (Resource Manager), VMs (classic), Cloud Services, Application Service Environments, and VM Scale Sets.</span></span> 
2. <span data-ttu-id="93e8d-293">기존 VNet의 서브넷에 연결되거나 연결하는 트래픽을 필터링하려는 리소스가 있습니까?</span><span class="sxs-lookup"><span data-stu-id="93e8d-293">Are the resources you want to filter traffic to/from connected to subnets in existing VNets?</span></span>

<span data-ttu-id="93e8d-294">Azure의 네트워크 보안 계획에 대한 자세한 내용은 [클라우드 서비스 및 네트워크 보안](../best-practices-network-security.md) 문서를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="93e8d-294">For more information on planning for network security in Azure, read the [Cloud services and network security](../best-practices-network-security.md) article.</span></span> 

## <a name="design-considerations"></a><span data-ttu-id="93e8d-295">디자인 고려 사항</span><span class="sxs-lookup"><span data-stu-id="93e8d-295">Design considerations</span></span>
<span data-ttu-id="93e8d-296">[계획](#Planning) 섹션에서 질문에 대한 답변을 확인한 후에 NSG를 정의하기 전에 다음 섹션을 검토합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-296">Once you know the answers to the questions in the [Planning](#Planning) section, review the following sections before defining your NSGs:</span></span>

### <a name="limits"></a><span data-ttu-id="93e8d-297">제한</span><span class="sxs-lookup"><span data-stu-id="93e8d-297">Limits</span></span>
<span data-ttu-id="93e8d-298">구독에서 보유할 수 있는 NSG 수와 NSG당 규칙의 수에 제한이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-298">There are limits to the number of NSGs you can have in a subscription and number of rules per NSG.</span></span> <span data-ttu-id="93e8d-299">이러한 한에 대한 자세한 내용은 [Azure 제한](../azure-subscription-service-limits.md#networking-limits) 문서를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="93e8d-299">To learn more about the limits, read the [Azure limits](../azure-subscription-service-limits.md#networking-limits) article.</span></span>

### <a name="vnet-and-subnet-design"></a><span data-ttu-id="93e8d-300">VNet 및 서브넷 디자인</span><span class="sxs-lookup"><span data-stu-id="93e8d-300">VNet and subnet design</span></span>
<span data-ttu-id="93e8d-301">NSG가 서브넷에 적용될 수 있기 때문에, 서브넷에 따라서 리소스를 그룹화고 서브넷에 NSG를 적용하여 NSG의 수를 최소화할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-301">Since NSGs can be applied to subnets, you can minimize the number of NSGs by grouping your resources by subnet, and applying NSGs to subnets.</span></span>  <span data-ttu-id="93e8d-302">NSG를 서브넷에 적용하기로 결정하고 나면, 사용자의 기존 VNet과 서브넷이 NSG를 감안하지 않고 정의되었다는 점을 발견할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-302">If you decide to apply NSGs to subnets, you may find that existing VNets and subnets you have were not defined with NSGs in mind.</span></span> <span data-ttu-id="93e8d-303">새 VNet 및 서브넷을 정의하여 NSG 디자인을 지원하고 새 리소스를 새 서브넷에 배포해야 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-303">You may need to define new VNets and subnets to support your NSG design and deploy your new resources to your new subnets.</span></span> <span data-ttu-id="93e8d-304">그 후 기존 리소스를 새 서브넷으로 이동하는 마이그레이션 전략을 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-304">You could then define a migration strategy to move existing resources to the new subnets.</span></span> 

### <a name="special-rules"></a><span data-ttu-id="93e8d-305">특별한 규칙</span><span class="sxs-lookup"><span data-stu-id="93e8d-305">Special rules</span></span>
<span data-ttu-id="93e8d-306">다음 규칙에서 허용하는 트래픽을 차단하면 인프라에서 필수 Azure 서비스와 통신할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-306">If you block traffic allowed by the following rules, your infrastructure can't communicate with essential Azure services:</span></span>

* <span data-ttu-id="93e8d-307">**호스트 노드의 가상 IP:** DHCP, DNS 및 상태 모니터링과 같은 기본 인프라 서비스는 가상화된 168.63.129.16 호스트 IP 주소를 통해 제공됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-307">**Virtual IP of the host node:** Basic infrastructure services such as DHCP, DNS, and health monitoring are provided through the virtualized host IP address 168.63.129.16.</span></span> <span data-ttu-id="93e8d-308">이 공용 IP 주소는 Microsoft에 속하며, 이 목적을 위해 모든 지역에서 유일하게 사용되는 가상화된 IP 주소입니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-308">This public IP address belongs to Microsoft and is the only virtualized IP address used in all regions for this purpose.</span></span> <span data-ttu-id="93e8d-309">이 IP 주소는 VM을 호스트하는 서버 컴퓨터(호스트 노드)의 실제 IP 주소에 매핑됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-309">This IP address maps to the physical IP address of the server machine (host node) hosting the VM.</span></span> <span data-ttu-id="93e8d-310">호스트 노드는 DHCP 릴레이, DNS 재귀 확인자, 부하 분산 장치 상태 검색 및 컴퓨터 상태 검색에 대한 검색 소스 등의 역할을 합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-310">The host node acts as the DHCP relay, the DNS recursive resolver, and the probe source for the load balancer health probe and the machine health probe.</span></span> <span data-ttu-id="93e8d-311">이 IP 주소로의 통신은 공격이 아닙니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-311">Communication to this IP address is not an attack.</span></span>
* <span data-ttu-id="93e8d-312">**라이선싱(키 관리 서비스)**: VM에서 실행되는 Windows 이미지를 사용하려면 라이선스가 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-312">**Licensing (Key Management Service):** Windows images running in VMs must be licensed.</span></span> <span data-ttu-id="93e8d-313">사용 허가를 위해 라이선스 요청이 이러한 쿼리를 처리하는 키 관리 서비스 호스트 서버로 전송됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-313">To ensure licensing, a request is sent to the Key Management Service host servers that handle such queries.</span></span> <span data-ttu-id="93e8d-314">요청은 1688 포트를 통해 아웃바운드로 수행됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-314">The request is made outbound through port 1688.</span></span>

### <a name="icmp-traffic"></a><span data-ttu-id="93e8d-315">ICMP 트래픽</span><span class="sxs-lookup"><span data-stu-id="93e8d-315">ICMP traffic</span></span>
<span data-ttu-id="93e8d-316">현재 NSG 규칙에는 *TCP* 또는 *UDP* 프로토콜만 허용됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-316">The current NSG rules only allow for protocols *TCP* or *UDP*.</span></span> <span data-ttu-id="93e8d-317">*ICMP*에 대한 고유 태그는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-317">There is not a specific tag for *ICMP*.</span></span> <span data-ttu-id="93e8d-318">그러나 ICMP 트래픽은 VNet 내의 모든 포트와 프로토콜로 들어오고 나가는 트래픽을 허용하는 AllowVNetInBound 기본 규칙에 따라 VNet 내에서 허용됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-318">However, ICMP traffic is allowed within a VNet by the AllowVNetInBound default rule, that allows traffic to and from any port and protocol within the VNet.</span></span>

### <a name="subnets"></a><span data-ttu-id="93e8d-319">서브넷</span><span class="sxs-lookup"><span data-stu-id="93e8d-319">Subnets</span></span>
* <span data-ttu-id="93e8d-320">워크로드에 필요한 계층의 수를 고려합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-320">Consider the number of tiers your workload requires.</span></span> <span data-ttu-id="93e8d-321">각 계층은 서브넷에 적용되는 NSG로 서브넷을 사용하여 격리될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-321">Each tier can be isolated by using a subnet, with an NSG applied to the subnet.</span></span> 
* <span data-ttu-id="93e8d-322">VPN 게이트웨이 또는 ExpressRoute 회로에 대한 서브넷을 구현해야 하는 경우 해당 서브넷에 NSG를 적용하지 **않습니다**.</span><span class="sxs-lookup"><span data-stu-id="93e8d-322">If you need to implement a subnet for a VPN gateway, or ExpressRoute circuit, do **not** apply an NSG to that subnet.</span></span> <span data-ttu-id="93e8d-323">그렇게 하면 VNet 간 또는 온-프레미스 간 연결이 실패할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-323">If you do so, cross-VNet or cross-premises connectivity may fail.</span></span> 
* <span data-ttu-id="93e8d-324">NVA(네트워크 가상 어플라이언스)를 구현해야 하는 경우 NVA를 자체 서브넷에 연결하고 NVA에 대한 UDR(사용자 정의 경로)를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-324">If you need to implement a network virtual appliance (NVA), connect the NVA to its own subnet and create user-defined routes (UDR) to and from the NVA.</span></span> <span data-ttu-id="93e8d-325">서브넷에 들어오고 나가는 트래픽을 필터링하도록 서브넷 수준 NSG를 구현할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-325">You can implement a subnet level NSG to filter traffic in and out of this subnet.</span></span> <span data-ttu-id="93e8d-326">UDR에 대한 자세한 내용은 [사용자 정의 경로](virtual-networks-udr-overview.md) 문서를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="93e8d-326">To learn more about UDRs, read the [User-defined routes](virtual-networks-udr-overview.md) article.</span></span>

### <a name="load-balancers"></a><span data-ttu-id="93e8d-327">부하 분산 장치</span><span class="sxs-lookup"><span data-stu-id="93e8d-327">Load balancers</span></span>
* <span data-ttu-id="93e8d-328">각 워크로드에서 사용하는 각 부하 분산 장치에 대한 부하 분산 및 NAT(Network Address Translation) 규칙을 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-328">Consider the load balancing and network address translation (NAT) rules for each load balancer used by each of your workloads.</span></span> <span data-ttu-id="93e8d-329">NAT 규칙은 NIC(Resource Manager) 또는 VM/Cloud Services 역할 인스턴스(클래식)가 포함된 백 엔드 풀에 바인딩됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-329">NAT rules are bound to a back-end pool that contains NICs (Resource Manager) or VMs/Cloud Services role instances (classic).</span></span> <span data-ttu-id="93e8d-330">각 백 엔드 풀에 대해 NSG를 만들어 부하 분산 장치에 구현된 규칙을 통해 매핑되는 트래픽만 허용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-330">Consider creating an NSG for each back-end pool, allowing only traffic mapped through the rules implemented in the load balancers.</span></span> <span data-ttu-id="93e8d-331">각 백 엔드 풀에 대한 NSG를 만들면 부하 분산 장치를 통하지 않고 직접 백 엔드 풀로 들어오는 트래픽도 필터링됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-331">Creating an NSG for each back-end pool guarantees that traffic coming to the back-end pool directly (rather than through the load balancer), is also filtered.</span></span>
* <span data-ttu-id="93e8d-332">클래식 배포의 경우, 부하 분산 장치의 포트를 VM 또는 역할 인스턴스의 포트에 매핑하는 끝점을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-332">In classic deployments, you create endpoints that map ports on a load balancer to ports on your VMs or role instances.</span></span> <span data-ttu-id="93e8d-333">또한 Resource Manager를 통해 사용자 고유의 개별적인 공용 부하 분산 장치를 만들 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-333">You can also create your own individual public-facing load balancer through Resource Manager.</span></span> <span data-ttu-id="93e8d-334">들어오는 트래픽의 대상 포트는 부하 분산 장치에서 노출하는 포트가 아닌 VM이나 역할 인스턴스의 실제 포트입니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-334">The destination port for incoming traffic is the actual port in the VM or role instance, not the port exposed by a load balancer.</span></span> <span data-ttu-id="93e8d-335">VM에 연결하기 위한 원본 포트와 주소는 부하 분산 장치에서 노출하는 포트와 주소가 아닌 인터넷 상의 원격 컴퓨터의 포트와 주소입니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-335">The source port and address for the connection to the VM is a port and address on the remote computer in the Internet, not the port and address exposed by the load balancer.</span></span>
* <span data-ttu-id="93e8d-336">ILB(내부 부하 분산 장치)를 통해 들어오는 트래픽을 필터링하기 위해 NSG를 만들 때 적용되는 원본 포트와 주소 범위는 부하 분산 장치가 아닌 원래 컴퓨터에서 가져온 것입니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-336">When you create NSGs to filter traffic coming through an internal load balancer (ILB), the source port and address range applied are  from the originating computer, not the load balancer.</span></span> <span data-ttu-id="93e8d-337">대상 포트와 주소 범위는 부하 분산 장치가 아닌 대상 컴퓨터의 포트와 주소 범위입니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-337">The destination port and address range are those of the destination computer, not the load balancer.</span></span>

### <a name="other"></a><span data-ttu-id="93e8d-338">기타</span><span class="sxs-lookup"><span data-stu-id="93e8d-338">Other</span></span>
* <span data-ttu-id="93e8d-339">끝점 기반 ACL(액세스 제어 목록)과 NSG는 동일한 VM 인스턴스에서 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-339">Endpoint-based access control lists (ACL) and NSGs are not supported on the same VM instance.</span></span> <span data-ttu-id="93e8d-340">NSG를 사용하려는데 끝점 ACL이 이미 있는 경우 먼저, 끝점 ACL을 제거합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-340">If you want to use an NSG and have an endpoint ACL already in place, first remove the endpoint ACL.</span></span> <span data-ttu-id="93e8d-341">끝점 ACL을 제거하는 방법에 대한 내용은 [끝점 ACL 관리](virtual-networks-acl-powershell.md) 문서를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="93e8d-341">For information about how to remove an endpoint ACL, see the [Manage endpoint ACLs](virtual-networks-acl-powershell.md) article.</span></span>
* <span data-ttu-id="93e8d-342">Resource Manager에서는 여러 NIC가 있는 VM의 NIC에 연결된 NSG를 사용하여 NIC별로 관리(원격 액세스)를 활성화할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-342">In Resource Manager, you can use an NSG associated to a NIC for VMs with multiple NICs to enable management (remote access) on a per NIC basis.</span></span> <span data-ttu-id="93e8d-343">고유한 NSG를 각 NIC에 연결하면 NIC에서 트래픽 종류를 분리할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-343">Associating unique NSGs to each NIC enables separation of traffic types across NICs.</span></span>
* <span data-ttu-id="93e8d-344">부하 분산 장치의 사용과 마찬가지로 다른 VNet의 트래픽을 필터링하는 경우 VNet을 연결하는 게이트웨이가 아닌 원격 컴퓨터의 원본 주소 범위를 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-344">Similar to the use of load balancers, when filtering traffic from other VNets, you must use the source address range of the remote computer, not the gateway connecting the VNets.</span></span>
* <span data-ttu-id="93e8d-345">많은 Azure 서비스에서 VNet에 연결할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-345">Many Azure services cannot be connected to VNets.</span></span> <span data-ttu-id="93e8d-346">Azure 리소스가 VNet에 연결되어 있지 않으면 NSG를 사용하여 리소스에 대한 트래픽을 필터링할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-346">If an Azure resource is not connected to a VNet, you cannot use an NSG to filter traffic to the resource.</span></span>  <span data-ttu-id="93e8d-347">서비스가 VNet에 연결될 수 있는지 여부를 결정하려면 사용하는 서비스에 대한 문서를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="93e8d-347">Read the documentation for the services you use to determine whether the service can be connected to a VNet.</span></span>

## <a name="sample-deployment"></a><span data-ttu-id="93e8d-348">샘플 배포</span><span class="sxs-lookup"><span data-stu-id="93e8d-348">Sample deployment</span></span>
<span data-ttu-id="93e8d-349">이 문서의 정보를 적용하는 방식을 설명하기 위해 다음 그림과 같은 2계층 응용 프로그램의 일반적인 시나리오를 고려해 보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-349">To illustrate the application of the information in this article, consider a common scenario of a two tier application shown in the following picture:</span></span>

![NSG](./media/virtual-network-nsg-overview/figure1.png)

<span data-ttu-id="93e8d-351">위의 다이어그램에서 보여 주듯이 *WEB1* 및 *WEB2* VM은 *FrontEnd* 서브넷에 연결되고, *DB1* 및 *DB2* VM은 *BackEnd* 서브넷에 연결됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-351">As shown in the diagram, the *Web1* and *Web2* VMs are connected to the *FrontEnd* subnet, and the *DB1* and *DB2* VMs are connected to the *BackEnd* subnet.</span></span>  <span data-ttu-id="93e8d-352">두 서브넷은 *TestVNet* VNet의 일부입니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-352">Both subnets are part of the *TestVNet* VNet.</span></span> <span data-ttu-id="93e8d-353">응용 프로그램 구성 요소는 각각 VNet에 연결된 Azure VM 내에서 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-353">The application components each run within an Azure VM connected to a VNet.</span></span> <span data-ttu-id="93e8d-354">시나리오에는 다음 요구 사항이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-354">The scenario has the following requirements:</span></span>

1. <span data-ttu-id="93e8d-355">WEB과 DB 서버 간의 트래픽을 분리합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-355">Separation of traffic between the WEB and DB servers.</span></span>
2. <span data-ttu-id="93e8d-356">부하 분산 규칙은 트래픽을 부하 분산 장치에서 80 포트의 모든 웹 서버로 전달합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-356">Load balancing rules forward traffic from the load balancer to all web servers on port 80.</span></span>
3. <span data-ttu-id="93e8d-357">부하 분산 장치 NAT 규칙은 50001 포트의 부하 분산 장치로 들어오는 트래픽을 WEB1 VM의 3389 포트로 전달합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-357">Load balancer NAT rules forward traffic coming into the load balancer on port 50001 to port 3389 on the WEB1 VM.</span></span>
4. <span data-ttu-id="93e8d-358">요구 사항 2와 3을 제외하고는 인터넷에서 프런트 엔드 또는 백 엔드 VM에 액세스할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-358">No access to the front-end or back-end VMs from the Internet, except requirements 2 and 3.</span></span>
5. <span data-ttu-id="93e8d-359">WEB 또는 DB 서버에서 아웃바운드로 인터넷에 액세스할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-359">No outbound Internet access from the WEB or DB servers.</span></span>
6. <span data-ttu-id="93e8d-360">FrontEnd 서브넷에서의 액세스는 모든 웹 서버의 3389 포트에 허용됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-360">Access from the FrontEnd subnet is allowed to port 3389 of any web server.</span></span>
7. <span data-ttu-id="93e8d-361">FrontEnd 서브넷에서의 액세스는 모든 DB 서버의 3389 포트에 허용됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-361">Access from the FrontEnd subnet is allowed to port 3389 of any DB server.</span></span>
8. <span data-ttu-id="93e8d-362">FrontEnd 서브넷에서의 액세스는 모든 DB 서버의 1433 포트에 허용됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-362">Access from the FrontEnd subnet is allowed to port 1433 of all DB servers.</span></span>
9. <span data-ttu-id="93e8d-363">DB 서버의 다른 NIC에서 관리 트래픽(3389 포트)과 데이터베이스 트래픽(1433 포트)을 분리합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-363">Separation of management traffic (port 3389) and database traffic (1433) on different NICs in DB servers.</span></span>

<span data-ttu-id="93e8d-364">요구 사항 1-6(요구 사항 3 및 4 제외)은 모두 서브넷 공간으로 제한됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-364">Requirements 1-6 (except requirements 3 and 4) are all confined to subnet spaces.</span></span> <span data-ttu-id="93e8d-365">다음 NSG는 이전 요구 사항을 충족하면서 필요한 NSG 수를 최소화합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-365">The following NSGs meet the previous requirements, while minimizing the number of NSGs required:</span></span>

### <a name="frontend"></a><span data-ttu-id="93e8d-366">FrontEnd</span><span class="sxs-lookup"><span data-stu-id="93e8d-366">FrontEnd</span></span>
<span data-ttu-id="93e8d-367">**인바운드 규칙**</span><span class="sxs-lookup"><span data-stu-id="93e8d-367">**Inbound rules**</span></span>

| <span data-ttu-id="93e8d-368">규칙</span><span class="sxs-lookup"><span data-stu-id="93e8d-368">Rule</span></span> | <span data-ttu-id="93e8d-369">Access</span><span class="sxs-lookup"><span data-stu-id="93e8d-369">Access</span></span> | <span data-ttu-id="93e8d-370">우선 순위</span><span class="sxs-lookup"><span data-stu-id="93e8d-370">Priority</span></span> | <span data-ttu-id="93e8d-371">원본 주소 범위</span><span class="sxs-lookup"><span data-stu-id="93e8d-371">Source address range</span></span> | <span data-ttu-id="93e8d-372">원본 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-372">Source port</span></span> | <span data-ttu-id="93e8d-373">대상 주소 범위</span><span class="sxs-lookup"><span data-stu-id="93e8d-373">Destination address range</span></span> | <span data-ttu-id="93e8d-374">대상 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-374">Destination port</span></span> | <span data-ttu-id="93e8d-375">프로토콜</span><span class="sxs-lookup"><span data-stu-id="93e8d-375">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="93e8d-376">Allow-Inbound-HTTP-Internet(인바운드 HTTP 인터넷 허용)</span><span class="sxs-lookup"><span data-stu-id="93e8d-376">Allow-Inbound-HTTP-Internet</span></span> | <span data-ttu-id="93e8d-377">허용</span><span class="sxs-lookup"><span data-stu-id="93e8d-377">Allow</span></span> | <span data-ttu-id="93e8d-378">100</span><span class="sxs-lookup"><span data-stu-id="93e8d-378">100</span></span> | <span data-ttu-id="93e8d-379">인터넷</span><span class="sxs-lookup"><span data-stu-id="93e8d-379">Internet</span></span> | * | * | <span data-ttu-id="93e8d-380">80</span><span class="sxs-lookup"><span data-stu-id="93e8d-380">80</span></span> | <span data-ttu-id="93e8d-381">TCP</span><span class="sxs-lookup"><span data-stu-id="93e8d-381">TCP</span></span> |
| <span data-ttu-id="93e8d-382">Allow-Inbound-RDP-Internet(인바운드 RDP 인터넷 허용)</span><span class="sxs-lookup"><span data-stu-id="93e8d-382">Allow-Inbound-RDP-Internet</span></span> | <span data-ttu-id="93e8d-383">허용</span><span class="sxs-lookup"><span data-stu-id="93e8d-383">Allow</span></span> | <span data-ttu-id="93e8d-384">200</span><span class="sxs-lookup"><span data-stu-id="93e8d-384">200</span></span> | <span data-ttu-id="93e8d-385">인터넷</span><span class="sxs-lookup"><span data-stu-id="93e8d-385">Internet</span></span> | * | * | <span data-ttu-id="93e8d-386">3389</span><span class="sxs-lookup"><span data-stu-id="93e8d-386">3389</span></span> | <span data-ttu-id="93e8d-387">TCP</span><span class="sxs-lookup"><span data-stu-id="93e8d-387">TCP</span></span> |
| <span data-ttu-id="93e8d-388">Deny-Inbound-All(모든 인바운드 거부)</span><span class="sxs-lookup"><span data-stu-id="93e8d-388">Deny-Inbound-All</span></span> | <span data-ttu-id="93e8d-389">거부</span><span class="sxs-lookup"><span data-stu-id="93e8d-389">Deny</span></span> | <span data-ttu-id="93e8d-390">300</span><span class="sxs-lookup"><span data-stu-id="93e8d-390">300</span></span> | <span data-ttu-id="93e8d-391">인터넷</span><span class="sxs-lookup"><span data-stu-id="93e8d-391">Internet</span></span> | * | * | * | <span data-ttu-id="93e8d-392">TCP</span><span class="sxs-lookup"><span data-stu-id="93e8d-392">TCP</span></span> |

<span data-ttu-id="93e8d-393">**아웃바운드 규칙**</span><span class="sxs-lookup"><span data-stu-id="93e8d-393">**Outbound rules**</span></span>

| <span data-ttu-id="93e8d-394">규칙</span><span class="sxs-lookup"><span data-stu-id="93e8d-394">Rule</span></span> | <span data-ttu-id="93e8d-395">Access</span><span class="sxs-lookup"><span data-stu-id="93e8d-395">Access</span></span> | <span data-ttu-id="93e8d-396">우선 순위</span><span class="sxs-lookup"><span data-stu-id="93e8d-396">Priority</span></span> | <span data-ttu-id="93e8d-397">원본 주소 범위</span><span class="sxs-lookup"><span data-stu-id="93e8d-397">Source address range</span></span> | <span data-ttu-id="93e8d-398">원본 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-398">Source port</span></span> | <span data-ttu-id="93e8d-399">대상 주소 범위</span><span class="sxs-lookup"><span data-stu-id="93e8d-399">Destination address range</span></span> | <span data-ttu-id="93e8d-400">대상 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-400">Destination port</span></span> | <span data-ttu-id="93e8d-401">프로토콜</span><span class="sxs-lookup"><span data-stu-id="93e8d-401">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="93e8d-402">Deny-Internet-All(모든 인터넷 거부)</span><span class="sxs-lookup"><span data-stu-id="93e8d-402">Deny-Internet-All</span></span> |<span data-ttu-id="93e8d-403">거부</span><span class="sxs-lookup"><span data-stu-id="93e8d-403">Deny</span></span> |<span data-ttu-id="93e8d-404">100</span><span class="sxs-lookup"><span data-stu-id="93e8d-404">100</span></span> | * | * | <span data-ttu-id="93e8d-405">인터넷</span><span class="sxs-lookup"><span data-stu-id="93e8d-405">Internet</span></span> | * | * |

### <a name="backend"></a><span data-ttu-id="93e8d-406">BackEnd</span><span class="sxs-lookup"><span data-stu-id="93e8d-406">BackEnd</span></span>
<span data-ttu-id="93e8d-407">**인바운드 규칙**</span><span class="sxs-lookup"><span data-stu-id="93e8d-407">**Inbound rules**</span></span>

| <span data-ttu-id="93e8d-408">규칙</span><span class="sxs-lookup"><span data-stu-id="93e8d-408">Rule</span></span> | <span data-ttu-id="93e8d-409">Access</span><span class="sxs-lookup"><span data-stu-id="93e8d-409">Access</span></span> | <span data-ttu-id="93e8d-410">우선 순위</span><span class="sxs-lookup"><span data-stu-id="93e8d-410">Priority</span></span> | <span data-ttu-id="93e8d-411">원본 주소 범위</span><span class="sxs-lookup"><span data-stu-id="93e8d-411">Source address range</span></span> | <span data-ttu-id="93e8d-412">원본 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-412">Source port</span></span> | <span data-ttu-id="93e8d-413">대상 주소 범위</span><span class="sxs-lookup"><span data-stu-id="93e8d-413">Destination address range</span></span> | <span data-ttu-id="93e8d-414">대상 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-414">Destination port</span></span> | <span data-ttu-id="93e8d-415">프로토콜</span><span class="sxs-lookup"><span data-stu-id="93e8d-415">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="93e8d-416">Deny-Internet-All(모든 인터넷 거부)</span><span class="sxs-lookup"><span data-stu-id="93e8d-416">Deny-Internet-All</span></span> | <span data-ttu-id="93e8d-417">거부</span><span class="sxs-lookup"><span data-stu-id="93e8d-417">Deny</span></span> | <span data-ttu-id="93e8d-418">100</span><span class="sxs-lookup"><span data-stu-id="93e8d-418">100</span></span> | <span data-ttu-id="93e8d-419">인터넷</span><span class="sxs-lookup"><span data-stu-id="93e8d-419">Internet</span></span> | * | * | * | * |

<span data-ttu-id="93e8d-420">**아웃바운드 규칙**</span><span class="sxs-lookup"><span data-stu-id="93e8d-420">**Outbound rules**</span></span>

| <span data-ttu-id="93e8d-421">규칙</span><span class="sxs-lookup"><span data-stu-id="93e8d-421">Rule</span></span> | <span data-ttu-id="93e8d-422">Access</span><span class="sxs-lookup"><span data-stu-id="93e8d-422">Access</span></span> | <span data-ttu-id="93e8d-423">우선 순위</span><span class="sxs-lookup"><span data-stu-id="93e8d-423">Priority</span></span> | <span data-ttu-id="93e8d-424">원본 주소 범위</span><span class="sxs-lookup"><span data-stu-id="93e8d-424">Source address range</span></span> | <span data-ttu-id="93e8d-425">원본 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-425">Source port</span></span> | <span data-ttu-id="93e8d-426">대상 주소 범위</span><span class="sxs-lookup"><span data-stu-id="93e8d-426">Destination address range</span></span> | <span data-ttu-id="93e8d-427">대상 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-427">Destination port</span></span> | <span data-ttu-id="93e8d-428">프로토콜</span><span class="sxs-lookup"><span data-stu-id="93e8d-428">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="93e8d-429">Deny-Internet-All(모든 인터넷 거부)</span><span class="sxs-lookup"><span data-stu-id="93e8d-429">Deny-Internet-All</span></span> | <span data-ttu-id="93e8d-430">거부</span><span class="sxs-lookup"><span data-stu-id="93e8d-430">Deny</span></span> | <span data-ttu-id="93e8d-431">100</span><span class="sxs-lookup"><span data-stu-id="93e8d-431">100</span></span> | * | * | <span data-ttu-id="93e8d-432">인터넷</span><span class="sxs-lookup"><span data-stu-id="93e8d-432">Internet</span></span> | * | * |

<span data-ttu-id="93e8d-433">다음 NSG가 만들어지고 다음 VM의 NIC와 연결됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-433">The following NSGs are created and associated to NICs in the following VMs:</span></span>

### <a name="web1"></a><span data-ttu-id="93e8d-434">WEB1</span><span class="sxs-lookup"><span data-stu-id="93e8d-434">WEB1</span></span>
<span data-ttu-id="93e8d-435">**인바운드 규칙**</span><span class="sxs-lookup"><span data-stu-id="93e8d-435">**Inbound rules**</span></span>

| <span data-ttu-id="93e8d-436">규칙</span><span class="sxs-lookup"><span data-stu-id="93e8d-436">Rule</span></span> | <span data-ttu-id="93e8d-437">Access</span><span class="sxs-lookup"><span data-stu-id="93e8d-437">Access</span></span> | <span data-ttu-id="93e8d-438">우선 순위</span><span class="sxs-lookup"><span data-stu-id="93e8d-438">Priority</span></span> | <span data-ttu-id="93e8d-439">원본 주소 범위</span><span class="sxs-lookup"><span data-stu-id="93e8d-439">Source address range</span></span> | <span data-ttu-id="93e8d-440">원본 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-440">Source port</span></span> | <span data-ttu-id="93e8d-441">대상 주소 범위</span><span class="sxs-lookup"><span data-stu-id="93e8d-441">Destination address range</span></span> | <span data-ttu-id="93e8d-442">대상 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-442">Destination port</span></span> | <span data-ttu-id="93e8d-443">프로토콜</span><span class="sxs-lookup"><span data-stu-id="93e8d-443">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="93e8d-444">Allow-Inbound-RDP-Internet(인바운드 RDP 인터넷 허용)</span><span class="sxs-lookup"><span data-stu-id="93e8d-444">Allow-Inbound-RDP-Internet</span></span> | <span data-ttu-id="93e8d-445">허용</span><span class="sxs-lookup"><span data-stu-id="93e8d-445">Allow</span></span> | <span data-ttu-id="93e8d-446">100</span><span class="sxs-lookup"><span data-stu-id="93e8d-446">100</span></span> | <span data-ttu-id="93e8d-447">인터넷</span><span class="sxs-lookup"><span data-stu-id="93e8d-447">Internet</span></span> | * | * | <span data-ttu-id="93e8d-448">3389</span><span class="sxs-lookup"><span data-stu-id="93e8d-448">3389</span></span> | <span data-ttu-id="93e8d-449">TCP</span><span class="sxs-lookup"><span data-stu-id="93e8d-449">TCP</span></span> |
| <span data-ttu-id="93e8d-450">Allow-Inbound-HTTP-Internet(인바운드 HTTP 인터넷 허용)</span><span class="sxs-lookup"><span data-stu-id="93e8d-450">Allow-Inbound-HTTP-Internet</span></span> | <span data-ttu-id="93e8d-451">허용</span><span class="sxs-lookup"><span data-stu-id="93e8d-451">Allow</span></span> | <span data-ttu-id="93e8d-452">200</span><span class="sxs-lookup"><span data-stu-id="93e8d-452">200</span></span> | <span data-ttu-id="93e8d-453">인터넷</span><span class="sxs-lookup"><span data-stu-id="93e8d-453">Internet</span></span> | * | * | <span data-ttu-id="93e8d-454">80</span><span class="sxs-lookup"><span data-stu-id="93e8d-454">80</span></span> | <span data-ttu-id="93e8d-455">TCP</span><span class="sxs-lookup"><span data-stu-id="93e8d-455">TCP</span></span> |

> [!NOTE]
> <span data-ttu-id="93e8d-456">이전 규칙의 원본 주소 범위는 부하 분산 장치의 가상 IP 주소가 아니라 **Internet**입니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-456">The source address range for the previous rules is **Internet**, not the virtual IP address of for the load balancer.</span></span> <span data-ttu-id="93e8d-457">원본 포트는 500001이 아니라 *입니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-457">The source port is *, not 500001.</span></span> <span data-ttu-id="93e8d-458">부하 분산 장치의 NAT 규칙은 NSG 보안 규칙과 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-458">NAT rules for load balancers are not the same as NSG security rules.</span></span> <span data-ttu-id="93e8d-459">NSG 보안 규칙은 원본과 대상 사이의 부하 분산 장치가 **아니라** 항상 트랙픽의 원래 원본 및 최종 대상과 관련이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-459">NSG security rules are always related to the original source and final destination of traffic, **not** the load balancer between the two.</span></span> 
> 
> 

### <a name="web2"></a><span data-ttu-id="93e8d-460">WEB2</span><span class="sxs-lookup"><span data-stu-id="93e8d-460">WEB2</span></span>
<span data-ttu-id="93e8d-461">**인바운드 규칙**</span><span class="sxs-lookup"><span data-stu-id="93e8d-461">**Inbound rules**</span></span>

| <span data-ttu-id="93e8d-462">규칙</span><span class="sxs-lookup"><span data-stu-id="93e8d-462">Rule</span></span> | <span data-ttu-id="93e8d-463">Access</span><span class="sxs-lookup"><span data-stu-id="93e8d-463">Access</span></span> | <span data-ttu-id="93e8d-464">우선 순위</span><span class="sxs-lookup"><span data-stu-id="93e8d-464">Priority</span></span> | <span data-ttu-id="93e8d-465">원본 주소 범위</span><span class="sxs-lookup"><span data-stu-id="93e8d-465">Source address range</span></span> | <span data-ttu-id="93e8d-466">원본 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-466">Source port</span></span> | <span data-ttu-id="93e8d-467">대상 주소 범위</span><span class="sxs-lookup"><span data-stu-id="93e8d-467">Destination address range</span></span> | <span data-ttu-id="93e8d-468">대상 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-468">Destination port</span></span> | <span data-ttu-id="93e8d-469">프로토콜</span><span class="sxs-lookup"><span data-stu-id="93e8d-469">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="93e8d-470">Deny-Inbound-RDP-Internet( 인바운드 RDP 인터넷 거부)</span><span class="sxs-lookup"><span data-stu-id="93e8d-470">Deny-Inbound-RDP-Internet</span></span> | <span data-ttu-id="93e8d-471">거부</span><span class="sxs-lookup"><span data-stu-id="93e8d-471">Deny</span></span> | <span data-ttu-id="93e8d-472">100</span><span class="sxs-lookup"><span data-stu-id="93e8d-472">100</span></span> | <span data-ttu-id="93e8d-473">인터넷</span><span class="sxs-lookup"><span data-stu-id="93e8d-473">Internet</span></span> | * | * | <span data-ttu-id="93e8d-474">3389</span><span class="sxs-lookup"><span data-stu-id="93e8d-474">3389</span></span> | <span data-ttu-id="93e8d-475">TCP</span><span class="sxs-lookup"><span data-stu-id="93e8d-475">TCP</span></span> |
| <span data-ttu-id="93e8d-476">Allow-Inbound-HTTP-Internet(인바운드 HTTP 인터넷 허용)</span><span class="sxs-lookup"><span data-stu-id="93e8d-476">Allow-Inbound-HTTP-Internet</span></span> | <span data-ttu-id="93e8d-477">허용</span><span class="sxs-lookup"><span data-stu-id="93e8d-477">Allow</span></span> | <span data-ttu-id="93e8d-478">200</span><span class="sxs-lookup"><span data-stu-id="93e8d-478">200</span></span> | <span data-ttu-id="93e8d-479">인터넷</span><span class="sxs-lookup"><span data-stu-id="93e8d-479">Internet</span></span> | * | * | <span data-ttu-id="93e8d-480">80</span><span class="sxs-lookup"><span data-stu-id="93e8d-480">80</span></span> | <span data-ttu-id="93e8d-481">TCP</span><span class="sxs-lookup"><span data-stu-id="93e8d-481">TCP</span></span> |

### <a name="db-servers-management-nic"></a><span data-ttu-id="93e8d-482">DB 서버(관리 NIC)</span><span class="sxs-lookup"><span data-stu-id="93e8d-482">DB servers (Management NIC)</span></span>
<span data-ttu-id="93e8d-483">**인바운드 규칙**</span><span class="sxs-lookup"><span data-stu-id="93e8d-483">**Inbound rules**</span></span>

| <span data-ttu-id="93e8d-484">규칙</span><span class="sxs-lookup"><span data-stu-id="93e8d-484">Rule</span></span> | <span data-ttu-id="93e8d-485">Access</span><span class="sxs-lookup"><span data-stu-id="93e8d-485">Access</span></span> | <span data-ttu-id="93e8d-486">우선 순위</span><span class="sxs-lookup"><span data-stu-id="93e8d-486">Priority</span></span> | <span data-ttu-id="93e8d-487">원본 주소 범위</span><span class="sxs-lookup"><span data-stu-id="93e8d-487">Source address range</span></span> | <span data-ttu-id="93e8d-488">원본 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-488">Source port</span></span> | <span data-ttu-id="93e8d-489">대상 주소 범위</span><span class="sxs-lookup"><span data-stu-id="93e8d-489">Destination address range</span></span> | <span data-ttu-id="93e8d-490">대상 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-490">Destination port</span></span> | <span data-ttu-id="93e8d-491">프로토콜</span><span class="sxs-lookup"><span data-stu-id="93e8d-491">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="93e8d-492">Allow-Inbound-RDP-Front-end(인바운드 RDP 프런트 엔드 허용)</span><span class="sxs-lookup"><span data-stu-id="93e8d-492">Allow-Inbound-RDP-Front-end</span></span> | <span data-ttu-id="93e8d-493">허용</span><span class="sxs-lookup"><span data-stu-id="93e8d-493">Allow</span></span> | <span data-ttu-id="93e8d-494">100</span><span class="sxs-lookup"><span data-stu-id="93e8d-494">100</span></span> | <span data-ttu-id="93e8d-495">192.168.1.0/24</span><span class="sxs-lookup"><span data-stu-id="93e8d-495">192.168.1.0/24</span></span> | * | * | <span data-ttu-id="93e8d-496">3389</span><span class="sxs-lookup"><span data-stu-id="93e8d-496">3389</span></span> | <span data-ttu-id="93e8d-497">TCP</span><span class="sxs-lookup"><span data-stu-id="93e8d-497">TCP</span></span> |

### <a name="db-servers-database-traffic-nic"></a><span data-ttu-id="93e8d-498">DB 서버(데이터베이스 트래픽 NIC)</span><span class="sxs-lookup"><span data-stu-id="93e8d-498">DB servers (Database traffic NIC)</span></span>
<span data-ttu-id="93e8d-499">**인바운드 규칙**</span><span class="sxs-lookup"><span data-stu-id="93e8d-499">**Inbound rules**</span></span>

| <span data-ttu-id="93e8d-500">규칙</span><span class="sxs-lookup"><span data-stu-id="93e8d-500">Rule</span></span> | <span data-ttu-id="93e8d-501">Access</span><span class="sxs-lookup"><span data-stu-id="93e8d-501">Access</span></span> | <span data-ttu-id="93e8d-502">우선 순위</span><span class="sxs-lookup"><span data-stu-id="93e8d-502">Priority</span></span> | <span data-ttu-id="93e8d-503">원본 주소 범위</span><span class="sxs-lookup"><span data-stu-id="93e8d-503">Source address range</span></span> | <span data-ttu-id="93e8d-504">원본 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-504">Source port</span></span> | <span data-ttu-id="93e8d-505">대상 주소 범위</span><span class="sxs-lookup"><span data-stu-id="93e8d-505">Destination address range</span></span> | <span data-ttu-id="93e8d-506">대상 포트</span><span class="sxs-lookup"><span data-stu-id="93e8d-506">Destination port</span></span> | <span data-ttu-id="93e8d-507">프로토콜</span><span class="sxs-lookup"><span data-stu-id="93e8d-507">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="93e8d-508">Allow-Inbound-SQL-Front-end(인바운드 SQL 프런트 엔드 허용)</span><span class="sxs-lookup"><span data-stu-id="93e8d-508">Allow-Inbound-SQL-Front-end</span></span> | <span data-ttu-id="93e8d-509">허용</span><span class="sxs-lookup"><span data-stu-id="93e8d-509">Allow</span></span> | <span data-ttu-id="93e8d-510">100</span><span class="sxs-lookup"><span data-stu-id="93e8d-510">100</span></span> | <span data-ttu-id="93e8d-511">192.168.1.0/24</span><span class="sxs-lookup"><span data-stu-id="93e8d-511">192.168.1.0/24</span></span> | * | * | <span data-ttu-id="93e8d-512">1433</span><span class="sxs-lookup"><span data-stu-id="93e8d-512">1433</span></span> | <span data-ttu-id="93e8d-513">TCP</span><span class="sxs-lookup"><span data-stu-id="93e8d-513">TCP</span></span> |

<span data-ttu-id="93e8d-514">NSG 중 일부는 개별 NIC와 연결되므로 Resource Manager를 통해 배포된 리소스에 대한 규칙이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-514">Since some of the NSGs are associated to individual NICs, the rules are for resources deployed through Resource Manager.</span></span> <span data-ttu-id="93e8d-515">규칙은 연결되는 방법에 따라 서브넷과 NIC에 대해 결합됩니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-515">Rules are combined for subnet and NIC, depending on how they are associated.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="93e8d-516">다음 단계</span><span class="sxs-lookup"><span data-stu-id="93e8d-516">Next steps</span></span>
* <span data-ttu-id="93e8d-517">[NSG 배포(Resource Manager)](virtual-networks-create-nsg-arm-pportal.md).</span><span class="sxs-lookup"><span data-stu-id="93e8d-517">[Deploy NSGs (Resource Manager)](virtual-networks-create-nsg-arm-pportal.md).</span></span>
* <span data-ttu-id="93e8d-518">[NSG 배포(클래식)](virtual-networks-create-nsg-classic-ps.md).</span><span class="sxs-lookup"><span data-stu-id="93e8d-518">[Deploy NSGs (classic)](virtual-networks-create-nsg-classic-ps.md).</span></span>
* <span data-ttu-id="93e8d-519">[NSG 로그를 관리](virtual-network-nsg-manage-log.md)합니다.</span><span class="sxs-lookup"><span data-stu-id="93e8d-519">[Manage NSG logs](virtual-network-nsg-manage-log.md).</span></span>
* <span data-ttu-id="93e8d-520">[NSG 문제 해결](virtual-network-nsg-troubleshoot-portal.md)</span><span class="sxs-lookup"><span data-stu-id="93e8d-520">[Troubleshoot NSGs] (virtual-network-nsg-troubleshoot-portal.md)</span></span>
