---
title: "aaaUser 정의 된 경로 및 Azure의 IP 전달 | Microsoft Docs"
description: "Tooconfigure 사용자 정의 경로 (UDR) 및 IP 전달 tooforward Azure에서 가상 어플라이언스 toonetwork 트래픽 방법에 대해 알아봅니다."
services: virtual-network
documentationcenter: na
author: jimdial
manager: timlt
editor: tysonn
ms.assetid: c39076c4-11b7-4b46-a904-817503c4b486
ms.service: virtual-network
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/15/2016
ms.author: jdial
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: f1f1d46166d5a7c776f472b7ade1354d943ece10
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/06/2017
---
# <a name="user-defined-routes-and-ip-forwarding"></a><span data-ttu-id="f3f2e-103">사용자 정의 경로 및 IP 전달</span><span class="sxs-lookup"><span data-stu-id="f3f2e-103">User-defined routes and IP forwarding</span></span>

<span data-ttu-id="f3f2e-104">Azure에서 가상 컴퓨터 (Vm) tooa 가상 네트워크 (VNet)를 추가할 때 hello Vm은 서로 수 toocommunicate hello 네트워크를 통해 자동으로 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-104">When you add virtual machines (VMs) tooa virtual network (VNet) in Azure, you will notice that hello VMs are able toocommunicate with each other over hello network, automatically.</span></span> <span data-ttu-id="f3f2e-105">Hello Vm 서브넷이 서로 다른 경우에 게이트웨이 toospecify를 않아도 됩니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-105">You do not need toospecify a gateway, even though hello VMs are in different subnets.</span></span> <span data-ttu-id="f3f2e-106">hello 같은 기준이 hello Vm toohello에서 통신에 대 한 공용 인터넷 및 tooyour Azure에서 하이브리드 연결 데이터 센터를 사용할 수 있는지를 소유 하는 경우에 tooyour 온-프레미스 네트워크입니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-106">hello same is true for communication from hello VMs toohello public Internet, and even tooyour on-premises network when a hybrid connection from Azure tooyour own datacenter is present.</span></span>

<span data-ttu-id="f3f2e-107">통신의이 흐름은 Azure 일련의 시스템 경로 toodefine IP 트래픽이 흐르는 방법을 사용 하기 때문에 가능 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-107">This flow of communication is possible because Azure uses a series of system routes toodefine how IP traffic flows.</span></span> <span data-ttu-id="f3f2e-108">Hello 흐름 hello 다음 시나리오에서에서이 통신을 제어 하는 시스템 경로:</span><span class="sxs-lookup"><span data-stu-id="f3f2e-108">System routes control hello flow of communication in hello following scenarios:</span></span>

* <span data-ttu-id="f3f2e-109">내에서 동일한 서브넷을 hello 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-109">From within hello same subnet.</span></span>
* <span data-ttu-id="f3f2e-110">VNet 내의 서브넷 tooanother에서.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-110">From a subnet tooanother within a VNet.</span></span>
* <span data-ttu-id="f3f2e-111">Vm toohello 인터넷 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-111">From VMs toohello Internet.</span></span>
* <span data-ttu-id="f3f2e-112">VPN 게이트웨이 통해는 VNet tooanother VNet입니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-112">From a VNet tooanother VNet through a VPN gateway.</span></span>
* <span data-ttu-id="f3f2e-113">VNet tooanother VNet (서비스 연결) 피어 링을 통해 VNet에서</span><span class="sxs-lookup"><span data-stu-id="f3f2e-113">From a VNet tooanother VNet through VNet Peering (Service Chaining).</span></span>
* <span data-ttu-id="f3f2e-114">VPN 게이트웨이 통해 VNet tooyour 온-프레미스 네트워크입니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-114">From a VNet tooyour on-premises network through a VPN gateway.</span></span>

<span data-ttu-id="f3f2e-115">아래 hello 그림 VNet, 2 서브넷 및 hello와 함께 몇 가지 Vm을 사용 하 여 간단한 설치 IP 트래픽이 tooflow 허용 하는 시스템 경로 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-115">hello figure below shows a simple setup with a VNet, two subnets, and a few VMs, along with hello system routes that allow IP traffic tooflow.</span></span>

![Azure의 시스템 경로](./media/virtual-networks-udr-overview/Figure1.png)

<span data-ttu-id="f3f2e-117">시스템 경로 hello 사용을 자동으로 배포에 대 한 트래픽을 용이 하 게, 있지만 toocontrol hello 패킷을 라우팅할 가상 어플라이언스를 통해 만들려는 경우가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-117">Although hello use of system routes facilitates traffic automatically for your deployment, there are cases in which you want toocontrol hello routing of packets through a virtual appliance.</span></span> <span data-ttu-id="f3f2e-118">수행 하므로 사용자 정의 경로 만들어 지정 tooa 특정 서브넷 toogo tooyour 가상 어플라이언스를 대신 흐르는 패킷이 대 한 다음 홉 hello 하 고 IP를 사용 하도록 설정에 대 한 전달 hello hello 가상 어플라이언스를 실행 중인 VM입니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-118">You can do so by creating user defined routes that specify hello next hop for packets flowing tooa specific subnet toogo tooyour virtual appliance instead, and enabling IP forwarding for hello VM running as hello virtual appliance.</span></span>

<span data-ttu-id="f3f2e-119">hello 아래 그림은 예의 사용자 정의 경로 및 IP tooforce 패킷을 전달 다른 toogo에서 세 번째 서브넷을 가상 어플라이언스를 통해 tooone 서브넷을 전송 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-119">hello figure below shows an example of user defined routes and IP forwarding tooforce packets sent tooone subnet from another toogo through a virtual appliance on a third subnet.</span></span>

![Azure의 시스템 경로](./media/virtual-networks-udr-overview/Figure2.png)

> [!IMPORTANT]
> <span data-ttu-id="f3f2e-121">사용자 정의 경로를 그대로 유지 하면서 서브넷 리소스에서 (예: 네트워크 인터페이스 연결 tooVMs) hello 서브넷 적용된 tootraffic 됩니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-121">User-defined routes are applied tootraffic leaving a subnet from any resource (such as network interfaces attached tooVMs) in hello subnet.</span></span> <span data-ttu-id="f3f2e-122">경로 toospecify를 만들 수 없습니다 어떻게 트래픽이 수신 서브넷 hello 인터넷에서에서 예를 들어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-122">You cannot create routes toospecify how traffic enters a subnet from hello Internet, for instance.</span></span> <span data-ttu-id="f3f2e-123">트래픽 toocannot를 전달 하는 hello 기기 hello에 있을 동일한 서브넷 hello 트래픽이 발생 하는 위치입니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-123">hello appliance you are forwarding traffic toocannot be in hello same subnet where hello traffic originates.</span></span> <span data-ttu-id="f3f2e-124">항상 기기를 위한 별도의 서브넷을 만드세요.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-124">Always create a separate subnet for your appliances.</span></span> 
> 
> 

## <a name="route-resource"></a><span data-ttu-id="f3f2e-125">경로 리소스</span><span class="sxs-lookup"><span data-stu-id="f3f2e-125">Route resource</span></span>
<span data-ttu-id="f3f2e-126">패킷을은 hello 실제 네트워크에 각 노드에 정의 된 경로 테이블을 기반으로 하는 TCP/IP 네트워크를 통해 라우팅됩니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-126">Packets are routed over a TCP/IP network based on a route table defined at each node on hello physical network.</span></span> <span data-ttu-id="f3f2e-127">경로 테이블은 개별 경로의 컬렉션 toodecide 여기서 tooforward 패킷을에 따라 사용 hello 대상 IP 주소.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-127">A route table is a collection of individual routes used toodecide where tooforward packets based on hello destination IP address.</span></span> <span data-ttu-id="f3f2e-128">경로는 hello 다음 이루어져 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-128">A route consists of hello following:</span></span>

| <span data-ttu-id="f3f2e-129">속성</span><span class="sxs-lookup"><span data-stu-id="f3f2e-129">Property</span></span> | <span data-ttu-id="f3f2e-130">설명</span><span class="sxs-lookup"><span data-stu-id="f3f2e-130">Description</span></span> | <span data-ttu-id="f3f2e-131">제약 조건</span><span class="sxs-lookup"><span data-stu-id="f3f2e-131">Constraints</span></span> | <span data-ttu-id="f3f2e-132">고려 사항</span><span class="sxs-lookup"><span data-stu-id="f3f2e-132">Considerations</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="f3f2e-133">주소 접두사</span><span class="sxs-lookup"><span data-stu-id="f3f2e-133">Address Prefix</span></span> |<span data-ttu-id="f3f2e-134">hello 대상 CIDR toowhich hello 경로 10.1.0.0/16 등 적용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-134">hello destination CIDR toowhich hello route applies, such as 10.1.0.0/16.</span></span> |<span data-ttu-id="f3f2e-135">Hello에 주소를 나타내는 유효한 CIDR 범위 여야 합니다. 공용 인터넷, Azure 가상 네트워크 또는 온-프레미스 데이터 센터입니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-135">Must be a valid CIDR range representing addresses on hello public Internet, Azure virtual network, or on-premises datacenter.</span></span> |<span data-ttu-id="f3f2e-136">있는지 hello 확인 **주소 접두사** hello에 대 한 hello 주소가 들어 있지 않으면 **다음 홉 주소**, 그렇지 않은 프로그램 패킷을 도달 하지 않고 hello 소스 toohello 다음 홉에서 이동 하는 루프에 입력 됩니다 hello 대상입니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-136">Make sure hello **Address prefix** does not contain hello address for hello **Next hop address**, otherwise your packets will enter in a loop going from hello source toohello next hop without ever reaching hello destination.</span></span> |
| <span data-ttu-id="f3f2e-137">다음 홉 유형</span><span class="sxs-lookup"><span data-stu-id="f3f2e-137">Next hop type</span></span> |<span data-ttu-id="f3f2e-138">hello 종류의 Azure 홉 hello 패킷에 전송 되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-138">hello type of Azure hop hello packet should be sent to.</span></span> |<span data-ttu-id="f3f2e-139">Hello 다음 값 중 하나 여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-139">Must be one of hello following values:</span></span> <br/> <span data-ttu-id="f3f2e-140">**Virtual Network**.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-140">**Virtual Network**.</span></span> <span data-ttu-id="f3f2e-141">Hello 로컬 가상 네트워크를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-141">Represents hello local virtual network.</span></span> <span data-ttu-id="f3f2e-142">예를 들어, 두 개의 서브넷이 있는 경우 10.1.0.0/16 및에서 10.2.0.0/16 hello 동일한 가상 네트워크, hello 경로 테이블의 각 서브넷에 대 한 hello 경로 다음 홉 값 *가상 네트워크*합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-142">For instance, if you have two subnets, 10.1.0.0/16 and 10.2.0.0/16 in hello same virtual network, hello route for each subnet in hello route table will have a next hop value of *Virtual Network*.</span></span> <br/> <span data-ttu-id="f3f2e-143">**Virtual Network 게이트웨이**.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-143">**Virtual Network Gateway**.</span></span> <span data-ttu-id="f3f2e-144">Azure S2S VPN Gateway를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-144">Represents an Azure S2S VPN Gateway.</span></span> <br/> <span data-ttu-id="f3f2e-145">**인터넷**.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-145">**Internet**.</span></span> <span data-ttu-id="f3f2e-146">Hello Azure 인프라에서 제공 하는 hello 기본 인터넷 게이트웨이 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-146">Represents hello default Internet gateway provided by hello Azure Infrastructure.</span></span> <br/> <span data-ttu-id="f3f2e-147">**가상 어플라이언스**.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-147">**Virtual Appliance**.</span></span> <span data-ttu-id="f3f2e-148">Tooyour Azure 가상 네트워크를 추가 하는 가상 어플라이언스를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-148">Represents a virtual appliance you added tooyour Azure virtual network.</span></span> <br/> <span data-ttu-id="f3f2e-149">**없음**.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-149">**None**.</span></span> <span data-ttu-id="f3f2e-150">블랙 홀을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-150">Represents a black hole.</span></span> <span data-ttu-id="f3f2e-151">Tooa 블랙홀에 전달 된 패킷은 전혀 전달 되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-151">Packets forwarded tooa black hole will not be forwarded at all.</span></span> |<span data-ttu-id="f3f2e-152">사용 하는 것이 좋습니다 **가상 어플라이언스** toodirect 트래픽 tooa VM 또는 Azure 부하 분산 장치 내부 IP 주소입니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-152">Consider using **Virtual Appliance** toodirect traffic tooa VM or Azure Load Balancer internal IP address.</span></span>  <span data-ttu-id="f3f2e-153">이 형식은 아래 설명 된 대로 IP 주소의 hello 지정이 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-153">This type allows hello specification of an IP address as described below.</span></span> <span data-ttu-id="f3f2e-154">사용 하는 것이 좋습니다는 **None** toostop 패킷을 대상 지정 된 이동을 tooa에서를 입력 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-154">Consider using a **None** type toostop packets from flowing tooa given destination.</span></span> |
| <span data-ttu-id="f3f2e-155">다음 홉 주소</span><span class="sxs-lookup"><span data-stu-id="f3f2e-155">Next hop address</span></span> |<span data-ttu-id="f3f2e-156">전달 해야 하는 패킷을 hello IP 주소를 포함 하는 hello 다음 홉 주소입니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-156">hello next hop address contains hello IP address packets should be forwarded to.</span></span> <span data-ttu-id="f3f2e-157">다음 홉 값은 다음 홉 형식이 hello 인 경로 에서만 허용 *가상 어플라이언스*합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-157">Next hop values are only allowed in routes where hello next hop type is *Virtual Appliance*.</span></span> |<span data-ttu-id="f3f2e-158">Hello를 거치지 않고 사용자 정의 경로 hello 적용 하는 가상 네트워크 내에서 연결할 수 있는 IP 주소 여야 합니다는 **가상 네트워크 게이트웨이**합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-158">Must be an IP address that is reachable within hello Virtual Network where hello User Defined Route is applied, without going through a **Virtual Network Gateway**.</span></span> <span data-ttu-id="f3f2e-159">hello IP 주소 또는 peered 가상 네트워크를 적용 하는 경우 동일한 가상 네트워크는 hello에 toobe에 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-159">hello IP address has toobe on hello same Virtual Network where it is applied, or on a peered Virtual Network.</span></span> |<span data-ttu-id="f3f2e-160">Hello IP 주소는 VM을 나타내는 경우 사용 하도록 설정 하면 있는지 확인 [IP 전달을](#IP-forwarding) hello VM에 대 한 Azure에서.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-160">If hello IP address represents a VM, make sure you enable [IP forwarding](#IP-forwarding) in Azure for hello VM.</span></span> <span data-ttu-id="f3f2e-161">Hello IP 주소 나타냅니다 hello 내부 IP 주소를 Azure 부하 분산 장치 있어야 일치 하는 부하 분산 규칙 각 포트에 대해 원하는 tooload 분산 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-161">If hello IP address represents hello internal IP address of Azure Load Balancer, make sure you have a matching load balancing rule for each port you wish tooload balance.</span></span>|

<span data-ttu-id="f3f2e-162">Azure PowerShell에서 일부 hello "NextHopType" 값 이름이 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-162">In Azure PowerShell some of hello "NextHopType" values have different names:</span></span>

* <span data-ttu-id="f3f2e-163">가상 네트워크는 VnetLocal입니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-163">Virtual Network is VnetLocal</span></span>
* <span data-ttu-id="f3f2e-164">가상 네트워크 게이트웨이는 VirtualNetworkGateway입니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-164">Virtual Network Gateway is VirtualNetworkGateway</span></span>
* <span data-ttu-id="f3f2e-165">가상 어플라이언스는 VirtualAppliance입니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-165">Virtual Appliance is VirtualAppliance</span></span>
* <span data-ttu-id="f3f2e-166">Internet은 인터넷입니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-166">Internet is Internet</span></span>
* <span data-ttu-id="f3f2e-167">None은 없음입니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-167">None is None</span></span>

### <a name="system-routes"></a><span data-ttu-id="f3f2e-168">시스템 경로</span><span class="sxs-lookup"><span data-stu-id="f3f2e-168">System routes</span></span>
<span data-ttu-id="f3f2e-169">가상 네트워크에서 만든 모든 서브넷 hello 시스템 경로 규칙을 포함 하는 경로 테이블 자동 연결 됩니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-169">Every subnet created in a virtual network is automatically associated with a route table that contains hello following system route rules:</span></span>

* <span data-ttu-id="f3f2e-170">**로컬 Vnet 규칙**:이 규칙은 가상 네트워크에 있는 모든 서브넷에 대해 자동으로 생성됩니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-170">**Local Vnet Rule**: This rule is automatically created for every subnet in a virtual network.</span></span> <span data-ttu-id="f3f2e-171">Hello Vm hello VNet에에서 직접 연결 되어 있는 및는 중간 없는 다음 홉을 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-171">It specifies that there is a direct link between hello VMs in hello VNet and there is no intermediate next hop.</span></span>
* <span data-ttu-id="f3f2e-172">**온-프레미스 규칙**:이 규칙 tooall 전송 트래픽을 toohello 온-프레미스 주소 범위를 적용 하 고 VPN 게이트웨이 사용 하 여 hello 다음 홉 대상으로 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-172">**On-premises Rule**: This rule applies tooall traffic destined toohello on-premises address range and uses VPN gateway as hello next hop destination.</span></span>
* <span data-ttu-id="f3f2e-173">**인터넷 규칙**:이 규칙에는 모든 트래픽이 toohello 처리 공용 인터넷 (주소 접두사 0.0.0.0/0) 및 사용 하 여 hello 인프라 인터넷 게이트웨이 hello로 모든 트래픽이 toohello 인터넷에 대 한 다음 홉 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-173">**Internet Rule**: This rule handles all traffic destined toohello public Internet (address prefix 0.0.0.0/0) and uses hello infrastructure internet gateway as hello next hop for all traffic destined toohello Internet.</span></span>

### <a name="user-defined-routes"></a><span data-ttu-id="f3f2e-174">사용자 정의 경로</span><span class="sxs-lookup"><span data-stu-id="f3f2e-174">User-defined routes</span></span>
<span data-ttu-id="f3f2e-175">대부분의 환경에만 Azure에서 이미 정의 된 hello 시스템 경로 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-175">For most environments you will only need hello system routes already defined by Azure.</span></span> <span data-ttu-id="f3f2e-176">그러나와 같은 특정 경우에 하나 이상의 경로 추가 toocreate 경로 테이블을 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-176">However, you may need toocreate a route table and add one or more routes in specific cases, such as:</span></span>

* <span data-ttu-id="f3f2e-177">온-프레미스 네트워크를 통해 터널링 toohello 인터넷 강제로 적용 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-177">Force tunneling toohello Internet via your on-premises network.</span></span>
* <span data-ttu-id="f3f2e-178">Azure 환경에서 가상 어플라이언스를 사용하는 경우</span><span class="sxs-lookup"><span data-stu-id="f3f2e-178">Use of virtual appliances in your Azure environment.</span></span>

<span data-ttu-id="f3f2e-179">위의 hello 시나리오에서는 toocreate 경로 테이블 및 사용자 정의 경로 tooit를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-179">In hello scenarios above, you will have toocreate a route table and add user defined routes tooit.</span></span> <span data-ttu-id="f3f2e-180">여러 경로 테이블을 포함할 수 있습니다 hello 동일한 경로 테이블 수 있으며 관련된 tooone 또는 서브넷을 더 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-180">You can have multiple route tables, and hello same route table can be associated tooone or more subnets.</span></span> <span data-ttu-id="f3f2e-181">및 각 서브넷 연결된 tooa 단일 경로 테이블에만 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-181">And each subnet can only be associated tooa single route table.</span></span> <span data-ttu-id="f3f2e-182">모든 Vm 및 서브넷에 있는 클라우드 서비스는 hello 경로 연결 된 테이블 toothat 서브넷을 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-182">All VMs and cloud services in a subnet use hello route table associated toothat subnet.</span></span>

<span data-ttu-id="f3f2e-183">서브넷 경로 테이블 연결된 toohello 서브넷 될 때까지 시스템 경로에 의존 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-183">Subnets rely on system routes until a route table is associated toohello subnet.</span></span> <span data-ttu-id="f3f2e-184">연결이 설정되면 사용자 정의 경로 및 시스템 경로 간에 LPM(가장 긴 접두사 일치)을 기반으로 라우팅이 수행됩니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-184">Once an association exists, routing is done based on Longest Prefix Match (LPM) among both user defined routes and system routes.</span></span> <span data-ttu-id="f3f2e-185">없을 경우 둘 이상의 경로가 동일한 LPM 경로 선택은 일치 하는 hello로 순서에 따라 hello에서 원본에 따라:</span><span class="sxs-lookup"><span data-stu-id="f3f2e-185">If there is more than one route with hello same LPM match then a route is selected based on its origin in hello following order:</span></span>

1. <span data-ttu-id="f3f2e-186">사용자 정의 경로</span><span class="sxs-lookup"><span data-stu-id="f3f2e-186">User defined route</span></span>
2. <span data-ttu-id="f3f2e-187">BGP 경로(ExpressRoute를 사용하는 경우)</span><span class="sxs-lookup"><span data-stu-id="f3f2e-187">BGP route (when ExpressRoute is used)</span></span>
3. <span data-ttu-id="f3f2e-188">시스템 경로</span><span class="sxs-lookup"><span data-stu-id="f3f2e-188">System route</span></span>

<span data-ttu-id="f3f2e-189">toolearn toocreate 사용자 경로 정의 하는 방법 참조 [tooCreate 라우팅합니다 하 고 Azure의 IP 전달을 사용 하도록 설정 하는 방법을](virtual-network-create-udr-arm-template.md)합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-189">toolearn how toocreate user defined routes, see [How tooCreate Routes and Enable IP Forwarding in Azure](virtual-network-create-udr-arm-template.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f3f2e-190">사용자 정의 경로 적용 된 tooAzure Vm 및 클라우드 서비스입니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-190">User defined routes are only applied tooAzure VMs and cloud services.</span></span> <span data-ttu-id="f3f2e-191">예를 들어, tooadd 온-프레미스 네트워크와 Azure 간의 방화벽 가상 어플라이언스를 원하는 경우 수 toocreate toohello 온-프레미스 주소 공간 toohello 가상 라인으로 전환 하는 모든 트래픽을 전달 하는 Azure 경로 테이블에 대 한 사용자 정의 경로 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-191">For instance, if you want tooadd a firewall virtual appliance between your on-premises network and Azure, you will have toocreate a user defined route for your Azure route tables that forwards all traffic going toohello on-premises address space toohello virtual appliance.</span></span> <span data-ttu-id="f3f2e-192">사용자 정의 경로 (UDR) toohello GatewaySubnet tooforward 모든 트래픽을 온-프레미스 tooAzure에서 hello 가상 어플라이언스를 통해 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-192">You can also add a user defined route (UDR) toohello GatewaySubnet tooforward all traffic from on-premises tooAzure through hello virtual appliance.</span></span> <span data-ttu-id="f3f2e-193">이 기능은 최근에 추가되었습니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-193">This is a recent addition.</span></span>
> 
> 

### <a name="bgp-routes"></a><span data-ttu-id="f3f2e-194">BGP 경로</span><span class="sxs-lookup"><span data-stu-id="f3f2e-194">BGP routes</span></span>
<span data-ttu-id="f3f2e-195">ExpressRoute 연결 온-프레미스 네트워크와 Azure 간에 있는 경우에 온-프레미스 네트워크 tooAzure에서 BGP toopropagate 경로 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-195">If you have an ExpressRoute connection between your on-premises network and Azure, you can enable BGP toopropagate routes from your on-premises network tooAzure.</span></span> <span data-ttu-id="f3f2e-196">Hello에 이러한 BGP 경로 사용 하는 시스템 경로 및 사용자 같은 방식으로 각 Azure 서브넷에 경로 정의 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-196">These BGP routes are used in hello same way as system routes and user defined routes in each Azure subnet.</span></span> <span data-ttu-id="f3f2e-197">자세한 내용은 [ExpressRoute 소개](../expressroute/expressroute-introduction.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-197">For more information see [ExpressRoute Introduction](../expressroute/expressroute-introduction.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f3f2e-198">프로그램 Azure 환경 toouse 강제 hello 다음 홉으로 hello VPN 게이트웨이 사용 하는 서브넷 0.0.0.0/0에 대 한 사용자 정의 경로 만들어 온-프레미스 네트워크를 통해 터널링을 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-198">You can configure your Azure environment toouse force tunneling through your on-premises network by creating a user defined route for subnet 0.0.0.0/0 that uses hello VPN gateway as hello next hop.</span></span> <span data-ttu-id="f3f2e-199">그러나 이 구성은 VPN Gateway를 사용하는 경우에만 작동하고 ExpressRoute를 사용하는 경우에는 작동하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-199">However, this only works if you are using a VPN gateway, not ExpressRoute.</span></span> <span data-ttu-id="f3f2e-200">ExpressRoute의 경우 강제 터널링은 BGP를 통해 구성됩니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-200">For ExpressRoute, forced tunneling is configured through BGP.</span></span>
> 
> 

## <a name="ip-forwarding"></a><span data-ttu-id="f3f2e-201">IP 전달</span><span class="sxs-lookup"><span data-stu-id="f3f2e-201">IP forwarding</span></span>
<span data-ttu-id="f3f2e-202">Hello는 주요 이유 toocreate 중 하나 위에 설명 된 대로 사용자 정의 경로 tooforward 트래픽 tooa 가상 어플라이언스는.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-202">As described above, one of hello main reasons toocreate a user defined route is tooforward traffic tooa virtual appliance.</span></span> <span data-ttu-id="f3f2e-203">가상 어플라이언스 방화벽이 나 NAT 장치 등의 방법으로 사용 되는 응용 프로그램 toohandle 네트워크 트래픽을 실행 하는 VM에 뿐입니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-203">A virtual appliance is nothing more than a VM that runs an application used toohandle network traffic in some way, such as a firewall or a NAT device.</span></span>

<span data-ttu-id="f3f2e-204">VM에 있는 수 tooreceive 들어오는 트래픽이 있어야 합니다.이 가상 어플라이언스 tooitself를 바람직하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-204">This virtual appliance VM must be able tooreceive incoming traffic that is not addressed tooitself.</span></span> <span data-ttu-id="f3f2e-205">VM tooreceive 트래픽이 tooallow 해결 tooother 대상, VM hello에 대 한 IP 전달 설정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-205">tooallow a VM tooreceive traffic addressed tooother destinations, you must enable IP Forwarding for hello VM.</span></span> <span data-ttu-id="f3f2e-206">이 Azure 설정 hello 게스트 운영 체제에서 설정이 아닙니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-206">This is an Azure setting, not a setting in hello guest operating system.</span></span>

## <a name="next-steps"></a><span data-ttu-id="f3f2e-207">다음 단계</span><span class="sxs-lookup"><span data-stu-id="f3f2e-207">Next steps</span></span>
* <span data-ttu-id="f3f2e-208">너무 방법에 대해 알아봅니다[hello 리소스 관리자 배포 모델에서 경로 만들어](virtual-network-create-udr-arm-template.md) toosubnets 연결 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-208">Learn how too[create routes in hello Resource Manager deployment model](virtual-network-create-udr-arm-template.md) and associate them toosubnets.</span></span> 
* <span data-ttu-id="f3f2e-209">너무 방법에 대해 알아봅니다[hello 클래식 배포 모델에서 경로 만들어](virtual-network-create-udr-classic-ps.md) toosubnets 연결 합니다.</span><span class="sxs-lookup"><span data-stu-id="f3f2e-209">Learn how too[create routes in hello classic deployment model](virtual-network-create-udr-classic-ps.md) and associate them toosubnets.</span></span>

