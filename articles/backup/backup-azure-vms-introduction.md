---
title: "Azure에서 VM 백업 인프라 계획 | Microsoft Docs"
description: "Azure에서 가상 컴퓨터를 백업하려고 할 때 중요한 고려 사항"
services: backup
documentationcenter: 
author: markgalioto
manager: carmonm
editor: 
keywords: "vm 백업, virtual machines 백업"
ms.assetid: 19d2cf82-1f60-43e1-b089-9238042887a9
ms.service: backup
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 7/18/2017
ms.author: markgal;trinadhk
ms.openlocfilehash: 0c930c7413b24a811707c3a1ff3d7d70585bc528
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/29/2017
---
# <a name="plan-your-vm-backup-infrastructure-in-azure"></a><span data-ttu-id="fa131-104">Azure에서 VM 백업 인프라 계획</span><span class="sxs-lookup"><span data-stu-id="fa131-104">Plan your VM backup infrastructure in Azure</span></span>
<span data-ttu-id="fa131-105">이 문서에서는 성능 및 리소스를 제안하여 VM 백업 인프라를 계획할 수 있도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-105">This article provides performance and resource suggestions to help you plan your VM backup infrastructure.</span></span> <span data-ttu-id="fa131-106">또한 백업 서비스의 핵심 요소를 정의합니다. 이러한 측면은 아키텍처, 용량 계획 및 예약을 결정하는 데 중요한 요인이 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-106">It also defines key aspects of the Backup service; these aspects can be critical in determining your architecture, capacity planning, and scheduling.</span></span> <span data-ttu-id="fa131-107">[환경을 준비](backup-azure-vms-prepare.md)했다면 계획은 [VM 백업](backup-azure-vms.md)을 시작하기 전의 다음 단계입니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-107">If you've [prepared your environment](backup-azure-vms-prepare.md), planning is the next step before you begin [to back up VMs](backup-azure-vms.md).</span></span> <span data-ttu-id="fa131-108">Azure 가상 컴퓨터에 대한 자세한 내용은 [가상 컴퓨터 설명서](https://azure.microsoft.com/documentation/services/virtual-machines/)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="fa131-108">If you need more information about Azure virtual machines, see the [Virtual Machines documentation](https://azure.microsoft.com/documentation/services/virtual-machines/).</span></span>

## <a name="how-does-azure-back-up-virtual-machines"></a><span data-ttu-id="fa131-109">Azure에서 가상 컴퓨터를 백업하는 방법</span><span class="sxs-lookup"><span data-stu-id="fa131-109">How does Azure back up virtual machines?</span></span>
<span data-ttu-id="fa131-110">Azure 백업 서비스는 예약된 시간에 백업 작업을 시작할 때 시점 스냅숏을 만드는 백업 확장을 트리거합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-110">When the Azure Backup service initiates a backup job at the scheduled time, it triggers the backup extension to take a point-in-time snapshot.</span></span> <span data-ttu-id="fa131-111">Azure Backup 서비스는 Windows에서 _VMSnapshot_ 확장을 사용하고, Linux에서는 _VMSnapshotLinux_ 확장을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-111">The Azure Backup service uses the _VMSnapshot_ extension in Windows, and the _VMSnapshotLinux_ extension in Linux.</span></span> <span data-ttu-id="fa131-112">확장은 첫 번째 VM 백업 중에 설치됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-112">The extension is installed during the first VM backup.</span></span> <span data-ttu-id="fa131-113">확장을 설치하려면 VM이 실행 중이어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-113">To install the extension, the VM must be running.</span></span> <span data-ttu-id="fa131-114">VM이 실행되고 있지 않을 경우 Backup 서비스가 기본 저장소의 스냅숏을 생성합니다(VM이 중지되었을 때는 응용 프로그램 쓰기가 수행되지 않음).</span><span class="sxs-lookup"><span data-stu-id="fa131-114">If the VM is not running, the Backup service takes a snapshot of the underlying storage (since no application writes occur while the VM is stopped).</span></span>

<span data-ttu-id="fa131-115">Windows VM의 스냅숏을 생성할 때 Backup 서비스는 가상 컴퓨터의 디스크에 대한 일관된 스냅숏을 가져오도록 VSS(볼륨 섀도 복사본 서비스)와 조정됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-115">When taking a snapshot of Windows VMs, the Backup service coordinates with the Volume Shadow Copy Service (VSS) to get a consistent snapshot of the virtual machine's disks.</span></span> <span data-ttu-id="fa131-116">Linux VM을 백업하는 경우 VM 스냅숏을 생성할 때 일관성을 유지하기 위해 직접 사용자 지정 스크립트를 작성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-116">If you're backing up Linux VMs, you can write your own custom scripts to ensure consistency when taking a VM snapshot.</span></span> <span data-ttu-id="fa131-117">이러한 스크립트 호출에 대한 자세한 내용은 이 문서의 뒷부분에 제공됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-117">Details on invoking these scripts are provided later in this article.</span></span>

<span data-ttu-id="fa131-118">Azure Backup 서비스가 스냅숏을 생성하면 데이터가 자격 증명 모음으로 전송됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-118">Once the Azure Backup service takes the snapshot, the data is transferred to the vault.</span></span> <span data-ttu-id="fa131-119">효율성을 극대화하기 위해 이 서비스는 이전 백업 이후에 변경된 데이터 블록만 식별하여 전송합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-119">To maximize efficiency, the service identifies and transfers only the blocks of data that have changed since the previous backup.</span></span>

![Azure 가상 컴퓨터 백업 아키텍처](./media/backup-azure-vms-introduction/vmbackup-architecture.png)

<span data-ttu-id="fa131-121">데이터 전송이 완료되면 스냅숏이 제거되고 복구 지점이 생성됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-121">When the data transfer is complete, the snapshot is removed and a recovery point is created.</span></span>

> [!NOTE]
> 1. <span data-ttu-id="fa131-122">Azure Backup은 백업 프로세스 중에 가상 컴퓨터에 연결된 임시 디스크를 포함하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-122">During the backup process, Azure Backup doesn't include the temporary disk attached to the virtual machine.</span></span> <span data-ttu-id="fa131-123">자세한 내용은 [임시 저장소](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/)에 대한 블로그를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="fa131-123">For more information, see the blog on [temporary storage](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).</span></span>
> 2. <span data-ttu-id="fa131-124">Azure Backup은 저장소 수준의 스냅숏을 생성하여 자격 증명 모음으로 전송하므로 백업 작업이 완료될 때까지 저장소 계정 키를 변경하지 마세요.</span><span class="sxs-lookup"><span data-stu-id="fa131-124">Since Azure Backup takes a storage-level snapshot and transfers that snapshot to vault, do not change the storage account keys until the backup job finishes.</span></span>
> 3. <span data-ttu-id="fa131-125">프리미엄 VM의 경우 저장소 계정에 스냅숏을 복사합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-125">For premium VMs, we copy the snapshot to storage account.</span></span> <span data-ttu-id="fa131-126">이렇게 하면 Azure Backup 서비스가 자격 증명 모음으로 데이터를 전송하는 데 충분한 IOPS를 갖게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-126">This is to make sure that Azure Backup service gets sufficient IOPS for transferring data to vault.</span></span> <span data-ttu-id="fa131-127">이러한 추가 저장소 복사본은 VM 할당 크기를 기준으로 대금이 청구됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-127">This additional copy of storage is charged as per the VM allocated size.</span></span> 
>

### <a name="data-consistency"></a><span data-ttu-id="fa131-128">데이터 일관성</span><span class="sxs-lookup"><span data-stu-id="fa131-128">Data consistency</span></span>
<span data-ttu-id="fa131-129">데이터를 생성하는 응용 프로그램이 실행되는 동안에 업무에 중요한 데이터가 백업되어야 하므로 이러한 데이터를 백업하고 복원하는 것은 복잡합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-129">Backing up and restoring business critical data is complicated by the fact that business critical data must be backed up while the applications that produce the data are running.</span></span> <span data-ttu-id="fa131-130">이를 해결하기 위해 Azure Backup은 Windows와 Linux VM에 대해 응용 프로그램 일치 백업을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-130">To address this, Azure Backup supports application-consistent backups for both Windows and Linux VMs</span></span>
#### <a name="windows-vm"></a><span data-ttu-id="fa131-131">Windows VM</span><span class="sxs-lookup"><span data-stu-id="fa131-131">Windows VM</span></span>
<span data-ttu-id="fa131-132">Windows VM에서 Azure 백업은 VSS 전체 백업을 사용합니다( [VSS 전체 백업](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)에 대해 자세히 알아보기).</span><span class="sxs-lookup"><span data-stu-id="fa131-132">Azure Backup takes VSS full backups on Windows VMs (read more about [VSS full backup](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)).</span></span> <span data-ttu-id="fa131-133">VSS 복사본 백업을 사용하도록 설정하려면 VM에서 다음 레지스트리 키를 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-133">To enable VSS copy backups, the following registry key needs to be set on the VM.</span></span>

```
[HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\BCDRAGENT]
"USEVSSCOPYBACKUP"="TRUE"
```

#### <a name="linux-vms"></a><span data-ttu-id="fa131-134">Linux VM</span><span class="sxs-lookup"><span data-stu-id="fa131-134">Linux VMs</span></span>
<span data-ttu-id="fa131-135">Azure Backup은 스크립팅 프레임워크를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-135">Azure Backup provides a scripting framework.</span></span> <span data-ttu-id="fa131-136">Linux VM을 백업할 때 응용 프로그램 일관성을 보장하려면 백업 워크플로 및 환경을 제어하는 사용자 지정 사전 스크립트 및 사후 스크립트를 만드세요.</span><span class="sxs-lookup"><span data-stu-id="fa131-136">To ensure application consistency when backing up Linux VMs, create custom pre-scripts and post-scripts that control the backup workflow and environment.</span></span> <span data-ttu-id="fa131-137">Azure Backup은 VM 스냅숏을 생성하기 전에 사전 스크립트를 호출하고 VM 스냅숏 작업이 완료되면 사후 스크립트를 호출합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-137">Azure Backup invokes the pre-script before taking the VM snapshot and invokes the post-script once the VM snapshot job completes.</span></span> <span data-ttu-id="fa131-138">자세한 내용은 [사전 스크립트 및 사후 스크립트를 사용하여 응용 프로그램 일치 VM 백업](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="fa131-138">For more details, see [application consistent VM backups using pre-script and post-script](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span>
> [!NOTE]
> <span data-ttu-id="fa131-139">Azure Backup은 고객이 작성한 사전 및 사후 스크립트만 호출합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-139">Azure Backup only invokes the customer-written pre- and post-scripts.</span></span> <span data-ttu-id="fa131-140">Azure Backup은 사전 스크립트 및 사후 스크립트가 성공적으로 실행되는 경우 응용 프로그램 일치로 복구 지점을 표시합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-140">If the pre-script and post-scripts execute successfully, Azure Backup marks the recovery point as application consistent.</span></span> <span data-ttu-id="fa131-141">그러나 사용자 지정 스크립트를 사용하는 경우 고객은 응용 프로그램 일관성에 궁극적으로 책임을 져야 합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-141">However, the customer is ultimately responsible for the application consistency when using custom scripts.</span></span>
>


<span data-ttu-id="fa131-142">다음 표에서는 Azure VM 백업 및 복원 절차 중에 발생하는 조건 및 일관성 유형을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-142">This table explains the types of consistency and the conditions that they occur under during Azure VM backup and restore procedures.</span></span>

| <span data-ttu-id="fa131-143">일관성</span><span class="sxs-lookup"><span data-stu-id="fa131-143">Consistency</span></span> | <span data-ttu-id="fa131-144">VSS 기반</span><span class="sxs-lookup"><span data-stu-id="fa131-144">VSS-based</span></span> | <span data-ttu-id="fa131-145">설명 및 세부 정보</span><span class="sxs-lookup"><span data-stu-id="fa131-145">Explanation and details</span></span> |
| --- | --- | --- |
| <span data-ttu-id="fa131-146">응용 프로그램 일관성</span><span class="sxs-lookup"><span data-stu-id="fa131-146">Application consistency</span></span> |<span data-ttu-id="fa131-147">Windows 경우 예</span><span class="sxs-lookup"><span data-stu-id="fa131-147">Yes for Windows</span></span>|<span data-ttu-id="fa131-148">응용 프로그램 일관성은 다음을 보장하므로 워크로드에 이상적입니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-148">Application consistency is ideal for workloads as it ensures that:</span></span><ol><li> <span data-ttu-id="fa131-149">VM이 *부팅*됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-149">The VM *boots up*.</span></span> <li><span data-ttu-id="fa131-150">*손상이 없습니다*.</span><span class="sxs-lookup"><span data-stu-id="fa131-150">There is *no corruption*.</span></span> <li><span data-ttu-id="fa131-151">*데이터 손실*이 없습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-151">There is *no data loss*.</span></span><li> <span data-ttu-id="fa131-152">데이터는 백업 시 VSS 또는 사전/사후 스크립트를 사용하는 응용 프로그램을 포함하여 데이터를 사용하는 응용 프로그램과 일치됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-152">The data is consistent to the application that uses the data, by involving the application at the time of backup--using VSS or pre/post script.</span></span></ol> <li><span data-ttu-id="fa131-153">*Windows VM* - 대부분의 Microsoft 워크로드에는 데이터 일관성과 관련된 워크로드 관련 동작을 수행하는 VSS 작성자가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-153">*Windows VMs*- Most Microsoft workloads have VSS writers that do workload-specific actions related to data consistency.</span></span> <span data-ttu-id="fa131-154">예를 들어 Microsoft SQL Server에는 트랜잭션 로그 파일에 대한 쓰기를 확인하고 데이터베이스가 제대로 수행되었는지 확인하는 VSS 작성자가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-154">For example, Microsoft SQL Server has a VSS writer that ensures that the writes to the transaction log file and the database are done correctly.</span></span> <span data-ttu-id="fa131-155">Azure Windows VM 백업의 경우, 응용 프로그램에 일관된 복구 지점을 생성하려면 백업 확장이 VSS 워크플로를 호출하고 VM 스냅숏을 촬영하기 전에 완료해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-155">For Azure Windows VM backups, to create an application-consistent recovery point, the backup extension must invoke the VSS workflow and complete it before taking the VM snapshot.</span></span> <span data-ttu-id="fa131-156">Azure VM 스냅숏이 정확하려면 모든 Azure VM 응용 프로그램의 VSS 기록기도 완료해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-156">For the Azure VM snapshot to be accurate, the VSS writers of all Azure VM applications must complete as well.</span></span> <span data-ttu-id="fa131-157">[VSS 기본 사항](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx)(영문) 및 [작동 방법](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)(영문)에서 자세히 알아 보세요.</span><span class="sxs-lookup"><span data-stu-id="fa131-157">(Learn the [basics of VSS](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx) and dive deep into the details of [how it works](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)).</span></span> </li> <li> <span data-ttu-id="fa131-158">*Linux VM* - 고객은 [응용 프로그램 일관성을 보장하기 위해 사용자 지정 사전 스크립트 및 사후 스크립트를](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent) 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-158">*Linux VMs*- Customers can execute [custom pre-script and post-script to ensure application consistency](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span> </li> |
| <span data-ttu-id="fa131-159">파일 시스템 일관성</span><span class="sxs-lookup"><span data-stu-id="fa131-159">File-system consistency</span></span> |<span data-ttu-id="fa131-160">예 - Windows 기반 컴퓨터</span><span class="sxs-lookup"><span data-stu-id="fa131-160">Yes - for Windows-based computers</span></span> |<span data-ttu-id="fa131-161">복구 지점이 *일관된 파일 시스템*일 수 있는 두 가지 시나리오는 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-161">There are two scenarios where the recovery point can be *file-system consistent*:</span></span><ul><li><span data-ttu-id="fa131-162">사전 스크립트/사후 스크립트 없이 또는 사전 스크립트/사후 스크립트가 실패한 경우 Azure에서 Linux VM의 백업.</span><span class="sxs-lookup"><span data-stu-id="fa131-162">Backups of Linux VMs in Azure, without pre-script/post-script or if pre-script/post-script failed.</span></span> <li><span data-ttu-id="fa131-163">Azure에서 Windows VM을 백업하는 중에 VSS 오류가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-163">VSS failure during backup for Windows VMs in Azure.</span></span></li></ul> <span data-ttu-id="fa131-164">두 경우 모두 다음을 보장하는 것이 가장 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-164">In both these cases, the best that can be done is to ensure that:</span></span> <ol><li> <span data-ttu-id="fa131-165">VM이 *부팅*됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-165">The VM *boots up*.</span></span> <li><span data-ttu-id="fa131-166">*손상이 없습니다*.</span><span class="sxs-lookup"><span data-stu-id="fa131-166">There is *no corruption*.</span></span><li><span data-ttu-id="fa131-167">*데이터 손실*이 없습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-167">There is *no data loss*.</span></span></ol> <span data-ttu-id="fa131-168">응용 프로그램은 복원된 데이터에 대해 고유한 "수정" 메커니즘을 구현해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-168">Applications need to implement their own "fix-up" mechanism on the restored data.</span></span> |
| <span data-ttu-id="fa131-169">충돌 일관성</span><span class="sxs-lookup"><span data-stu-id="fa131-169">Crash consistency</span></span> |<span data-ttu-id="fa131-170">아니요</span><span class="sxs-lookup"><span data-stu-id="fa131-170">No</span></span> |<span data-ttu-id="fa131-171">이 상황은 "충돌"이 발생하는 가상 컴퓨터와 같습니다(소프트 또는 하드 재설정을 통해).</span><span class="sxs-lookup"><span data-stu-id="fa131-171">This situation is equivalent to a virtual machine experiencing a "crash" (through either a soft or hard reset).</span></span> <span data-ttu-id="fa131-172">충돌 일관성은 일반적으로 Azure 가상 컴퓨터가 백업 시 종료될 때 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-172">Crash consistency typically happens when the Azure virtual machine is shut down at the time of backup.</span></span> <span data-ttu-id="fa131-173">일관된 복구 지점에 충돌이 있다는 것은 저장소 매체의 데이터에 일관성을 보장해 주지 않는다는 뜻입니다(OS 관점 또는 응용 프로그램의 관점에서).</span><span class="sxs-lookup"><span data-stu-id="fa131-173">A crash-consistent recovery point provides no guarantees around the consistency of the data on the storage medium--either from the perspective of the operating system or the application.</span></span> <span data-ttu-id="fa131-174">백업 시 디스크에 이미 존재하는 데이터만 캡처 및 백업됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-174">Only the data that already exists on the disk at the time of backup is captured and backed up.</span></span> <br/> <br/> <span data-ttu-id="fa131-175">보장은 없지만 대부분의 경우에 OS는 부팅됩니다. 이는 손상 오류를 수정하기 위한 chkdsk와 같은 디스크 검사 과정 이후에 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-175">While there are no guarantees, usually, the operating system boots, followed by disk-checking procedure, like chkdsk, to fix any corruption errors.</span></span> <span data-ttu-id="fa131-176">메모리 내 데이터 또는 디스크로 이전되지 않은 쓰기는 손실됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-176">Any in-memory data or writes that have not been transferred to the disk are lost.</span></span> <span data-ttu-id="fa131-177">일반적으로 응용 프로그램은 데이터 롤백 작업을 수행해야 하는 경우에 고유한 확인 매커니즘을 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-177">The application typically follows with its own verification mechanism in case data rollback needs to be done.</span></span> <br><br><span data-ttu-id="fa131-178">예를 들어 트랜잭션 로그에 데이터베이스에 없는 항목이 있는 경우 데이터베이스 소프트웨어는 데이터가 일관성을 찾을 때가지 롤백합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-178">As an example, if the transaction log has entries that are not present in the database, then the database software does a rollback until the data is consistent.</span></span> <span data-ttu-id="fa131-179">여러 가상 디스크(예: 스팬 볼륨)에 분산된 데이터의 경우 충돌-일관성 복구 지점은 데이터 정확성을 보장하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-179">When data is spread across multiple virtual disks (like spanned volumes), a crash-consistent recovery point provides no guarantees for the correctness of the data.</span></span> |

## <a name="performance-and-resource-utilization"></a><span data-ttu-id="fa131-180">성능 및 리소스 사용률</span><span class="sxs-lookup"><span data-stu-id="fa131-180">Performance and resource utilization</span></span>
<span data-ttu-id="fa131-181">온-프레미스에 배포되는 백업 소프트웨어와 마찬가지로 Azure에서 VM을 백업하는 경우 용량 및 리소스 사용률에 대한 계획을 세워야 합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-181">Like backup software that is deployed on-premises, you should plan for capacity and resource utilization needs when backing up VMs in Azure.</span></span> <span data-ttu-id="fa131-182">[Azure 저장소 제한](../azure-subscription-service-limits.md#storage-limits) 은 워크로드 실행에 대한 영향을 최소화하면서 최대의 성능을 얻기 위한 VM 배포 구성 방법을 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-182">The [Azure Storage limits](../azure-subscription-service-limits.md#storage-limits) define how to structure VM deployments to get maximum performance with minimum impact to running workloads.</span></span>

<span data-ttu-id="fa131-183">백업 성능을 계획할 때 다음과 같은 Azure 저장소 제한에 주의해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-183">Pay attention to the following Azure Storage limits when planning backup performance:</span></span>

* <span data-ttu-id="fa131-184">저장소 계정당 최대 송신</span><span class="sxs-lookup"><span data-stu-id="fa131-184">Max egress per storage account</span></span>
* <span data-ttu-id="fa131-185">저장소 계정당 총 요청 속도</span><span class="sxs-lookup"><span data-stu-id="fa131-185">Total request rate per storage account</span></span>

### <a name="storage-account-limits"></a><span data-ttu-id="fa131-186">저장소 계정 제한</span><span class="sxs-lookup"><span data-stu-id="fa131-186">Storage account limits</span></span>
<span data-ttu-id="fa131-187">백업 데이터가 저장소 계정에서 복사되면 저장소 계정의 초당 입력/출력 작업(IOPS) 및 송신(또는 처리량) 메트릭에 가산됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-187">Backup data copied from a storage account, adds to the input/output operations per second (IOPS) and egress (or throughput) metrics of the storage account.</span></span> <span data-ttu-id="fa131-188">동시에 가상 컴퓨터도 실행되어 IOPS와 처리량을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-188">At the same time, virtual machines are also consuming IOPS and throughput.</span></span> <span data-ttu-id="fa131-189">목표는 백업 및 가상 컴퓨터 트래픽이 저장소 계정 한도를 초과하지 않도록 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-189">The goal is to ensure Backup and virtual machine traffic don't exceed your storage account limits.</span></span>

### <a name="number-of-disks"></a><span data-ttu-id="fa131-190">디스크 수</span><span class="sxs-lookup"><span data-stu-id="fa131-190">Number of disks</span></span>
<span data-ttu-id="fa131-191">백업 프로세스에서는 백업 작업을 가능한 한 빨리 완료하려고 합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-191">The backup process tries to complete a backup job as quickly as possible.</span></span> <span data-ttu-id="fa131-192">이렇게 하면 가능한 많은 리소스를 소모합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-192">In doing so, it consumes as many resources as it can.</span></span> <span data-ttu-id="fa131-193">그러나 모든 I/O 작업은 초당 60MB의 제한이 있는 *단일 Blob의 목표 처리량*에 의해 제한됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-193">However, all I/O operations are limited by the *Target Throughput for Single Blob*, which has a limit of 60 MB per second.</span></span> <span data-ttu-id="fa131-194">해당 속도를 최대화하기 위해 백업 프로세스에서는 각 VM의 디스크를 *병렬로*백업하려고 합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-194">In an attempt to maximize its speed, the backup process tries to back up each of the VM's disks *in parallel*.</span></span> <span data-ttu-id="fa131-195">VM에 4개의 디스크가 있는 경우, 이 서비스는 4개의 디스크를 모두 병렬로 백업하게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-195">If a VM has four disks, the service attempts to back up all four disks in parallel.</span></span> <span data-ttu-id="fa131-196">저장소 계정 백업 트래픽을 결정하는 가장 중요한 요소는 백업하는 **디스크 수**입니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-196">The **number of disks** being backed up, is the most important factor in determining storage account backup traffic.</span></span>

### <a name="backup-schedule"></a><span data-ttu-id="fa131-197">백업 일정</span><span class="sxs-lookup"><span data-stu-id="fa131-197">Backup schedule</span></span>
<span data-ttu-id="fa131-198">성능에 영향을 주는 추가 요소는 **백업 일정**입니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-198">An additional factor that impacts performance is the **backup schedule**.</span></span> <span data-ttu-id="fa131-199">모든 VM이 동시에 백업하도록 정책을 구성한 경우 트래픽 정체가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-199">If you configure the policies so all VMs are backed up at the same time, you have scheduled a traffic jam.</span></span> <span data-ttu-id="fa131-200">백업 프로세스는 동시에 모든 디스크를 백업하려고 합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-200">The backup process attempts to back up all disks in parallel.</span></span> <span data-ttu-id="fa131-201">저장소 계정에서 백업 트래픽을 줄이려면 여러 VM이 겹치지 않게 하루 중 서로 다른 시간대에 백업되도록 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-201">To reduce the backup traffic from a storage account, back up different VMs at different time of the day, with no overlap.</span></span>

## <a name="capacity-planning"></a><span data-ttu-id="fa131-202">용량 계획</span><span class="sxs-lookup"><span data-stu-id="fa131-202">Capacity planning</span></span>
<span data-ttu-id="fa131-203">이전 요소를 모두 종합하여 저장소 계정 사용 요구 사항을 계획해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-203">Putting the previous factors together, you need to plan for the storage account usage needs.</span></span> <span data-ttu-id="fa131-204">[VM 백업 용량 계획 Excel 스프레드시트](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) 를 다운로드하여 디스크 및 백업 일정 선택의 영향을 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-204">Download the [VM backup capacity planning Excel spreadsheet](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) to see the impact of your disk and backup schedule choices.</span></span>

### <a name="backup-throughput"></a><span data-ttu-id="fa131-205">백업 처리량</span><span class="sxs-lookup"><span data-stu-id="fa131-205">Backup throughput</span></span>
<span data-ttu-id="fa131-206">백업 중인 각 디스크에 대해 Azure 백업은 디스크의 블록을 읽고 변경 된 데이터(증분 백업)만 저장합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-206">For each disk being backed up, Azure Backup reads the blocks on the disk and stores only the changed data (incremental backup).</span></span> <span data-ttu-id="fa131-207">다음 표에서 평균 Backup 서비스 처리량 값을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-207">The following table shows the average Backup service throughput values.</span></span> <span data-ttu-id="fa131-208">다음 데이터를 사용하여 지정된 크기의 디스크 백업에 필요한 시간을 예상할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-208">Using the following data, you can estimate the amount of time needed to back up a disk of a given size.</span></span>

| <span data-ttu-id="fa131-209">백업 작업</span><span class="sxs-lookup"><span data-stu-id="fa131-209">Backup operation</span></span> | <span data-ttu-id="fa131-210">최상의 처리량</span><span class="sxs-lookup"><span data-stu-id="fa131-210">Best-case throughput</span></span> |
| --- | --- |
| <span data-ttu-id="fa131-211">초기 백업</span><span class="sxs-lookup"><span data-stu-id="fa131-211">Initial backup</span></span> |<span data-ttu-id="fa131-212">160Mbps</span><span class="sxs-lookup"><span data-stu-id="fa131-212">160 Mbps</span></span> |
| <span data-ttu-id="fa131-213">증분 백업(DR)</span><span class="sxs-lookup"><span data-stu-id="fa131-213">Incremental backup (DR)</span></span> |<span data-ttu-id="fa131-214">640Mbps </span><span class="sxs-lookup"><span data-stu-id="fa131-214">640 Mbps</span></span> <br><br> <span data-ttu-id="fa131-215">변경된 데이터(백업이 필요한)가 디스크에서 분산되어 있는 경우에는 처리량이 크게 저하됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-215">Throughput drops significantly if the changed data (that needs to be backed up) is dispersed across the disk.</span></span>|

## <a name="total-vm-backup-time"></a><span data-ttu-id="fa131-216">총 VM 백업 시간</span><span class="sxs-lookup"><span data-stu-id="fa131-216">Total VM backup time</span></span>
<span data-ttu-id="fa131-217">대부분의 백업 시간은 데이터를 읽고 쓰는 데 사용되지만, VM을 백업하는 데 필요한 총 시간에는 다른 작업도 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-217">While most of the backup time is spent reading and copying data, other operations contribute to the total time needed to back up a VM:</span></span>

* <span data-ttu-id="fa131-218">[백업 확장 설치 또는 업데이트](backup-azure-vms.md)하는 데 필요한 시간</span><span class="sxs-lookup"><span data-stu-id="fa131-218">Time needed to [install or update the backup extension](backup-azure-vms.md).</span></span>
* <span data-ttu-id="fa131-219">스냅숏 시간 - 스냅숏을 트리거하는 데 걸리는 시간입니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-219">Snapshot time, which is the time taken to trigger a snapshot.</span></span> <span data-ttu-id="fa131-220">스냅숏은 예약된 백업 시간에 가깝게 트리거됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-220">Snapshots are triggered close to the scheduled backup time.</span></span>
* <span data-ttu-id="fa131-221">큐 대기 시간입니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-221">Queue wait time.</span></span> <span data-ttu-id="fa131-222">백업 서비스는 여러 고객의 백업을 처리하기 때문에 스냅숏의 백업 데이터를 백업 또는 복구 서비스 자격 증명 모음에 복사하는 작업이 즉시 시작되지 않을 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-222">Since the Backup service is processing backups from multiple customers, copying backup data from snapshot to the backup or Recovery Services vault might not start immediately.</span></span> <span data-ttu-id="fa131-223">사용량이 많은 시간에는 처리되는 백업 수로 인해 대기가 최대 8시간까지 연장될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-223">In times of peak load, the wait can stretch up to eight hours due to the number of backups being processed.</span></span> <span data-ttu-id="fa131-224">그러나 일별 백업 정책의 경우 총 VM 백업 시간은 24시간 미만입니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-224">However, the total VM backup time is less than 24 hours for daily backup policies.</span></span>
* <span data-ttu-id="fa131-225">데이터 전송 시간은 이전 백업에서 증분 변경 내용을 계산하고 해당 변경 내용을 자격 증명 모음 저장소에 전송하는 백업 서비스에 필요한 시간입니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-225">Data transfer time, time needed for backup service to compute the incremental changes from previous backup and transfer those changes to vault storage.</span></span>

### <a name="why-am-i-observing-longer12-hours-backup-time"></a><span data-ttu-id="fa131-226">백업 시간이 길어진(12시간 초과) 이유는 무엇인가요?</span><span class="sxs-lookup"><span data-stu-id="fa131-226">Why am I observing longer(>12 hours) backup time?</span></span>
<span data-ttu-id="fa131-227">백업은 자격 증명 모음에 스냅숏 만들기 및 스냅숏 전송과 같은 두 단계로 구성됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-227">Backup consists of two phases: taking snapshots and transferring the snapshots to the vault.</span></span> <span data-ttu-id="fa131-228">Backup 서비스는 저장소에 최적화됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-228">The Backup service optimizes for storage.</span></span> <span data-ttu-id="fa131-229">스냅숏 데이터를 자격 증명 모음으로 이전할 경우 서비스는 이전 스냅숏에서 증분 변경 사항만 이전합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-229">When transferring the snapshot data to a vault, the service only transfers incremental changes from the previous snapshot.</span></span>  <span data-ttu-id="fa131-230">증분 변경을 확인하기 위해 컴퓨터는 블록의 체크섬을 계산합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-230">To determine the incremental changes, the service computes the checksum of the blocks.</span></span> <span data-ttu-id="fa131-231">블록이 변경되면 해당 블록은 자격 증명 모음으로 전송될 블록으로 식별됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-231">If a block is changed, the block is identified as a block to be sent to the vault.</span></span> <span data-ttu-id="fa131-232">그런 다음 서비스는 식별된 각 블록을 더 분석하여 전송할 데이터를 최소화할 기회를 찾습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-232">Then the service drills further into each of the identified blocks, looking for opportunities to minimize the data to transfer.</span></span> <span data-ttu-id="fa131-233">모든 변경된 블록을 평가한 후 서비스는 변경 사항을 취합하여 자격 증명 모음으로 보냅니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-233">After evaluating all changed blocks, the service coalesces the changes and sends them to the vault.</span></span> <span data-ttu-id="fa131-234">일부 레거시 응용 프로그램의 경우 소규모의 조각난 쓰기는 저장소에 적합하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-234">In some legacy applications, small, fragmented writes are not optimal for storage.</span></span> <span data-ttu-id="fa131-235">스냅숏에 많은 소규모의 조각난 쓰기가 포함되어 있을 경우 서비스는 응용 프로그램에서 기록한 데이터를 처리하는 데 추가적인 시간을 소비합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-235">If the snapshot contains many small, fragmented writes, the service spends additional time processing the data written by the applications.</span></span> <span data-ttu-id="fa131-236">VM 내에서 실행되는 응용 프로그램의 경우 Azure에서 권장되는 응용 프로그램 쓰기 블록은 최소 8KB입니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-236">The recommended application write block from Azure, for applications running inside the VM, is a minimum of 8 KB.</span></span> <span data-ttu-id="fa131-237">응용 프로그램에서 8KB 보다 작은 블록을 사용할 경우 백업 성능에 영향을 미칩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-237">If your application uses a block of less than 8 KB, backup performance is effected.</span></span> <span data-ttu-id="fa131-238">백업 성능을 개선하도록 응용 프로그램을 조정하려면 [Azure Storage에서 최적의 성능을 위한 응용 프로그램 조정](../storage/common/storage-premium-storage-performance.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="fa131-238">For help with tuning your application to improve backup performance, see [Tuning applications for optimal performance with Azure storage](../storage/common/storage-premium-storage-performance.md).</span></span> <span data-ttu-id="fa131-239">백업 성능에 관한 문서에서는 프리미엄 저장소 예제를 사용하고 있지만 해당 지침은 표준 저장소 디스크에 적용 가능합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-239">Though the article on backup performance uses Premium storage examples, the guidance is applicable for Standard storage disks.</span></span>

## <a name="total-restore-time"></a><span data-ttu-id="fa131-240">총 복원 시간</span><span class="sxs-lookup"><span data-stu-id="fa131-240">Total restore time</span></span>
<span data-ttu-id="fa131-241">복원 작업은 두 가지 기본 하위 작업으로 구성됩니다(볼트에서 선택한 고객 저장소 계정으로 데이터를 다시 복사 및 가상 시스템 만들기).</span><span class="sxs-lookup"><span data-stu-id="fa131-241">A restore operation consists of two main sub tasks: Copying data back from the vault to the chosen customer storage account, and creating the virtual machine.</span></span> <span data-ttu-id="fa131-242">볼트에서 데이터를 다시 복사하는 것은 백업이 Azure에 내부적으로 저장되는 위치와 고객 저장소 계정이 저장되는 위치에 따라 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-242">Copying data back from the vault depends on where the backups are stored internally in Azure, and where the customer storage account is stored.</span></span> <span data-ttu-id="fa131-243">데이터를 복사하는 데 걸리는 시간은 다음에 따라 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-243">Time taken to copy data depends upon:</span></span>
* <span data-ttu-id="fa131-244">큐 대기 시간 - 서비스가 동시에 여러 고객의 복원을 처리하므로 복원 요청이 큐에 배치됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-244">Queue wait time - Since the service processes restore jobs from multiple customers at the same time, restore requests are put in a queue.</span></span>
* <span data-ttu-id="fa131-245">데이터 복사 시간 - 데이터가 자격 증명 모음에서 고객 저장소 계정으로 복사됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-245">Data copy time - Data is copied from the vault to the customer storage account.</span></span> <span data-ttu-id="fa131-246">복원 시간은 Azure Backup 서비스가 선택된 고객 저장소 계정에서 가져오는 IOPS 및 처리량에 따라 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-246">Restore time depends on IOPS and throughput Azure Backup service gets on the selected customer storage account.</span></span> <span data-ttu-id="fa131-247">복원 과정 중 복사 시간을 단축하려면 다른 응용 프로그램 쓰기 및 읽기로 로드되지 않은 저장소 계정을 선택하세요.</span><span class="sxs-lookup"><span data-stu-id="fa131-247">To reduce the copying time during the restore process, select a storage account not loaded with other application writes and reads.</span></span>

## <a name="best-practices"></a><span data-ttu-id="fa131-248">모범 사례</span><span class="sxs-lookup"><span data-stu-id="fa131-248">Best practices</span></span>
<span data-ttu-id="fa131-249">가상 컴퓨터에 대한 백업을 구성하는 동안 다음 사례를 따르는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-249">We suggest following these practices while configuring backups for virtual machines:</span></span>

* <span data-ttu-id="fa131-250">동일한 클라우드 서비스에서 10개가 넘는 클래식 VM을 동시에 백업하도록 예약하지 마세요.</span><span class="sxs-lookup"><span data-stu-id="fa131-250">Don't schedule more than 10 classic VMs from the same cloud service to back up at the same time.</span></span> <span data-ttu-id="fa131-251">동일한 클라우드 서비스에서 여러 VM을 백업하려면 백업 시작 시간에 한 시간의 시차를 두는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-251">If you want to back up multiple VMs from same cloud service, stagger the backup start times by an hour.</span></span>
* <span data-ttu-id="fa131-252">40개 이상의 VM을 동시에 백업하도록 예약하지 마세요.</span><span class="sxs-lookup"><span data-stu-id="fa131-252">Do not schedule more than 40 VMs to back up at the same time.</span></span>
* <span data-ttu-id="fa131-253">사용량이 많지 않은 시간에 VM 백업을 예약하세요.</span><span class="sxs-lookup"><span data-stu-id="fa131-253">Schedule VM backups during non-peak hours.</span></span> <span data-ttu-id="fa131-254">그러면 Backup 서비스가 고객 저장소 계정에서 자격 증명 모음으로 데이터를 전송할 때 IOPS를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-254">This way the Backup service uses IOPS for transferring data from the customer storage account to the vault.</span></span>
* <span data-ttu-id="fa131-255">정책이 서로 다른 저장소 계정에 분산된 VM에 적용되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-255">Make sure that a policy is applied on VMs spread across different storage accounts.</span></span> <span data-ttu-id="fa131-256">권장 단일 저장소 계정에서 20개 이하의 총 디스크를 동일한 백업 일정으로 보호하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-256">We suggest no more than 20 total disks from a single storage account be protected by the same backup schedule.</span></span> <span data-ttu-id="fa131-257">저장소 계정에 20개가 넘는 디스크가 있는 경우 해당 VM을 여러 정책에 분산하여 백업 프로세스의 전송 단계에서 필요한 IOPS를 얻습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-257">If you have greater than 20 disks in a storage account, spread those VMs across multiple policies to get the required IOPS during the transfer phase of the backup process.</span></span>
* <span data-ttu-id="fa131-258">프리미엄 저장소에서 실행되는 VM을 동일한 저장소 계정에 복원하지 마세요.</span><span class="sxs-lookup"><span data-stu-id="fa131-258">Do not restore a VM running on Premium storage to same storage account.</span></span> <span data-ttu-id="fa131-259">복원 작업 프로세스가 백업 작업과 일치하는 경우 백업에 사용할 수 있는 IOPS를 감소시킵니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-259">If the restore operation process coincides with the backup operation, it reduces the available IOPS for backup.</span></span>
* <span data-ttu-id="fa131-260">프리미엄 VM 백업의 경우 프리미엄 디스크를 호스트하는 저장소 계정에 성공적인 백업을 위해 스냅샷 준비에 사용할 50% 이상의 사용 가능한 공간이 있는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-260">For Premium VM backup, ensure that storage account that hosts premium disks has atleast 50% free space for staging snapshot for a successful backup.</span></span> 
* <span data-ttu-id="fa131-261">백업에 사용할 수 있는 Linux VM의 python 버전이 2.7인지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-261">Make sure that python version on Linux VMs enabled for backup is 2.7</span></span>

## <a name="data-encryption"></a><span data-ttu-id="fa131-262">데이터 암호화.</span><span class="sxs-lookup"><span data-stu-id="fa131-262">Data encryption</span></span>
<span data-ttu-id="fa131-263">Azure 백업은 백업 프로세스의 일부로 데이터를 암호화하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-263">Azure Backup does not encrypt data as a part of the backup process.</span></span> <span data-ttu-id="fa131-264">그러나 VM 내에서 원활하게 데이터를 암호화하고 보호되는 데이터를 백업할 수 있습니다( [암호화된 데이터 백업](backup-azure-vms-encryption.md)에 대해 자세히 알아보기).</span><span class="sxs-lookup"><span data-stu-id="fa131-264">However, you can encrypt data within the VM and back up the protected data seamlessly (read more about [backup of encrypted data](backup-azure-vms-encryption.md)).</span></span>

## <a name="calculating-the-cost-of-protected-instances"></a><span data-ttu-id="fa131-265">보호된 인스턴스 비용 계산</span><span class="sxs-lookup"><span data-stu-id="fa131-265">Calculating the cost of protected instances</span></span>
<span data-ttu-id="fa131-266">Azure 백업을 통해 백업된 Azure 가상 컴퓨터에는 [Azure 백업 가격](https://azure.microsoft.com/pricing/details/backup/)이 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-266">Azure virtual machines that are backed up through Azure Backup are subject to [Azure Backup pricing](https://azure.microsoft.com/pricing/details/backup/).</span></span> <span data-ttu-id="fa131-267">보호된 인스턴스 계산은 가상 컴퓨터의 *실제* 크기를 기반으로 하며, "리소스 디스크"를 제외한 가상 컴퓨터의 모든 데이터 합계입니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-267">The Protected Instances calculation is based on the *actual* size of the virtual machine, which is the sum of all the data in the virtual machine--excluding the “resource disk.”</span></span>

<span data-ttu-id="fa131-268">VM 백업 비용은 가상 컴퓨터에 연결된 각 데이터 디스크의 최대 지원 크기에 따라 결정되는 것이 *아니라*,</span><span class="sxs-lookup"><span data-stu-id="fa131-268">Pricing for backing up VMs is *not* based on the maximum supported size for each data disk attached to the virtual machine.</span></span> <span data-ttu-id="fa131-269">데이터 디스크에 저장된 실제 데이터에 따라 청구됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-269">Pricing is based on the actual data stored in the data disk.</span></span> <span data-ttu-id="fa131-270">마찬가지로, 백업 저장소 요금은 Azure 백업을 사용하여 저장된 데이터 양(각 복구 지점의 실제 데이터 합계)을 기준으로 청구됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-270">Similarly, the backup storage bill is based on the amount of data that is stored in Azure Backup, which is the sum of the actual data in each recovery point.</span></span>

<span data-ttu-id="fa131-271">최대 크기가 각각 1TB인 두 개의 추가 데이터 디스크가 있는 A2 표준 크기 가상 컴퓨터를 예로 들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-271">For example, take an A2 Standard-sized virtual machine that has two additional data disks with a maximum size of 1 TB each.</span></span> <span data-ttu-id="fa131-272">다음 표는 각 디스크에 저장된 실제 데이터를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-272">The following table gives the actual data stored on each of these disks:</span></span>

| <span data-ttu-id="fa131-273">디스크 유형</span><span class="sxs-lookup"><span data-stu-id="fa131-273">Disk type</span></span> | <span data-ttu-id="fa131-274">최대 크기</span><span class="sxs-lookup"><span data-stu-id="fa131-274">Max size</span></span> | <span data-ttu-id="fa131-275">실제 데이터 표시</span><span class="sxs-lookup"><span data-stu-id="fa131-275">Actual data present</span></span> |
| --- | --- | --- |
| <span data-ttu-id="fa131-276">운영 체제 디스크</span><span class="sxs-lookup"><span data-stu-id="fa131-276">Operating system disk</span></span> |<span data-ttu-id="fa131-277">1023GB</span><span class="sxs-lookup"><span data-stu-id="fa131-277">1023 GB</span></span> |<span data-ttu-id="fa131-278">17GB</span><span class="sxs-lookup"><span data-stu-id="fa131-278">17 GB</span></span> |
| <span data-ttu-id="fa131-279">로컬 디스크/리소스 디스크</span><span class="sxs-lookup"><span data-stu-id="fa131-279">Local disk / Resource disk</span></span> |<span data-ttu-id="fa131-280">135GB</span><span class="sxs-lookup"><span data-stu-id="fa131-280">135 GB</span></span> |<span data-ttu-id="fa131-281">5GB(백업에 포함되지 않음)</span><span class="sxs-lookup"><span data-stu-id="fa131-281">5 GB (not included for backup)</span></span> |
| <span data-ttu-id="fa131-282">데이터 디스크 1</span><span class="sxs-lookup"><span data-stu-id="fa131-282">Data disk 1</span></span> |<span data-ttu-id="fa131-283">1023GB</span><span class="sxs-lookup"><span data-stu-id="fa131-283">1023 GB</span></span> |<span data-ttu-id="fa131-284">30GB</span><span class="sxs-lookup"><span data-stu-id="fa131-284">30 GB</span></span> |
| <span data-ttu-id="fa131-285">데이터 디스크 2</span><span class="sxs-lookup"><span data-stu-id="fa131-285">Data disk 2</span></span> |<span data-ttu-id="fa131-286">1023GB</span><span class="sxs-lookup"><span data-stu-id="fa131-286">1023 GB</span></span> |<span data-ttu-id="fa131-287">0GB</span><span class="sxs-lookup"><span data-stu-id="fa131-287">0 GB</span></span> |

<span data-ttu-id="fa131-288">이 경우 가상 컴퓨터의 *실제* 크기는 17GB + 30GB + 0GB = 47GB입니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-288">The *actual* size of the virtual machine in this case is 17 GB + 30 GB + 0 GB = 47 GB.</span></span> <span data-ttu-id="fa131-289">이 보호된 인스턴스 크기(47GB)는 월별 청구서의 근거가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-289">This Protected Instance size (47 GB) becomes the basis for the monthly bill.</span></span> <span data-ttu-id="fa131-290">가상 컴퓨터의 데이터 양이 증가하면 요금 청구에 사용되는 보호된 인스턴스 크기도 그에 따라 변경됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-290">As the amount of data in the virtual machine grows, the Protected Instance size used for billing changes accordingly.</span></span>

<span data-ttu-id="fa131-291">요금 청구는 첫 번째 백업이 성공적으로 완료되기 전까지 시작되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-291">Billing does not start until the first successful backup completes.</span></span> <span data-ttu-id="fa131-292">이때 저장소와 보호된 인스턴스 둘 다에 대한 요금 청구가 시작됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-292">At this point, the billing for both Storage and Protected Instances begins.</span></span> <span data-ttu-id="fa131-293">*자격 증명 모음에 저장된 가상 컴퓨터의 백업 데이터*가 있는 한 요금이 계속 청구됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-293">Billing continues as long as there is *any backup data stored in a vault* for the virtual machine.</span></span> <span data-ttu-id="fa131-294">가상 컴퓨터의 보호를 중지하더라도 자격 증명 모음에 가상 컴퓨터 백업 데이터가 있으면 요금이 계속 청구됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-294">If you stop protection on the virtual machine, but virtual machine backup data exists in a vault, billing continues.</span></span>

<span data-ttu-id="fa131-295">지정된 가상 컴퓨터에 대한 요금 청구는 보호가 중지되고 모든 백업 데이터 *또한* 삭제된 경우에만 중단됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-295">Billing for a specified virtual machine stops only if the protection is stopped *and* all backup data is deleted.</span></span> <span data-ttu-id="fa131-296">보호가 중지되고 활성 백업 작업이 없으면 마지막으로 성공한 VM 백업이 월별 청구에 사용되는 보호된 인스턴스 크기가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="fa131-296">When protection stops and there are no active backup jobs, the size of the last successful VM backup becomes the Protected Instance size used for the monthly bill.</span></span>

## <a name="questions"></a><span data-ttu-id="fa131-297">질문?</span><span class="sxs-lookup"><span data-stu-id="fa131-297">Questions?</span></span>
<span data-ttu-id="fa131-298">질문이 있거나 포함되었으면 하는 기능이 있는 경우 [의견을 보내 주세요](http://aka.ms/azurebackup_feedback).</span><span class="sxs-lookup"><span data-stu-id="fa131-298">If you have questions, or if there is any feature that you would like to see included, [send us feedback](http://aka.ms/azurebackup_feedback).</span></span>

## <a name="next-steps"></a><span data-ttu-id="fa131-299">다음 단계</span><span class="sxs-lookup"><span data-stu-id="fa131-299">Next steps</span></span>
* [<span data-ttu-id="fa131-300">가상 컴퓨터 설정</span><span class="sxs-lookup"><span data-stu-id="fa131-300">Back up virtual machines</span></span>](backup-azure-vms.md)
* [<span data-ttu-id="fa131-301">가상 컴퓨터 백업 관리</span><span class="sxs-lookup"><span data-stu-id="fa131-301">Manage virtual machine backup</span></span>](backup-azure-manage-vms.md)
* [<span data-ttu-id="fa131-302">가상 컴퓨터 복원</span><span class="sxs-lookup"><span data-stu-id="fa131-302">Restore virtual machines</span></span>](backup-azure-restore-vms.md)
* [<span data-ttu-id="fa131-303">VM 백업 문제 해결</span><span class="sxs-lookup"><span data-stu-id="fa131-303">Troubleshoot VM backup issues</span></span>](backup-azure-vms-troubleshoot.md)
