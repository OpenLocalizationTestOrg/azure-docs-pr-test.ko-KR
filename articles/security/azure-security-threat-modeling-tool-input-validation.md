---
title: "입력 유효성 검사 - Microsoft 위협 모델링 도구 - Azure | Microsoft Docs"
description: "위협 모델링 도구에 노출되는 위협 완화"
services: security
documentationcenter: na
author: RodSan
manager: RodSan
editor: RodSan
ms.assetid: na
ms.service: security
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/17/2017
ms.author: rodsan
ms.openlocfilehash: b7ce6f353cf8cf48d5fb038ee77b0d3fdae16fb7
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/29/2017
---
# <a name="security-frame-input-validation--mitigations"></a><span data-ttu-id="04806-103">보안 프레임: 입력 유효성 검사 | 완화</span><span class="sxs-lookup"><span data-stu-id="04806-103">Security Frame: Input Validation | Mitigations</span></span> 
| <span data-ttu-id="04806-104">제품/서비스</span><span class="sxs-lookup"><span data-stu-id="04806-104">Product/Service</span></span> | <span data-ttu-id="04806-105">문서</span><span class="sxs-lookup"><span data-stu-id="04806-105">Article</span></span> |
| --------------- | ------- |
| <span data-ttu-id="04806-106">**웹 응용 프로그램**</span><span class="sxs-lookup"><span data-stu-id="04806-106">**Web Application**</span></span> | <ul><li>[<span data-ttu-id="04806-107">신뢰할 수 없는 스타일시트를 사용하는 모든 변환에 대해 XSLT 스크립팅을 사용하지 않도록 설정</span><span class="sxs-lookup"><span data-stu-id="04806-107">Disable XSLT scripting for all transforms using untrusted style sheets</span></span>](#disable-xslt)</li><li>[<span data-ttu-id="04806-108">사용자가 제어할 수 있는 콘텐츠를 포함할 수 있는 각 페이지가 자동 MIME 스니핑에서 옵트아웃하는지 확인</span><span class="sxs-lookup"><span data-stu-id="04806-108">Ensure that each page that could contain user controllable content opts out of automatic MIME sniffing</span></span>](#out-sniffing)</li><li>[<span data-ttu-id="04806-109">XML 엔터티 확인 확정 또는 사용 중지</span><span class="sxs-lookup"><span data-stu-id="04806-109">Harden or Disable XML Entity Resolution</span></span>](#xml-resolution)</li><li>[<span data-ttu-id="04806-110">http.sys를 활용하는 응용 프로그램에서 URL 정형화 확인 수행</span><span class="sxs-lookup"><span data-stu-id="04806-110">Applications utilizing http.sys perform URL canonicalization verification</span></span>](#app-verification)</li><li>[<span data-ttu-id="04806-111">사용자의 파일을 허용할 때 적절한 제어가 수행되는지 확인</span><span class="sxs-lookup"><span data-stu-id="04806-111">Ensure appropriate controls are in place when accepting files from users</span></span>](#controls-users)</li><li>[<span data-ttu-id="04806-112">웹 응용 프로그램에서 데이터 액세스를 위해 형식이 안전한 매개 변수를 사용하는지 확인</span><span class="sxs-lookup"><span data-stu-id="04806-112">Ensure that type-safe parameters are used in Web Application for data access</span></span>](#typesafe)</li><li>[<span data-ttu-id="04806-113">별도의 모델 바인딩 클래스 또는 바인딩 필터 목록을 사용하여 MVC 대량 할당 취약성 방지</span><span class="sxs-lookup"><span data-stu-id="04806-113">Use separate model binding classes or binding filter lists to prevent MVC mass assignment vulnerability</span></span>](#binding-mvc)</li><li>[<span data-ttu-id="04806-114">렌더링하기 전에 신뢰할 수 없는 웹 출력 인코딩</span><span class="sxs-lookup"><span data-stu-id="04806-114">Encode untrusted web output prior to rendering</span></span>](#rendering)</li><li>[<span data-ttu-id="04806-115">모든 문자열 형식 모델 속성에 대한 입력 유효성 검사 및 필터링 수행</span><span class="sxs-lookup"><span data-stu-id="04806-115">Perform input validation and filtering on all string type Model properties</span></span>](#typemodel)</li><li>[<span data-ttu-id="04806-116">모든 문자를 허용하는 양식 필드(예: 서식 있는 텍스트 편집기)에서 삭제 적용</span><span class="sxs-lookup"><span data-stu-id="04806-116">Sanitization should be applied on form fields that accept all characters, e.g, rich text editor</span></span>](#richtext)</li><li>[<span data-ttu-id="04806-117">기본 제공 인코딩이 없는 싱크에 DOM 요소 할당 금지</span><span class="sxs-lookup"><span data-stu-id="04806-117">Do not assign DOM elements to sinks that do not have inbuilt encoding</span></span>](#inbuilt-encode)</li><li>[<span data-ttu-id="04806-118">응용 프로그램 내의 모든 리디렉션이 폐쇄되어 있거나 안전하게 수행되는지 확인</span><span class="sxs-lookup"><span data-stu-id="04806-118">Validate all redirects within the application are closed or done safely</span></span>](#redirect-safe)</li><li>[<span data-ttu-id="04806-119">컨트롤러 메서드에서 허용하는 모든 문자열 형식 매개 변수에 대한 입력 유효성 검사 구현</span><span class="sxs-lookup"><span data-stu-id="04806-119">Implement input validation on all string type parameters accepted by Controller methods</span></span>](#string-method)</li><li>[<span data-ttu-id="04806-120">정규식 처리에 대한 시간 제한 상한값을 설정하여 잘못된 정규식으로 인한 DoS 방지</span><span class="sxs-lookup"><span data-stu-id="04806-120">Set upper limit timeout for regular expression processing to prevent DoS due to bad regular expressions</span></span>](#dos-expression)</li><li>[<span data-ttu-id="04806-121">Razor 보기에서 Html.Raw 사용 방지</span><span class="sxs-lookup"><span data-stu-id="04806-121">Avoid using Html.Raw in Razor views</span></span>](#html-razor)</li></ul> | 
| <span data-ttu-id="04806-122">**데이터베이스**</span><span class="sxs-lookup"><span data-stu-id="04806-122">**Database**</span></span> | <ul><li>[<span data-ttu-id="04806-123">저장 프로시저에서 동적 쿼리 사용 금지</span><span class="sxs-lookup"><span data-stu-id="04806-123">Do not use dynamic queries in stored procedures</span></span>](#stored-proc)</li></ul> |
| <span data-ttu-id="04806-124">**앱 API**</span><span class="sxs-lookup"><span data-stu-id="04806-124">**Web API**</span></span> | <ul><li>[<span data-ttu-id="04806-125">모델 유효성 검사가 Web API 메서드에서 수행되는지 확인</span><span class="sxs-lookup"><span data-stu-id="04806-125">Ensure that model validation is done on Web API methods</span></span>](#validation-api)</li><li>[<span data-ttu-id="04806-126">Web API 메서드에서 허용하는 모든 문자열 형식 매개 변수에 대한 입력 유효성 검사 구현</span><span class="sxs-lookup"><span data-stu-id="04806-126">Implement input validation on all string type parameters accepted by Web API methods</span></span>](#string-api)</li><li>[<span data-ttu-id="04806-127">Web API에서 데이터 액세스를 위해 형식이 안전한 매개 변수를 사용하는지 확인</span><span class="sxs-lookup"><span data-stu-id="04806-127">Ensure that type-safe parameters are used in Web API for data access</span></span>](#typesafe-api)</li></ul> | 
| <span data-ttu-id="04806-128">**Azure Document DB**</span><span class="sxs-lookup"><span data-stu-id="04806-128">**Azure Document DB**</span></span> | <ul><li>[<span data-ttu-id="04806-129">DocumentDB에 매개 변수가 있는 SQL 쿼리 사용</span><span class="sxs-lookup"><span data-stu-id="04806-129">Use parametrized SQL queries for DocumentDB</span></span>](#sql-docdb)</li></ul> | 
| <span data-ttu-id="04806-130">**WCF**</span><span class="sxs-lookup"><span data-stu-id="04806-130">**WCF**</span></span> | <ul><li>[<span data-ttu-id="04806-131">WCF - 스키마 바인딩을 통한 입력 유효성 검사</span><span class="sxs-lookup"><span data-stu-id="04806-131">WCF Input validation through Schema binding</span></span>](#schema-binding)</li><li>[<span data-ttu-id="04806-132">WCF - 매개 변수 검사기를 통한 입력 유효성 검사</span><span class="sxs-lookup"><span data-stu-id="04806-132">WCF- Input validation through Parameter Inspectors</span></span>](#parameters)</li></ul> |

## <span data-ttu-id="04806-133"><a id="disable-xslt"></a>신뢰할 수 없는 스타일시트를 사용하는 모든 변환에 대해 XSLT 스크립팅을 사용하지 않도록 설정</span><span class="sxs-lookup"><span data-stu-id="04806-133"><a id="disable-xslt"></a>Disable XSLT scripting for all transforms using untrusted style sheets</span></span>

| <span data-ttu-id="04806-134">제목</span><span class="sxs-lookup"><span data-stu-id="04806-134">Title</span></span>                   | <span data-ttu-id="04806-135">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-135">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-136">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-136">**Component**</span></span>               | <span data-ttu-id="04806-137">웹 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="04806-137">Web Application</span></span> | 
| <span data-ttu-id="04806-138">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-138">**SDL Phase**</span></span>               | <span data-ttu-id="04806-139">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-139">Build</span></span> |  
| <span data-ttu-id="04806-140">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-140">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-141">일반</span><span class="sxs-lookup"><span data-stu-id="04806-141">Generic</span></span> |
| <span data-ttu-id="04806-142">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-142">**Attributes**</span></span>              | <span data-ttu-id="04806-143">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-143">N/A</span></span>  |
| <span data-ttu-id="04806-144">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-144">**References**</span></span>              | <span data-ttu-id="04806-145">[XSLT 보안](https://msdn.microsoft.com/library/ms763800(v=vs.85).aspx), [XsltSettings.EnableScript 속성](http://msdn.microsoft.com/library/system.xml.xsl.xsltsettings.enablescript.aspx)</span><span class="sxs-lookup"><span data-stu-id="04806-145">[XSLT Security](https://msdn.microsoft.com/library/ms763800(v=vs.85).aspx), [XsltSettings.EnableScript Property](http://msdn.microsoft.com/library/system.xml.xsl.xsltsettings.enablescript.aspx)</span></span> |
| <span data-ttu-id="04806-146">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-146">**Steps**</span></span> | <span data-ttu-id="04806-147">XSLT는 `<msxml:script>` 요소를 사용하여 스타일시트 내에서 스크립팅을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-147">XSLT supports scripting inside style sheets using the `<msxml:script>` element.</span></span> <span data-ttu-id="04806-148">이렇게 하면 사용자 지정 함수를 XSLT 변환에 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-148">This allows custom functions to be used in an XSLT transformation.</span></span> <span data-ttu-id="04806-149">스크립트는 변환을 수행하는 프로세스의 컨텍스트에서 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="04806-149">The script is executed under the context of the process performing the transform.</span></span> <span data-ttu-id="04806-150">신뢰할 수 없는 코드가 신뢰할 수 없는 환경에서 실행되지 않도록 하려면 XSLT 스크립트를 사용하지 않도록 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-150">XSLT script must be disabled when in an untrusted environment to prevent execution of untrusted code.</span></span> <span data-ttu-id="04806-151">*.NET을 사용하는 경우:* XSLT 스크립팅은 기본적으로 비활성화됩니다. 그러나 `XsltSettings.EnableScript` 속성을 통해 명시적으로 사용하지 않도록 설정되지 않았는지 확인해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-151">*If using .NET:* XSLT scripting is disabled by default; however, you must ensure that it has not been explicitly enabled through the `XsltSettings.EnableScript` property.</span></span>|

### <a name="example"></a><span data-ttu-id="04806-152">예제</span><span class="sxs-lookup"><span data-stu-id="04806-152">Example</span></span> 

```C#
XsltSettings settings = new XsltSettings();
settings.EnableScript = true; // WRONG: THIS SHOULD BE SET TO false
```

### <a name="example"></a><span data-ttu-id="04806-153">예제</span><span class="sxs-lookup"><span data-stu-id="04806-153">Example</span></span>
<span data-ttu-id="04806-154">MSXML 6.0을 사용하는 경우 XSLT 스크립팅은 기본적으로 비활성화됩니다. 그러나 AllowXsltScript XML DOM 개체 속성을 통해 명시적으로 사용하지 않도록 설정되지 않았는지 확인해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-154">If you are using using MSXML 6.0, XSLT scripting is disabled by default; however, you must ensure that it has not been explicitly enabled through the XML DOM object property AllowXsltScript.</span></span> 

```C#
doc.setProperty("AllowXsltScript", true); // WRONG: THIS SHOULD BE SET TO false
```

### <a name="example"></a><span data-ttu-id="04806-155">예제</span><span class="sxs-lookup"><span data-stu-id="04806-155">Example</span></span>
<span data-ttu-id="04806-156">MSXML 5 이하를 사용하는 경우 XSLT 스크립팅은 기본적으로 활성화되며, 명시적으로 사용하지 않도록 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-156">If you are using MSXML 5 or below, XSLT scripting is enabled by default and you must explicitly disable it.</span></span> <span data-ttu-id="04806-157">AllowXsltScript XML DOM 개체 속성을 false로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-157">Set the XML DOM object property AllowXsltScript to false.</span></span> 

```C#
doc.setProperty("AllowXsltScript", false); // CORRECT. Setting to false disables XSLT scripting.
```

## <span data-ttu-id="04806-158"><a id="out-sniffing"></a>사용자가 제어할 수 있는 콘텐츠를 포함할 수 있는 각 페이지가 자동 MIME 스니핑에서 옵트아웃하는지 확인</span><span class="sxs-lookup"><span data-stu-id="04806-158"><a id="out-sniffing"></a>Ensure that each page that could contain user controllable content opts out of automatic MIME sniffing</span></span>

| <span data-ttu-id="04806-159">제목</span><span class="sxs-lookup"><span data-stu-id="04806-159">Title</span></span>                   | <span data-ttu-id="04806-160">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-160">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-161">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-161">**Component**</span></span>               | <span data-ttu-id="04806-162">웹 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="04806-162">Web Application</span></span> | 
| <span data-ttu-id="04806-163">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-163">**SDL Phase**</span></span>               | <span data-ttu-id="04806-164">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-164">Build</span></span> |  
| <span data-ttu-id="04806-165">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-165">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-166">일반</span><span class="sxs-lookup"><span data-stu-id="04806-166">Generic</span></span> |
| <span data-ttu-id="04806-167">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-167">**Attributes**</span></span>              | <span data-ttu-id="04806-168">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-168">N/A</span></span>  |
| <span data-ttu-id="04806-169">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-169">**References**</span></span>              | <span data-ttu-id="04806-170">[IE8 보안 5부 - 포괄적 보호](http://blogs.msdn.com/ie/archive/2008/07/02/ie8-security-part-v-comprehensive-protection.aspx)(영문)</span><span class="sxs-lookup"><span data-stu-id="04806-170">[IE8 Security Part V - Comprehensive Protection](http://blogs.msdn.com/ie/archive/2008/07/02/ie8-security-part-v-comprehensive-protection.aspx)</span></span>  |
| <span data-ttu-id="04806-171">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-171">**Steps**</span></span> | <p><span data-ttu-id="04806-172">사용자가 제어할 수 있는 콘텐츠를 포함할 수 있는 각 페이지에 대해 `X-Content-Type-Options:nosniff` HTTP 헤더를 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-172">For each page that could contain user controllable content, you must use the HTTP Header `X-Content-Type-Options:nosniff`.</span></span> <span data-ttu-id="04806-173">이 요구 사항을 준수하려면 사용자가 제어할 수 있는 콘텐츠를 포함할 수 있는 페이지에 대해서만 페이지별로 필수 헤더를 설정하거나 응용 프로그램의 모든 페이지에 대해 전역으로 필수 헤더를 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-173">To comply with this requirement, you can either set the required header page by page for only those pages that might contain user-controllable content, or you can set it globally for all pages in the application.</span></span></p><p><span data-ttu-id="04806-174">웹 서버에서 제공되는 파일의 각 형식에는 콘텐츠의 특성(즉 이미지, 텍스트, 응용 프로그램 등)을 설명하는 [MIME 형식](http://en.wikipedia.org/wiki/Mime_type)(*콘텐츠 형식*이라고도 함)이 연결되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-174">Each type of file delivered from a web server has an associated [MIME type](http://en.wikipedia.org/wiki/Mime_type) (also called a *content-type*) that describes the nature of the content (that is, image, text, application, etc.)</span></span></p><p><span data-ttu-id="04806-175">X-Content-Type-Options 헤더는 개발자가 콘텐츠를 MIME 스니핑하지 않아야 한다고 지정할 수 있는 HTTP 헤더입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-175">The X-Content-Type-Options header is an HTTP header that allows developers to specify that their content should not be MIME-sniffed.</span></span> <span data-ttu-id="04806-176">이 헤더는 MIME 스니핑 공격을 완화하도록 설계되었습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-176">This header is designed to mitigate MIME-Sniffing attacks.</span></span> <span data-ttu-id="04806-177">IE8(Internet Explorer 8)에는 이 헤더에 대한 지원이 추가되었습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-177">Support for this header was added in Internet Explorer 8 (IE8)</span></span></p><p><span data-ttu-id="04806-178">IE8 사용자만 X-Content-Type-Options의 이점을 얻을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-178">Only users of Internet Explorer 8 (IE8) will benefit from X-Content-Type-Options.</span></span> <span data-ttu-id="04806-179">이전 버전의 Internet Explorer에서는 현재 X-Content-Type-Options 헤더를 사용하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-179">Previous versions of Internet Explorer do not currently respect the X-Content-Type-Options header</span></span></p><p><span data-ttu-id="04806-180">Internet Explorer 8 이상은 MIME 스니핑 옵트아웃 기능을 구현하는 유일한 주요 브라우저입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-180">Internet Explorer 8 (and later) are the only major browsers to implement a MIME-sniffing opt-out feature.</span></span> <span data-ttu-id="04806-181">다른 주요 브라우저(Firefox, Safari, Chrome)에서 비슷한 기능을 구현하는 경우 이 권장 사항은 해당 브라우저의 구문도 포함하도록 업데이트됩니다.</span><span class="sxs-lookup"><span data-stu-id="04806-181">If and when other major browsers (Firefox, Safari, Chrome) implement similar features, this recommendation will be updated to include syntax for those browsers as well</span></span></p>|

### <a name="example"></a><span data-ttu-id="04806-182">예제</span><span class="sxs-lookup"><span data-stu-id="04806-182">Example</span></span>
<span data-ttu-id="04806-183">응용 프로그램의 모든 페이지에 대해 필수 헤더를 전역으로 사용하도록 설정하려면 다음 중 하나를 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-183">To enable the required header globally for all pages in the application, you can do one of the following:</span></span> 

* <span data-ttu-id="04806-184">IIS(인터넷 정보 서비스) 7에서 응용 프로그램을 호스팅하는 경우 web.config 파일에 헤더를 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-184">Add the header in the web.config file if the application is hosted by Internet Information Services (IIS) 7</span></span> 

```
<system.webServer> 
  <httpProtocol> 
    <customHeaders> 
      <add name=""X-Content-Type-Options"" value=""nosniff""/>
    </customHeaders>
  </httpProtocol>
</system.webServer> 
```

* <span data-ttu-id="04806-185">전역 Application\_BeginRequest를 통해 헤더를 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-185">Add the header through the global Application\_BeginRequest</span></span> 

``` 
void Application_BeginRequest(object sender, EventArgs e)
{
  this.Response.Headers[""X-Content-Type-Options""] = ""nosniff"";
} 
```

* <span data-ttu-id="04806-186">사용자 지정 HTTP 모듈을 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-186">Implement custom HTTP module</span></span> 

``` 
public class XContentTypeOptionsModule : IHttpModule 
  {
    #region IHttpModule Members 
    public void Dispose() 
    { 

    } 
    public void Init(HttpApplication context)
    { 
      context.PreSendRequestHeaders += newEventHandler(context_PreSendRequestHeaders); 
    } 
    #endregion 
    void context_PreSendRequestHeaders(object sender, EventArgs e) 
      { 
        HttpApplication application = sender as HttpApplication; 
        if (application == null) 
          return; 
        if (application.Response.Headers[""X-Content-Type-Options ""] != null) 
          return; 
        application.Response.Headers.Add(""X-Content-Type-Options "", ""nosniff""); 
      } 
  } 

``` 

* <span data-ttu-id="04806-187">개별 응답에 추가하여 특정 페이지에 대해서만 필수 헤더를 사용하도록 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-187">You can enable the required header only for specific pages by adding it to individual responses:</span></span> 

```
this.Response.Headers[""X-Content-Type-Options""] = ""nosniff""; 
``` 

## <span data-ttu-id="04806-188"><a id="xml-resolution"></a>XML 엔터티 확인 확정 또는 사용 중지</span><span class="sxs-lookup"><span data-stu-id="04806-188"><a id="xml-resolution"></a>Harden or Disable XML Entity Resolution</span></span>

| <span data-ttu-id="04806-189">제목</span><span class="sxs-lookup"><span data-stu-id="04806-189">Title</span></span>                   | <span data-ttu-id="04806-190">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-190">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-191">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-191">**Component**</span></span>               | <span data-ttu-id="04806-192">웹 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="04806-192">Web Application</span></span> | 
| <span data-ttu-id="04806-193">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-193">**SDL Phase**</span></span>               | <span data-ttu-id="04806-194">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-194">Build</span></span> |  
| <span data-ttu-id="04806-195">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-195">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-196">일반</span><span class="sxs-lookup"><span data-stu-id="04806-196">Generic</span></span> |
| <span data-ttu-id="04806-197">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-197">**Attributes**</span></span>              | <span data-ttu-id="04806-198">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-198">N/A</span></span>  |
| <span data-ttu-id="04806-199">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-199">**References**</span></span>              | <span data-ttu-id="04806-200">[XML 엔터티 확장](http://capec.mitre.org/data/definitions/197.html)(영문), [XML DoS(서비스 거부) 공격 및 방어](http://msdn.microsoft.com/magazine/ee335713.aspx)(영문), [MSXML 보안 개요](http://msdn.microsoft.com/library/ms754611(v=VS.85).aspx), [MSXML 코드 보안에 대한 모범 사례](http://msdn.microsoft.com/library/ms759188(VS.85).aspx), [NSXMLParserDelegate 프로토콜 참조](http://developer.apple.com/library/ios/#documentation/cocoa/reference/NSXMLParserDelegate_Protocol/Reference/Reference.html)(영문), [외부 참조 확인](https://msdn.microsoft.com/library/5fcwybb2.aspx)</span><span class="sxs-lookup"><span data-stu-id="04806-200">[XML Entity Expansion](http://capec.mitre.org/data/definitions/197.html), [XML Denial of Service Attacks and Defenses](http://msdn.microsoft.com/magazine/ee335713.aspx), [MSXML Security Overview](http://msdn.microsoft.com/library/ms754611(v=VS.85).aspx), [Best Practices for Securing MSXML Code](http://msdn.microsoft.com/library/ms759188(VS.85).aspx), [NSXMLParserDelegate Protocol Reference](http://developer.apple.com/library/ios/#documentation/cocoa/reference/NSXMLParserDelegate_Protocol/Reference/Reference.html), [Resolving External References](https://msdn.microsoft.com/library/5fcwybb2.aspx)</span></span> |
| <span data-ttu-id="04806-201">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-201">**Steps**</span></span>| <p><span data-ttu-id="04806-202">널리 사용되지는 않지만 XML 파서가 문서 자체 또는 외부 원본에서 정의된 값을 사용하여 매크로 엔터티를 확장할 수 있도록 하는 XML 기능이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-202">Although it is not widely used, there is a feature of XML that allows the XML parser to expand macro entities with values defined either within the document itself or from external sources.</span></span> <span data-ttu-id="04806-203">예를 들어 문서에서 "Microsoft" 값이 있는 "companyname" 엔터티를 정의하여 "&companyname;" 텍스트가 문서에 나타날 때마다 자동으로 Microsoft 텍스트로 바꿀 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-203">For example, the document might define an entity "companyname" with the value "Microsoft," so that every time the text "&companyname;" appears in the document, it is automatically replaced with the text Microsoft.</span></span> <span data-ttu-id="04806-204">또는 문서에서 외부 웹 서비스를 참조하는 "MSFTStock" 엔터티를 정의하여 Microsoft 주식의 현재 가치를 가져올 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-204">Or, the document might define an entity "MSFTStock" that references an external web service to fetch the current value of Microsoft stock.</span></span></p><p><span data-ttu-id="04806-205">그러면 언제든지 "&MSFTStock;"이 문서에 나타나면 자동으로 현재 주가로 바뀝니다.</span><span class="sxs-lookup"><span data-stu-id="04806-205">Then any time "&MSFTStock;" appears in the document, it is automatically replaced with the current stock price.</span></span> <span data-ttu-id="04806-206">그러나 이 기능을 악용하여 DoS(서비스 거부) 조건을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-206">However, this functionality can be abused to create denial of service (DoS) conditions.</span></span> <span data-ttu-id="04806-207">공격자가 시스템에서 사용 가능한 모든 메모리를 소비 하는 지 수 확장 XML 폭탄 만들려는 여러 엔터티를 중첩할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-207">An attacker can nest multiple entities to create an exponential expansion XML bomb that consumes all available memory on the system.</span></span> </p><p><span data-ttu-id="04806-208">또는 무한한 양의 데이터를 다시 스트림하거나 단순히 스레드를 중단하는 외부 참조를 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-208">Alternatively, he can create an external reference that streams back an infinite amount of data or that simply hangs the thread.</span></span> <span data-ttu-id="04806-209">결과적으로 응용 프로그램에서 내부 및/또는 외부 XML 엔터티 확인을 사용하지 않는 경우 모든 팀이 해당 확인을 완전히 사용하지 않도록 설정하거나, 이 기능이 절대적으로 필요한 경우 응용 프로그램에서 엔터티 분석을 위해 소비할 수 있는 메모리와 시간의 양을 수동으로 제한해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-209">As a result, all teams must disable internal and/or external XML entity resolution entirely if their application does not use it, or manually limit the amount of memory and time that the application can consume for entity resolution if this functionality is absolutely necessary.</span></span> <span data-ttu-id="04806-210">응용 프로그램에서 엔터티 확인이 필요하지 않은 경우 엔터티 확인을 사용하지 않도록 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-210">If entity resolution is not required by your application, then disable it.</span></span> </p>|

### <a name="example"></a><span data-ttu-id="04806-211">예제</span><span class="sxs-lookup"><span data-stu-id="04806-211">Example</span></span>
<span data-ttu-id="04806-212">.NET Framework 코드의 경우 다음 방법을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-212">For .NET Framework code, you can use the following approaches:</span></span>

```C#
XmlTextReader reader = new XmlTextReader(stream);
reader.ProhibitDtd = true;

XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = true;
XmlReader reader = XmlReader.Create(stream, settings);

// for .NET 4
XmlReaderSettings settings = new XmlReaderSettings();
settings.DtdProcessing = DtdProcessing.Prohibit;
XmlReader reader = XmlReader.Create(stream, settings);
```
<span data-ttu-id="04806-213">`XmlReaderSettings`에서 `ProhibitDtd`의 기본값은 true이지만 `XmlTextReader`에서는 false입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-213">Note that the default value of `ProhibitDtd` in `XmlReaderSettings` is true, but in `XmlTextReader` it is false.</span></span> <span data-ttu-id="04806-214">XmlReaderSettings를 사용하는 경우 명시적으로 ProhibitDtd를 true로 설정할 필요는 없지만 보안을 위해 수행하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-214">If you are using XmlReaderSettings, you do not need to set ProhibitDtd to true explicitly, but it is recommended for safety sake that you do.</span></span> <span data-ttu-id="04806-215">또한 XmlDocument 클래스는 기본적으로 엔터티 확인을 허용합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-215">Also note that the XmlDocument class allows entity resolution by default.</span></span> 

### <a name="example"></a><span data-ttu-id="04806-216">예제</span><span class="sxs-lookup"><span data-stu-id="04806-216">Example</span></span>
<span data-ttu-id="04806-217">XmlDocuments에 대한 엔터티 확인을 사용하지 않도록 설정하려면, Load 메서드의 `XmlDocument.Load(XmlReader)` 오버로드를 사용하고 다음 코드와 같이 XmlReader 인수에 적절한 속성을 설정하여 확인을 사용하지 않도록 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-217">To disable entity resolution for XmlDocuments, use the `XmlDocument.Load(XmlReader)` overload of the Load method and set the appropriate properties in the XmlReader argument to disable resolution, as illustrated in the following code:</span></span> 

```C#
XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = true;
XmlReader reader = XmlReader.Create(stream, settings);
XmlDocument doc = new XmlDocument();
doc.Load(reader);
```

### <a name="example"></a><span data-ttu-id="04806-218">예제</span><span class="sxs-lookup"><span data-stu-id="04806-218">Example</span></span>
<span data-ttu-id="04806-219">응용 프로그램에서 엔터티 확인을 사용하지 않도록 설정할 수 없는 경우 응용 프로그램의 필요에 따라 XmlReaderSettings.MaxCharactersFromEntities 속성을 적절한 값으로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-219">If disabling entity resolution is not possible for your application, set the XmlReaderSettings.MaxCharactersFromEntities property to a reasonable value according to your application's needs.</span></span> <span data-ttu-id="04806-220">이 속성은 잠재적인 지수 확장 DoS 공격의 영향을 제한합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-220">This will limit the impact of potential exponential expansion DoS attacks.</span></span> <span data-ttu-id="04806-221">다음 코드에서는 이 방법의 예제를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-221">The following code provides an example of this approach:</span></span> 

```C#
XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = false;
settings.MaxCharactersFromEntities = 1000;
XmlReader reader = XmlReader.Create(stream, settings);
```

### <a name="example"></a><span data-ttu-id="04806-222">예제</span><span class="sxs-lookup"><span data-stu-id="04806-222">Example</span></span>
<span data-ttu-id="04806-223">인라인 엔터티는 확인해야 하지만 외부 엔터티는 확인할 필요가 없는 경우 XmlReaderSettings.XmlResolver 속성을 null로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-223">If you need to resolve inline entities but do not need to resolve external entities, set the XmlReaderSettings.XmlResolver property to null.</span></span> <span data-ttu-id="04806-224">예:</span><span class="sxs-lookup"><span data-stu-id="04806-224">For example:</span></span> 

```C#
XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = false;
settings.MaxCharactersFromEntities = 1000;
settings.XmlResolver = null;
XmlReader reader = XmlReader.Create(stream, settings);
```
<span data-ttu-id="04806-225">MSXML6에서 ProhibitDTD는 기본적으로 true(DTD 처리 비활성화)로 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="04806-225">Note that in MSXML6, ProhibitDTD is set to true (disabling DTD processing) by default.</span></span> <span data-ttu-id="04806-226">Apple OSX/iOS 코드의 경우 두 가지 XML 파서, NSXMLParser 및 libXML2를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-226">For Apple OSX/iOS code, there are two XML parsers you can use: NSXMLParser and libXML2.</span></span> 

## <span data-ttu-id="04806-227"><a id="app-verification"></a>http.sys를 활용하는 응용 프로그램에서 URL 정형화 확인 수행</span><span class="sxs-lookup"><span data-stu-id="04806-227"><a id="app-verification"></a>Applications utilizing http.sys perform URL canonicalization verification</span></span>

| <span data-ttu-id="04806-228">제목</span><span class="sxs-lookup"><span data-stu-id="04806-228">Title</span></span>                   | <span data-ttu-id="04806-229">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-229">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-230">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-230">**Component**</span></span>               | <span data-ttu-id="04806-231">웹 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="04806-231">Web Application</span></span> | 
| <span data-ttu-id="04806-232">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-232">**SDL Phase**</span></span>               | <span data-ttu-id="04806-233">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-233">Build</span></span> |  
| <span data-ttu-id="04806-234">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-234">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-235">일반</span><span class="sxs-lookup"><span data-stu-id="04806-235">Generic</span></span> |
| <span data-ttu-id="04806-236">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-236">**Attributes**</span></span>              | <span data-ttu-id="04806-237">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-237">N/A</span></span>  |
| <span data-ttu-id="04806-238">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-238">**References**</span></span>              | <span data-ttu-id="04806-239">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-239">N/A</span></span>  |
| <span data-ttu-id="04806-240">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-240">**Steps**</span></span> | <p><span data-ttu-id="04806-241">http.sys를 사용하는 모든 응용 프로그램은 다음 지침을 따라야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-241">Any application that uses http.sys should follow these guidelines:</span></span></p><ul><li><span data-ttu-id="04806-242">URL 길이를 16,384자(ASCII 또는 유니코드) 이하로 제한합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-242">Limit the URL length to no more than 16,384 characters (ASCII or Unicode).</span></span> <span data-ttu-id="04806-243">이 값은 기본 IIS(인터넷 정보 서비스) 6 설정에 따른 절대 최대 URL 길이입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-243">This is the absolute maximum URL length based on the default Internet Information Services (IIS) 6 setting.</span></span> <span data-ttu-id="04806-244">웹 사이트에서는 가능한 경우 이 길이보다 더 짧도록 노력해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-244">Websites should strive for a length shorter than this if possible</span></span></li><li><span data-ttu-id="04806-245">.NET FX의 정규화 규칙을 활용할 수 있으므로 표준 .NET Framework 파일 I/O 클래스(예: FileStream)를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-245">Use the standard .NET Framework file I/O classes (such as FileStream) as these will take advantage of the canonicalization rules in the .NET FX</span></span></li><li><span data-ttu-id="04806-246">알려진 파일 이름의 허용 목록을 명시적으로 작성합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-246">Explicitly build an allow-list of known filenames</span></span></li><li><span data-ttu-id="04806-247">UrlScan 거부를 제공하지 않는 것으로 알려진 파일 형식(exe, bat, cmd, com, htw, ida, idq, htr, idc, shtm[l], stm, printer, ini, pol, dat 파일)을 명시적으로 거부합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-247">Explicitly reject known filetypes you will not serve UrlScan rejects: exe, bat, cmd, com, htw, ida, idq, htr, idc, shtm[l], stm, printer, ini, pol, dat files</span></span></li><li><span data-ttu-id="04806-248">다음 예외를 catch합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-248">Catch the following exceptions:</span></span><ul><li><span data-ttu-id="04806-249">System.ArgumentException(장치 이름의 경우)</span><span class="sxs-lookup"><span data-stu-id="04806-249">System.ArgumentException (for device names)</span></span></li><li><span data-ttu-id="04806-250">System.NotSupportedException(데이터 스트림의 경우)</span><span class="sxs-lookup"><span data-stu-id="04806-250">System.NotSupportedException (for data streams)</span></span></li><li><span data-ttu-id="04806-251">System.IO.FileNotFoundException(잘못된 이스케이프 문자를 사용한 파일 이름의 경우)</span><span class="sxs-lookup"><span data-stu-id="04806-251">System.IO.FileNotFoundException (for invalid escaped filenames)</span></span></li><li><span data-ttu-id="04806-252">System.IO.DirectoryNotFoundException(잘못된 이스케이프 문자를 사용한 디렉터리의 경우)</span><span class="sxs-lookup"><span data-stu-id="04806-252">System.IO.DirectoryNotFoundException (for invalid escaped dirs)</span></span></li></ul></li><li><span data-ttu-id="04806-253">Win32 파일 I/O API를 호출하면 *안됩니다*.</span><span class="sxs-lookup"><span data-stu-id="04806-253">*Do not* call out to Win32 file I/O APIs.</span></span> <span data-ttu-id="04806-254">잘못된 URL인 경우 사용자에게 400 오류를 정상적으로 반환하고 실제 오류를 기록합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-254">On an invalid URL gracefully return a 400 error to the user, and log the real error.</span></span></li></ul>|

## <span data-ttu-id="04806-255"><a id="controls-users"></a>사용자의 파일을 허용할 때 적절한 제어가 수행되는지 확인</span><span class="sxs-lookup"><span data-stu-id="04806-255"><a id="controls-users"></a>Ensure appropriate controls are in place when accepting files from users</span></span>

| <span data-ttu-id="04806-256">제목</span><span class="sxs-lookup"><span data-stu-id="04806-256">Title</span></span>                   | <span data-ttu-id="04806-257">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-257">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-258">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-258">**Component**</span></span>               | <span data-ttu-id="04806-259">웹 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="04806-259">Web Application</span></span> | 
| <span data-ttu-id="04806-260">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-260">**SDL Phase**</span></span>               | <span data-ttu-id="04806-261">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-261">Build</span></span> |  
| <span data-ttu-id="04806-262">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-262">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-263">일반</span><span class="sxs-lookup"><span data-stu-id="04806-263">Generic</span></span> |
| <span data-ttu-id="04806-264">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-264">**Attributes**</span></span>              | <span data-ttu-id="04806-265">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-265">N/A</span></span>  |
| <span data-ttu-id="04806-266">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-266">**References**</span></span>              | <span data-ttu-id="04806-267">[무제한 파일 업로드](https://www.owasp.org/index.php/Unrestricted_File_Upload)(영문), [파일 서명 테이블](http://www.garykessler.net/library/file_sigs.html)(영문)</span><span class="sxs-lookup"><span data-stu-id="04806-267">[Unrestricted File Upload](https://www.owasp.org/index.php/Unrestricted_File_Upload), [File Signature Table](http://www.garykessler.net/library/file_sigs.html)</span></span> |
| <span data-ttu-id="04806-268">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-268">**Steps**</span></span> | <p><span data-ttu-id="04806-269">업로드된 파일은 응용 프로그램에 상당한 위험을 초래합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-269">Uploaded files represent a significant risk to applications.</span></span></p><p><span data-ttu-id="04806-270">많은 공격의 첫 번째 단계는 공격 대상 시스템에 일부 코드를 가져오는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-270">The first step in many attacks is to get some code to the system to be attacked.</span></span> <span data-ttu-id="04806-271">그런 다음 공격에서 해당 코드를 실행하도록 하는 방법을 찾아야만 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-271">Then the attack only needs to find a way to get the code executed.</span></span> <span data-ttu-id="04806-272">파일 업로드를 사용하면 공격자가 첫 번째 단계를 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-272">Using a file upload helps the attacker accomplish the first step.</span></span> <span data-ttu-id="04806-273">무제한 파일 업로드의 결과는 전체 시스템 감염, 오버로드된 파일 시스템 또는 데이터베이스, 백 엔드 시스템에 대한 전달 공격 및 단순 변조를 포함하여 다양할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-273">The consequences of unrestricted file upload can vary, including complete system takeover, an overloaded file system or database, forwarding attacks to back-end systems, and simple defacement.</span></span></p><p><span data-ttu-id="04806-274">응용 프로그램에서 업로드된 파일로 수행하는 작업과 특히 파일이 저장되는 위치에 따라 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="04806-274">It depends on what the application does with the uploaded file and especially where it is stored.</span></span> <span data-ttu-id="04806-275">파일 업로드에 대한 서버 쪽 유효성 검사는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-275">Server side validation of file uploads is missing.</span></span> <span data-ttu-id="04806-276">파일 업로드 기능에 대해 다음과 같은 보안 제어를 구현해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-276">Following security controls should be implemented for File Upload functionality:</span></span></p><ul><li><span data-ttu-id="04806-277">파일 확장명 검사(허용되는 파일 형식의 유효한 집합만)</span><span class="sxs-lookup"><span data-stu-id="04806-277">File Extension check (only a valid set of allowed file type should be accepted)</span></span></li><li><span data-ttu-id="04806-278">최대 파일 크기 제한</span><span class="sxs-lookup"><span data-stu-id="04806-278">Maximum file size limit</span></span></li><li><span data-ttu-id="04806-279">파일을 웹 루트에 업로드하면 안됩니다. 비시스템 드라이브의 디렉터리에 업로드해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-279">File should not be uploaded to webroot; the location should be a directory on non-system drive</span></span></li><li><span data-ttu-id="04806-280">파일 덮어쓰기를 방지하기 위해 업로드된 파일 이름에 임의성이 있도록 명명 규칙을 따라야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-280">Naming convention should be followed, such that the uploaded file name have some randomness, so as to prevent file overwrites</span></span></li><li><span data-ttu-id="04806-281">디스크에 쓰기 전에 파일에 대해 바이러스 백신 검사를 수행해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-281">Files should be scanned for anti-virus before writing to the disk</span></span></li><li><span data-ttu-id="04806-282">악의적 문자에 대해 파일 이름 및 다른 메타데이터(예: 파일 경로)의 유효성을 검사해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-282">Ensure that the file name and any other metadata (e.g., file path) are validated for malicious characters</span></span></li><li><span data-ttu-id="04806-283">사용자가 위장된 파일을 업로드하지 못하도록 파일 형식 서명을 확인해야 합니다(예: 확장명을 txt로 변경하여 exe 파일 업로드).</span><span class="sxs-lookup"><span data-stu-id="04806-283">File format signature should be checked, to prevent a user from uploading a masqueraded file (e.g., uploading an exe file by changing extension to txt)</span></span></li></ul>| 

### <a name="example"></a><span data-ttu-id="04806-284">예제</span><span class="sxs-lookup"><span data-stu-id="04806-284">Example</span></span>
<span data-ttu-id="04806-285">파일 형식 서명 유효성 검사와 관련된 마지막 지점에 대한 자세한 내용은 아래 클래스를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="04806-285">For the last point regarding file format signature validation, refer to the class below for details:</span></span> 

```C#
        private static Dictionary<string, List<byte[]>> fileSignature = new Dictionary<string, List<byte[]>>
                    {
                    { ".DOC", new List<byte[]> { new byte[] { 0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1 } } },
                    { ".DOCX", new List<byte[]> { new byte[] { 0x50, 0x4B, 0x03, 0x04 } } },
                    { ".PDF", new List<byte[]> { new byte[] { 0x25, 0x50, 0x44, 0x46 } } },
                    { ".ZIP", new List<byte[]> 
                                            {
                                              new byte[] { 0x50, 0x4B, 0x03, 0x04 },
                                              new byte[] { 0x50, 0x4B, 0x4C, 0x49, 0x54, 0x55 },
                                              new byte[] { 0x50, 0x4B, 0x53, 0x70, 0x58 },
                                              new byte[] { 0x50, 0x4B, 0x05, 0x06 },
                                              new byte[] { 0x50, 0x4B, 0x07, 0x08 },
                                              new byte[] { 0x57, 0x69, 0x6E, 0x5A, 0x69, 0x70 }
                                                }
                                            },
                    { ".PNG", new List<byte[]> { new byte[] { 0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A } } },
                    { ".JPG", new List<byte[]>
                                    {
                                              new byte[] { 0xFF, 0xD8, 0xFF, 0xE0 },
                                              new byte[] { 0xFF, 0xD8, 0xFF, 0xE1 },
                                              new byte[] { 0xFF, 0xD8, 0xFF, 0xE8 }
                                    }
                                    },
                    { ".JPEG", new List<byte[]>
                                        { 
                                            new byte[] { 0xFF, 0xD8, 0xFF, 0xE0 },
                                            new byte[] { 0xFF, 0xD8, 0xFF, 0xE2 },
                                            new byte[] { 0xFF, 0xD8, 0xFF, 0xE3 }
                                        }
                                        },
                    { ".XLS", new List<byte[]>
                                            {
                                              new byte[] { 0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1 },
                                              new byte[] { 0x09, 0x08, 0x10, 0x00, 0x00, 0x06, 0x05, 0x00 },
                                              new byte[] { 0xFD, 0xFF, 0xFF, 0xFF }
                                            }
                                            },
                    { ".XLSX", new List<byte[]> { new byte[] { 0x50, 0x4B, 0x03, 0x04 } } },
                    { ".GIF", new List<byte[]> { new byte[] { 0x47, 0x49, 0x46, 0x38 } } }
                };

        public static bool IsValidFileExtension(string fileName, byte[] fileData, byte[] allowedChars)
        {
            if (string.IsNullOrEmpty(fileName) || fileData == null || fileData.Length == 0)
            {
                return false;
            }

            bool flag = false;
            string ext = Path.GetExtension(fileName);
            if (string.IsNullOrEmpty(ext))
            {
                return false;
            }

            ext = ext.ToUpperInvariant();

            if (ext.Equals(".TXT") || ext.Equals(".CSV") || ext.Equals(".PRN"))
            {
                foreach (byte b in fileData)
                {
                    if (b > 0x7F)
                    {
                        if (allowedChars != null)
                        {
                            if (!allowedChars.Contains(b))
                            {
                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                }

                return true;
            }

            if (!fileSignature.ContainsKey(ext))
            {
                return true;
            }

            List<byte[]> sig = fileSignature[ext];
            foreach (byte[] b in sig)
            {
                var curFileSig = new byte[b.Length];
                Array.Copy(fileData, curFileSig, b.Length);
                if (curFileSig.SequenceEqual(b))
                {
                    flag = true;
                    break;
                }
            }

            return flag;
        }
```

## <span data-ttu-id="04806-286"><a id="typesafe"></a>웹 응용 프로그램에서 데이터 액세스를 위해 형식이 안전한 매개 변수를 사용하는지 확인</span><span class="sxs-lookup"><span data-stu-id="04806-286"><a id="typesafe"></a>Ensure that type-safe parameters are used in Web Application for data access</span></span>

| <span data-ttu-id="04806-287">제목</span><span class="sxs-lookup"><span data-stu-id="04806-287">Title</span></span>                   | <span data-ttu-id="04806-288">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-288">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-289">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-289">**Component**</span></span>               | <span data-ttu-id="04806-290">웹 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="04806-290">Web Application</span></span> | 
| <span data-ttu-id="04806-291">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-291">**SDL Phase**</span></span>               | <span data-ttu-id="04806-292">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-292">Build</span></span> |  
| <span data-ttu-id="04806-293">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-293">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-294">일반</span><span class="sxs-lookup"><span data-stu-id="04806-294">Generic</span></span> |
| <span data-ttu-id="04806-295">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-295">**Attributes**</span></span>              | <span data-ttu-id="04806-296">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-296">N/A</span></span>  |
| <span data-ttu-id="04806-297">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-297">**References**</span></span>              | <span data-ttu-id="04806-298">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-298">N/A</span></span>  |
| <span data-ttu-id="04806-299">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-299">**Steps**</span></span> | <p><span data-ttu-id="04806-300">매개 변수 컬렉션을 사용하는 경우 SQL은 입력을 실행 코드가 아닌 리터럴 값으로 처리합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-300">If you use the Parameters collection, SQL treats the input is as a literal value rather then as executable code.</span></span> <span data-ttu-id="04806-301">매개 변수 컬렉션을 사용하여 입력 데이터에 형식 및 길이 제약 조건을 적용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-301">The Parameters collection can be used to enforce type and length constraints on input data.</span></span> <span data-ttu-id="04806-302">범위를 벗어난 값은 예외를 트리거합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-302">Values outside of the range trigger an exception.</span></span> <span data-ttu-id="04806-303">형식이 안전한 SQL 매개 변수를 사용하지 않으면 공격자가 필터링되지 않은 입력에 포함된 삽입 공격을 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-303">If type-safe SQL parameters are not used, attackers might be able to execute injection attacks that are embedded in the unfiltered input.</span></span></p><p><span data-ttu-id="04806-304">필터링되지 않은 입력에서 발생할 수 있는 SQL 삽입 공격을 방지하려면 SQL 쿼리를 구성할 때 형식이 안전한 매개 변수를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-304">Use type safe parameters when constructing SQL queries to avoid possible SQL injection attacks that can occur with unfiltered input.</span></span> <span data-ttu-id="04806-305">저장 프로시저 및 동적 SQL 문과 함께 형식이 안전한 매개 변수를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-305">You can use type safe parameters with stored procedures and with dynamic SQL statements.</span></span> <span data-ttu-id="04806-306">매개 변수는 데이터베이스에서 리터럴 값으로 처리되며 실행 코드로는 처리되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-306">Parameters are treated as literal values by the database and not as executable code.</span></span> <span data-ttu-id="04806-307">또한 매개 변수의 형식 및 길이에 대해서도 검사합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-307">Parameters are also checked for type and length.</span></span></p>|

### <a name="example"></a><span data-ttu-id="04806-308">예제</span><span class="sxs-lookup"><span data-stu-id="04806-308">Example</span></span> 
<span data-ttu-id="04806-309">다음 코드에서는 저장 프로시저를 호출할 때 형식이 안전한 매개 변수를 SqlParameterCollection에 사용하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="04806-309">The following code shows how to use type safe parameters with the SqlParameterCollection when calling a stored procedure.</span></span> 

```C#
using System.Data;
using System.Data.SqlClient;

using (SqlConnection connection = new SqlConnection(connectionString))
{ 
DataSet userDataset = new DataSet(); 
SqlDataAdapter myCommand = new SqlDataAdapter(LoginStoredProcedure", connection); 
myCommand.SelectCommand.CommandType = CommandType.StoredProcedure; 
myCommand.SelectCommand.Parameters.Add("@au_id", SqlDbType.VarChar, 11); 
myCommand.SelectCommand.Parameters["@au_id"].Value = SSN.Text; 
myCommand.Fill(userDataset);
}  
```
<span data-ttu-id="04806-310">이전의 코드 예제에서 입력 값은 11자를 초과할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-310">In the preceding code example, the input value cannot be longer than 11 characters.</span></span> <span data-ttu-id="04806-311">데이터가 매개 변수에 정의된 형식 또는 길이를 따르지 않으면 SqlParameter 클래스에서 예외가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-311">If the data does not conform to the type or length defined by the parameter, the SqlParameter class throws an exception.</span></span> 

## <span data-ttu-id="04806-312"><a id="binding-mvc"></a>별도의 모델 바인딩 클래스 또는 바인딩 필터 목록을 사용하여 MVC 대량 할당 취약성 방지</span><span class="sxs-lookup"><span data-stu-id="04806-312"><a id="binding-mvc"></a>Use separate model binding classes or binding filter lists to prevent MVC mass assignment vulnerability</span></span>

| <span data-ttu-id="04806-313">제목</span><span class="sxs-lookup"><span data-stu-id="04806-313">Title</span></span>                   | <span data-ttu-id="04806-314">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-314">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-315">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-315">**Component**</span></span>               | <span data-ttu-id="04806-316">웹 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="04806-316">Web Application</span></span> | 
| <span data-ttu-id="04806-317">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-317">**SDL Phase**</span></span>               | <span data-ttu-id="04806-318">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-318">Build</span></span> |  
| <span data-ttu-id="04806-319">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-319">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-320">MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="04806-320">MVC5, MVC6</span></span> |
| <span data-ttu-id="04806-321">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-321">**Attributes**</span></span>              | <span data-ttu-id="04806-322">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-322">N/A</span></span>  |
| <span data-ttu-id="04806-323">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-323">**References**</span></span>              | <span data-ttu-id="04806-324">[메타데이터 특성](http://msdn.microsoft.com/library/system.componentmodel.dataannotations.metadatatypeattribute), [공개 키 보안 취약성 및 완화](https://github.com/blog/1068-public-key-security-vulnerability-and-mitigation)(영문), [ASP.NET MVC의 대량 할당에 대한 완벽한 가이드](http://odetocode.com/Blogs/scott/archive/2012/03/11/complete-guide-to-mass-assignment-in-asp-net-mvc.aspx)(영문), [MVC를 사용하여 EF 시작](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application#overpost)(영문)</span><span class="sxs-lookup"><span data-stu-id="04806-324">[Metadata Attributes](http://msdn.microsoft.com/library/system.componentmodel.dataannotations.metadatatypeattribute), [Public Key Security Vulnerability And Mitigation](https://github.com/blog/1068-public-key-security-vulnerability-and-mitigation), [Complete Guide to Mass Assignment in ASP.NET MVC](http://odetocode.com/Blogs/scott/archive/2012/03/11/complete-guide-to-mass-assignment-in-asp-net-mvc.aspx), [Getting Started with EF using MVC](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application#overpost)</span></span> |
| <span data-ttu-id="04806-325">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-325">**Steps**</span></span> | <ul><li><span data-ttu-id="04806-326">**과도한 게시 취약성은 언제 찾아야 합니까? -** 사용자 입력에서 모델 클래스를 바인딩하는 모든 위치에서 과도한 게시 취약성이 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-326">**When should I look for over-posting vulnerabilities? -** Over-posting vulnerabilities can occur any place you bind model classes from user input.</span></span> <span data-ttu-id="04806-327">MVC와 같은 프레임워크는 POCO(Plain Old CLR Object)를 포함하여 사용자 지정 .NET 클래스의 사용자 데이터를 나타낼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-327">Frameworks like MVC can represent user data in custom .NET classes, including Plain Old CLR Objects (POCOs).</span></span> <span data-ttu-id="04806-328">MVC는 자동으로 이러한 모델 클래스를 요청의 데이터로 채우고, 사용자 입력을 처리하는 데 편리한 표현을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-328">MVC automatically populates these model classes with data from the request, providing a convenient representation for dealing with user input.</span></span> <span data-ttu-id="04806-329">사용자가 설정하지 않아야 하는 속성이 이러한 클래스에 포함되어 있으면, 사용자가 응용 프로그램에서 전혀 의도하지 않은 데이터를 제어할 수 있는 과도한 게시 공격으로 인해 응용 프로그램이 취약하게 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-329">When these classes include properties that should not be set by the user, the application can be vulnerable to over-posting attacks, which allow user control of data that the application never intended.</span></span> <span data-ttu-id="04806-330">MVC 모델 바인딩과 마찬가지로 개체/관계형 매퍼(예: Entity Framework)와 같은 데이터베이스 액세스 기술도 종종 POCO 개체를 사용하여 데이터베이스 데이터를 나타낼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-330">Like MVC model binding, database access technologies such as object/relational mappers like Entity Framework often also support using POCO objects to represent database data.</span></span> <span data-ttu-id="04806-331">이러한 데이터 모델 클래스는 MVC에서 사용자 입력을 처리할 때와 마찬가지로 데이터베이스 데이터를 처리할 때도 동일한 편리성을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-331">These data model classes provide the same convenience in dealing with database data as MVC does in dealing with user input.</span></span> <span data-ttu-id="04806-332">MVC와 데이터베이스는 모두 POCO 개체와 같은 유사한 모델을 지원하기 때문에 두 가지 용도로 동일한 클래스를 쉽게 다시 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-332">Because both MVC and the database support similar models, like POCO objects, it seems easy to reuse the same classes for both purposes.</span></span> <span data-ttu-id="04806-333">이러한 사례는 중요한 부분의 분리를 유지하는 데 실패하며, 의도하지 않은 속성이 모델 바인딩에 노출되어 과도한 게시 공격을 허용하는 일반적인 영역 중 하나입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-333">This practice fails to preserve separation of concerns, and it is one common area where unintended properties are exposed to model binding, enabling over-posting attacks.</span></span></li><li><span data-ttu-id="04806-334">**필터링되지 않은 데이터베이스 모델 클래스를 MVC 작업에 대한 매개 변수로 사용하지 않아야 하는 이유는 무엇입니까? -** MVC 모델 바인딩은 해당 클래스의 모든 항목을 바인딩하기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-334">**Why shouldn't I use my unfiltered database model classes as parameters to my MVC actions? -** Because MVC model binding will bind anything in that class.</span></span> <span data-ttu-id="04806-335">데이터가 보기에 표시되지 않더라도 악의적인 사용자는 이 데이터를 포함한 HTTP 요청을 보낼 수 있으며, 작업에서 사용자 입력을 위해 허용해야 하는 데이터의 셰이프가 데이터베이스 클래스라고 지시하므로 MVC에서 해당 데이터를 기꺼이 바인딩합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-335">Even if the data does not appear in your view, a malicious user can send an HTTP request with this data included, and MVC will gladly bind it because your action says that database class is the shape of data it should accept for user input.</span></span></li><li><span data-ttu-id="04806-336">**모델 바인딩에 사용되는 셰이프에 주의해야 하는 이유는 무엇입니까? -** 지나치게 광범위한 모델로 ASP.NET MVC 모델 바인딩을 사용하면 응용 프로그램이 과도한 게시 공격에 노출됩니다.</span><span class="sxs-lookup"><span data-stu-id="04806-336">**Why should I care about the shape used for model binding? -** Using ASP.NET MVC model binding with overly broad models exposes an application to over-posting attacks.</span></span> <span data-ttu-id="04806-337">과도한 게시로 인해 공격자는 항목에 대한 가격이나 계정의 보안 권한을 무시하는 등 개발자가 의도한 것 이상으로 응용 프로그램 데이터를 변경할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-337">Over-posting could enable attackers to change application data beyond what the developer intended, such as overriding the price for an item or the security privileges for an account.</span></span> <span data-ttu-id="04806-338">응용 프로그램은 작업별 바인딩 모델(또는 특정의 허용되는 속성 필터 목록)을 사용하여 신뢰할 수 없는 입력에서 모델 바인딩을 통해 허용할 수 있는 명시적 계약을 제공해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-338">Applications should use action-specific binding models (or specific allowed property filter lists) to provide an explicit contract for what untrusted input to allow via model binding.</span></span></li><li><span data-ttu-id="04806-339">**코드를 복제하는 별도의 바인딩 모델이 있습니까? -** 아니요, 이는 중요한 부분의 분리 문제입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-339">**Is having separate binding models just duplicating code? -** No, it is a matter of separation of concerns.</span></span> <span data-ttu-id="04806-340">작업 메서드에서 데이터베이스 모델을 다시 사용하는 경우 사용자가 HTTP 요청에 해당 클래스의 모든 속성(또는 하위 속성)을 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-340">If you reuse database models in action methods, you are saying any property (or sub-property) in that class can be set by the user in an HTTP request.</span></span> <span data-ttu-id="04806-341">이 작업이 MVC에서 수행하려는 작업이 아닌 경우 사용자 입력에서 가져올 수 있는 데이터를 MVC에 대신 표시하려면 필터 목록이나 별도의 클래스 셰이프가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-341">If that is not what you want MVC to do, you need a filter list or a separate class shape to show MVC what data can come from user input instead.</span></span></li><li><span data-ttu-id="04806-342">**사용자 입력에 대한 별도의 바인딩 모델이 있는 경우 모든 데이터 주석 특성을 복제해야 합니까? -** 반드시 그렇지는 않습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-342">**If I have separate binding models for user input, do I have to duplicate all my data annotation attributes? -** Not necessarily.</span></span> <span data-ttu-id="04806-343">데이터베이스 모델 클래스의 MetadataTypeAttribute를 사용하여 모델 바인딩 클래스의 메타데이터에 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-343">You can use MetadataTypeAttribute on the database model class to link to the metadata on a model binding class.</span></span> <span data-ttu-id="04806-344">MetadataTypeAttribute에서 참조하는 형식은 참조하는 형식의 하위 집합이어야 합니다(더 적은 속성이 있을 수 있지만, 더 많지는 않음).</span><span class="sxs-lookup"><span data-stu-id="04806-344">Just note that the type referenced by the MetadataTypeAttribute must be a subset of the referencing type (it can have fewer properties, but not more).</span></span></li><li><span data-ttu-id="04806-345">**사용자 입력 모델과 데이터베이스 모델 간에 데이터를 앞뒤로 이동하는 것은 지루한 작업입니다. 리플렉션을 사용하여 모든 속성을 복사할 수 있습니까? -** 예.</span><span class="sxs-lookup"><span data-stu-id="04806-345">**Moving data back and forth between user input models and database models is tedious. Can I just copy over all properties using reflection? -** Yes.</span></span> <span data-ttu-id="04806-346">바인딩 모델에 표시되는 유일한 속성은 사용자 입력에 대해 안전하다고 확인한 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-346">The only properties that appear in the binding models are the ones you have determined to be safe for user input.</span></span> <span data-ttu-id="04806-347">리플렉션을 사용하여 이 두 모델 간에 공통으로 존재하는 모든 속성을 복사하지 못하게 할 보안상의 이유는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-347">There is no security reason that prevents using reflection to copy over all properties that exist in common between these two models.</span></span></li><li><span data-ttu-id="04806-348">**[Bind(Exclude ="â€¦")]는 어떻습니까? 별도의 바인딩 모델을 사용하는 대신 이 특성을 사용할 수 있습니까? -** 이 방법은 권장되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-348">**What about [Bind(Exclude ="â€¦")]. Can I use that instead of having separate binding models? -** This approach is not recommended.</span></span> <span data-ttu-id="04806-349">[Bind(Exclude ="â€¦")]를 사용하면 새 속성 모두를 기본적으로 바인딩할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-349">Using [Bind(Exclude ="â€¦")] means that any new property is bindable by default.</span></span> <span data-ttu-id="04806-350">새 속성이 추가되면 기본적으로 디자인을 안전하게 유지하는 것보다 작업들을 안전하게 유지하도록 기억하는 추가 단계가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-350">When a new property is added, there is an extra step to remember to keep things secure, rather than having the design be secure by default.</span></span> <span data-ttu-id="04806-351">속성이 추가될 때마다 개발자에 따라 이 목록을 확인하는 것은 위험합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-351">Depending on the developer checking this list every time a property is added is risky.</span></span></li><li><span data-ttu-id="04806-352">**[Bind(Include ="â€¦")]는 편집 작업에 유용합니까? -** 아니요.</span><span class="sxs-lookup"><span data-stu-id="04806-352">**Is [Bind(Include ="â€¦")] useful for Edit operations? -** No.</span></span> <span data-ttu-id="04806-353">[Bind(Include ="â€¦")]는 삽입 방식 작업(새 데이터 추가)에만 적합합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-353">[Bind(Include ="â€¦")] is only suitable for INSERT-style operations (adding new data).</span></span> <span data-ttu-id="04806-354">업데이트 방식 작업(기존 데이터 수정)의 경우 별도의 바인딩 모델을 사용하거나 허용되는 명시적 속성 목록을 UpdateModel 또는 TryUpdateModel에 전달하는 등의 다른 방법을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-354">For UPDATE-style operations (revising existing data), use another approach, like having separate binding models or passing an explicit list of allowed properties to UpdateModel or TryUpdateModel.</span></span> <span data-ttu-id="04806-355">편집 작업에 [Bind(Include ="â€¦")] 특성을 추가하면 MVC에서 개체 인스턴스를 만들고, 나열된 속성만 설정하며, 다른 모든 속성은 기본값으로 그대로 둡니다.</span><span class="sxs-lookup"><span data-stu-id="04806-355">Adding a [Bind(Include ="â€¦")] attribute on an Edit operation means that MVC will create an object instance and set only the listed properties, leaving all others at their default values.</span></span> <span data-ttu-id="04806-356">지속형 데이터인 경우 생략된 모든 속성의 값을 기본값으로 다시 설정하여 기존 엔터티를 완전히 대체합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-356">When the data is persisted, it will entirely replace the existing entity, resetting the values for any omitted properties to their defaults.</span></span> <span data-ttu-id="04806-357">예를 들어 편집 작업에서 [Bind(Include ="â€¦")] 특성의 IsAdmin이 생략되었으면 이 작업을 통해 편집된 이름을 가진 사용자는 모두 IsAdmin = false로 다시 설정됩니다(편집된 모든 사용자는 관리자 상태를 상실함).</span><span class="sxs-lookup"><span data-stu-id="04806-357">For example, if IsAdmin was omitted from a [Bind(Include ="â€¦")] attribute on an Edit operation, any user whose name was edited via this action would be reset to IsAdmin = false (any edited user would lose administrator status).</span></span> <span data-ttu-id="04806-358">특정 속성에 대한 업데이트를 방지하려면 위에서 설명한 다른 방법 중 하나를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-358">If you want to prevent updates to certain properties, use one of the other approaches above.</span></span> <span data-ttu-id="04806-359">일부 버전의 MVC 도구는 [Bind(Include ="â€¦")]를 포함한 컨트롤러 클래스를 편집 작업에서 생성하며, 해당 목록에서 속성을 제거하면 과도한 게시 공격이 방지됩니다.</span><span class="sxs-lookup"><span data-stu-id="04806-359">Note that some versions of MVC tooling generate controller classes with [Bind(Include ="â€¦")] on Edit actions and imply that removing a property from that list will prevent over-posting attacks.</span></span> <span data-ttu-id="04806-360">그러나 위에서 설명한 대로 이 방법은 의도한 대로 작동하지 않는 대신 생략된 속성의 모든 데이터를 기본값으로 다시 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-360">However, as described above, that approach does not work as intended and instead will reset any data in the omitted properties to their default values.</span></span></li><li><span data-ttu-id="04806-361">**만들기 작업의 경우 별도의 바인딩 모델이 아닌 [Bind(Include ="â€¦")]를 사용하는 데 주의해야 합니까? -** 예.</span><span class="sxs-lookup"><span data-stu-id="04806-361">**For Create operations, are there any caveats using [Bind(Include ="â€¦")] rather than separate binding models? -** Yes.</span></span> <span data-ttu-id="04806-362">첫째, 이 방법은 편집 시나리오에서 작동하지 않으므로 모든 과도한 게시 취약성을 완화하기 위해서는 별도의 두 가지 방법을 유지해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-362">First this approach does not work for Edit scenarios, requiring maintaining two separate approaches for mitigating all over-posting vulnerabilities.</span></span> <span data-ttu-id="04806-363">둘째, 별도의 바인딩 모델은 사용자 입력에 사용되는 셰이프와 지속성에 사용되는 셰이프 간에 중요한 부분을 분리하도록 강제하지만, [Bind(Include ="â€¦")]는 그렇지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-363">Second, separate binding models enforce separation of concerns between the shape used for user input and the shape used for persistence, something [Bind(Include ="â€¦")] does not do.</span></span> <span data-ttu-id="04806-364">셋째, [Bind(Include ="â€¦")]는 최상위 수준 속성만 처리할 수 있습니다. 특성의 하위 속성(예: "Details.Name") 일부만 허용할 수는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-364">Third, note that [Bind(Include ="â€¦")] can only handle top-level properties; you cannot allow only portions of sub-properties (such as "Details.Name") in the attribute.</span></span> <span data-ttu-id="04806-365">마지막으로, 가장 중요한 것은 [Bind(Include ="â€¦")]를 사용하면 모델 바인딩에 클래스를 사용할 때마다 기억해야 하는 추가 단계가 추가된다는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-365">Finally, and perhaps most importantly, using [Bind(Include ="â€¦")] adds an extra step that must be remembered any time the class is used for model binding.</span></span> <span data-ttu-id="04806-366">새 작업 메서드가 데이터 클래스에 직접 바인딩되어 [Bind(Include ="â€¦")] 특성을 포함하지 않으면 과도한 게시 공격에 취약할 수 있으므로 [Bind(Include ="â€¦")] 방법은 기본적으로 다소 덜 안전합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-366">If a new action method binds to the data class directly and forgets to include a [Bind(Include ="â€¦")] attribute, it can be vulnerable to over-posting attacks, so the [Bind(Include ="â€¦")] approach is somewhat less secure by default.</span></span> <span data-ttu-id="04806-367">[Bind(Include ="â€¦")]를 사용하는 경우 데이터 클래스가 작업 메서드 매개 변수로 나타날 때마다 항상 이 특성을 지정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-367">If you use [Bind(Include ="â€¦")], take care always to remember to specify it every time your data classes appear as action method parameters.</span></span></li><li><span data-ttu-id="04806-368">**만들기 작업의 경우 [Bind(Include ="â€¦")] 특성을 모델 클래스 자체에 배치하는 것은 어떻습니까? 여기서는 모든 작업 메서드에 이 특성을 배치하는 것을 기억할 필요가 없습니까? -** 이 방법은 경우에 따라 작동합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-368">**For Create operations, what about putting the [Bind(Include ="â€¦")] attribute on the model class itself? Does not this approach avoid the need to remember putting the attribute on every action method? -** This approach works in some cases.</span></span> <span data-ttu-id="04806-369">이 클래스를 사용하는 작업 매개 변수가 아니라 모델 형식 자체에 [Bind(Include ="â€¦")]를 사용하면 모든 작업 메서드에서 [Bind(Include ="â€¦")] 특성을 포함해야 한다는 것을 기억할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-369">Using [Bind(Include ="â€¦")] on the model type itself (rather than on action parameters using this class), does avoid the need to remember to include the [Bind(Include ="â€¦")] attribute on every action method.</span></span> <span data-ttu-id="04806-370">클래스에서 특성을 직접 사용하면 모델 바인딩을 위해 이 클래스의 별도 노출 영역을 효과적으로 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="04806-370">Using the attribute directly on the class effectively creates a separate surface area of this class for model binding purposes.</span></span> <span data-ttu-id="04806-371">그러나 이 방법은 모델 클래스마다 모델 바인딩 셰이프 하나만 허용합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-371">However, this approach only allows for one model binding shape per model class.</span></span> <span data-ttu-id="04806-372">한 작업(예: 사용자 역할을 업데이트하는 관리자 전용 작업) 메서드에서 필드의 모델 바인딩을 허용해야 하고, 다른 작업에서는 이 필드의 모델 바인딩을 방지해야 하는 경우 이 방법은 작동하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-372">If one action method needs to allow model binding of a field (for example, an administrator-only action that updates user roles) and other actions need to prevent model binding of this field, this approach will not work.</span></span> <span data-ttu-id="04806-373">각 클래스에는 모델 바인딩 셰이프 하나만 있을 수 있습니다. 작업마다 서로 다른 모델 바인딩 셰이프가 필요한 경우 작업 메서드에 별도의 모델 바인딩 클래스 또는 별도의 [Bind(Include ="â€¦")] 특성을 사용하여 이러한 셰이프를 개별적으로 표시해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-373">Each class can only have one model binding shape; if different actions need different model binding shapes, they need to represent these separate shapes using either separate model binding classes or separate [Bind(Include ="â€¦")] attributes on the action methods.</span></span></li><li><span data-ttu-id="04806-374">**바인딩 모델이란 무엇입니까? 보기 모델과 동일한 것입니까? -** 여기에는 관련된 두 가지 개념이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-374">**What are binding models? Are they the same thing as view models? -** These are two related concepts.</span></span> <span data-ttu-id="04806-375">바인딩 모델이라는 용어는 작업에 사용되는 모델 클래스를 가리키며, 매개 변수 목록(MVC 모델 바인딩에서 작업 메서드로 전달된 셰이프)입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-375">The term binding model refers to a model class used in an action is parameter list (the shape passed from MVC model binding to the action method).</span></span> <span data-ttu-id="04806-376">보기 모델이라는 용어는 작업 메서드에서 보기로 전달된 모델 클래스를 가리킵니다.</span><span class="sxs-lookup"><span data-stu-id="04806-376">The term view model refers to a model class passed from an action method to a view.</span></span> <span data-ttu-id="04806-377">보기 특정 모델을 사용하는 것은 작업 메서드에서 보기로 데이터를 전달하는 일반적인 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-377">Using a view-specific model is a common approach for passing data from an action method to a view.</span></span> <span data-ttu-id="04806-378">종종이 셰이프는 모델 바인딩에 대 한 적합도 및 양쪽 모두에서 사용 되는 동일한 모델을 참조 하는 용어 보기 모델을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-378">Often, this shape is also suitable for model binding, and the term view model can be used to refer the same model used in both places.</span></span> <span data-ttu-id="04806-379">정확하게 이 절차는 바인딩 모델에 대해 구체적으로 설명하며, 작업에 전달되는 셰이프에 초점을 맞추고 있습니다. 이는 대량 할당을 위해 중요한 것입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-379">To be precise, this procedure talks specifically about binding models, focusing on the shape passed to the action, which is what matters for mass assignment purposes.</span></span></li></ul>| 

## <span data-ttu-id="04806-380"><a id="rendering"></a>렌더링하기 전에 신뢰할 수 없는 웹 출력 인코딩</span><span class="sxs-lookup"><span data-stu-id="04806-380"><a id="rendering"></a>Encode untrusted web output prior to rendering</span></span>

| <span data-ttu-id="04806-381">제목</span><span class="sxs-lookup"><span data-stu-id="04806-381">Title</span></span>                   | <span data-ttu-id="04806-382">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-382">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-383">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-383">**Component**</span></span>               | <span data-ttu-id="04806-384">웹 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="04806-384">Web Application</span></span> | 
| <span data-ttu-id="04806-385">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-385">**SDL Phase**</span></span>               | <span data-ttu-id="04806-386">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-386">Build</span></span> |  
| <span data-ttu-id="04806-387">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-387">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-388">일반, Web Forms, MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="04806-388">Generic, Web Forms, MVC5, MVC6</span></span> |
| <span data-ttu-id="04806-389">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-389">**Attributes**</span></span>              | <span data-ttu-id="04806-390">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-390">N/A</span></span>  |
| <span data-ttu-id="04806-391">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-391">**References**</span></span>              | <span data-ttu-id="04806-392">[ASP.NET에서 XSS(사이트 간 스크립팅)를 방지하는 방법](http://msdn.microsoft.com/library/ms998274.aspx)(영문), [XSS(사이트 간 스크립팅)](http://cwe.mitre.org/data/definitions/79.html)(영문), [XSS(사이트 간 스크립팅) 방지 참고 자료](https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet)(영문)</span><span class="sxs-lookup"><span data-stu-id="04806-392">[How to prevent Cross-site scripting in ASP.NET](http://msdn.microsoft.com/library/ms998274.aspx), [Cross-site Scripting](http://cwe.mitre.org/data/definitions/79.html), [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet)</span></span> |
| <span data-ttu-id="04806-393">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-393">**Steps**</span></span> | <span data-ttu-id="04806-394">사이트 간 스크립팅(약어로 XSS)은 온라인 서비스 또는 웹에서 입력을 사용하는 응용 프로그램/구성 요소에 대한 공격 벡터입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-394">Cross-site scripting (commonly abbreviated as XSS) is an attack vector for online services or any application/component that consumes input from the web.</span></span> <span data-ttu-id="04806-395">XSS 취약성으로 인해 공격자가 취약한 웹 응용 프로그램을 통해 다른 사용자의 컴퓨터에서 스크립트를 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-395">XSS vulnerabilities may allow an attacker to execute script on another user's machine through a vulnerable web application.</span></span> <span data-ttu-id="04806-396">악성 스크립트는 쿠키를 도용하거나 그렇지 않으면 JavaScript를 통해 공격 대상의 컴퓨터에 손상을 입히는 데 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-396">Malicious scripts can be used to steal cookies and otherwise tamper with a victim's machine through JavaScript.</span></span> <span data-ttu-id="04806-397">XSS는 사용자 입력의 유효성을 검사하고 웹 페이지에 렌더링하기 전에 형식과 인코딩이 올바른지 확인함으로써 방지됩니다.</span><span class="sxs-lookup"><span data-stu-id="04806-397">XSS is prevented by validating user input, ensuring it is well formed and encoding before it is rendered in a web page.</span></span> <span data-ttu-id="04806-398">입력 유효성 검사 및 출력 인코딩은 Web Protection Library를 사용하여 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-398">Input validation and output encoding can be done by using Web Protection Library.</span></span> <span data-ttu-id="04806-399">관리 코드(C\#, VB.net 등)의 경우 사용자 입력이 매니페스트되는 컨텍스트에 따라 Web Protection (Anti-XSS) Library에서 적절한 인코딩 메서드를 하나 이상 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-399">For Managed code (C\#, VB.net, etc.), use one or more appropriate encoding methods from the Web Protection (Anti-XSS) Library, depending on the context where the user input gets manifested:</span></span>| 

### <a name="example"></a><span data-ttu-id="04806-400">예제</span><span class="sxs-lookup"><span data-stu-id="04806-400">Example</span></span>

```C#
* Encoder.HtmlEncode 
* Encoder.HtmlAttributeEncode 
* Encoder.JavaScriptEncode 
* Encoder.UrlEncode
* Encoder.VisualBasicScriptEncode 
* Encoder.XmlEncode 
* Encoder.XmlAttributeEncode 
* Encoder.CssEncode 
* Encoder.LdapEncode 
```

## <span data-ttu-id="04806-401"><a id="typemodel"></a>모든 문자열 형식 모델 속성에 대한 입력 유효성 검사 및 필터링 수행</span><span class="sxs-lookup"><span data-stu-id="04806-401"><a id="typemodel"></a>Perform input validation and filtering on all string type Model properties</span></span>

| <span data-ttu-id="04806-402">제목</span><span class="sxs-lookup"><span data-stu-id="04806-402">Title</span></span>                   | <span data-ttu-id="04806-403">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-403">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-404">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-404">**Component**</span></span>               | <span data-ttu-id="04806-405">웹 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="04806-405">Web Application</span></span> | 
| <span data-ttu-id="04806-406">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-406">**SDL Phase**</span></span>               | <span data-ttu-id="04806-407">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-407">Build</span></span> |  
| <span data-ttu-id="04806-408">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-408">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-409">일반, MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="04806-409">Generic, MVC5, MVC6</span></span> |
| <span data-ttu-id="04806-410">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-410">**Attributes**</span></span>              | <span data-ttu-id="04806-411">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-411">N/A</span></span>  |
| <span data-ttu-id="04806-412">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-412">**References**</span></span>              | <span data-ttu-id="04806-413">[유효성 검사 추가](http://www.asp.net/mvc/overview/getting-started/introduction/adding-validation), [MVC 응용 프로그램에서 모델 데이터 유효성 검사](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx)(영문), [ASP.NET MVC 응용 프로그램을 위한 기본 원칙](http://msdn.microsoft.com/magazine/dd942822.aspx)(영문)</span><span class="sxs-lookup"><span data-stu-id="04806-413">[Adding Validation](http://www.asp.net/mvc/overview/getting-started/introduction/adding-validation), [Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Guiding Principles For Your ASP.NET MVC Applications](http://msdn.microsoft.com/magazine/dd942822.aspx)</span></span> |
| <span data-ttu-id="04806-414">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-414">**Steps**</span></span> | <p><span data-ttu-id="04806-415">악의적인 사용자 입력으로부터 응용 프로그램을 보호하려면 응용 프로그램에서 사용하기 전에 모든 입력 매개 변수의 유효성을 검사해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-415">All the input parameters must be validated before they are used in the application to ensure that the application is safeguarded against malicious user inputs.</span></span> <span data-ttu-id="04806-416">허용 목록 유효성 검사 전략으로 서버 쪽에서 정규식 유효성 검사를 사용하여 입력 값의 유효성을 검사합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-416">Validate the input values using regular expression validations on server side with a whitelist validation strategy.</span></span> <span data-ttu-id="04806-417">삭제되지 않은 사용자 입력/매개 변수가 메서드에 전달되면 코드 삽입 취약성이 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-417">Unsanitized user inputs / parameters passed to the methods can cause code injection vulnerabilities.</span></span></p><p><span data-ttu-id="04806-418">웹 응용 프로그램의 경우 양식 필드, QueryStrings, 쿠키, HTTP 헤더 및 웹 서비스 매개 변수가 진입점에 포함될 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-418">For web applications, entry points can also include form fields, QueryStrings, cookies, HTTP headers, and web service parameters.</span></span></p><p><span data-ttu-id="04806-419">모델 바인딩 시 다음과 같이 입력 유효성 검사를 수행해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-419">The following input validation checks must be performed upon model binding:</span></span></p><ul><li><span data-ttu-id="04806-420">모델 속성에는 허용되는 문자 및 최대 허용 길이를 받아들이기 위해 RegularExpression 주석으로 주석을 추가해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-420">The model properties should be annotated with RegularExpression annotation, for accepting allowed characters and maximum permissible length</span></span></li><li><span data-ttu-id="04806-421">컨트롤러 메서드에서 ModelState 유효성 검사를 수행해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-421">The controller methods should perform ModelState validity</span></span></li></ul>|

## <span data-ttu-id="04806-422"><a id="richtext"></a>모든 문자를 허용하는 양식 필드(예: 서식 있는 텍스트 편집기)에서 삭제 적용</span><span class="sxs-lookup"><span data-stu-id="04806-422"><a id="richtext"></a>Sanitization should be applied on form fields that accept all characters, e.g, rich text editor</span></span>

| <span data-ttu-id="04806-423">제목</span><span class="sxs-lookup"><span data-stu-id="04806-423">Title</span></span>                   | <span data-ttu-id="04806-424">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-424">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-425">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-425">**Component**</span></span>               | <span data-ttu-id="04806-426">웹 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="04806-426">Web Application</span></span> | 
| <span data-ttu-id="04806-427">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-427">**SDL Phase**</span></span>               | <span data-ttu-id="04806-428">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-428">Build</span></span> |  
| <span data-ttu-id="04806-429">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-429">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-430">일반</span><span class="sxs-lookup"><span data-stu-id="04806-430">Generic</span></span> |
| <span data-ttu-id="04806-431">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-431">**Attributes**</span></span>              | <span data-ttu-id="04806-432">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-432">N/A</span></span>  |
| <span data-ttu-id="04806-433">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-433">**References**</span></span>              | <span data-ttu-id="04806-434">[안전하지 않은 입력 인코딩](https://msdn.microsoft.com/library/ff647397.aspx#paght000003_step3)(영어), [HTML 삭제기](https://github.com/mganss/HtmlSanitizer)(영어)</span><span class="sxs-lookup"><span data-stu-id="04806-434">[Encode Unsafe Input](https://msdn.microsoft.com/library/ff647397.aspx#paght000003_step3), [HTML Sanitizer](https://github.com/mganss/HtmlSanitizer)</span></span> |
| <span data-ttu-id="04806-435">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-435">**Steps**</span></span> | <p><span data-ttu-id="04806-436">사용하려는 정적 태그를 모두 식별합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-436">Identify all static markup tags that you want to use.</span></span> <span data-ttu-id="04806-437">일반적으로 `<b>`(굵게) 및 `<i>`(기울임꼴)와 같은 안전한 HTML 요소로 서식 지정을 제한하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-437">A common practice is to restrict formatting to safe HTML elements, such as `<b>` (bold) and `<i>` (italic).</span></span></p><p><span data-ttu-id="04806-438">데이터를 작성하기 전에 HTML로 인코딩합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-438">Before writing the data, HTML-encode it.</span></span> <span data-ttu-id="04806-439">이렇게 하면 악성 스크립트를 실행 코드가 아닌 텍스트로 처리하므로 안전하게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="04806-439">This makes any malicious script safe by causing it to be handled as text, not as executable code.</span></span></p><ol><li><span data-ttu-id="04806-440">@ Page 지시문에 ValidateRequest="false" 특성을 추가하여 ASP.NET 요청 유효성 검사를 사용하지 않도록 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-440">Disable ASP.NET request validation by the adding the ValidateRequest="false" attribute to the @ Page directive</span></span></li><li><span data-ttu-id="04806-441">HtmlEncode 메서드로 문자열 입력을 인코딩합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-441">Encode the string input with the HtmlEncode method</span></span></li><li><span data-ttu-id="04806-442">StringBuilder를 사용하고 해당 Replace 메서드를 호출하여 허용하려는 HTML 요소의 인코딩을 선택적으로 제거합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-442">Use a StringBuilder and call its Replace method to selectively remove the encoding on the HTML elements that you want to permit</span></span></li></ol><p><span data-ttu-id="04806-443">page-in 참조는 `ValidateRequest="false"`를 설정하여 ASP.NET 요청 유효성 검사를 비활성화합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-443">The page-in the references disables ASP.NET request validation by setting `ValidateRequest="false"`.</span></span> <span data-ttu-id="04806-444">입력을 HTML로 인코딩하고 선택적으로 `<b>` 및 `<i>`를 허용합니다. 또는 HTML 삭제를 위한 .NET 라이브러리를 사용할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-444">It HTML-encodes the input and selectively allows the `<b>` and `<i>` Alternatively, a .NET library for HTML sanitization may also be used.</span></span></p><p><span data-ttu-id="04806-445">HtmlSanitizer는 XSS 공격을 일으킬 수 있는 구문에서 HTML 조각과 문서를 정리하는 .NET 라이브러리입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-445">HtmlSanitizer is a .NET library for cleaning HTML fragments and documents from constructs that can lead to XSS attacks.</span></span> <span data-ttu-id="04806-446">AngleSharp를 사용하여 HTML 및 CSS를 구문 분석, 조작 및 렌더링합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-446">It uses AngleSharp to parse, manipulate, and render HTML and CSS.</span></span> <span data-ttu-id="04806-447">HtmlSanitizer는 NuGet 패키지로 설치할 수 있으며, 사용자 입력은 관련 HTML 또는 CSS 삭제 메서드를 통해 서버 쪽에서 전달할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-447">HtmlSanitizer can be installed as a NuGet package, and the user input can be passed through relevant HTML or CSS sanitization methods, as applicable, on the server side.</span></span> <span data-ttu-id="04806-448">보안 제어로서의 삭제는 마지막 옵션으로만 고려해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-448">Please note that Sanitization as a security control should be considered only as a last option.</span></span></p><p><span data-ttu-id="04806-449">입력 유효성 검사 및 출력 인코딩은 보다 효과적인 보안 제어로 간주됩니다.</span><span class="sxs-lookup"><span data-stu-id="04806-449">Input validation and Output Encoding are considered better security controls.</span></span></p> |

## <span data-ttu-id="04806-450"><a id="inbuilt-encode"></a>기본 제공 인코딩이 없는 싱크에 DOM 요소 할당 금지</span><span class="sxs-lookup"><span data-stu-id="04806-450"><a id="inbuilt-encode"></a>Do not assign DOM elements to sinks that do not have inbuilt encoding</span></span>

| <span data-ttu-id="04806-451">제목</span><span class="sxs-lookup"><span data-stu-id="04806-451">Title</span></span>                   | <span data-ttu-id="04806-452">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-452">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-453">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-453">**Component**</span></span>               | <span data-ttu-id="04806-454">웹 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="04806-454">Web Application</span></span> | 
| <span data-ttu-id="04806-455">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-455">**SDL Phase**</span></span>               | <span data-ttu-id="04806-456">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-456">Build</span></span> |  
| <span data-ttu-id="04806-457">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-457">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-458">일반</span><span class="sxs-lookup"><span data-stu-id="04806-458">Generic</span></span> |
| <span data-ttu-id="04806-459">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-459">**Attributes**</span></span>              | <span data-ttu-id="04806-460">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-460">N/A</span></span>  |
| <span data-ttu-id="04806-461">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-461">**References**</span></span>              | <span data-ttu-id="04806-462">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-462">N/A</span></span>  |
| <span data-ttu-id="04806-463">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-463">**Steps**</span></span> | <span data-ttu-id="04806-464">다양한 JavaScript 함수는 기본적으로 인코딩을 수행하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-464">Many javascript functions don't do encoding by default.</span></span> <span data-ttu-id="04806-465">이러한 함수를 통해 신뢰할 수 없는 입력을 DOM 요소에 할당하면 XSS(사이트 간 스크립트) 실행이 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-465">When assigning untrusted input to DOM elements via such functions, may result in cross site script (XSS) executions.</span></span>| 

### <a name="example"></a><span data-ttu-id="04806-466">예제</span><span class="sxs-lookup"><span data-stu-id="04806-466">Example</span></span>
<span data-ttu-id="04806-467">다음은 안전하지 않은 예제입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-467">Following are insecure examples:</span></span> 

```
document.getElementByID("div1").innerHtml = value;
$("#userName").html(res.Name);
return $('<div/>').html(value)
$('body').append(resHTML);   
```
<span data-ttu-id="04806-468">`innerHtml`을 사용하지 않는 대신 `innerText`를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-468">Don't use `innerHtml`; instead use `innerText`.</span></span> <span data-ttu-id="04806-469">마찬가지로 `$("#elm").html()` 대신 `$("#elm").text()`를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-469">Similarly, instead of `$("#elm").html()`, use `$("#elm").text()`</span></span> 

## <span data-ttu-id="04806-470"><a id="redirect-safe"></a>응용 프로그램 내의 모든 리디렉션이 폐쇄되어 있거나 안전하게 수행되는지 확인</span><span class="sxs-lookup"><span data-stu-id="04806-470"><a id="redirect-safe"></a>Validate all redirects within the application are closed or done safely</span></span>

| <span data-ttu-id="04806-471">제목</span><span class="sxs-lookup"><span data-stu-id="04806-471">Title</span></span>                   | <span data-ttu-id="04806-472">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-472">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-473">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-473">**Component**</span></span>               | <span data-ttu-id="04806-474">웹 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="04806-474">Web Application</span></span> | 
| <span data-ttu-id="04806-475">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-475">**SDL Phase**</span></span>               | <span data-ttu-id="04806-476">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-476">Build</span></span> |  
| <span data-ttu-id="04806-477">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-477">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-478">일반</span><span class="sxs-lookup"><span data-stu-id="04806-478">Generic</span></span> |
| <span data-ttu-id="04806-479">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-479">**Attributes**</span></span>              | <span data-ttu-id="04806-480">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-480">N/A</span></span>  |
| <span data-ttu-id="04806-481">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-481">**References**</span></span>              | [<span data-ttu-id="04806-482">OAuth 2.0 권한 부여 프레임워크 - 오픈 리디렉터</span><span class="sxs-lookup"><span data-stu-id="04806-482">The OAuth 2.0 Authorization Framework - Open Redirectors</span></span>](http://tools.ietf.org/html/rfc6749#section-10.15) |
| <span data-ttu-id="04806-483">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-483">**Steps**</span></span> | <p><span data-ttu-id="04806-484">사용자가 제공한 위치로 리디렉션해야 하는 응용 프로그램 디자인은 가능한 리디렉션 대상을 사이트 또는 도메인의 미리 정의된 "안전한" 목록으로 제한해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-484">Application design requiring redirection to a user-supplied location must constrain the possible redirection targets to a predefined "safe" list of sites or domains.</span></span> <span data-ttu-id="04806-485">응용 프로그램의 모든 리디렉션은 폐쇄되어 있거나 안전해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-485">All redirects in the application must be closed/safe.</span></span></p><p><span data-ttu-id="04806-486">다음을 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-486">To do this:</span></span></p><ul><li><span data-ttu-id="04806-487">모든 리디렉션을 식별합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-487">Identify all redirects</span></span></li><li><span data-ttu-id="04806-488">리디렉션마다 적절한 완화를 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-488">Implement an appropriate mitigation for each redirect.</span></span> <span data-ttu-id="04806-489">적절한 완화에는 리디렉션 허용 목록 또는 사용자 확인이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="04806-489">Appropriate mitigations include redirect whitelist or user confirmation.</span></span> <span data-ttu-id="04806-490">오픈 리디렉션 취약성이 있는 웹 사이트 또는 서비스에서 Facebook/OAuth/OpenID ID 공급자를 사용하는 경우 공격자가 사용자의 로그온 토큰을 도용하여 해당 사용자를 가장할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-490">If a web site or service with an open redirect vulnerability uses Facebook/OAuth/OpenID identity providers, an attacker can steal a user's logon token and impersonate that user.</span></span> <span data-ttu-id="04806-491">이는 RFC 6749 "OAuth 2.0 인증 프레임워크", 10.15 섹션 "오픈 리디렉션"에서 설명하는 OAuth를 사용할 때 내재된 위험입니다. 마찬가지로 오픈 리디렉션을 사용하는 스피어 피싱 공격으로 인해 사용자의 자격 증명이 손상될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-491">This is an inherent risk when using OAuth, which is documented in RFC 6749 "The OAuth 2.0 Authorization Framework", Section 10.15 "Open Redirects" Similarly, users' credentials can be compromised by spear phishing attacks using open redirects</span></span></li></ul>|

## <span data-ttu-id="04806-492"><a id="string-method"></a>컨트롤러 메서드에서 허용하는 모든 문자열 형식 매개 변수에 대한 입력 유효성 검사 구현</span><span class="sxs-lookup"><span data-stu-id="04806-492"><a id="string-method"></a>Implement input validation on all string type parameters accepted by Controller methods</span></span>

| <span data-ttu-id="04806-493">제목</span><span class="sxs-lookup"><span data-stu-id="04806-493">Title</span></span>                   | <span data-ttu-id="04806-494">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-494">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-495">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-495">**Component**</span></span>               | <span data-ttu-id="04806-496">웹 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="04806-496">Web Application</span></span> | 
| <span data-ttu-id="04806-497">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-497">**SDL Phase**</span></span>               | <span data-ttu-id="04806-498">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-498">Build</span></span> |  
| <span data-ttu-id="04806-499">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-499">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-500">일반, MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="04806-500">Generic, MVC5, MVC6</span></span> |
| <span data-ttu-id="04806-501">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-501">**Attributes**</span></span>              | <span data-ttu-id="04806-502">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-502">N/A</span></span>  |
| <span data-ttu-id="04806-503">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-503">**References**</span></span>              | <span data-ttu-id="04806-504">[MVC 응용 프로그램에서 모델 데이터 유효성 검사](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx)(영문), [ASP.NET MVC 응용 프로그램을 위한 기본 원칙](http://msdn.microsoft.com/magazine/dd942822.aspx)(영문)</span><span class="sxs-lookup"><span data-stu-id="04806-504">[Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Guiding Principles For Your ASP.NET MVC Applications](http://msdn.microsoft.com/magazine/dd942822.aspx)</span></span> |
| <span data-ttu-id="04806-505">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-505">**Steps**</span></span> | <span data-ttu-id="04806-506">인수로 모델이 아니라 기본 데이터 형식만 허용하는 메서드의 경우 정규식을 사용하여 입력 유효성 검사를 수행해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-506">For methods that just accept primitive data type, and not models as argument,input validation using Regular Expression should be done.</span></span> <span data-ttu-id="04806-507">여기서는 Regex.IsMatch를 유효한 정규식 패턴과 함께 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-507">Here Regex.IsMatch should be used with a valid regex pattern.</span></span> <span data-ttu-id="04806-508">입력이 지정된 정규식과 일치하지 않으면 제어를 더 이상 진행하지 않아야 하며 유효성 검사 실패와 관련된 적절한 경고를 표시해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-508">If the input doesn't match the specified Regular Expression, control should not proceed further, and an adequate warning regarding validation failure should be displayed.</span></span>| 

## <span data-ttu-id="04806-509"><a id="dos-expression"></a>정규식 처리에 대한 시간 제한 상한값을 설정하여 잘못된 정규식으로 인한 DoS 방지</span><span class="sxs-lookup"><span data-stu-id="04806-509"><a id="dos-expression"></a>Set upper limit timeout for regular expression processing to prevent DoS due to bad regular expressions</span></span>

| <span data-ttu-id="04806-510">제목</span><span class="sxs-lookup"><span data-stu-id="04806-510">Title</span></span>                   | <span data-ttu-id="04806-511">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-511">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-512">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-512">**Component**</span></span>               | <span data-ttu-id="04806-513">웹 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="04806-513">Web Application</span></span> | 
| <span data-ttu-id="04806-514">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-514">**SDL Phase**</span></span>               | <span data-ttu-id="04806-515">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-515">Build</span></span> |  
| <span data-ttu-id="04806-516">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-516">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-517">일반, Web Forms, MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="04806-517">Generic, Web Forms, MVC5, MVC6</span></span>  |
| <span data-ttu-id="04806-518">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-518">**Attributes**</span></span>              | <span data-ttu-id="04806-519">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-519">N/A</span></span>  |
| <span data-ttu-id="04806-520">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-520">**References**</span></span>              | [<span data-ttu-id="04806-521">DefaultRegexMatchTimeout 속성</span><span class="sxs-lookup"><span data-stu-id="04806-521">DefaultRegexMatchTimeout Property </span></span>](https://msdn.microsoft.com/library/system.web.configuration.httpruntimesection.defaultregexmatchtimeout.aspx) |
| <span data-ttu-id="04806-522">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-522">**Steps**</span></span> | <span data-ttu-id="04806-523">잘못 작성된 정규식에 대한 DoS(서비스 거부) 공격을 방지하려면 많은 역 추적이 발생하므로 전역 기본 시간 제한을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-523">To ensure denial of service attacks against badly created regular expressions, that cause a lot of backtracking, set the global default timeout.</span></span> <span data-ttu-id="04806-524">처리 시간이 정의된 상한보다 더 오래 걸리면 제한 시간 예외가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-524">If the processing time takes longer than the defined upper limit, it would throw a Timeout exception.</span></span> <span data-ttu-id="04806-525">아무 값도 구성되지 않으면 제한 시간은 무한입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-525">If nothing is configured, the timeout would be infinite.</span></span>| 

### <a name="example"></a><span data-ttu-id="04806-526">예제</span><span class="sxs-lookup"><span data-stu-id="04806-526">Example</span></span>
<span data-ttu-id="04806-527">예를 들어 다음 구성에서 처리하는 데 5초 이상 걸리는 경우 RegexMatchTimeoutException이 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-527">For example, the following configuration will throw a RegexMatchTimeoutException, if the processing takes more than 5 seconds:</span></span> 

```C#
<httpRuntime targetFramework="4.5" defaultRegexMatchTimeout="00:00:05" />
```

## <span data-ttu-id="04806-528"><a id="html-razor"></a>Razor 보기에서 Html.Raw 사용 방지</span><span class="sxs-lookup"><span data-stu-id="04806-528"><a id="html-razor"></a>Avoid using Html.Raw in Razor views</span></span>

| <span data-ttu-id="04806-529">제목</span><span class="sxs-lookup"><span data-stu-id="04806-529">Title</span></span>                   | <span data-ttu-id="04806-530">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-530">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-531">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-531">**Component**</span></span>               | <span data-ttu-id="04806-532">웹 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="04806-532">Web Application</span></span> | 
| <span data-ttu-id="04806-533">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-533">**SDL Phase**</span></span>               | <span data-ttu-id="04806-534">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-534">Build</span></span> |  
| <span data-ttu-id="04806-535">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-535">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-536">MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="04806-536">MVC5, MVC6</span></span> |
| <span data-ttu-id="04806-537">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-537">**Attributes**</span></span>              | <span data-ttu-id="04806-538">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-538">N/A</span></span>  |
| <span data-ttu-id="04806-539">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-539">**References**</span></span>              | <span data-ttu-id="04806-540">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-540">N/A</span></span>  |
| <span data-ttu-id="04806-541">단계</span><span class="sxs-lookup"><span data-stu-id="04806-541">Step</span></span> | <span data-ttu-id="04806-542">ASP.Net WebPages(Razor)는 자동 HTML 인코딩을 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-542">ASP.Net WebPages (Razor) perform automatic HTML encoding.</span></span> <span data-ttu-id="04806-543">포함된 코드 너깃(@ 블록)으로 인쇄된 모든 문자열은 자동으로 HTML로 인코딩됩니다.</span><span class="sxs-lookup"><span data-stu-id="04806-543">All strings printed by embedded code nuggets (@ blocks) are automatically HTML-encoded.</span></span> <span data-ttu-id="04806-544">그러나 `HtmlHelper.Raw` 메서드가 호출되면 HTML로 인코딩되지 않은 태그를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-544">However, when `HtmlHelper.Raw` Method is invoked, it returns markup that is not HTML encoded.</span></span> <span data-ttu-id="04806-545">`Html.Raw()` 도우미 메서드를 사용하면 Razor에서 제공하는 자동 인코딩 보호를 무시합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-545">If `Html.Raw()` helper method is used, it bypasses the automatic encoding protection that Razor provides.</span></span>|

### <a name="example"></a><span data-ttu-id="04806-546">예제</span><span class="sxs-lookup"><span data-stu-id="04806-546">Example</span></span>
<span data-ttu-id="04806-547">다음은 안전하지 않은 예제입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-547">Following is an insecure example:</span></span> 

```C#
<div class="form-group">
            @Html.Raw(Model.AccountConfirmText)
        </div>
        <div class="form-group">
            @Html.Raw(Model.PaymentConfirmText)
        </div>
</div>
```
<span data-ttu-id="04806-548">태그를 표시할 필요가 없는 경우 `Html.Raw()`를 사용하면 안됩니다.</span><span class="sxs-lookup"><span data-stu-id="04806-548">Do not use `Html.Raw()` unless you need to display markup.</span></span> <span data-ttu-id="04806-549">이 메서드는 암시적으로 출력 인코딩을 수행하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-549">This method does not perform output encoding implicitly.</span></span> <span data-ttu-id="04806-550">다른 ASP.NET 도우미(예: `@Html.DisplayFor()`)를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-550">Use other ASP.NET helpers e.g., `@Html.DisplayFor()`</span></span> 

## <span data-ttu-id="04806-551"><a id="stored-proc"></a>저장 프로시저에서 동적 쿼리 사용 금지</span><span class="sxs-lookup"><span data-stu-id="04806-551"><a id="stored-proc"></a>Do not use dynamic queries in stored procedures</span></span>

| <span data-ttu-id="04806-552">제목</span><span class="sxs-lookup"><span data-stu-id="04806-552">Title</span></span>                   | <span data-ttu-id="04806-553">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-553">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-554">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-554">**Component**</span></span>               | <span data-ttu-id="04806-555">데이터베이스</span><span class="sxs-lookup"><span data-stu-id="04806-555">Database</span></span> | 
| <span data-ttu-id="04806-556">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-556">**SDL Phase**</span></span>               | <span data-ttu-id="04806-557">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-557">Build</span></span> |  
| <span data-ttu-id="04806-558">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-558">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-559">일반</span><span class="sxs-lookup"><span data-stu-id="04806-559">Generic</span></span> |
| <span data-ttu-id="04806-560">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-560">**Attributes**</span></span>              | <span data-ttu-id="04806-561">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-561">N/A</span></span>  |
| <span data-ttu-id="04806-562">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-562">**References**</span></span>              | <span data-ttu-id="04806-563">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-563">N/A</span></span>  |
| <span data-ttu-id="04806-564">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-564">**Steps**</span></span> | <p><span data-ttu-id="04806-565">SQL 삽입 공격은 입력 유효성 검사의 취약성을 악용하여 데이터베이스에서 임의의 명령을 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-565">A SQL injection attack exploits vulnerabilities in input validation to run arbitrary commands in the database.</span></span> <span data-ttu-id="04806-566">데이터베이스에 액세스하기 위해 응용 프로그램에서 입력을 사용하여 동적 SQL 문을 구성할 때 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-566">It can occur when your application uses input to construct dynamic SQL statements to access the database.</span></span> <span data-ttu-id="04806-567">또한 코드에서 원시 사용자 입력을 포함한 문자열이 전달되는 저장 프로시저를 사용하는 경우에도 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-567">It can also occur if your code uses stored procedures that are passed strings that contain raw user input.</span></span> <span data-ttu-id="04806-568">공격자가 SQL 삽입 공격을 사용하여 데이터베이스에서 임의의 명령을 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-568">Using the SQL injection attack, the attacker can execute arbitrary commands in the database.</span></span> <span data-ttu-id="04806-569">모든 SQL 문(저장 프로시저의 SQL 문 포함)에는 매개 변수가 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-569">All SQL statements (including the SQL statements in stored procedures) must be parameterized.</span></span> <span data-ttu-id="04806-570">매개 변수가 있는 SQL 문은 강력한 형식으로 인해 SQL에 특별한 의미가 있는 문자(예: 작은 따옴표)를 문제 없이 허용합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-570">Parameterized SQL statements will accept characters that have special meaning to SQL (like single quote) without problems because they are strongly typed.</span></span> |

### <a name="example"></a><span data-ttu-id="04806-571">예제</span><span class="sxs-lookup"><span data-stu-id="04806-571">Example</span></span>
<span data-ttu-id="04806-572">다음은 안전하지 않은 동적 저장 프로시저의 예제입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-572">Following is an example of insecure dynamic Stored Procedure:</span></span> 

```C#
CREATE PROCEDURE [dbo].[uspGetProductsByCriteria]
(
  @productName nvarchar(200) = NULL,
  @startPrice float = NULL,
  @endPrice float = NULL
)
AS
 BEGIN
  DECLARE @sql nvarchar(max)
  SELECT @sql = ' SELECT ProductID, ProductName, Description, UnitPrice, ImagePath' +
       ' FROM dbo.Products WHERE 1 = 1 '
       PRINT @sql
  IF @productName IS NOT NULL
     SELECT @sql = @sql + ' AND ProductName LIKE ''%' + @productName + '%'''
  IF @startPrice IS NOT NULL
     SELECT @sql = @sql + ' AND UnitPrice > ''' + CONVERT(VARCHAR(10),@startPrice) + ''''
  IF @endPrice IS NOT NULL
     SELECT @sql = @sql + ' AND UnitPrice < ''' + CONVERT(VARCHAR(10),@endPrice) + ''''

  PRINT @sql
  EXEC(@sql)
 END
```

### <a name="example"></a><span data-ttu-id="04806-573">예제</span><span class="sxs-lookup"><span data-stu-id="04806-573">Example</span></span>
<span data-ttu-id="04806-574">다음은 안전하게 구현된 동일한 저장 프로시저입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-574">Following is the same stored procedure implemented securely:</span></span> 
```C#
CREATE PROCEDURE [dbo].[uspGetProductsByCriteriaSecure]
(
             @productName nvarchar(200) = NULL,
             @startPrice float = NULL,
             @endPrice float = NULL
)
AS
       BEGIN
             SELECT ProductID, ProductName, Description, UnitPrice, ImagePath
             FROM dbo.Products where
             (@productName IS NULL or ProductName like '%'+ @productName +'%')
             AND
             (@startPrice IS NULL or UnitPrice > @startPrice)
             AND
             (@endPrice IS NULL or UnitPrice < @endPrice)         
       END
```

## <span data-ttu-id="04806-575"><a id="validation-api"></a>모델 유효성 검사가 Web API 메서드에서 수행되는지 확인</span><span class="sxs-lookup"><span data-stu-id="04806-575"><a id="validation-api"></a>Ensure that model validation is done on Web API methods</span></span>

| <span data-ttu-id="04806-576">제목</span><span class="sxs-lookup"><span data-stu-id="04806-576">Title</span></span>                   | <span data-ttu-id="04806-577">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-577">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-578">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-578">**Component**</span></span>               | <span data-ttu-id="04806-579">Web API</span><span class="sxs-lookup"><span data-stu-id="04806-579">Web API</span></span> | 
| <span data-ttu-id="04806-580">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-580">**SDL Phase**</span></span>               | <span data-ttu-id="04806-581">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-581">Build</span></span> |  
| <span data-ttu-id="04806-582">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-582">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-583">MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="04806-583">MVC5, MVC6</span></span> |
| <span data-ttu-id="04806-584">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-584">**Attributes**</span></span>              | <span data-ttu-id="04806-585">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-585">N/A</span></span>  |
| <span data-ttu-id="04806-586">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-586">**References**</span></span>              | <span data-ttu-id="04806-587">[ASP.NET Web API의 모델 유효성 검사](http://www.asp.net/web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api)(영문)</span><span class="sxs-lookup"><span data-stu-id="04806-587">[Model Validation in ASP.NET Web API ](http://www.asp.net/web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api)</span></span> |
| <span data-ttu-id="04806-588">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-588">**Steps**</span></span> | <span data-ttu-id="04806-589">클라이언트에서 Web API로 데이터를 보낼 때 처리를 수행하기 전에 데이터의 유효성을 검사해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-589">When a client sends data to a web API, it is mandatory to validate the data before doing any processing.</span></span> <span data-ttu-id="04806-590">모델을 입력으로 받아들이는 ASP.NET Web API의 경우 모델의 데이터 주석을 사용하여 모델의 속성에 대한 유효성 검사 규칙을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-590">For ASP.NET Web APIs which accept models as input, use data annotations on models to set validation rules on the properties of the model.</span></span>|

### <a name="example"></a><span data-ttu-id="04806-591">예제</span><span class="sxs-lookup"><span data-stu-id="04806-591">Example</span></span>
<span data-ttu-id="04806-592">다음 코드에서는 이러한 작업을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="04806-592">The following code demonstrates the same:</span></span> 

```C#
using System.ComponentModel.DataAnnotations;

namespace MyApi.Models
{
    public class Product
    {
        public int Id { get; set; }
        [Required]
        [RegularExpression(@"^[a-zA-Z0-9]*$", ErrorMessage="Only alphanumeric characters are allowed.")]
        public string Name { get; set; }
        public decimal Price { get; set; }
        [Range(0, 999)]
        public double Weight { get; set; }
    }
}
```

### <a name="example"></a><span data-ttu-id="04806-593">예</span><span class="sxs-lookup"><span data-stu-id="04806-593">Example</span></span>
<span data-ttu-id="04806-594">API 컨트롤러의 작업 메서드에서 모델의 유효성은 아래와 같이 명시적으로 검사되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-594">In the action method of the API controllers, validity of the model has to be explicitly checked as shown below:</span></span> 

```C#
namespace MyApi.Controllers
{
    public class ProductsController : ApiController
    {
        public HttpResponseMessage Post(Product product)
        {
            if (ModelState.IsValid)
            {
                // Do something with the product (not shown).

                return new HttpResponseMessage(HttpStatusCode.OK);
            }
            else
            {
                return Request.CreateErrorResponse(HttpStatusCode.BadRequest, ModelState);
            }
        }
    }
}
```

## <span data-ttu-id="04806-595"><a id="string-api"></a>Web API 메서드에서 허용하는 모든 문자열 형식 매개 변수에 대한 입력 유효성 검사 구현</span><span class="sxs-lookup"><span data-stu-id="04806-595"><a id="string-api"></a>Implement input validation on all string type parameters accepted by Web API methods</span></span>

| <span data-ttu-id="04806-596">제목</span><span class="sxs-lookup"><span data-stu-id="04806-596">Title</span></span>                   | <span data-ttu-id="04806-597">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-597">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-598">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-598">**Component**</span></span>               | <span data-ttu-id="04806-599">Web API</span><span class="sxs-lookup"><span data-stu-id="04806-599">Web API</span></span> | 
| <span data-ttu-id="04806-600">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-600">**SDL Phase**</span></span>               | <span data-ttu-id="04806-601">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-601">Build</span></span> |  
| <span data-ttu-id="04806-602">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-602">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-603">일반, MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="04806-603">Generic, MVC 5, MVC 6</span></span> |
| <span data-ttu-id="04806-604">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-604">**Attributes**</span></span>              | <span data-ttu-id="04806-605">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-605">N/A</span></span>  |
| <span data-ttu-id="04806-606">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-606">**References**</span></span>              | <span data-ttu-id="04806-607">[MVC 응용 프로그램에서 모델 데이터 유효성 검사](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx)(영문), [ASP.NET MVC 응용 프로그램을 위한 기본 원칙](http://msdn.microsoft.com/magazine/dd942822.aspx)(영문)</span><span class="sxs-lookup"><span data-stu-id="04806-607">[Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Guiding Principles For Your ASP.NET MVC Applications](http://msdn.microsoft.com/magazine/dd942822.aspx)</span></span> |
| <span data-ttu-id="04806-608">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-608">**Steps**</span></span> | <span data-ttu-id="04806-609">인수로 모델이 아니라 기본 데이터 형식만 허용하는 메서드의 경우 정규식을 사용하여 입력 유효성 검사를 수행해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-609">For methods that just accept primitive data type, and not models as argument,input validation using Regular Expression should be done.</span></span> <span data-ttu-id="04806-610">여기서는 Regex.IsMatch를 유효한 정규식 패턴과 함께 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-610">Here Regex.IsMatch should be used with a valid regex pattern.</span></span> <span data-ttu-id="04806-611">입력이 지정된 정규식과 일치하지 않으면 제어를 더 이상 진행하지 않아야 하며 유효성 검사 실패와 관련된 적절한 경고를 표시해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-611">If the input doesn't match the specified Regular Expression, control should not proceed further, and an adequate warning regarding validation failure should be displayed.</span></span>|

## <span data-ttu-id="04806-612"><a id="typesafe-api"></a>Web API에서 데이터 액세스를 위해 형식이 안전한 매개 변수를 사용하는지 확인</span><span class="sxs-lookup"><span data-stu-id="04806-612"><a id="typesafe-api"></a>Ensure that type-safe parameters are used in Web API for data access</span></span>

| <span data-ttu-id="04806-613">제목</span><span class="sxs-lookup"><span data-stu-id="04806-613">Title</span></span>                   | <span data-ttu-id="04806-614">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-614">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-615">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-615">**Component**</span></span>               | <span data-ttu-id="04806-616">Web API</span><span class="sxs-lookup"><span data-stu-id="04806-616">Web API</span></span> | 
| <span data-ttu-id="04806-617">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-617">**SDL Phase**</span></span>               | <span data-ttu-id="04806-618">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-618">Build</span></span> |  
| <span data-ttu-id="04806-619">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-619">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-620">일반</span><span class="sxs-lookup"><span data-stu-id="04806-620">Generic</span></span> |
| <span data-ttu-id="04806-621">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-621">**Attributes**</span></span>              | <span data-ttu-id="04806-622">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-622">N/A</span></span>  |
| <span data-ttu-id="04806-623">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-623">**References**</span></span>              | <span data-ttu-id="04806-624">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-624">N/A</span></span>  |
| <span data-ttu-id="04806-625">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-625">**Steps**</span></span> | <p><span data-ttu-id="04806-626">매개 변수 컬렉션을 사용하는 경우 SQL은 입력을 실행 코드가 아닌 리터럴 값으로 처리합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-626">If you use the Parameters collection, SQL treats the input is as a literal value rather then as executable code.</span></span> <span data-ttu-id="04806-627">매개 변수 컬렉션을 사용하여 입력 데이터에 형식 및 길이 제약 조건을 적용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-627">The Parameters collection can be used to enforce type and length constraints on input data.</span></span> <span data-ttu-id="04806-628">범위를 벗어난 값은 예외를 트리거합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-628">Values outside of the range trigger an exception.</span></span> <span data-ttu-id="04806-629">형식이 안전한 SQL 매개 변수를 사용하지 않으면 공격자가 필터링되지 않은 입력에 포함된 삽입 공격을 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-629">If type-safe SQL parameters are not used, attackers might be able to execute injection attacks that are embedded in the unfiltered input.</span></span></p><p><span data-ttu-id="04806-630">필터링되지 않은 입력에서 발생할 수 있는 SQL 삽입 공격을 방지하려면 SQL 쿼리를 구성할 때 형식이 안전한 매개 변수를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-630">Use type safe parameters when constructing SQL queries to avoid possible SQL injection attacks that can occur with unfiltered input.</span></span> <span data-ttu-id="04806-631">저장 프로시저 및 동적 SQL 문과 함께 형식이 안전한 매개 변수를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-631">You can use type safe parameters with stored procedures and with dynamic SQL statements.</span></span> <span data-ttu-id="04806-632">매개 변수는 데이터베이스에서 리터럴 값으로 처리되며 실행 코드로는 처리되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-632">Parameters are treated as literal values by the database and not as executable code.</span></span> <span data-ttu-id="04806-633">또한 매개 변수의 형식 및 길이에 대해서도 검사합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-633">Parameters are also checked for type and length.</span></span></p>|

### <a name="example"></a><span data-ttu-id="04806-634">예제</span><span class="sxs-lookup"><span data-stu-id="04806-634">Example</span></span>
<span data-ttu-id="04806-635">다음 코드에서는 저장 프로시저를 호출할 때 형식이 안전한 매개 변수를 SqlParameterCollection에 사용하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="04806-635">The following code shows how to use type safe parameters with the SqlParameterCollection when calling a stored procedure.</span></span> 

```C#
using System.Data;
using System.Data.SqlClient;

using (SqlConnection connection = new SqlConnection(connectionString))
{ 
DataSet userDataset = new DataSet(); 
SqlDataAdapter myCommand = new SqlDataAdapter(LoginStoredProcedure", connection); 
myCommand.SelectCommand.CommandType = CommandType.StoredProcedure; 
myCommand.SelectCommand.Parameters.Add("@au_id", SqlDbType.VarChar, 11); 
myCommand.SelectCommand.Parameters["@au_id"].Value = SSN.Text; 
myCommand.Fill(userDataset);
}  
```
<span data-ttu-id="04806-636">이전의 코드 예제에서 입력 값은 11자를 초과할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-636">In the preceding code example, the input value cannot be longer than 11 characters.</span></span> <span data-ttu-id="04806-637">데이터가 매개 변수에 정의된 형식 또는 길이를 따르지 않으면 SqlParameter 클래스에서 예외가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-637">If the data does not conform to the type or length defined by the parameter, the SqlParameter class throws an exception.</span></span> 

## <span data-ttu-id="04806-638"><a id="sql-docdb"></a>Cosmos DB에 매개 변수가 있는 SQL 쿼리 사용</span><span class="sxs-lookup"><span data-stu-id="04806-638"><a id="sql-docdb"></a>Use parametrized SQL queries for Cosmos DB</span></span>

| <span data-ttu-id="04806-639">제목</span><span class="sxs-lookup"><span data-stu-id="04806-639">Title</span></span>                   | <span data-ttu-id="04806-640">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-640">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-641">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-641">**Component**</span></span>               | <span data-ttu-id="04806-642">Azure Document DB</span><span class="sxs-lookup"><span data-stu-id="04806-642">Azure Document DB</span></span> | 
| <span data-ttu-id="04806-643">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-643">**SDL Phase**</span></span>               | <span data-ttu-id="04806-644">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-644">Build</span></span> |  
| <span data-ttu-id="04806-645">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-645">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-646">일반</span><span class="sxs-lookup"><span data-stu-id="04806-646">Generic</span></span> |
| <span data-ttu-id="04806-647">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-647">**Attributes**</span></span>              | <span data-ttu-id="04806-648">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-648">N/A</span></span>  |
| <span data-ttu-id="04806-649">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-649">**References**</span></span>              | <span data-ttu-id="04806-650">[DocumentDB에서 SQL 매개 변수 지정 발표](https://azure.microsoft.com/blog/announcing-sql-parameterization-in-documentdb/)(영문)</span><span class="sxs-lookup"><span data-stu-id="04806-650">[Announcing SQL Parameterization in DocumentDB](https://azure.microsoft.com/blog/announcing-sql-parameterization-in-documentdb/)</span></span> |
| <span data-ttu-id="04806-651">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-651">**Steps**</span></span> | <span data-ttu-id="04806-652">DocumentDB는 읽기 전용 쿼리만 지원하지만 사용자 입력과 연결하여 쿼리를 구성하면 여전히 SQL 삽입이 가능합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-652">Although DocumentDB only supports read-only queries, SQL injection is still possible if queries are constructed by concatenating with user input.</span></span> <span data-ttu-id="04806-653">사용자가 악성 SQL 쿼리를 만들어 동일한 컬렉션 내에서 액세스하면 안되는 데이터에 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-653">It might be possible for a user to gain access to data they shouldn’t be accessing within the same collection by crafting malicious SQL queries.</span></span> <span data-ttu-id="04806-654">사용자 입력을 기반으로 하여 쿼리를 구성한 경우 매개 변수가 있는 SQL를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-654">Use parameterized SQL queries if queries are constructed based on user input.</span></span> |

## <span data-ttu-id="04806-655"><a id="schema-binding"></a>WCF - 스키마 바인딩을 통한 입력 유효성 검사</span><span class="sxs-lookup"><span data-stu-id="04806-655"><a id="schema-binding"></a>WCF Input validation through Schema binding</span></span>

| <span data-ttu-id="04806-656">제목</span><span class="sxs-lookup"><span data-stu-id="04806-656">Title</span></span>                   | <span data-ttu-id="04806-657">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-657">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-658">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-658">**Component**</span></span>               | <span data-ttu-id="04806-659">WCF</span><span class="sxs-lookup"><span data-stu-id="04806-659">WCF</span></span> | 
| <span data-ttu-id="04806-660">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-660">**SDL Phase**</span></span>               | <span data-ttu-id="04806-661">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-661">Build</span></span> |  
| <span data-ttu-id="04806-662">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-662">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-663">일반, .NET Framework 3</span><span class="sxs-lookup"><span data-stu-id="04806-663">Generic, NET Framework 3</span></span> |
| <span data-ttu-id="04806-664">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-664">**Attributes**</span></span>              | <span data-ttu-id="04806-665">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-665">N/A</span></span>  |
| <span data-ttu-id="04806-666">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-666">**References**</span></span>              | [<span data-ttu-id="04806-667">MSDN</span><span class="sxs-lookup"><span data-stu-id="04806-667">MSDN</span></span>](https://msdn.microsoft.com/library/ff647820.aspx) |
| <span data-ttu-id="04806-668">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-668">**Steps**</span></span> | <p><span data-ttu-id="04806-669">유효성 검사가 부족하면 다양한 형식 삽입 공격이 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-669">Lack of validation leads to different type injection attacks.</span></span></p><p><span data-ttu-id="04806-670">메시지 유효성 검사는 WCF 응용 프로그램을 보호하기 위한 하나의 방어선을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="04806-670">Message validation represents one line of defense in the protection of your WCF application.</span></span> <span data-ttu-id="04806-671">이 방법에서는 스키마를 통해 메시지의 유효성을 검사하여 악의적인 클라이언트의 공격으로부터 WCF 서비스 작업을 보호합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-671">With this approach, you validate messages using schemas to protect WCF service operations from attack by a malicious client.</span></span> <span data-ttu-id="04806-672">악성 서비스에 의한 공격으로부터 클라이언트를 보호하기 위해 클라이언트에서 받은 모든 메시지의 유효성을 검사합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-672">Validate all messages received by the client to protect the client from attack by a malicious service.</span></span> <span data-ttu-id="04806-673">메시지 유효성 검사를 통해 작업에서 메시지 계약이나 데이터 계약을 소비할 때 메시지의 유효성을 검사할 수 있으며, 매개 변수 유효성 검사로는 이러한 작업을 수행할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-673">Message validation makes it possible to validate messages when operations consume message contracts or data contracts, which cannot be done using parameter validation.</span></span> <span data-ttu-id="04806-674">메시지 유효성 검사를 사용하면 스키마 내에 유효성 검사 논리를 만들어 유연성을 높이고 개발 시간을 줄일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-674">Message validation allows you to create validation logic inside schemas, thereby providing more flexibility and reducing development time.</span></span> <span data-ttu-id="04806-675">스키마는 조직 내의 여러 응용 프로그램 간에 다시 사용하여 데이터 표현을 위한 표준을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-675">Schemas can be reused across different applications inside the organization, creating standards for data representation.</span></span> <span data-ttu-id="04806-676">또한 메시지 유효성 검사를 사용하면 비즈니스 논리를 나타내는 계약과 관련된 보다 복잡한 데이터 형식을 사용할 때 작업을 보호할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="04806-676">Additionally, message validation allows you to protect operations when they consume more complex data types involving contracts representing business logic.</span></span></p><p><span data-ttu-id="04806-677">메시지 유효성 검사를 수행하려면 먼저 서비스 작업과 해당 작업에서 사용하는 데이터 형식을 나타내는 스키마를 빌드합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-677">To perform message validation, you first build a schema that represents the operations of your service and the data types consumed by those operations.</span></span> <span data-ttu-id="04806-678">그런 다음 사용자 지정 클라이언트 메시지 검사기와 사용자 지정 디스패처 메시지 검사기를 구현하는 .NET 클래스를 만들어 서비스와 보내고 받는 메시지의 유효성을 검사합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-678">You then create a .NET class that implements a custom client message inspector and custom dispatcher message inspector to validate the messages sent/received to/from the service.</span></span> <span data-ttu-id="04806-679">다음으로 사용자 지정 끝점 동작을 구현하여 클라이언트와 서비스 모두에서 메시지 유효성 검사를 사용하도록 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-679">Next, you implement a custom endpoint behavior to enable message validation on both the client and the service.</span></span> <span data-ttu-id="04806-680">마지막으로 확장된 사용자 지정 끝점 동작을 서비스 또는 클라이언트의 구성 파일에 노출할 수 있도록 하는 클래스에 사용자 지정 구성 요소를 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-680">Finally, you implement a custom configuration element on the class that allows you to expose the extended custom endpoint behavior in the configuration file of the service or the client"</span></span></p>|

## <span data-ttu-id="04806-681"><a id="parameters"></a>WCF - 매개 변수 검사기를 통한 입력 유효성 검사</span><span class="sxs-lookup"><span data-stu-id="04806-681"><a id="parameters"></a>WCF- Input validation through Parameter Inspectors</span></span>

| <span data-ttu-id="04806-682">제목</span><span class="sxs-lookup"><span data-stu-id="04806-682">Title</span></span>                   | <span data-ttu-id="04806-683">세부 정보</span><span class="sxs-lookup"><span data-stu-id="04806-683">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="04806-684">**구성 요소**</span><span class="sxs-lookup"><span data-stu-id="04806-684">**Component**</span></span>               | <span data-ttu-id="04806-685">WCF</span><span class="sxs-lookup"><span data-stu-id="04806-685">WCF</span></span> | 
| <span data-ttu-id="04806-686">**SDL 단계**</span><span class="sxs-lookup"><span data-stu-id="04806-686">**SDL Phase**</span></span>               | <span data-ttu-id="04806-687">빌드</span><span class="sxs-lookup"><span data-stu-id="04806-687">Build</span></span> |  
| <span data-ttu-id="04806-688">**적용 가능한 기술**</span><span class="sxs-lookup"><span data-stu-id="04806-688">**Applicable Technologies**</span></span> | <span data-ttu-id="04806-689">일반, .NET Framework 3</span><span class="sxs-lookup"><span data-stu-id="04806-689">Generic, NET Framework 3</span></span> |
| <span data-ttu-id="04806-690">**특성**</span><span class="sxs-lookup"><span data-stu-id="04806-690">**Attributes**</span></span>              | <span data-ttu-id="04806-691">해당 없음</span><span class="sxs-lookup"><span data-stu-id="04806-691">N/A</span></span>  |
| <span data-ttu-id="04806-692">**참조**</span><span class="sxs-lookup"><span data-stu-id="04806-692">**References**</span></span>              | [<span data-ttu-id="04806-693">MSDN</span><span class="sxs-lookup"><span data-stu-id="04806-693">MSDN</span></span>](https://msdn.microsoft.com/library/ff647875.aspx) |
| <span data-ttu-id="04806-694">**단계**</span><span class="sxs-lookup"><span data-stu-id="04806-694">**Steps**</span></span> | <p><span data-ttu-id="04806-695">입력 및 데이터 유효성 검사는 WCF 응용 프로그램을 보호하기 위한 하나의 중요한 방어선을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="04806-695">Input and data validation represents one important line of defense in the protection of your WCF application.</span></span> <span data-ttu-id="04806-696">악성 클라이언트의 공격으로부터 서비스를 보호하기 위해 WCF 서비스 작업에 노출된 모든 매개 변수의 유효성을 검사해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-696">You should validate all parameters exposed in WCF service operations to protect the service from attack by a malicious client.</span></span> <span data-ttu-id="04806-697">반대로 악성 서비스에 의한 공격으로부터 클라이언트를 보호하기 위해 클라이언트에서 받은 모든 반환 값의 유효성도 검사해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-697">Conversely, you should also validate all return values received by the client to protect the client from attack by a malicious service</span></span></p><p><span data-ttu-id="04806-698">WCF는 사용자 지정 확장을 만들어 WCF 런타임 동작을 사용자 지정할 수 있는 다양한 확장성 지점을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-698">WCF provides different extensibility points that allow you to customize the WCF runtime behavior by creating custom extensions.</span></span> <span data-ttu-id="04806-699">메시지 검사기와 매개 변수 검사기는 클라이언트와 서비스 간에 전달되는 데이터를 보다 효율적으로 제어하는 데 사용되는 두 가지 확장성 메커니즘입니다.</span><span class="sxs-lookup"><span data-stu-id="04806-699">Message Inspectors and Parameter Inspectors are two extensibility mechanisms used to gain greater control over the data passing between a client and a service.</span></span> <span data-ttu-id="04806-700">입력 유효성 검사에 매개 변수 검사기를 사용해야 하며, 서비스에서 들어오고 나가는 전체 메시지를 검사해야 하는 경우에만 메시지 검사기를 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-700">You should use parameter inspectors for input validation and use message inspectors only when you need to inspect the entire message flowing in and out of a service.</span></span></p><p><span data-ttu-id="04806-701">입력 유효성 검사를 수행하려면 .NET 클래스를 빌드하고, 서비스의 작업에 대한 매개 변수의 유효성을 검사하기 위해 사용자 지정 매개 변수 검사기를 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-701">To perform input validation, you will build a .NET class and implement a custom parameter inspector in order to validate parameters on operations in your service.</span></span> <span data-ttu-id="04806-702">그런 다음 사용자 지정 끝점 동작을 구현하여 클라이언트와 서비스 모두에서 유효성 검사를 사용하도록 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-702">You will then implement a custom endpoint behavior to enable validation on both the client and the service.</span></span> <span data-ttu-id="04806-703">마지막으로 확장된 사용자 지정 끝점 동작을 서비스 또는 클라이언트의 구성 파일에 노출할 수 있도록 하는 클래스에 사용자 지정 구성 요소를 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="04806-703">Finally, you will implement a custom configuration element on the class that allows you to expose the extended custom endpoint behavior in the configuration file of the service or the client</span></span></p>|
