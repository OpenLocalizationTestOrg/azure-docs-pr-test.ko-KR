---
title: "비대칭 라우팅 | Microsoft Docs"
description: "이 문서에서는 대상에 여러 개의 링크가 있는 네트워크에서 비대칭 라우팅을 사용하는 고객이 경험할 수 있는 문제를 살펴봅니다."
documentationcenter: na
services: expressroute
author: osamazia
manager: carmonm
editor: 
ms.assetid: a754bff9-95c9-44b5-9796-377fc21e8322
ms.service: expressroute
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 10/10/2016
ms.author: osamam
ms.openlocfilehash: 8568c13d2834a0643e15ab1814a35c92123837d1
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/11/2017
---
# <a name="asymmetric-routing-with-multiple-network-paths"></a><span data-ttu-id="b8aa0-103">여러 네트워크 경로를 포함한 비대칭 라우팅</span><span class="sxs-lookup"><span data-stu-id="b8aa0-103">Asymmetric routing with multiple network paths</span></span>
<span data-ttu-id="b8aa0-104">이 문서에서는 네트워크 원본과 대상 간에 여러 경로를 사용할 수 있을 때 전달 및 반환 네트워크 트래픽에서 다른 경로를 사용하는 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-104">This article explains how forward and return network traffic might take different routes when multiple paths are available between network source and destination.</span></span>

<span data-ttu-id="b8aa0-105">비대칭 라우팅을 이해하려면 두 가지 개념을 이해해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-105">It's important to understand two concepts to understand asymmetric routing.</span></span> <span data-ttu-id="b8aa0-106">하나는 여러 네트워크 경로의 영향입니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-106">One is the effect of multiple network paths.</span></span> <span data-ttu-id="b8aa0-107">다른 하나는 방화벽 같은 장치가 상태를 유지하는 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-107">The other is how devices, like a firewall, keep state.</span></span> <span data-ttu-id="b8aa0-108">이러한 종류의 장치는 상태 저장 장치라고 합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-108">These types of devices are called stateful devices.</span></span> <span data-ttu-id="b8aa0-109">이러한 두 가지 요인을 조합하면 상태 저장 장치가 장치 자체로 시작된 트래픽을 감지하지 못하기 때문에 상태 저장 장치에서 네트워크 트래픽을 삭제하는 시나리오를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-109">A combination of these two factors creates scenarios in which network traffic is dropped by a stateful device because the stateful device didn't detect that traffic originated with the device itself.</span></span>

## <a name="multiple-network-paths"></a><span data-ttu-id="b8aa0-110">여러 네트워크 경로</span><span class="sxs-lookup"><span data-stu-id="b8aa0-110">Multiple network paths</span></span>
<span data-ttu-id="b8aa0-111">엔터프라이즈 네트워크가 해당 인터넷 서비스 공급자를 통해 인터넷에 대한 하나의 링크를 가진 경우 동일한 경로를 통해 인터넷 내외에서 모든 트래픽이 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-111">When an enterprise network has only one link to the Internet through their Internet service provider, all traffic to and from the Internet travels the same path.</span></span> <span data-ttu-id="b8aa0-112">종종 회사는 네트워크 가동 시간을 개선하기 위해 중복 경로로 여러 회로를 구입합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-112">Often, companies purchase multiple circuits, as redundant paths, to improve network uptime.</span></span> <span data-ttu-id="b8aa0-113">이러한 경우 네트워크 외부에서 들어오는 트래픽은 하나의 링크를 통해 인터넷으로 이동하고 반환 트래픽은 다른 링크를 통해 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-113">When this happens, it's possible that traffic that goes outside of the network, to the Internet, goes through one link, and the return traffic goes through a different link.</span></span> <span data-ttu-id="b8aa0-114">이를 일반적으로 비대칭 라우팅이라고 합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-114">This is commonly known as asymmetric routing.</span></span> <span data-ttu-id="b8aa0-115">비대칭 라우팅에서 역방향 네트워크 트래픽은 원래 흐름과 다른 경로를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-115">In asymmetric routing, reverse network traffic takes a different path from the original flow.</span></span>

![여러 경로가 포함된 네트워크](./media/expressroute-asymmetric-routing/AsymmetricRouting3.png)

<span data-ttu-id="b8aa0-117">인터넷에서 주로 발생하지만 비대칭 라우팅도 다른 조합의 여러 경로에 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-117">Although it primarily occurs on the Internet, asymmetric routing also applies to other combinations of multiple paths.</span></span> <span data-ttu-id="b8aa0-118">예를 들어 동일한 대상으로 이동하는 인터넷 경로 및 개인 경로와 동일한 대상으로 이동하는 여러 개인 경로에 모두 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-118">It applies, for example, both to an Internet path and a private path that go to the same destination, and to multiple private paths that go to the same destination.</span></span>

<span data-ttu-id="b8aa0-119">원본에서 대상까지의 과정에서 라우터는 각각 대상에 도달하는 최상의 경로를 계산합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-119">Each router along the way, from source to destination, computes the best path to reach a destination.</span></span> <span data-ttu-id="b8aa0-120">라우터는 두 가지 주요 요소를 기반으로 가능한 최상의 경로를 결정합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-120">The router's determination of best possible path is based on two main factors:</span></span>

* <span data-ttu-id="b8aa0-121">외부 네트워크 간의 라우팅은 BGP(경계 게이트웨이 프로토콜), 라우팅 프로토콜을 기반으로 합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-121">Routing between external networks is based on a routing protocol, Border Gateway Protocol (BGP).</span></span> <span data-ttu-id="b8aa0-122">BGP는 인접 라우터에서 보급하고 의도한 대상에 최상의 경로를 결정하는 여러 단계를 통해 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-122">BGP takes advertisements from neighbors and runs them through a series of steps to determine the best path to the intended destination.</span></span> <span data-ttu-id="b8aa0-123">최상의 경로를 해당 라우팅 테이블에 저장합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-123">It stores the best path in its routing table.</span></span>
* <span data-ttu-id="b8aa0-124">경로와 연결된 서브넷 마스크의 길이는 라우팅 경로에 영향을 줍니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-124">The length of a subnet mask associated with a route influences routing paths.</span></span> <span data-ttu-id="b8aa0-125">라우터가 다른 서브넷 마스크가 아닌 동일한 IP 주소에 대한 여러 보급을 수신하는 경우 해당 라우터는 더 긴 서브넷 마스크를 포함한 보급을 구체적인 경로로 간주하기 때문에 선호합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-125">If a router receives multiple advertisements for the same IP address but with different subnet masks, the router prefers the advertisement with a longer subnet mask because it's considered a more specific route.</span></span>

## <a name="stateful-devices"></a><span data-ttu-id="b8aa0-126">상태 저장 장치</span><span class="sxs-lookup"><span data-stu-id="b8aa0-126">Stateful devices</span></span>
<span data-ttu-id="b8aa0-127">라우터는 라우팅을 위해 패킷의 IP 헤더를 살펴봅니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-127">Routers look at the IP header of a packet for routing purposes.</span></span> <span data-ttu-id="b8aa0-128">패킷 내부를 훨씬 자세히 살펴보는 장치가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-128">Some devices look even deeper inside the packet.</span></span> <span data-ttu-id="b8aa0-129">일반적으로 이러한 장치는 Layer4(전송 제어 프로토콜 또는 TCP; 또는 사용자 데이터그램 프로토콜 또는 UDP) 또는 심지어 Layer7(응용 프로그램 계층) 헤더를 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-129">Typically, these devices look at Layer4 (Transmission Control Protocol, or TCP; or User Datagram Protocol, or UDP), or even Layer7 (Application Layer) headers.</span></span> <span data-ttu-id="b8aa0-130">이러한 종류의 장치는 보안 장치 또는 대역폭 최적화 장치입니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-130">These kinds of devices are either security devices or bandwidth-optimization devices.</span></span> 

<span data-ttu-id="b8aa0-131">방화벽은 상태 저장 장치의 일반적인 예입니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-131">A firewall is a common example of a stateful device.</span></span> <span data-ttu-id="b8aa0-132">방화벽은 패킷이 프로토콜, TCP/UDP 포트, URL 헤더 등 다양한 필드에 따라 해당 인터페이스를 통과하도록 허용하거나 거부합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-132">A firewall allows or denies a packet to pass through its interfaces based on various fields such as protocol, TCP/UDP port, and URL headers.</span></span> <span data-ttu-id="b8aa0-133">이 수준의 패킷 검사는 장치에 많은 처리 부하를 배치합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-133">This level of packet inspection puts a heavy processing load on the device.</span></span> <span data-ttu-id="b8aa0-134">방화벽은 성능을 개선하기 위해 흐름의 첫 번째 패킷을 검사합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-134">To improve performance, the firewall inspects the first packet of a flow.</span></span> <span data-ttu-id="b8aa0-135">패킷이 진행되도록 허용하는 경우 해당 상태 테이블에 흐름 정보를 보관합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-135">If it allows the packet to proceed, it keeps the flow information in its state table.</span></span> <span data-ttu-id="b8aa0-136">이 흐름에 관련된 모든 후속 패킷은 초기 결정에 따라 허용됩니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-136">All subsequent packets related to this flow are allowed based on the initial determination.</span></span> <span data-ttu-id="b8aa0-137">기존 흐름의 일부인 패킷은 방화벽에 도달할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-137">A packet that is part of an existing flow might arrive at the firewall.</span></span> <span data-ttu-id="b8aa0-138">방화벽에 이전 상태 정보가 없는 경우 방화벽은 패킷을 삭제합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-138">If the firewall has no prior state information about it, the firewall drops the packet.</span></span>

## <a name="asymmetric-routing-with-expressroute"></a><span data-ttu-id="b8aa0-139">Express 경로를 포함한 비대칭 라우팅</span><span class="sxs-lookup"><span data-stu-id="b8aa0-139">Asymmetric routing with ExpressRoute</span></span>
<span data-ttu-id="b8aa0-140">Express 경로를 통해 Microsoft에 연결할 때 네트워크에는 다음과 같은 변경 내용이 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-140">When you connect to Microsoft through Azure ExpressRoute, your network changes like this:</span></span>

* <span data-ttu-id="b8aa0-141">Microsoft에 대한 여러 링크가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-141">You have multiple links to Microsoft.</span></span> <span data-ttu-id="b8aa0-142">한 가지 링크는 기존 인터넷 연결이고 다른 하나는 Express 경로를 통한 연결입니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-142">One link is your existing Internet connection, and the other is via ExpressRoute.</span></span> <span data-ttu-id="b8aa0-143">Microsoft에 대한 일부 트래픽은 인터넷을 통과할 수 있지만 Express 경로를 통해 돌아옵니다. 혹은 그 반대입니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-143">Some traffic to Microsoft might go through the Internet but come back via ExpressRoute, or vice versa.</span></span>
* <span data-ttu-id="b8aa0-144">Express 경로를 통해 구체적인 IP 주소를 수신합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-144">You receive more specific IP addresses via ExpressRoute.</span></span> <span data-ttu-id="b8aa0-145">따라서 항상 Express 경로를 통해 제공되는 서비스에 대해 네트워크에서 Microsoft로 전달되는 트래픽의 경우 라우터는 Express 경로를 선호합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-145">So, for traffic from your network to Microsoft for services offered via ExpressRoute, routers always prefer ExpressRoute.</span></span>

<span data-ttu-id="b8aa0-146">이러한 두 가지 변경 사항이 네트워크에 미칠 영향을 이해하기 위해 몇 가지 시나리오를 고려해 보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-146">To understand the effect these two changes have on a network, let’s consider some scenarios.</span></span> <span data-ttu-id="b8aa0-147">예를 들어 인터넷에 대한 회로가 오직 하나이며 인터넷을 통한 모든 Microsoft 서비스를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-147">As an example, you have only one circuit to the Internet and you consume all Microsoft services via the Internet.</span></span> <span data-ttu-id="b8aa0-148">네트워크에서 Microsoft로 전달되는 트래픽은 동일한 인터넷 링크를 탐색하고 방화벽을 통해 전달됩니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-148">The traffic from your network to Microsoft and back traverses the same Internet link and passes through the firewall.</span></span> <span data-ttu-id="b8aa0-149">첫 번째 패킷을 확인하면 방화벽이 흐름을 기록하고 흐름이 상태 테이블에 존재하면 반환 패킷이 허용됩니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-149">The firewall records the flow as it sees the first packet and return packets are allowed because the flow exists in the state table.</span></span>

![Express 경로를 포함한 비대칭 라우팅](./media/expressroute-asymmetric-routing/AsymmetricRouting1.png)

<span data-ttu-id="b8aa0-151">그런 다음 Express 경로를 켜고 Express 경로를 통해 Microsoft에서 제공하는 서비스를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-151">Then, you turn on ExpressRoute and consume services offered by Microsoft over ExpressRoute.</span></span> <span data-ttu-id="b8aa0-152">Microsoft의 다른 모든 서비스는 인터넷을 통해 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-152">All other services from Microsoft are consumed over the Internet.</span></span> <span data-ttu-id="b8aa0-153">Express 경로에 연결된 에지에 별도 방화벽을 배포합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-153">You deploy a separate firewall at your edge that is connected to ExpressRoute.</span></span> <span data-ttu-id="b8aa0-154">Microsoft는 특정 서비스에 대한 Express 경로에 네트워크에 대한 구체적인 접두사를 보급합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-154">Microsoft advertises more specific prefixes to your network over ExpressRoute for specific services.</span></span> <span data-ttu-id="b8aa0-155">라우팅 인프라는 해당 접두사에 대한 기본 경로로 Express 경로를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-155">Your routing infrastructure chooses ExpressRoute as the preferred path for those prefixes.</span></span> <span data-ttu-id="b8aa0-156">Express 경로에 걸쳐 Microsoft에 대한 공용 IP 주소를 보급하지 않는 경우 Microsoft는 인터넷을 통해 공용 IP 주소와 통신합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-156">If you are not advertising your public IP addresses to Microsoft over ExpressRoute, Microsoft communicates with your public IP addresses via the Internet.</span></span> <span data-ttu-id="b8aa0-157">네트워크에서 Microsoft로 전달되는 트래픽은 Express 경로를 사용하고 Microsoft의 역방향 트래픽은 인터넷을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-157">Forward traffic from your network to Microsoft uses ExpressRoute, and reverse traffic from Microsoft uses the Internet.</span></span> <span data-ttu-id="b8aa0-158">에지의 방화벽이 상태 테이블에서 찾을 수 없는 흐름에 대한 응답 패킷을 확인하는 경우 반환 트래픽을 삭제합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-158">When the firewall at the edge sees a response packet for a flow that it does not find in the state table, it drops the return traffic.</span></span>

<span data-ttu-id="b8aa0-159">Express 경로 및 인터넷에 동일한 NAT(네트워크 주소 변환) 풀을 사용하는 경우 개인 IP 주소의 네트워크에 클라이언트와 비슷한 문제가 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-159">If you choose to use the same network address translation (NAT) pool for ExpressRoute and for the Internet, you'll see similar issues with the clients in your network on private IP addresses.</span></span> <span data-ttu-id="b8aa0-160">이러한 서비스에 대한 IP 주소가 Express 경로를 통해 보급되지 않기 때문에 Windows 업데이트와 같은 서비스에 대한 요청은 인터넷을 통해 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-160">Requests for services like Windows Update go via the Internet because IP addresses for these services are not advertised via ExpressRoute.</span></span> <span data-ttu-id="b8aa0-161">그러나 반환 트래픽은 Express 경로를 통해 다시 돌아옵니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-161">However, the return traffic comes back via ExpressRoute.</span></span> <span data-ttu-id="b8aa0-162">Microsoft가 인터넷 및 Express 경로에서 동일한 서브넷 마스크를 가진 IP 주소를 수신하는 경우 인터넷에 대한 Express 경로를 선호합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-162">If Microsoft receives an IP address with the same subnet mask from the Internet and ExpressRoute, it prefers ExpressRoute over the Internet.</span></span> <span data-ttu-id="b8aa0-163">네트워크 에지에서 Express 경로에 연결된 방화벽이나 기타 상태 저장 장치에 흐름에 대한 이전 정보가 없는 경우 해당 흐름에 속하는 패킷을 삭제합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-163">If a firewall or another stateful device that is on your network edge and facing ExpressRoute has no prior information about the flow, it drops the packets that belong to that flow.</span></span>

## <a name="asymmetric-routing-solutions"></a><span data-ttu-id="b8aa0-164">비대칭 라우팅 솔루션</span><span class="sxs-lookup"><span data-stu-id="b8aa0-164">Asymmetric routing solutions</span></span>
<span data-ttu-id="b8aa0-165">비대칭 라우팅의 문제를 해결하는 두 가지 주요 옵션이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-165">You have two main options to solve the problem of asymmetric routing.</span></span> <span data-ttu-id="b8aa0-166">하나는 라우팅을 통한 방법이고 다른 하나는 SNAT(원본 기반 NAT)를 사용하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-166">One is through routing, and the other is by using source-based NAT (SNAT).</span></span>

### <a name="routing"></a><span data-ttu-id="b8aa0-167">라우팅</span><span class="sxs-lookup"><span data-stu-id="b8aa0-167">Routing</span></span>
<span data-ttu-id="b8aa0-168">공용 IP 주소를 적절한 WAN(광역 네트워크) 링크에 보급하도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-168">Ensure that your public IP addresses are advertised to appropriate wide area network (WAN) links.</span></span> <span data-ttu-id="b8aa0-169">예를 들어 메일 트래픽에 대한 인증 트래픽 및 Express 경로의 인터넷을 사용하려는 경우 Express 경로를 통해 AD FS(Active Directory Federation Services) 공용 IP 주소를 보급하지 않아야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-169">For example, if you want to use the Internet for authentication traffic and ExpressRoute for your mail traffic, you should not advertise your Active Directory Federation Services (AD FS) public IP addresses over ExpressRoute.</span></span> <span data-ttu-id="b8aa0-170">마찬가지로 라우터가 Express 경로로 수신하는 IP 주소에 온-프레미스 AD FS 서버를 노출하지 않아야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-170">Similarly, be sure not to expose an on-premises AD FS server to IP addresses that the router receives over ExpressRoute.</span></span> <span data-ttu-id="b8aa0-171">Express 경로를 통해 수신된 경로는 구체적이므로 Express 경로를 Microsoft에 대한 인증 트래픽의 기본 경로로 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-171">Routes received over ExpressRoute are more specific so they make ExpressRoute the preferred path for authentication traffic to Microsoft.</span></span> <span data-ttu-id="b8aa0-172">이렇게 하면 비대칭 라우팅이 생겨납니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-172">This causes asymmetric routing.</span></span>

<span data-ttu-id="b8aa0-173">인증을 위해 Express 경로를 사용하려는 경우 NAT 없이 Express 경로에 AD FS 공용 IP 주소를 보급해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-173">If you want to use ExpressRoute for authentication, make sure that you are advertising AD FS public IP addresses over ExpressRoute without NAT.</span></span> <span data-ttu-id="b8aa0-174">이 방법으로 Microsoft에서 시작되고 온-프레미스 AD FS 서버로 이동하는 트래픽은 Express 경로를 통해 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-174">This way, traffic that originates from Microsoft and goes to an on-premises AD FS server goes over ExpressRoute.</span></span> <span data-ttu-id="b8aa0-175">고객으로부터 Microsoft에 대한 반환 트래픽은 인터넷을 통한 기본 경로이기 때문에 Express 경로를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-175">Return traffic from customer to Microsoft uses ExpressRoute because it's the preferred route over the Internet.</span></span>

### <a name="source-based-nat"></a><span data-ttu-id="b8aa0-176">원본 기반 NAT</span><span class="sxs-lookup"><span data-stu-id="b8aa0-176">Source-based NAT</span></span>
<span data-ttu-id="b8aa0-177">비대칭 라우팅 문제를 해결하는 다른 방법은 SNAT를 사용하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-177">Another way of solving asymmetric routing issues is by using SNAT.</span></span> <span data-ttu-id="b8aa0-178">예를 들어 이러한 유형의 통신에 인터넷을 사용하려고 하기 때문에 Express 경로에 온-프레미스 SMTP(단순 메일 전송 프로토콜) 서버의 공용 IP 주소를 보급하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-178">For example, you have not advertised the public IP address of an on-premises Simple Mail Transfer Protocol (SMTP) server over ExpressRoute because you intend to use the Internet for this type of communication.</span></span> <span data-ttu-id="b8aa0-179">Microsoft로 시작하고 온-프레미스 SMTP 서버로 이동하는 요청은 인터넷을 탐색합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-179">A request that originates with Microsoft and then goes to your on-premises SMTP server traverses the Internet.</span></span> <span data-ttu-id="b8aa0-180">SNAT는 내부 IP 주소에 대한 들어오는 요청입니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-180">You SNAT the incoming request to an internal IP address.</span></span> <span data-ttu-id="b8aa0-181">SMTP 서버의 역방향 트래픽은 Express 경로 대신 에지 방화벽(NAT에 사용함)으로 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-181">Reverse traffic from the SMTP server goes to the edge firewall (which you use for NAT) instead of through ExpressRoute.</span></span> <span data-ttu-id="b8aa0-182">반환 트래픽은 인터넷을 통해 돌아갑니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-182">The return traffic goes back via the Internet.</span></span>

![원본 기반 NAT 네트워크 구성](./media/expressroute-asymmetric-routing/AsymmetricRouting2.png)

## <a name="asymmetric-routing-detection"></a><span data-ttu-id="b8aa0-184">비대칭 라우팅 감지</span><span class="sxs-lookup"><span data-stu-id="b8aa0-184">Asymmetric routing detection</span></span>
<span data-ttu-id="b8aa0-185">경로 추적은 네트워크 트래픽이 예상된 경로를 탐색하도록 하는 가장 좋은 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-185">Traceroute is the best way to make sure that your network traffic is traversing the expected path.</span></span> <span data-ttu-id="b8aa0-186">온-프레미스 SMTP 서버에서 Microsoft로 전달되는 트래픽이 인터넷 경로를 사용해야 하는 경우 예상된 경로 추적은 SMTP 서버에서 Office 365로 이동합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-186">If you expect traffic from your on-premises SMTP server to Microsoft to take the Internet path, the expected traceroute is from the SMTP server to Office 365.</span></span> <span data-ttu-id="b8aa0-187">결과를 통해 트래픽이 네트워크를 Express 경로가 아닌 인터넷에 남겨두는지 유효성을 검사합니다.</span><span class="sxs-lookup"><span data-stu-id="b8aa0-187">The result validates that traffic is indeed leaving your network toward the Internet and not toward ExpressRoute.</span></span>

