---
title: "Azure Application Insights 원격 분석 상관 관계 | Microsoft 문서"
description: "Application Insights 원격 분석 상관 관계"
services: application-insights
documentationcenter: .net
author: SergeyKanzhelev
manager: carmonm
ms.service: application-insights
ms.workload: TBD
ms.tgt_pltfrm: ibiza
ms.devlang: multiple
ms.topic: article
ms.date: 04/25/2017
ms.author: bwren
ms.openlocfilehash: 747c00842f4df9c7fbd816c99771ba8a267106a4
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/18/2017
---
# <a name="telemetry-correlation-in-application-insights"></a><span data-ttu-id="70dfd-103">Application Insights의 원격 분석 상관 관계</span><span class="sxs-lookup"><span data-stu-id="70dfd-103">Telemetry correlation in Application Insights</span></span>

<span data-ttu-id="70dfd-104">마이크로 서비스의 세상에서 모든 논리 작업에는 다양한 서비스 구성 요소로 이루어지는 작업이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-104">In the world of micro services, every logical operation requires work done in various components of the service.</span></span> <span data-ttu-id="70dfd-105">이러한 각 구성 요소는 [Application Insights](app-insights-overview.md)에서 개별적으로 모니터링할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-105">Each of these components can be separately monitored by [Application Insights](app-insights-overview.md).</span></span> <span data-ttu-id="70dfd-106">웹앱 구성 요소는 인증 공급자 구성 요소와 통신하여 사용자 자격 증명의 유효성을 검사하고, API 구성 요소를 사용하여 시각화할 데이터를 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-106">The web app component communicates with authentication provider component to validate user credentials, and with the API component to get data for visualization.</span></span> <span data-ttu-id="70dfd-107">이에 따라 API 구성 요소는 다른 서비스의 데이터를 쿼리하고, 캐시 공급자 구성 요소를 사용하고, 이 호출에 대해 청구 구성 요소에 알릴 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-107">The API component in its turn can query data from other services and use cache-provider components and notify the billing component about this call.</span></span> <span data-ttu-id="70dfd-108">Application Insights는 분산 원격 분석 상관 관계를 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-108">Application Insights supports distributed telemetry correlation.</span></span> <span data-ttu-id="70dfd-109">이를 통해 실패하거나 성능 저하된 구성 요소를 검색할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-109">It allows you to detect which component is responsible for failures or performance degradation.</span></span>

<span data-ttu-id="70dfd-110">이 문서에서는 여러 구성 요소에서 보낸 원격 분석의 상관 관계를 지정하기 위해 Application Insights에서 사용되는 데이터 모델에 대해 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-110">This article explains the data model used by Application Insights to correlate telemetry sent by multiple components.</span></span> <span data-ttu-id="70dfd-111">컨텍스트 전파 기술 및 프로토콜을 다룹니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-111">It covers the context propagation techniques and protocols.</span></span> <span data-ttu-id="70dfd-112">다양한 언어와 플랫폼에 대한 상관 관계 개념 구현도 다룹니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-112">It also covers the implementation of the correlation concepts on different languages and platforms.</span></span>

## <a name="telemetry-correlation-data-model"></a><span data-ttu-id="70dfd-113">원격 분석 상관 관계 데이터 모델</span><span class="sxs-lookup"><span data-stu-id="70dfd-113">Telemetry correlation data model</span></span>

<span data-ttu-id="70dfd-114">Application Insights는 분산 원격 분석 상관 관계에 대한 [데이터 모델](application-insights-data-model.md)을 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-114">Application Insights defines a [data model](application-insights-data-model.md) for distributed telemetry correlation.</span></span> <span data-ttu-id="70dfd-115">원격 분석을 논리 작업과 연결하기 위해 모든 원격 분석 항목에 `operation_Id`라는 컨텍스트 필드가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-115">To associate telemetry with the logical operation, every telemetry item has a context field called `operation_Id`.</span></span> <span data-ttu-id="70dfd-116">이 식별자는 분산 추적의 모든 원격 분석 항목에서 공유됩니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-116">This identifier is shared by every telemetry item in the distributed trace.</span></span> <span data-ttu-id="70dfd-117">따라서 단일 계층에서 원격 분석이 손실되더라도 다른 구성 요소에서 보고한 원격 분석을 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-117">So even with loss of telemetry from a single layer you still can associate telemetry reported by other components.</span></span>

<span data-ttu-id="70dfd-118">일반적으로 분산 논리 작업은 구성 요소 중 하나에서 처리되는 요청인 더 작은 작업의 집합으로 구성됩니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-118">Distributed logical operation typically consists of a set of smaller operations - requests processed by one of the components.</span></span> <span data-ttu-id="70dfd-119">이러한 작업은 [요청 원격 분석](application-insights-data-model-request-telemetry.md)을 통해 정의됩니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-119">Those operations are defined by [request telemetry](application-insights-data-model-request-telemetry.md).</span></span> <span data-ttu-id="70dfd-120">모든 요청 원격 분석에는 전체적으로 고유하게 식별되는 자체 `id`가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-120">Every request telemetry has its own `id` that uniquely globally identifies it.</span></span> <span data-ttu-id="70dfd-121">또한 이 요청과 연결된 모든 원격 분석(추적, 예외 등)은 `operation_parentId`를 요청 `id`의 값으로 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-121">And all telemetry - traces, exceptions, etc. associated with this request should set the `operation_parentId` to the value of the request `id`.</span></span>

<span data-ttu-id="70dfd-122">다른 구성 요소에 대한 HTTP 호출 같은 모든 나가는 작업은 [종속성 원격 분석](application-insights-data-model-dependency-telemetry.md)을 통해 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-122">Every outgoing operation like http call to another component represented by [dependency telemetry](application-insights-data-model-dependency-telemetry.md).</span></span> <span data-ttu-id="70dfd-123">종속성 원격 분석은 전체적으로 고유한 자체 `id`도 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-123">Dependency telemetry also defines its own `id` that is globally unique.</span></span> <span data-ttu-id="70dfd-124">이 종속성 호출을 통해 시작된 요청 원격 분석은 이를 `operation_parentId`로 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-124">Request telemetry, initiated by this dependency call, uses it as `operation_parentId`.</span></span>

<span data-ttu-id="70dfd-125">`operation_Id`, `operation_parentId` 및 `request.id`를 `dependency.id`와 함께 사용하여 분산 논리 작업의 보기를 빌드할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-125">You can build the view of distributed logical operation using `operation_Id`, `operation_parentId`, and `request.id` with `dependency.id`.</span></span> <span data-ttu-id="70dfd-126">해당 필드는 원격 분석 호출의 인과 관계 순서를 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-126">Those fields also define the causality order of telemetry calls.</span></span>

<span data-ttu-id="70dfd-127">마이크로 서비스 환경에서 구성 요소의 추적은 다른 저장소로 이동할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-127">In micro services environment, traces from components may go to the different storages.</span></span> <span data-ttu-id="70dfd-128">모든 구성 요소는 Application Insights에 자체 계측 키가 있을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-128">Every component may have its own instrumentation key in Application Insights.</span></span> <span data-ttu-id="70dfd-129">논리 작업에 대한 원격 분석을 가져오려면 모든 저장소에서 데이터를 쿼리해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-129">To get telemetry for the logical operation, you need to query data from every storage.</span></span> <span data-ttu-id="70dfd-130">저장소 수가 너무 큰 경우에는 다음 찾을 위치에 대한 힌트를 포함해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-130">When number of storages is huge, you need to have a hint on where to look next.</span></span>

<span data-ttu-id="70dfd-131">Application Insights 데이터 모델에서는 이 문제를 해결하기 위해 두 가지 필드, 즉 `request.source` 및 `dependency.target` 필드를 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-131">Application Insights data model defines two fields to solve this problem: `request.source` and `dependency.target`.</span></span> <span data-ttu-id="70dfd-132">첫 번째 필드는 종속성 요청을 시작한 구성 요소를 식별하고, 두 번째 필드는 종속성 호출의 응답을 반환한 구성 요소를 식별합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-132">The first field identifies the component that initiated the dependency request, and the second identifies which component returned the response of the dependency call.</span></span>


## <a name="example"></a><span data-ttu-id="70dfd-133">예제</span><span class="sxs-lookup"><span data-stu-id="70dfd-133">Example</span></span>

<span data-ttu-id="70dfd-134">STOCKS API라는 외부 API를 사용하여 주식의 현재 시가를 보여 주는 응용 프로그램 STOCK PRICES의 예제를 살펴보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-134">Let's take an example of an application STOCK PRICES showing the current market price of a stock using the external API called STOCKS API.</span></span> <span data-ttu-id="70dfd-135">STOCK PRICES 응용 프로그램에는 `GET /Home/Stock`를 사용하여 클라이언트 웹 브라우저에서 연 `Stock page` 페이지가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-135">The STOCK PRICES application has a page `Stock page` opened by the client web browser using `GET /Home/Stock`.</span></span> <span data-ttu-id="70dfd-136">응용 프로그램에서 `GET /api/stock/value` HTTP 호출을 사용하여 STOCK API를 조회합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-136">The application queries the STOCK API by using an HTTP call `GET /api/stock/value`.</span></span>

<span data-ttu-id="70dfd-137">쿼리를 실행하여 결과 원격 분석을 분석할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-137">You can analyze resulting telemetry running a query:</span></span>

```
(requests | union dependencies | union pageViews) 
| where operation_Id == "STYz"
| project timestamp, itemType, name, id, operation_ParentId, operation_Id
```

<span data-ttu-id="70dfd-138">결과 보기에서 모든 원격 분석 항목은 루트 `operation_Id`를 공유합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-138">In the result view note that all telemetry items share the root `operation_Id`.</span></span> <span data-ttu-id="70dfd-139">Ajax 호출이 페이지에서 실행된 경우 새로운 고유 ID `qJSXU`가 종속성 원격 분석에 할당되고 pageView의 ID가 `operation_ParentId`로 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-139">When ajax call made from the page - new unique id `qJSXU` is assigned to the dependency telemetry and pageView's id is used as `operation_ParentId`.</span></span> <span data-ttu-id="70dfd-140">따라서 서버 요청은 Ajax의 ID를 `operation_ParentId`로 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-140">In turn server request uses ajax's id as `operation_ParentId`, etc.</span></span>

| <span data-ttu-id="70dfd-141">itemType</span><span class="sxs-lookup"><span data-stu-id="70dfd-141">itemType</span></span>   | <span data-ttu-id="70dfd-142">name</span><span class="sxs-lookup"><span data-stu-id="70dfd-142">name</span></span>                      | <span data-ttu-id="70dfd-143">id</span><span class="sxs-lookup"><span data-stu-id="70dfd-143">id</span></span>           | <span data-ttu-id="70dfd-144">operation_ParentId</span><span class="sxs-lookup"><span data-stu-id="70dfd-144">operation_ParentId</span></span> | <span data-ttu-id="70dfd-145">operation_Id</span><span class="sxs-lookup"><span data-stu-id="70dfd-145">operation_Id</span></span> |
|------------|---------------------------|--------------|--------------------|--------------|
| <span data-ttu-id="70dfd-146">pageView</span><span class="sxs-lookup"><span data-stu-id="70dfd-146">pageView</span></span>   | <span data-ttu-id="70dfd-147">Stock page</span><span class="sxs-lookup"><span data-stu-id="70dfd-147">Stock page</span></span>                |              | <span data-ttu-id="70dfd-148">STYz</span><span class="sxs-lookup"><span data-stu-id="70dfd-148">STYz</span></span>               | <span data-ttu-id="70dfd-149">STYz</span><span class="sxs-lookup"><span data-stu-id="70dfd-149">STYz</span></span>         |
| <span data-ttu-id="70dfd-150">dependency</span><span class="sxs-lookup"><span data-stu-id="70dfd-150">dependency</span></span> | <span data-ttu-id="70dfd-151">GET /Home/Stock</span><span class="sxs-lookup"><span data-stu-id="70dfd-151">GET /Home/Stock</span></span>           | <span data-ttu-id="70dfd-152">qJSXU</span><span class="sxs-lookup"><span data-stu-id="70dfd-152">qJSXU</span></span>        | <span data-ttu-id="70dfd-153">STYz</span><span class="sxs-lookup"><span data-stu-id="70dfd-153">STYz</span></span>               | <span data-ttu-id="70dfd-154">STYz</span><span class="sxs-lookup"><span data-stu-id="70dfd-154">STYz</span></span>         |
| <span data-ttu-id="70dfd-155">request</span><span class="sxs-lookup"><span data-stu-id="70dfd-155">request</span></span>    | <span data-ttu-id="70dfd-156">GET Home/Stock</span><span class="sxs-lookup"><span data-stu-id="70dfd-156">GET Home/Stock</span></span>            | <span data-ttu-id="70dfd-157">KqKwlrSt9PA=</span><span class="sxs-lookup"><span data-stu-id="70dfd-157">KqKwlrSt9PA=</span></span> | <span data-ttu-id="70dfd-158">qJSXU</span><span class="sxs-lookup"><span data-stu-id="70dfd-158">qJSXU</span></span>              | <span data-ttu-id="70dfd-159">STYz</span><span class="sxs-lookup"><span data-stu-id="70dfd-159">STYz</span></span>         |
| <span data-ttu-id="70dfd-160">dependency</span><span class="sxs-lookup"><span data-stu-id="70dfd-160">dependency</span></span> | <span data-ttu-id="70dfd-161">GET /api/stock/value</span><span class="sxs-lookup"><span data-stu-id="70dfd-161">GET /api/stock/value</span></span>      | <span data-ttu-id="70dfd-162">bBrf2L7mm2g=</span><span class="sxs-lookup"><span data-stu-id="70dfd-162">bBrf2L7mm2g=</span></span> | <span data-ttu-id="70dfd-163">KqKwlrSt9PA=</span><span class="sxs-lookup"><span data-stu-id="70dfd-163">KqKwlrSt9PA=</span></span>       | <span data-ttu-id="70dfd-164">STYz</span><span class="sxs-lookup"><span data-stu-id="70dfd-164">STYz</span></span>         |

<span data-ttu-id="70dfd-165">이제 호출 `GET /api/stock/value`가 외부 서비스에 대해 실행될 경우 해당 서버의 ID를 알아야 합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-165">Now when the call `GET /api/stock/value` made to an external service you want to know the identity of that server.</span></span> <span data-ttu-id="70dfd-166">따라서 `dependency.target` 필드를 적절하게 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-166">So you can set `dependency.target` field appropriately.</span></span> <span data-ttu-id="70dfd-167">외부 서비스가 모니터링을 지원하지 않을 경우 `target`은 서비스의 호스트 이름으로 설정됩니다(예: `stock-prices-api.com`).</span><span class="sxs-lookup"><span data-stu-id="70dfd-167">When the external service does not support monitoring - `target` is set to the host name of the service like `stock-prices-api.com`.</span></span> <span data-ttu-id="70dfd-168">하지만 해당 서비스가 미리 정의된 HTTP 헤더를 반환하는 방식으로 자신을 식별하면 `target`에는 Application Insights가 해당 서비스에서 원격 분석을 쿼리하여 분산 추적을 빌드하는 데 사용되는 서비스 ID가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-168">However if that service identifies itself by returning a predefined HTTP header - `target` contains the service identity that allows Application Insights to build distributed trace by querying telemetry from that service.</span></span> 

## <a name="correlation-headers"></a><span data-ttu-id="70dfd-169">상관 관계 헤더</span><span class="sxs-lookup"><span data-stu-id="70dfd-169">Correlation headers</span></span>

<span data-ttu-id="70dfd-170">현재 [correlation HTTP protocol](https://github.com/lmolkova/correlation/blob/master/http_protocol_proposal_v1.md)(상관 관계 HTTP 프로토콜)에 대한 RFC 제안 작업을 진행하고 있습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-170">We are working on RFC proposal for the [correlation HTTP protocol](https://github.com/lmolkova/correlation/blob/master/http_protocol_proposal_v1.md).</span></span> <span data-ttu-id="70dfd-171">이 제안은 다음 두 가지 헤더를 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-171">This proposal defines two headers:</span></span>

- <span data-ttu-id="70dfd-172">`Request-Id`는 호출의 전체적으로 고유한 ID를 전달합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-172">`Request-Id` carry the globally unique id of the call</span></span>
- <span data-ttu-id="70dfd-173">`Correlation-Context` - 분산 추적 속성의 이름-값 쌍 컬렉션을 전달합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-173">`Correlation-Context` - carry the name value pairs collection of the distributed trace properties</span></span>

<span data-ttu-id="70dfd-174">표준은 `Request-Id` 생성의 두 가지 스키마인 플랫 및 계층 구조를 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-174">The standard also defines two schemas of `Request-Id` generation - flat and hierarchical.</span></span> <span data-ttu-id="70dfd-175">플랫 스키마의 경우 `Correlation-Context` 컬렉션에 대한 잘 알려진 `Id` 키가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-175">With the flat schema, there is a well-known `Id` key defined for the `Correlation-Context` collection.</span></span>

<span data-ttu-id="70dfd-176">Application Insights에서는 상관 관계 HTTP 프로토콜에 대한 [extension](https://github.com/lmolkova/correlation/blob/master/http_protocol_proposal_v2.md)(확장)을 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-176">Application Insights defines the [extension](https://github.com/lmolkova/correlation/blob/master/http_protocol_proposal_v2.md) for the correlation HTTP protocol.</span></span> <span data-ttu-id="70dfd-177">`Request-Context` 이름-값 쌍을 사용하여 즉각적인 호출자 또는 호출 수신자에서 사용된 속성 컬렉션을 전파합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-177">It uses `Request-Context` name value pairs to propagate the collection of properties used by the immediate caller or callee.</span></span> <span data-ttu-id="70dfd-178">Application Insights SDK는 이 헤더를 사용하여 `dependency.target` 및 `request.source` 필드를 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-178">Application Insights SDK uses this header to set `dependency.target` and `request.source` fields.</span></span>

## <a name="open-tracing-and-application-insights"></a><span data-ttu-id="70dfd-179">Open Tracing 및 Application Insights</span><span class="sxs-lookup"><span data-stu-id="70dfd-179">Open tracing and Application Insights</span></span>

<span data-ttu-id="70dfd-180">[Open Tracing](http://opentracing.io/) 및 Application Insights 데이터 모델은 다음과 같이 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-180">[Open Tracing](http://opentracing.io/) and Application Insights data models looks</span></span> 

- <span data-ttu-id="70dfd-181">`request`, `pageView`가 **Span**으로 매핑되고 `span.kind = server`입니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-181">`request`, `pageView` maps to **Span** with `span.kind = server`</span></span>
- <span data-ttu-id="70dfd-182">`dependency`가 **Span**을 매핑되고 `span.kind = client`입니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-182">`dependency` maps to **Span** with `span.kind = client`</span></span>
- <span data-ttu-id="70dfd-183">`request` 및 `dependency`의 `id`가 **Span.Id**로 매핑됩니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-183">`id` of a `request` and `dependency` maps to **Span.Id**</span></span>
- <span data-ttu-id="70dfd-184">`operation_Id`가 **TraceId**로 매핑됩니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-184">`operation_Id` maps to **TraceId**</span></span>
- <span data-ttu-id="70dfd-185">`operation_ParentId`가 `ChileOf` 형식의 **Reference**로 매핑됩니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-185">`operation_ParentId` maps to **Reference** of type `ChileOf`</span></span>

<span data-ttu-id="70dfd-186">Application Insights 형식 및 데이터 모델에 대한 자세한 내용은 [데이터 모델](application-insights-data-model.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="70dfd-186">See [data model](application-insights-data-model.md) for Application Insights types and data model.</span></span>

<span data-ttu-id="70dfd-187">Open Tracing 개념의 정의는 [specification](https://github.com/opentracing/specification/blob/master/specification.md)(사양) 및 [semantic_conventions](https://github.com/opentracing/specification/blob/master/semantic_conventions.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="70dfd-187">See [specification](https://github.com/opentracing/specification/blob/master/specification.md) and [semantic_conventions](https://github.com/opentracing/specification/blob/master/semantic_conventions.md) for definitions of Open Tracing concepts.</span></span>


## <a name="telemetry-correlation-in-net"></a><span data-ttu-id="70dfd-188">.NET의 원격 분석 상관 관계</span><span class="sxs-lookup"><span data-stu-id="70dfd-188">Telemetry correlation in .NET</span></span>

<span data-ttu-id="70dfd-189">시간이 지나면서 .NET에서는 원격 분석과 진단 로그를 상호 연결하는 수많은 방법을 정의했습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-189">Over time .NET defined number of ways to correlate telemetry and diagnostics logs.</span></span> <span data-ttu-id="70dfd-190">[LogicalOperationStack and ActivityId](https://msdn.microsoft.com/library/system.diagnostics.correlationmanager.aspx)(LogicalOperationStack 및 ActivityId)를 추적할 수 있는 `System.Diagnostics.CorrelationManager`가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-190">There is `System.Diagnostics.CorrelationManager` allowing to track [LogicalOperationStack and ActivityId](https://msdn.microsoft.com/library/system.diagnostics.correlationmanager.aspx).</span></span> <span data-ttu-id="70dfd-191">`System.Diagnostics.Tracing.EventSource` 및 Windows ETW는 [SetCurrentThreadActivityId](https://msdn.microsoft.com/library/system.diagnostics.tracing.eventsource.setcurrentthreadactivityid.aspx) 메서드를 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-191">`System.Diagnostics.Tracing.EventSource` and Windows ETW define the method [SetCurrentThreadActivityId](https://msdn.microsoft.com/library/system.diagnostics.tracing.eventsource.setcurrentthreadactivityid.aspx).</span></span> <span data-ttu-id="70dfd-192">`ILogger`는 [Log Scopes](https://docs.microsoft.com/aspnet/core/fundamentals/logging#log-scopes)(로그 범위)를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-192">`ILogger` uses [Log Scopes](https://docs.microsoft.com/aspnet/core/fundamentals/logging#log-scopes).</span></span> <span data-ttu-id="70dfd-193">WCF 및 HTTP는 "현재" 컨텍스트 전파를 연결합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-193">WCF and Http wire up "current" context propagation.</span></span>

<span data-ttu-id="70dfd-194">하지만 해당 메서드는 자동 분산 추적 지원을 사용하지 않았습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-194">However those methods didn't enable automatic distributed tracing support.</span></span> <span data-ttu-id="70dfd-195">`DiagnosticsSource`는 자동 컴퓨터 간 상관 관계를 지원하는 한 가지 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-195">`DiagnosticsSource` is a way to support automatic cross machine correlation.</span></span> <span data-ttu-id="70dfd-196">.NET 라이브러리는 Diagnostics Source를 지원하고 HTTP 같은 전송을 통해 상관 관계 컨텍스트의 자동 컴퓨터 간 전파를 허용합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-196">.NET libraries support Diagnostics Source and allow automatic cross machine propagation of the correlation context via the transport like http.</span></span>

<span data-ttu-id="70dfd-197">Diagnostics Source의 [guide to Activities](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/ActivityUserGuide.md)(활동 가이드)에서는 활동 추적의 기본 사항을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-197">The [guide to Activities](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/ActivityUserGuide.md) in Diagnostics Source explains the basics of tracking Activities.</span></span> 

<span data-ttu-id="70dfd-198">ASP.NET Core 2.0에서는 HTTP 헤더 추출 및 새 활동 시작을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-198">ASP.NET Core 2.0 supports extraction of Http Headers and starting the new Activity.</span></span> 

<span data-ttu-id="70dfd-199">`System.Net.HttpClient` 시작 버전 `<fill in>`에서는 상관 관계 Http 헤더의 자동 삽입 및 http 호출을 활동으로 추적하는 기능을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-199">`System.Net.HttpClient` starting version `<fill in>` supports automatic injection of the correlation Http Headers and tracking the http call as an Activity.</span></span>

<span data-ttu-id="70dfd-200">ASP.NET 클래식에 대한 새로운 HTTP 모듈 [Microsoft.AspNet.TelemetryCorrelation](https://www.nuget.org/packages/Microsoft.AspNet.TelemetryCorrelation/)이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-200">There is a new Http Module [Microsoft.AspNet.TelemetryCorrelation](https://www.nuget.org/packages/Microsoft.AspNet.TelemetryCorrelation/) for the ASP.NET Classic.</span></span> <span data-ttu-id="70dfd-201">이 모듈은 DiagnosticsSource를 사용하여 원격 분석 상관 관계를 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-201">This module implements telemetry correlation using DiagnosticsSource.</span></span> <span data-ttu-id="70dfd-202">들어오는 요청 헤더를 기반으로 활동을 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-202">It starts activity based on incoming request headers.</span></span> <span data-ttu-id="70dfd-203">또한 서로 다른 요청 처리 단계의 원격 분석을 상호 연결합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-203">It also correlates telemetry from the different stages of request processing.</span></span> <span data-ttu-id="70dfd-204">IIS 처리의 모든 단계가 서로 다른 관리 스레드에서 실행되는 경우에도 마찬가지입니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-204">Even for the cases when every stage of IIS processing runs on a different manage threads.</span></span>

<span data-ttu-id="70dfd-205">Application Insights SDK 시작 버전 `2.4.0-beta1`에서는 DiagnosticsSource 및 활동을 사용하여 원격 분석을 수집하고 이를 현재 활동과 연결합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-205">Application Insights SDK starting version `2.4.0-beta1` uses DiagnosticsSource and Activity to collect telemetry and associate it with the current activity.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="70dfd-206">다음 단계</span><span class="sxs-lookup"><span data-stu-id="70dfd-206">Next steps</span></span>

- <span data-ttu-id="70dfd-207">[사용자 지정 원격 분석을 작성합니다](app-insights-api-custom-events-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="70dfd-207">[Write custom telemetry](app-insights-api-custom-events-metrics.md)</span></span>
- <span data-ttu-id="70dfd-208">Application Insights에서 마이크로 서비스의 모든 구성 요소를 등록합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-208">Onboard all components of your micro service on Application Insights.</span></span> <span data-ttu-id="70dfd-209">[지원되는 플랫폼](app-insights-platforms.md)을 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-209">Check out [supported platforms](app-insights-platforms.md).</span></span>
- <span data-ttu-id="70dfd-210">Application Insights 형식 및 데이터 모델에 대한 자세한 내용은 [데이터 모델](application-insights-data-model.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="70dfd-210">See [data model](application-insights-data-model.md) for Application Insights types and data model.</span></span>
- <span data-ttu-id="70dfd-211">[원격 분석을 확장 및 필터링](app-insights-api-filtering-sampling.md)하는 방법을 알아봅니다.</span><span class="sxs-lookup"><span data-stu-id="70dfd-211">Learn how to [extend and filter telemetry](app-insights-api-filtering-sampling.md).</span></span>
